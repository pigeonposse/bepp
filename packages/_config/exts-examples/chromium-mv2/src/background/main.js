var __defProp=Object.defineProperty,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value,__publicField=(obj,key,value)=>(__defNormalProp(obj,"symbol"!=typeof key?key+"":key,value),value),__accessCheck=(obj,member,msg)=>{if(!member.has(obj))throw TypeError("Cannot "+msg)},__privateGet=(obj,member,getter)=>(__accessCheck(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),__privateAdd=(obj,member,value)=>{if(member.has(obj))throw TypeError("Cannot add the same private member more than once");member instanceof WeakSet?member.add(obj):member.set(obj,value)},__privateSet=(obj,member,value,setter)=>(__accessCheck(obj,member,"write to private field"),setter?setter.call(obj,value):member.set(obj,value),value),__privateMethod=(obj,member,method)=>(__accessCheck(obj,member,"access private method"),method);!function(){var _addStyleTagToHeadHtml,addStyleTagToHeadHtml_fn,_transformDataToCSS,transformDataToCSS_fn,_values,values_fn,_functions,functions_fn,_values2,values_fn2,_functions2,functions_fn2,_values3,values_fn3,_functions3,functions_fn3,_menuExt,_menuOrg,_menuContent,_menus,menus_fn,_contextMenu,_storage,_setErrors,setErrors_fn;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var browserPolyfill={exports:{}};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,function(module2){var _a2,_b;if(!(null==(_b=null==(_a2=globalThis.chrome)?void 0:_a2.runtime)?void 0:_b.id))throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE="The message port closed before a response was received.",wrapAPIs=extensionAPIs=>{const apiMetadata={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(apiMetadata).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class DefaultWeakMap extends WeakMap{constructor(createItem,items2=void 0){super(items2),this.createItem=createItem}get(key){return this.has(key)||this.set(key,this.createItem(key)),super.get(key)}}const isThenable=value=>value&&"object"==typeof value&&"function"==typeof value.then,makeCallback=(promise2,metadata)=>(...callbackArgs)=>{extensionAPIs.runtime.lastError?promise2.reject(new Error(extensionAPIs.runtime.lastError.message)):metadata.singleCallbackArg||callbackArgs.length<=1&&!1!==metadata.singleCallbackArg?promise2.resolve(callbackArgs[0]):promise2.resolve(callbackArgs)},pluralizeArguments=numArgs=>1==numArgs?"argument":"arguments",wrapAsyncFunction=(name2,metadata)=>function(target,...args){if(args.length<metadata.minArgs)throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name2}(), got ${args.length}`);if(args.length>metadata.maxArgs)throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name2}(), got ${args.length}`);return new Promise(((resolve,reject)=>{if(metadata.fallbackToNoCallback)try{target[name2](...args,makeCallback({resolve:resolve,reject:reject},metadata))}catch(cbError){console.warn(`${name2} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,cbError),target[name2](...args),metadata.fallbackToNoCallback=!1,metadata.noCallback=!0,resolve()}else metadata.noCallback?(target[name2](...args),resolve()):target[name2](...args,makeCallback({resolve:resolve,reject:reject},metadata))}))},wrapMethod=(target,method,wrapper)=>new Proxy(method,{apply:(targetMethod,thisObj,args)=>wrapper.call(thisObj,target,...args)});let hasOwnProperty=Function.call.bind(Object.prototype.hasOwnProperty);const wrapObject=(target,wrappers={},metadata={})=>{let cache=Object.create(null),handlers2={has:(proxyTarget2,prop)=>prop in target||prop in cache,get(proxyTarget2,prop,receiver){if(prop in cache)return cache[prop];if(!(prop in target))return;let value=target[prop];if("function"==typeof value)if("function"==typeof wrappers[prop])value=wrapMethod(target,target[prop],wrappers[prop]);else if(hasOwnProperty(metadata,prop)){let wrapper=wrapAsyncFunction(prop,metadata[prop]);value=wrapMethod(target,target[prop],wrapper)}else value=value.bind(target);else if("object"==typeof value&&null!==value&&(hasOwnProperty(wrappers,prop)||hasOwnProperty(metadata,prop)))value=wrapObject(value,wrappers[prop],metadata[prop]);else{if(!hasOwnProperty(metadata,"*"))return Object.defineProperty(cache,prop,{configurable:!0,enumerable:!0,get:()=>target[prop],set(value2){target[prop]=value2}}),value;value=wrapObject(value,wrappers[prop],metadata["*"])}return cache[prop]=value,value},set:(proxyTarget2,prop,value,receiver)=>(prop in cache?cache[prop]=value:target[prop]=value,!0),defineProperty:(proxyTarget2,prop,desc)=>Reflect.defineProperty(cache,prop,desc),deleteProperty:(proxyTarget2,prop)=>Reflect.deleteProperty(cache,prop)},proxyTarget=Object.create(target);return new Proxy(proxyTarget,handlers2)},wrapEvent=wrapperMap=>({addListener(target,listener,...args){target.addListener(wrapperMap.get(listener),...args)},hasListener:(target,listener)=>target.hasListener(wrapperMap.get(listener)),removeListener(target,listener){target.removeListener(wrapperMap.get(listener))}}),onRequestFinishedWrappers=new DefaultWeakMap((listener=>"function"!=typeof listener?listener:function(req){const wrappedReq=wrapObject(req,{},{getContent:{minArgs:0,maxArgs:0}});listener(wrappedReq)})),onMessageWrappers=new DefaultWeakMap((listener=>"function"!=typeof listener?listener:function(message,sender,sendResponse){let wrappedSendResponse,result,didCallSendResponse=!1,sendResponsePromise=new Promise((resolve=>{wrappedSendResponse=function(response){didCallSendResponse=!0,resolve(response)}}));try{result=listener(message,sender,wrappedSendResponse)}catch(err){result=Promise.reject(err)}const isResultThenable=!0!==result&&isThenable(result);if(!0!==result&&!isResultThenable&&!didCallSendResponse)return!1;const sendPromisedResult=promise2=>{promise2.then((msg=>{sendResponse(msg)}),(error=>{let message2;message2=error&&(error instanceof Error||"string"==typeof error.message)?error.message:"An unexpected error occurred",sendResponse({__mozWebExtensionPolyfillReject__:!0,message:message2})})).catch((err=>{console.error("Failed to send onMessage rejected reply",err)}))};return sendPromisedResult(isResultThenable?result:sendResponsePromise),!0})),wrappedSendMessageCallback=({reject:reject,resolve:resolve},reply)=>{extensionAPIs.runtime.lastError?extensionAPIs.runtime.lastError.message===CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE?resolve():reject(new Error(extensionAPIs.runtime.lastError.message)):reply&&reply.__mozWebExtensionPolyfillReject__?reject(new Error(reply.message)):resolve(reply)},wrappedSendMessage=(name2,metadata,apiNamespaceObj,...args)=>{if(args.length<metadata.minArgs)throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name2}(), got ${args.length}`);if(args.length>metadata.maxArgs)throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name2}(), got ${args.length}`);return new Promise(((resolve,reject)=>{const wrappedCb=wrappedSendMessageCallback.bind(null,{resolve:resolve,reject:reject});args.push(wrappedCb),apiNamespaceObj.sendMessage(...args)}))},staticWrappers={devtools:{network:{onRequestFinished:wrapEvent(onRequestFinishedWrappers)}},runtime:{onMessage:wrapEvent(onMessageWrappers),onMessageExternal:wrapEvent(onMessageWrappers),sendMessage:wrappedSendMessage.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:wrappedSendMessage.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},settingMetadata={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return apiMetadata.privacy={network:{"*":settingMetadata},services:{"*":settingMetadata},websites:{"*":settingMetadata}},wrapObject(extensionAPIs,staticWrappers,apiMetadata)};module2.exports=wrapAPIs(chrome)}else module2.exports=globalThis.browser}(browserPolyfill);var browserPolyfillExports=browserPolyfill.exports;const isBrowser=object=>!!(object&&object.storage&&object.storage.sync),isFirefox=()=>{try{return isBrowser(browser)}catch(e){return!1}},is=Object.freeze(Object.defineProperty({__proto__:null,isChromium:()=>{try{return isBrowser(chrome)&&!isFirefox()}catch(e){return!1}},isFirefox:isFirefox},Symbol.toStringTag,{value:"Module"})),browser$3={i18n:browserPolyfillExports.i18n,storage:browserPolyfillExports.storage,runtime:browserPolyfillExports.runtime,contextMenus:browserPolyfillExports.contextMenus,menus:browserPolyfillExports.menus,tabs:browserPolyfillExports.tabs,...is},debounce$2=(cb,delay=250)=>{let timeout;return(...args)=>{clearTimeout(timeout),timeout=setTimeout((()=>{cb(...args)}),delay)}},writeToStorage=(key,data2)=>{browser$3.storage.sync.set({[key]:data2})},setKey=writeToStorage,setKeyWithDebounce=debounce$2(writeToStorage,500),set=browser$3.storage.sync.set,setWithDebounce=debounce$2(set,500),store$1={clearAll:browser$3.storage.sync.clear,get:async key=>new Promise(((resolve,reject)=>{browser$3.storage.sync.get(key).then((result=>{resolve(null===key?result:result[key])})).catch((error=>{console.error("Error getting data from storage:",error),reject(error)}))})),set:set,setWithDebounce:setWithDebounce,setKey:setKey,setKeyWithDebounce:setKeyWithDebounce},pkgMain={name:"s-8",private:!0,type:"module",description:"\ud83c\udfac\ud83c\udfa8\ud83e\udde9 Add styles to web videos like iFrames, YouTube & Vimeo videos, Netflix, Amazon etc",keywords:["super-8","youtube","styles","video","iframe","browser-extension","chrome-extension","web"],homepage:"https://super8.pigeonposse.com/",bugs:{url:"https://github.com/pigeonposse/super8/issues",email:"dev@pigeonposse.com"},repository:{type:"git",url:"https://github.com/pigeonposse/super8"},funding:{type:"individual",url:"https://pigeonposse.com/?popup=donate"},author:{name:"Angelo",email:"angelo@pigeonposse.com",url:"https://pigeonposse.com"},workspaces:["packages/*"],scripts:{prepare:"husky install .dev/husky",core:"pnpm --filter core $@","core-react":"pnpm --filter core-react $@",docs:"pnpm --filter docs $@",exts:"pnpm --filter exts $@",web:"pnpm --filter web $@",dev:"turbo dev","dev:core":"turbo dev --filter=core --filter=core-react","dev:exts":"turbo dev --filter=core --filter=exts","dev:web":"turbo dev --filter=core --filter=web --filter=docs","dev:docs":"turbo dev --filter=core --filter=web","dev-info":"md docs/dev-info.md",build:"turbo build","build:core":"turbo lint build test --filter=core --filter=core-react","build:exts":"turbo lint build test --filter=core --filter=exts","build:web":"turbo lint build test --filter=core --filter=web","build:docs":"turbo lint build test --filter=docs",lint:"pnpm eslint .","lint-fix":"pnpm eslint . --fix",test:"turbo test",cm:"cz","cm-origin":"git add . && pnpm cm && git push -f origin $@","update-version":"changeset && changeset version","publish-npm":"pnpm build:core && pnpm update-version && changeset publish","push-main":"pnpm cm-origin main","push-dev":"pnpm cm-origin dev",todo:"node .dev/todo.js"},commitlint:{extends:["gitmoji"],rules:{"header-max-length":[0,"always",100]}},config:{commitizen:{path:"./node_modules/cz-customizable"},"cz-customizable":{config:".dev/cz-config.cjs"}},"lint-staged":{"*.{js,cjs,mjs,jsx,ts,cts,mts,tsx,json}":"eslint"},devDependencies:{"@changesets/changelog-github":"^0.4.8","@changesets/cli":"^2.26.2","@commitlint/cli":"^18.4.1","@playwright/test":"^1.39.0","@sveltejs/adapter-auto":"^2.1.1","@sveltejs/kit":"^1.27.5","@sveltejs/package":"^2.2.2","@sveltejs/vite-plugin-svelte":"^2.5.2","@tsconfig/svelte":"^5.0.2","@typescript-eslint/eslint-plugin":"^6.10.0","@typescript-eslint/parser":"^6.10.0",autoprefixer:"^10.4.16",browserslist:"^4.22.1","cli-markdown":"^3.0.5",commitizen:"^4.3.0","commitlint-config-gitmoji":"^2.3.1","cz-customizable":"^7.0.0","cz-emoji":"1.3.2-canary.2",eslint:"^8.53.0","eslint-plugin-align-assignments":"^1.1.2","eslint-plugin-align-import":"^1.0.0","eslint-plugin-html":"^7.1.0","eslint-plugin-import":"^2.29.0","eslint-plugin-jsdoc":"^46.9.0","eslint-plugin-json":"^3.1.0","eslint-plugin-jsonc":"^2.10.0","eslint-plugin-promise":"^6.1.1","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-react-refresh":"^0.4.4","eslint-plugin-svelte":"^2.35.0","eslint-plugin-tailwindcss":"^3.13.0","eslint-plugin-yaml":"^0.5.0",husky:"^8.0.3",inquirer:"^9.2.12","jsonc-eslint-parser":"^2.4.0","lint-staged":"^15.1.0",markdownlint:"^0.31.1","npm-run-all":"^4.1.5",open:"^9.1.0",postcss:"^8.4.31",publint:"^0.1.16",rimraf:"^5.0.5",svelte:"^4.2.3","svelte-check":"^3.6.0","svelte-eslint-parser":"^0.33.1","svelte-preprocess":"5.0.4","tailwind-merge":"^1.14.0",tailwindcss:"^3.3.5",terser:"^5.24.0",tslib:"^2.6.2",turbo:"^1.10.16",typescript:"^5.2.2",vite:"4.5.0","vite-plugin-dts":"^3.6.3","web-ext":"^7.8.0"},packageManager:"pnpm@8.10.0",engines:{node:">=18.17.1",pnpm:">=8.10.0"},extra:{productName:"Super8",docsUrl:"https://docs.super8.pigeonposse.com",socialLinks:[{icon:"github",link:"https://github.com/pigeonposse/super8"},{icon:"twitter",link:"https://twitter.com/pigeonposse_"},{icon:"instagram",link:"https://www.instagram.com/pigeon.posse/"}],store:{chrome:{url:"https://chromewebstore.google.com/detail/super8/aejkinmllndkgoodkfbhfkffnebmibkd",id:"aejkinmllndkgoodkfbhfkffnebmibkd"},mozilla:{url:"https://addons.mozilla.org/es/firefox/addon/super8/",id:"{63bba7f4-510b-4478-b401-a2726a9703ba}"},wpPlugin:{url:"https://es.wordpress.org/plugins/fake-admin/"},wpPluginPremium:{url:"https://pigeonposse.gumroad.com/"}},collective:{name:"PigeonPosse",gh:"https://github.com/pigeonposse",about:"https://pigeonposse.com?popup=about",url:"https://pigeonposse.com",web:"https://pigeonposse.com",email:"dev@pigeonposse.com"}}},pkg={name:"@s-8/exts",description:"Super8 browser extensions",private:!0,version:"0.0.3",type:"module",scripts:{dev:"run-p dev:chrome","dev:chrome":"rimraf dist/chrome && TARGET=chrome vite dev","dev:firefox":"rimraf dist/chrome && TARGET=firefox vite","watch:chrome":"NODE_ENV=development TARGET=chrome vite build --watch","watch:firefox":"NODE_ENV=development TARGET=firefox vite build --watch",build:"run-p build:* && pnpm zip","build:chrome":"rimraf dist/chrome && NODE_ENV=production TARGET=chrome vite build","build:firefox":"rimraf dist/firefox && NODE_ENV=production TARGET=firefox vite build",zip:"node zip.js",lint:"run-p lint:js","lint:js":"pnpm eslint .","lint:svelte":"svelte-check --tsconfig ./tsconfig.json",test:""},devDependencies:{"@s-8/core":"0.0.4","@types/chrome":"0.0.243","@types/webextension-polyfill":"^0.10.5",flowbite:"^1.8.1","flowbite-svelte":"^0.39.3",lightningcss:"^1.22.0","postcss-prefix-selector":"^1.16.0","vite-plugin-web-extension":"^3.2.0","webextension-polyfill":"^0.10.0","zip-a-folder":"^2.0.2"},extra:{devServerPort:"5173"},webExt:{run:{startUrl:["https://www.youtube.com/watch?v=UN1hu4e-VmM","https://www.twitch.tv/","https://www.filmin.es/","https://vimeo.com","https://www.disneyplus.com/","https://www.netflix.com/","chrome://extensions/"],devtools:!0}},repository:{type:"git",url:"https://github.com/pigeonposse/super8/packages/exts"},author:{name:"Angelo",email:"angelo@pigeonposse.com",url:"https://pigeonposse.com"}},{version:version}=pkg,[major,minor,patch]=version.replace(/[^\d.-]+/g,"").split(/[.-]/),allowSites={youtube:["https://www.youtube.com/"],vimeo:["https://vimeo.com/"],twitch:["https://www.twitch.tv/"],filmin:["https://www.filmin.es/"],disney:["https://www.disneyplus.com/"],netflix:["https://www.netflix.com/"],primevideo:["https://www.primevideo.com/"]},images={icons:{16:"images/icon-16.png",32:"images/icon-32.png",48:"images/icon-48.png",96:"images/icon-96.png",128:"images/icon-128.png"},background:"images/background.png",logo:"images/logo.png"};(urlStarts=>{const combinedUrls=[];for(const site2 in urlStarts){const urlList=urlStarts[site2];if(urlList&&Array.isArray(urlList)){const urls=urlList.map((url=>url.endsWith("*")?url:url+"*"));combinedUrls.push(...urls)}}})(allowSites);pkg.author.name;const extImagesSrc=images,extVersion=pkg.version,extRepoUrl=pkgMain.repository.url,extRepoBugsUrl=pkgMain.bugs.url,extStoreUrl=browser$3.isChromium()?pkgMain.extra.store.chrome.url:pkgMain.extra.store.mozilla.url,extWebUrl=pkgMain.homepage,collectiveRepoUrl=pkgMain.extra.collective.gh,collectiveAboutUrl=pkgMain.extra.collective.about,collectiveFundingUrl=pkgMain.funding.url,collectiveWebUrl=pkgMain.extra.collective.web,data=Object.freeze(Object.defineProperty({__proto__:null,collectiveAboutUrl:collectiveAboutUrl,collectiveFundingUrl:collectiveFundingUrl,collectiveRepoUrl:collectiveRepoUrl,collectiveWebUrl:collectiveWebUrl,extImagesSrc:extImagesSrc,extRepoBugsUrl:extRepoBugsUrl,extRepoUrl:extRepoUrl,extStoreUrl:extStoreUrl,extVersion:extVersion,extWebUrl:extWebUrl,openOptionsPage:()=>browser$3.runtime.openOptionsPage()},Symbol.toStringTag,{value:"Module"})),storageGroupsIds={option:"option",content:"content"},storageSetIds_set="set",messagesIds_log="log",messagesIds_activeFilters="active-filters",insertedAdjacentPosition_afterbegin="afterbegin",insertedAdjacentPosition_afterend="afterend",optBtnStylesIds_theme="opts-btn-styles-theme",storageIds_options="options",storageIds_active="content-active",storageIds_hide="content-hide",storageIds_values="content-values",storageIds_presets="content-presets",optionsIds={options:"options",content:"content",popup:"popup",bg:"background",contentDiv:"pp-s8-content",filters:"pp-s8-extension",filtersSidebar:{display:"button-display",insidePlayer:"button-inside-player",popupPosition:"popup-position",buttonPosition:"button-position",styleTheme:"button-style-theme"},allowSites:{youtube:"allow-youtube",vimeo:"allow-vimeo",twitch:"allow-twitch",filmin:"allow-filmin",netflix:"allow-netflix",disney:"allow-disney",primevideo:"allow-primevideo"}},getDateString=()=>{const currentdate=new Date;return currentdate.getDate(),currentdate.getMonth(),currentdate.getFullYear(),currentdate.getHours(),currentdate.getMinutes(),currentdate.getSeconds(),currentdate};function noop(){}const identity=x=>x;function assign(tar,src){for(const k in src)tar[k]=src[k];return tar}function run(fn){return fn()}function blank_object(){return Object.create(null)}function run_all(fns){fns.forEach(run)}function is_function(thing){return"function"==typeof thing}function safe_not_equal(a,b){return a!=a?b==b:a!==b||a&&"object"==typeof a||"function"==typeof a}function subscribe(store2,...callbacks){if(null==store2){for(const callback of callbacks)callback(void 0);return noop}const unsub=store2.subscribe(...callbacks);return unsub.unsubscribe?()=>unsub.unsubscribe():unsub}function get_store_value(store2){let value;return subscribe(store2,(_=>value=_))(),value}function component_subscribe(component,store2,callback){component.$$.on_destroy.push(subscribe(store2,callback))}function create_slot(definition,ctx,$$scope,fn){if(definition){const slot_ctx=get_slot_context(definition,ctx,$$scope,fn);return definition[0](slot_ctx)}}function get_slot_context(definition,ctx,$$scope,fn){return definition[1]&&fn?assign($$scope.ctx.slice(),definition[1](fn(ctx))):$$scope.ctx}function get_slot_changes(definition,$$scope,dirty,fn){if(definition[2]&&fn){const lets=definition[2](fn(dirty));if(void 0===$$scope.dirty)return lets;if("object"==typeof lets){const merged=[],len=Math.max($$scope.dirty.length,lets.length);for(let i2=0;i2<len;i2+=1)merged[i2]=$$scope.dirty[i2]|lets[i2];return merged}return $$scope.dirty|lets}return $$scope.dirty}function update_slot_base(slot,slot_definition,ctx,$$scope,slot_changes,get_slot_context_fn){if(slot_changes){const slot_context=get_slot_context(slot_definition,ctx,$$scope,get_slot_context_fn);slot.p(slot_context,slot_changes)}}function get_all_dirty_from_scope($$scope){if($$scope.ctx.length>32){const dirty=[],length=$$scope.ctx.length/32;for(let i2=0;i2<length;i2++)dirty[i2]=-1;return dirty}return-1}function exclude_internal_props(props){const result={};for(const k in props)"$"!==k[0]&&(result[k]=props[k]);return result}function compute_rest_props(props,keys2){const rest={};keys2=new Set(keys2);for(const k in props)keys2.has(k)||"$"===k[0]||(rest[k]=props[k]);return rest}function compute_slots(slots){const result={};for(const key in slots)result[key]=!0;return result}function action_destroyer(action_result){return action_result&&is_function(action_result.destroy)?action_result.destroy:noop}function split_css_unit(value){const split="string"==typeof value&&value.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return split?[parseFloat(split[1]),split[2]||"px"]:[value,"px"]}const is_client="undefined"!=typeof window;let now=is_client?()=>window.performance.now():()=>Date.now(),raf=is_client?cb=>requestAnimationFrame(cb):noop;const tasks=new Set;function run_tasks(now2){tasks.forEach((task=>{task.c(now2)||(tasks.delete(task),task.f())})),0!==tasks.size&&raf(run_tasks)}function append(target,node){target.appendChild(node)}function get_root_for_style(node){if(!node)return document;const root=node.getRootNode?node.getRootNode():node.ownerDocument;return root&&root.host?root:node.ownerDocument}function append_empty_stylesheet(node){const style_element=element("style");return style_element.textContent="/* empty */",function(node,style){append(node.head||node,style),style.sheet}(get_root_for_style(node),style_element),style_element.sheet}function insert$1(target,node,anchor){target.insertBefore(node,anchor||null)}function detach(node){node.parentNode&&node.parentNode.removeChild(node)}function destroy_each(iterations,detaching){for(let i2=0;i2<iterations.length;i2+=1)iterations[i2]&&iterations[i2].d(detaching)}function element(name2){return document.createElement(name2)}function svg_element(name2){return document.createElementNS("http://www.w3.org/2000/svg",name2)}function text(data2){return document.createTextNode(data2)}function space(){return text(" ")}function empty$1(){return text("")}function listen(node,event,handler,options){return node.addEventListener(event,handler,options),()=>node.removeEventListener(event,handler,options)}function attr(node,attribute,value){null==value?node.removeAttribute(attribute):node.getAttribute(attribute)!==value&&node.setAttribute(attribute,value)}const always_set_through_set_attribute=["width","height"];function set_attributes(node,attributes){const descriptors=Object.getOwnPropertyDescriptors(node.__proto__);for(const key in attributes)null==attributes[key]?node.removeAttribute(key):"style"===key?node.style.cssText=attributes[key]:"__value"===key?node.value=node[key]=attributes[key]:descriptors[key]&&descriptors[key].set&&-1===always_set_through_set_attribute.indexOf(key)?node[key]=attributes[key]:attr(node,key,attributes[key])}function set_svg_attributes(node,attributes){for(const key in attributes)attr(node,key,attributes[key])}function set_custom_element_data_map(node,data_map){Object.keys(data_map).forEach((key=>{!function(node,prop,value){const lower=prop.toLowerCase();lower in node?node[lower]="boolean"==typeof node[lower]&&""===value||value:prop in node?node[prop]="boolean"==typeof node[prop]&&""===value||value:attr(node,prop,value)}(node,key,data_map[key])}))}function set_dynamic_element_data(tag){return/-/.test(tag)?set_custom_element_data_map:set_attributes}function to_number(value){return""===value?null:+value}function set_data(text2,data2){data2=""+data2,text2.data!==data2&&(text2.data=data2)}function set_input_value(input,value){input.value=null==value?"":value}function set_style(node,key,value,important){null==value?node.style.removeProperty(key):node.style.setProperty(key,value,important?"important":"")}function select_option(select,value,mounting){for(let i2=0;i2<select.options.length;i2+=1){const option=select.options[i2];if(option.__value===value)return void(option.selected=!0)}mounting&&void 0===value||(select.selectedIndex=-1)}function toggle_class(element2,name2,toggle){element2.classList.toggle(name2,!!toggle)}function custom_event(type2,detail,{bubbles:bubbles=!1,cancelable:cancelable=!1}={}){return new CustomEvent(type2,{detail:detail,bubbles:bubbles,cancelable:cancelable})}const managed_styles=new Map;let current_component,active$1=0;function create_rule(node,a,b,duration,delay,ease,fn,uid=0){const step=16.666/duration;let keyframes="{\n";for(let p=0;p<=1;p+=step){const t2=a+(b-a)*ease(p);keyframes+=100*p+`%{${fn(t2,1-t2)}}\n`}const rule=keyframes+`100% {${fn(b,1-b)}}\n}`,name2=`__svelte_${function(str){let hash2=5381,i2=str.length;for(;i2--;)hash2=(hash2<<5)-hash2^str.charCodeAt(i2);return hash2>>>0}(rule)}_${uid}`,doc2=get_root_for_style(node),{stylesheet:stylesheet,rules:rules}=managed_styles.get(doc2)||function(doc2,node){const info={stylesheet:append_empty_stylesheet(node),rules:{}};return managed_styles.set(doc2,info),info}(doc2,node);rules[name2]||(rules[name2]=!0,stylesheet.insertRule(`@keyframes ${name2} ${rule}`,stylesheet.cssRules.length));const animation=node.style.animation||"";return node.style.animation=`${animation?`${animation}, `:""}${name2} ${duration}ms linear ${delay}ms 1 both`,active$1+=1,name2}function delete_rule(node,name2){const previous=(node.style.animation||"").split(", "),next=previous.filter(name2?anim=>anim.indexOf(name2)<0:anim=>-1===anim.indexOf("__svelte")),deleted=previous.length-next.length;deleted&&(node.style.animation=next.join(", "),active$1-=deleted,active$1||raf((()=>{active$1||(managed_styles.forEach((info=>{const{ownerNode:ownerNode}=info.stylesheet;ownerNode&&detach(ownerNode)})),managed_styles.clear())})))}function set_current_component(component){current_component=component}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(fn){get_current_component().$$.on_mount.push(fn)}function setContext(key,context){return get_current_component().$$.context.set(key,context),context}function getContext(key){return get_current_component().$$.context.get(key)}function bubble(component,event){const callbacks=component.$$.callbacks[event.type];callbacks&&callbacks.slice().forEach((fn=>fn.call(this,event)))}const dirty_components=[],binding_callbacks=[];let render_callbacks=[];const flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function add_render_callback(fn){render_callbacks.push(fn)}function add_flush_callback(fn){flush_callbacks.push(fn)}const seen_callbacks=new Set;let promise,flushidx=0;function flush(){if(0!==flushidx)return;const saved_component=current_component;do{try{for(;flushidx<dirty_components.length;){const component=dirty_components[flushidx];flushidx++,set_current_component(component),update(component.$$)}}catch(e){throw dirty_components.length=0,flushidx=0,e}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let i2=0;i2<render_callbacks.length;i2+=1){const callback=render_callbacks[i2];seen_callbacks.has(callback)||(seen_callbacks.add(callback),callback())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(saved_component)}function update($$){if(null!==$$.fragment){$$.update(),run_all($$.before_update);const dirty=$$.dirty;$$.dirty=[-1],$$.fragment&&$$.fragment.p($$.ctx,dirty),$$.after_update.forEach(add_render_callback)}}function dispatch(node,direction,kind){node.dispatchEvent(custom_event(`${direction?"intro":"outro"}${kind}`))}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(block,local){block&&block.i&&(outroing.delete(block),block.i(local))}function transition_out(block,local,detach2,callback){if(block&&block.o){if(outroing.has(block))return;outroing.add(block),outros.c.push((()=>{outroing.delete(block),callback&&(detach2&&block.d(1),callback())})),block.o(local)}else callback&&callback()}const null_transition={duration:0};function create_bidirectional_transition(node,fn,params,intro){let original_inert_value,config2=fn(node,params,{direction:"both"}),t2=intro?0:1,running_program=null,pending_program=null,animation_name=null;function clear_animation(){animation_name&&delete_rule(node,animation_name)}function init2(program,duration){const d=program.b-t2;return duration*=Math.abs(d),{a:t2,b:program.b,d:d,duration:duration,start:program.start,end:program.start+duration,group:program.group}}function go(b){const{delay:delay=0,duration:duration=300,easing:easing=identity,tick:tick=noop,css:css}=config2||null_transition,program={start:now()+delay,b:b};b||(program.group=outros,outros.r+=1),"inert"in node&&(b?void 0!==original_inert_value&&(node.inert=original_inert_value):(original_inert_value=node.inert,node.inert=!0)),running_program||pending_program?pending_program=program:(css&&(clear_animation(),animation_name=create_rule(node,t2,b,duration,delay,easing,css)),b&&tick(0,1),running_program=init2(program,duration),add_render_callback((()=>dispatch(node,b,"start"))),function(callback){let task;0===tasks.size&&raf(run_tasks),new Promise((fulfill=>{tasks.add(task={c:callback,f:fulfill})}))}((now2=>{if(pending_program&&now2>pending_program.start&&(running_program=init2(pending_program,duration),pending_program=null,dispatch(node,running_program.b,"start"),css&&(clear_animation(),animation_name=create_rule(node,t2,running_program.b,running_program.duration,0,easing,config2.css))),running_program)if(now2>=running_program.end)tick(t2=running_program.b,1-t2),dispatch(node,running_program.b,"end"),pending_program||(running_program.b?clear_animation():--running_program.group.r||run_all(running_program.group.c)),running_program=null;else if(now2>=running_program.start){const p=now2-running_program.start;t2=running_program.a+running_program.d*easing(p/running_program.duration),tick(t2,1-t2)}return!(!running_program&&!pending_program)})))}return{run(b){is_function(config2)?(promise||(promise=Promise.resolve(),promise.then((()=>{promise=null}))),promise).then((()=>{config2=config2({direction:b?"in":"out"}),go(b)})):go(b)},end(){clear_animation(),running_program=pending_program=null}}}function ensure_array_like(array_like_or_iterator){return void 0!==(null==array_like_or_iterator?void 0:array_like_or_iterator.length)?array_like_or_iterator:Array.from(array_like_or_iterator)}function get_spread_update(levels,updates){const update2={},to_null_out={},accounted_for={$$scope:1};let i2=levels.length;for(;i2--;){const o=levels[i2],n=updates[i2];if(n){for(const key in o)key in n||(to_null_out[key]=1);for(const key in n)accounted_for[key]||(update2[key]=n[key],accounted_for[key]=1);levels[i2]=n}else for(const key in o)accounted_for[key]=1}for(const key in to_null_out)key in update2||(update2[key]=void 0);return update2}function get_spread_object(spread_props){return"object"==typeof spread_props&&null!==spread_props?spread_props:{}}function bind(component,name2,callback){const index=component.$$.props[name2];void 0!==index&&(component.$$.bound[index]=callback,callback(component.$$.ctx[index]))}function create_component(block){block&&block.c()}function mount_component(component,target,anchor){const{fragment:fragment,after_update:after_update}=component.$$;fragment&&fragment.m(target,anchor),add_render_callback((()=>{const new_on_destroy=component.$$.on_mount.map(run).filter(is_function);component.$$.on_destroy?component.$$.on_destroy.push(...new_on_destroy):run_all(new_on_destroy),component.$$.on_mount=[]})),after_update.forEach(add_render_callback)}function destroy_component(component,detaching){const $$=component.$$;null!==$$.fragment&&(!function(fns){const filtered=[],targets=[];render_callbacks.forEach((c=>-1===fns.indexOf(c)?filtered.push(c):targets.push(c))),targets.forEach((c=>c())),render_callbacks=filtered}($$.after_update),run_all($$.on_destroy),$$.fragment&&$$.fragment.d(detaching),$$.on_destroy=$$.fragment=null,$$.ctx=[])}function make_dirty(component,i2){-1===component.$$.dirty[0]&&(dirty_components.push(component),update_scheduled||(update_scheduled=!0,resolved_promise.then(flush)),component.$$.dirty.fill(0)),component.$$.dirty[i2/31|0]|=1<<i2%31}function init$1(component,options,instance2,create_fragment2,not_equal,props,append_styles=null,dirty=[-1]){const parent_component=current_component;set_current_component(component);const $$=component.$$={fragment:null,ctx:[],props:props,update:noop,not_equal:not_equal,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(options.context||(parent_component?parent_component.$$.context:[])),callbacks:blank_object(),dirty:dirty,skip_bound:!1,root:options.target||parent_component.$$.root};append_styles&&append_styles($$.root);let ready=!1;if($$.ctx=instance2?instance2(component,options.props||{},((i2,ret,...rest)=>{const value=rest.length?rest[0]:ret;return $$.ctx&&not_equal($$.ctx[i2],$$.ctx[i2]=value)&&(!$$.skip_bound&&$$.bound[i2]&&$$.bound[i2](value),ready&&make_dirty(component,i2)),ret})):[],$$.update(),ready=!0,run_all($$.before_update),$$.fragment=!!create_fragment2&&create_fragment2($$.ctx),options.target){if(options.hydrate){const nodes=(element2=options.target,Array.from(element2.childNodes));$$.fragment&&$$.fragment.l(nodes),nodes.forEach(detach)}else $$.fragment&&$$.fragment.c();options.intro&&transition_in(component.$$.fragment),mount_component(component,options.target,options.anchor),flush()}var element2;set_current_component(parent_component)}class SvelteComponent{constructor(){__publicField(this,"$$"),__publicField(this,"$$set")}$destroy(){destroy_component(this,1),this.$destroy=noop}$on(type2,callback){if(!is_function(callback))return noop;const callbacks=this.$$.callbacks[type2]||(this.$$.callbacks[type2]=[]);return callbacks.push(callback),()=>{const index=callbacks.indexOf(callback);-1!==index&&callbacks.splice(index,1)}}$set(props){var obj;this.$$set&&(obj=props,0!==Object.keys(obj).length)&&(this.$$.skip_bound=!0,this.$$set(props),this.$$.skip_bound=!1)}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const subscriber_queue=[];function writable(value,start2=noop){let stop;const subscribers=new Set;function set2(new_value){if(safe_not_equal(value,new_value)&&(value=new_value,stop)){const run_queue=!subscriber_queue.length;for(const subscriber of subscribers)subscriber[1](),subscriber_queue.push(subscriber,value);if(run_queue){for(let i2=0;i2<subscriber_queue.length;i2+=2)subscriber_queue[i2][0](subscriber_queue[i2+1]);subscriber_queue.length=0}}}function update2(fn){set2(fn(value))}return{set:set2,update:update2,subscribe:function(run2,invalidate=noop){const subscriber=[run2,invalidate];return subscribers.add(subscriber),1===subscribers.size&&(stop=start2(set2,update2)||noop),run2(value),()=>{subscribers.delete(subscriber),0===subscribers.size&&stop&&(stop(),stop=null)}}}}function derived(stores,fn,initial_value){const single=!Array.isArray(stores),stores_array=single?[stores]:stores;if(!stores_array.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const auto2=fn.length<2;return start2=(set2,update2)=>{let started=!1;const values=[];let pending=0,cleanup=noop;const sync=()=>{if(pending)return;cleanup();const result=fn(single?values[0]:values,set2,update2);auto2?set2(result):cleanup=is_function(result)?result:noop},unsubscribers=stores_array.map(((store2,i2)=>subscribe(store2,(value=>{values[i2]=value,pending&=~(1<<i2),started&&sync()}),(()=>{pending|=1<<i2}))));return started=!0,sync(),function(){run_all(unsubscribers),cleanup(),started=!1}},{subscribe:writable(initial_value,start2).subscribe};var start2}function twJoin(){for(var argument,resolvedValue,index=0,string2="";index<arguments.length;)(argument=arguments[index++])&&(resolvedValue=toValue(argument))&&(string2&&(string2+=" "),string2+=resolvedValue);return string2}function toValue(mix){if("string"==typeof mix)return mix;for(var resolvedValue,string2="",k=0;k<mix.length;k++)mix[k]&&(resolvedValue=toValue(mix[k]))&&(string2&&(string2+=" "),string2+=resolvedValue);return string2}var CLASS_PART_SEPARATOR="-";function createClassUtils(config2){var classMap=function(config2){var theme2=config2.theme,prefix=config2.prefix,classMap={nextPart:new Map,validators:[]},prefixedClassGroupEntries=function(classGroupEntries,prefix){if(!prefix)return classGroupEntries;return classGroupEntries.map((function(_ref4){return[_ref4[0],_ref4[1].map((function(classDefinition){return"string"==typeof classDefinition?prefix+classDefinition:"object"==typeof classDefinition?Object.fromEntries(Object.entries(classDefinition).map((function(_ref5){var key=_ref5[0],value=_ref5[1];return[prefix+key,value]}))):classDefinition}))]}))}(Object.entries(config2.classGroups),prefix);return prefixedClassGroupEntries.forEach((function(_ref2){var classGroupId=_ref2[0];processClassesRecursively(_ref2[1],classMap,classGroupId,theme2)})),classMap}(config2),conflictingClassGroups=config2.conflictingClassGroups,_config$conflictingCl=config2.conflictingClassGroupModifiers,conflictingClassGroupModifiers=void 0===_config$conflictingCl?{}:_config$conflictingCl;return{getClassGroupId:function(className){var classParts=className.split(CLASS_PART_SEPARATOR);return""===classParts[0]&&1!==classParts.length&&classParts.shift(),getGroupRecursive(classParts,classMap)||function(className){if(arbitraryPropertyRegex.test(className)){var arbitraryPropertyClassName=arbitraryPropertyRegex.exec(className)[1],property=null==arbitraryPropertyClassName?void 0:arbitraryPropertyClassName.substring(0,arbitraryPropertyClassName.indexOf(":"));if(property)return"arbitrary.."+property}}(className)},getConflictingClassGroupIds:function(classGroupId,hasPostfixModifier){var conflicts=conflictingClassGroups[classGroupId]||[];return hasPostfixModifier&&conflictingClassGroupModifiers[classGroupId]?[].concat(conflicts,conflictingClassGroupModifiers[classGroupId]):conflicts}}}function getGroupRecursive(classParts,classPartObject){var _a2;if(0===classParts.length)return classPartObject.classGroupId;var currentClassPart=classParts[0],nextClassPartObject=classPartObject.nextPart.get(currentClassPart),classGroupFromNextClassPart=nextClassPartObject?getGroupRecursive(classParts.slice(1),nextClassPartObject):void 0;if(classGroupFromNextClassPart)return classGroupFromNextClassPart;if(0!==classPartObject.validators.length){var classRest=classParts.join(CLASS_PART_SEPARATOR);return null==(_a2=classPartObject.validators.find((function(_ref){return(0,_ref.validator)(classRest)})))?void 0:_a2.classGroupId}}var arbitraryPropertyRegex=/^\[(.+)\]$/;function processClassesRecursively(classGroup,classPartObject,classGroupId,theme2){classGroup.forEach((function(classDefinition){if("string"!=typeof classDefinition){if("function"==typeof classDefinition)return classDefinition.isThemeGetter?void processClassesRecursively(classDefinition(theme2),classPartObject,classGroupId,theme2):void classPartObject.validators.push({validator:classDefinition,classGroupId:classGroupId});Object.entries(classDefinition).forEach((function(_ref3){var key=_ref3[0];processClassesRecursively(_ref3[1],getPart(classPartObject,key),classGroupId,theme2)}))}else{(""===classDefinition?classPartObject:getPart(classPartObject,classDefinition)).classGroupId=classGroupId}}))}function getPart(classPartObject,path2){var currentClassPartObject=classPartObject;return path2.split(CLASS_PART_SEPARATOR).forEach((function(pathPart){currentClassPartObject.nextPart.has(pathPart)||currentClassPartObject.nextPart.set(pathPart,{nextPart:new Map,validators:[]}),currentClassPartObject=currentClassPartObject.nextPart.get(pathPart)})),currentClassPartObject}function createLruCache(maxCacheSize){if(maxCacheSize<1)return{get:function(){},set:function(){}};var cacheSize=0,cache=new Map,previousCache=new Map;function update2(key,value){cache.set(key,value),++cacheSize>maxCacheSize&&(cacheSize=0,previousCache=cache,cache=new Map)}return{get:function(key){var value=cache.get(key);return void 0!==value?value:void 0!==(value=previousCache.get(key))?(update2(key,value),value):void 0},set:function(key,value){cache.has(key)?cache.set(key,value):update2(key,value)}}}var IMPORTANT_MODIFIER="!";function createSplitModifiers(config2){var separator=config2.separator||":",isSeparatorSingleCharacter=1===separator.length,firstSeparatorCharacter=separator[0],separatorLength=separator.length;return function(className){for(var postfixModifierPosition,modifiers2=[],bracketDepth=0,modifierStart=0,index=0;index<className.length;index++){var currentCharacter=className[index];if(0===bracketDepth){if(currentCharacter===firstSeparatorCharacter&&(isSeparatorSingleCharacter||className.slice(index,index+separatorLength)===separator)){modifiers2.push(className.slice(modifierStart,index)),modifierStart=index+separatorLength;continue}if("/"===currentCharacter){postfixModifierPosition=index;continue}}"["===currentCharacter?bracketDepth++:"]"===currentCharacter&&bracketDepth--}var baseClassNameWithImportantModifier=0===modifiers2.length?className:className.substring(modifierStart),hasImportantModifier=baseClassNameWithImportantModifier.startsWith(IMPORTANT_MODIFIER);return{modifiers:modifiers2,hasImportantModifier:hasImportantModifier,baseClassName:hasImportantModifier?baseClassNameWithImportantModifier.substring(1):baseClassNameWithImportantModifier,maybePostfixModifierPosition:postfixModifierPosition&&postfixModifierPosition>modifierStart?postfixModifierPosition-modifierStart:void 0}}}var SPLIT_CLASSES_REGEX=/\s+/;function createTailwindMerge(){for(var _len=arguments.length,createConfig=new Array(_len),_key=0;_key<_len;_key++)createConfig[_key]=arguments[_key];var configUtils,cacheGet,cacheSet,functionToCall=function(classList){var firstCreateConfig=createConfig[0],config2=createConfig.slice(1).reduce((function(previousConfig,createConfigCurrent){return createConfigCurrent(previousConfig)}),firstCreateConfig());return configUtils=function(config2){return{cache:createLruCache(config2.cacheSize),splitModifiers:createSplitModifiers(config2),...createClassUtils(config2)}}(config2),cacheGet=configUtils.cache.get,cacheSet=configUtils.cache.set,functionToCall=tailwindMerge,tailwindMerge(classList)};function tailwindMerge(classList){var cachedResult=cacheGet(classList);if(cachedResult)return cachedResult;var result=function(classList,configUtils){var splitModifiers=configUtils.splitModifiers,getClassGroupId=configUtils.getClassGroupId,getConflictingClassGroupIds=configUtils.getConflictingClassGroupIds,classGroupsInConflict=new Set;return classList.trim().split(SPLIT_CLASSES_REGEX).map((function(originalClassName){var _splitModifiers=splitModifiers(originalClassName),modifiers2=_splitModifiers.modifiers,hasImportantModifier=_splitModifiers.hasImportantModifier,baseClassName=_splitModifiers.baseClassName,maybePostfixModifierPosition=_splitModifiers.maybePostfixModifierPosition,classGroupId=getClassGroupId(maybePostfixModifierPosition?baseClassName.substring(0,maybePostfixModifierPosition):baseClassName),hasPostfixModifier=Boolean(maybePostfixModifierPosition);if(!classGroupId){if(!maybePostfixModifierPosition)return{isTailwindClass:!1,originalClassName:originalClassName};if(!(classGroupId=getClassGroupId(baseClassName)))return{isTailwindClass:!1,originalClassName:originalClassName};hasPostfixModifier=!1}var variantModifier=function(modifiers2){if(modifiers2.length<=1)return modifiers2;var sortedModifiers=[],unsortedModifiers=[];return modifiers2.forEach((function(modifier){"["===modifier[0]?(sortedModifiers.push.apply(sortedModifiers,unsortedModifiers.sort().concat([modifier])),unsortedModifiers=[]):unsortedModifiers.push(modifier)})),sortedModifiers.push.apply(sortedModifiers,unsortedModifiers.sort()),sortedModifiers}(modifiers2).join(":");return{isTailwindClass:!0,modifierId:hasImportantModifier?variantModifier+IMPORTANT_MODIFIER:variantModifier,classGroupId:classGroupId,originalClassName:originalClassName,hasPostfixModifier:hasPostfixModifier}})).reverse().filter((function(parsed){if(!parsed.isTailwindClass)return!0;var modifierId=parsed.modifierId,classGroupId=parsed.classGroupId,hasPostfixModifier=parsed.hasPostfixModifier,classId=modifierId+classGroupId;return!classGroupsInConflict.has(classId)&&(classGroupsInConflict.add(classId),getConflictingClassGroupIds(classGroupId,hasPostfixModifier).forEach((function(group){return classGroupsInConflict.add(modifierId+group)})),!0)})).reverse().map((function(parsed){return parsed.originalClassName})).join(" ")}(classList,configUtils);return cacheSet(classList,result),result}return function(){return functionToCall(twJoin.apply(null,arguments))}}function fromTheme(key){var themeGetter=function(theme2){return theme2[key]||[]};return themeGetter.isThemeGetter=!0,themeGetter}var arbitraryValueRegex=/^\[(?:([a-z-]+):)?(.+)\]$/i,fractionRegex=/^\d+\/\d+$/,stringLengths=new Set(["px","full","screen"]),tshirtUnitRegex=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lengthUnitRegex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,shadowRegex=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function isLength(value){return isNumber(value)||stringLengths.has(value)||fractionRegex.test(value)||isArbitraryLength(value)}function isArbitraryLength(value){return getIsArbitraryValue(value,"length",isLengthOnly)}function isArbitrarySize(value){return getIsArbitraryValue(value,"size",isNever)}function isArbitraryPosition(value){return getIsArbitraryValue(value,"position",isNever)}function isArbitraryUrl(value){return getIsArbitraryValue(value,"url",isUrl)}function isArbitraryNumber(value){return getIsArbitraryValue(value,"number",isNumber)}function isNumber(value){return!Number.isNaN(Number(value))}function isPercent(value){return value.endsWith("%")&&isNumber(value.slice(0,-1))}function isInteger(value){return isIntegerOnly(value)||getIsArbitraryValue(value,"number",isIntegerOnly)}function isArbitraryValue(value){return arbitraryValueRegex.test(value)}function isAny(){return!0}function isTshirtSize(value){return tshirtUnitRegex.test(value)}function isArbitraryShadow(value){return getIsArbitraryValue(value,"",isShadow)}function getIsArbitraryValue(value,label,testValue){var result=arbitraryValueRegex.exec(value);return!!result&&(result[1]?result[1]===label:testValue(result[2]))}function isLengthOnly(value){return lengthUnitRegex.test(value)}function isNever(){return!1}function isUrl(value){return value.startsWith("url(")}function isIntegerOnly(value){return Number.isInteger(Number(value))}function isShadow(value){return shadowRegex.test(value)}function getDefaultConfig(){var colors=fromTheme("colors"),spacing2=fromTheme("spacing"),blur2=fromTheme("blur"),brightness=fromTheme("brightness"),borderColor=fromTheme("borderColor"),borderRadius=fromTheme("borderRadius"),borderSpacing=fromTheme("borderSpacing"),borderWidth=fromTheme("borderWidth"),contrast=fromTheme("contrast"),grayscale=fromTheme("grayscale"),hueRotate=fromTheme("hueRotate"),invert=fromTheme("invert"),gap=fromTheme("gap"),gradientColorStops=fromTheme("gradientColorStops"),gradientColorStopPositions=fromTheme("gradientColorStopPositions"),inset=fromTheme("inset"),margin=fromTheme("margin"),opacity=fromTheme("opacity"),padding=fromTheme("padding"),saturate=fromTheme("saturate"),scale=fromTheme("scale"),sepia=fromTheme("sepia"),skew=fromTheme("skew"),space2=fromTheme("space"),translate=fromTheme("translate"),getSpacingWithAutoAndArbitrary=function(){return["auto",isArbitraryValue,spacing2]},getSpacingWithArbitrary=function(){return[isArbitraryValue,spacing2]},getLengthWithEmpty=function(){return["",isLength]},getNumberWithAutoAndArbitrary=function(){return["auto",isNumber,isArbitraryValue]},getZeroAndEmpty=function(){return["","0",isArbitraryValue]},getNumber=function(){return[isNumber,isArbitraryNumber]},getNumberAndArbitrary=function(){return[isNumber,isArbitraryValue]};return{cacheSize:500,theme:{colors:[isAny],spacing:[isLength],blur:["none","",isTshirtSize,isArbitraryValue],brightness:getNumber(),borderColor:[colors],borderRadius:["none","","full",isTshirtSize,isArbitraryValue],borderSpacing:getSpacingWithArbitrary(),borderWidth:getLengthWithEmpty(),contrast:getNumber(),grayscale:getZeroAndEmpty(),hueRotate:getNumberAndArbitrary(),invert:getZeroAndEmpty(),gap:getSpacingWithArbitrary(),gradientColorStops:[colors],gradientColorStopPositions:[isPercent,isArbitraryLength],inset:getSpacingWithAutoAndArbitrary(),margin:getSpacingWithAutoAndArbitrary(),opacity:getNumber(),padding:getSpacingWithArbitrary(),saturate:getNumber(),scale:getNumber(),sepia:getZeroAndEmpty(),skew:getNumberAndArbitrary(),space:getSpacingWithArbitrary(),translate:getSpacingWithArbitrary()},classGroups:{aspect:[{aspect:["auto","square","video",isArbitraryValue]}],container:["container"],columns:[{columns:[isTshirtSize]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],[isArbitraryValue])}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[inset]}],"inset-x":[{"inset-x":[inset]}],"inset-y":[{"inset-y":[inset]}],start:[{start:[inset]}],end:[{end:[inset]}],top:[{top:[inset]}],right:[{right:[inset]}],bottom:[{bottom:[inset]}],left:[{left:[inset]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",isInteger]}],basis:[{basis:getSpacingWithAutoAndArbitrary()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",isArbitraryValue]}],grow:[{grow:getZeroAndEmpty()}],shrink:[{shrink:getZeroAndEmpty()}],order:[{order:["first","last","none",isInteger]}],"grid-cols":[{"grid-cols":[isAny]}],"col-start-end":[{col:["auto",{span:["full",isInteger]},isArbitraryValue]}],"col-start":[{"col-start":getNumberWithAutoAndArbitrary()}],"col-end":[{"col-end":getNumberWithAutoAndArbitrary()}],"grid-rows":[{"grid-rows":[isAny]}],"row-start-end":[{row:["auto",{span:[isInteger]},isArbitraryValue]}],"row-start":[{"row-start":getNumberWithAutoAndArbitrary()}],"row-end":[{"row-end":getNumberWithAutoAndArbitrary()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",isArbitraryValue]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",isArbitraryValue]}],gap:[{gap:[gap]}],"gap-x":[{"gap-x":[gap]}],"gap-y":[{"gap-y":[gap]}],"justify-content":[{justify:["normal"].concat(["start","end","center","between","around","evenly","stretch"])}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(["start","end","center","between","around","evenly","stretch"],["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(["start","end","center","between","around","evenly","stretch"],["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[padding]}],px:[{px:[padding]}],py:[{py:[padding]}],ps:[{ps:[padding]}],pe:[{pe:[padding]}],pt:[{pt:[padding]}],pr:[{pr:[padding]}],pb:[{pb:[padding]}],pl:[{pl:[padding]}],m:[{m:[margin]}],mx:[{mx:[margin]}],my:[{my:[margin]}],ms:[{ms:[margin]}],me:[{me:[margin]}],mt:[{mt:[margin]}],mr:[{mr:[margin]}],mb:[{mb:[margin]}],ml:[{ml:[margin]}],"space-x":[{"space-x":[space2]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[space2]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",isArbitraryValue,spacing2]}],"min-w":[{"min-w":["min","max","fit",isArbitraryValue,isLength]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[isTshirtSize]},isTshirtSize,isArbitraryValue]}],h:[{h:[isArbitraryValue,spacing2,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",isArbitraryValue,isLength]}],"max-h":[{"max-h":[isArbitraryValue,spacing2,"min","max","fit"]}],"font-size":[{text:["base",isTshirtSize,isArbitraryLength]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",isArbitraryNumber]}],"font-family":[{font:[isAny]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",isArbitraryValue]}],"line-clamp":[{"line-clamp":["none",isNumber,isArbitraryNumber]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",isArbitraryValue,isLength]}],"list-image":[{"list-image":["none",isArbitraryValue]}],"list-style-type":[{list:["none","disc","decimal",isArbitraryValue]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[colors]}],"placeholder-opacity":[{"placeholder-opacity":[opacity]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[colors]}],"text-opacity":[{"text-opacity":[opacity]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(["solid","dashed","dotted","double","none"],["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",isLength]}],"underline-offset":[{"underline-offset":["auto",isArbitraryValue,isLength]}],"text-decoration-color":[{decoration:[colors]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:getSpacingWithArbitrary()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",isArbitraryValue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",isArbitraryValue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[opacity]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],[isArbitraryPosition])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",isArbitrarySize]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},isArbitraryUrl]}],"bg-color":[{bg:[colors]}],"gradient-from-pos":[{from:[gradientColorStopPositions]}],"gradient-via-pos":[{via:[gradientColorStopPositions]}],"gradient-to-pos":[{to:[gradientColorStopPositions]}],"gradient-from":[{from:[gradientColorStops]}],"gradient-via":[{via:[gradientColorStops]}],"gradient-to":[{to:[gradientColorStops]}],rounded:[{rounded:[borderRadius]}],"rounded-s":[{"rounded-s":[borderRadius]}],"rounded-e":[{"rounded-e":[borderRadius]}],"rounded-t":[{"rounded-t":[borderRadius]}],"rounded-r":[{"rounded-r":[borderRadius]}],"rounded-b":[{"rounded-b":[borderRadius]}],"rounded-l":[{"rounded-l":[borderRadius]}],"rounded-ss":[{"rounded-ss":[borderRadius]}],"rounded-se":[{"rounded-se":[borderRadius]}],"rounded-ee":[{"rounded-ee":[borderRadius]}],"rounded-es":[{"rounded-es":[borderRadius]}],"rounded-tl":[{"rounded-tl":[borderRadius]}],"rounded-tr":[{"rounded-tr":[borderRadius]}],"rounded-br":[{"rounded-br":[borderRadius]}],"rounded-bl":[{"rounded-bl":[borderRadius]}],"border-w":[{border:[borderWidth]}],"border-w-x":[{"border-x":[borderWidth]}],"border-w-y":[{"border-y":[borderWidth]}],"border-w-s":[{"border-s":[borderWidth]}],"border-w-e":[{"border-e":[borderWidth]}],"border-w-t":[{"border-t":[borderWidth]}],"border-w-r":[{"border-r":[borderWidth]}],"border-w-b":[{"border-b":[borderWidth]}],"border-w-l":[{"border-l":[borderWidth]}],"border-opacity":[{"border-opacity":[opacity]}],"border-style":[{border:[].concat(["solid","dashed","dotted","double","none"],["hidden"])}],"divide-x":[{"divide-x":[borderWidth]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[borderWidth]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[opacity]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[borderColor]}],"border-color-x":[{"border-x":[borderColor]}],"border-color-y":[{"border-y":[borderColor]}],"border-color-t":[{"border-t":[borderColor]}],"border-color-r":[{"border-r":[borderColor]}],"border-color-b":[{"border-b":[borderColor]}],"border-color-l":[{"border-l":[borderColor]}],"divide-color":[{divide:[borderColor]}],"outline-style":[{outline:[""].concat(["solid","dashed","dotted","double","none"])}],"outline-offset":[{"outline-offset":[isArbitraryValue,isLength]}],"outline-w":[{outline:[isLength]}],"outline-color":[{outline:[colors]}],"ring-w":[{ring:getLengthWithEmpty()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[colors]}],"ring-opacity":[{"ring-opacity":[opacity]}],"ring-offset-w":[{"ring-offset":[isLength]}],"ring-offset-color":[{"ring-offset":[colors]}],shadow:[{shadow:["","inner","none",isTshirtSize,isArbitraryShadow]}],"shadow-color":[{shadow:[isAny]}],opacity:[{opacity:[opacity]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]}],filter:[{filter:["","none"]}],blur:[{blur:[blur2]}],brightness:[{brightness:[brightness]}],contrast:[{contrast:[contrast]}],"drop-shadow":[{"drop-shadow":["","none",isTshirtSize,isArbitraryValue]}],grayscale:[{grayscale:[grayscale]}],"hue-rotate":[{"hue-rotate":[hueRotate]}],invert:[{invert:[invert]}],saturate:[{saturate:[saturate]}],sepia:[{sepia:[sepia]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[blur2]}],"backdrop-brightness":[{"backdrop-brightness":[brightness]}],"backdrop-contrast":[{"backdrop-contrast":[contrast]}],"backdrop-grayscale":[{"backdrop-grayscale":[grayscale]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[hueRotate]}],"backdrop-invert":[{"backdrop-invert":[invert]}],"backdrop-opacity":[{"backdrop-opacity":[opacity]}],"backdrop-saturate":[{"backdrop-saturate":[saturate]}],"backdrop-sepia":[{"backdrop-sepia":[sepia]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[borderSpacing]}],"border-spacing-x":[{"border-spacing-x":[borderSpacing]}],"border-spacing-y":[{"border-spacing-y":[borderSpacing]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",isArbitraryValue]}],duration:[{duration:getNumberAndArbitrary()}],ease:[{ease:["linear","in","out","in-out",isArbitraryValue]}],delay:[{delay:getNumberAndArbitrary()}],animate:[{animate:["none","spin","ping","pulse","bounce",isArbitraryValue]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[scale]}],"scale-x":[{"scale-x":[scale]}],"scale-y":[{"scale-y":[scale]}],rotate:[{rotate:[isInteger,isArbitraryValue]}],"translate-x":[{"translate-x":[translate]}],"translate-y":[{"translate-y":[translate]}],"skew-x":[{"skew-x":[skew]}],"skew-y":[{"skew-y":[skew]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",isArbitraryValue]}],accent:[{accent:["auto",colors]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",isArbitraryValue]}],"caret-color":[{caret:[colors]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":getSpacingWithArbitrary()}],"scroll-mx":[{"scroll-mx":getSpacingWithArbitrary()}],"scroll-my":[{"scroll-my":getSpacingWithArbitrary()}],"scroll-ms":[{"scroll-ms":getSpacingWithArbitrary()}],"scroll-me":[{"scroll-me":getSpacingWithArbitrary()}],"scroll-mt":[{"scroll-mt":getSpacingWithArbitrary()}],"scroll-mr":[{"scroll-mr":getSpacingWithArbitrary()}],"scroll-mb":[{"scroll-mb":getSpacingWithArbitrary()}],"scroll-ml":[{"scroll-ml":getSpacingWithArbitrary()}],"scroll-p":[{"scroll-p":getSpacingWithArbitrary()}],"scroll-px":[{"scroll-px":getSpacingWithArbitrary()}],"scroll-py":[{"scroll-py":getSpacingWithArbitrary()}],"scroll-ps":[{"scroll-ps":getSpacingWithArbitrary()}],"scroll-pe":[{"scroll-pe":getSpacingWithArbitrary()}],"scroll-pt":[{"scroll-pt":getSpacingWithArbitrary()}],"scroll-pr":[{"scroll-pr":getSpacingWithArbitrary()}],"scroll-pb":[{"scroll-pb":getSpacingWithArbitrary()}],"scroll-pl":[{"scroll-pl":getSpacingWithArbitrary()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",isArbitraryValue]}],fill:[{fill:[colors,"none"]}],"stroke-w":[{stroke:[isLength,isArbitraryNumber]}],stroke:[{stroke:[colors,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var twMerge=createTailwindMerge(getDefaultConfig);function create_dynamic_element(ctx){let svelte_element,use_action,svelte_element_transition,current,mounted,dispose;const default_slot_template=ctx[14].default,default_slot=create_slot(default_slot_template,ctx,ctx[13],null);let svelte_element_levels=[ctx[8],{class:ctx[7]},{role:ctx[6]}],svelte_element_data={};for(let i2=0;i2<svelte_element_levels.length;i2+=1)svelte_element_data=assign(svelte_element_data,svelte_element_levels[i2]);return{c(){svelte_element=element(ctx[1]),default_slot&&default_slot.c(),set_dynamic_element_data(ctx[1])(svelte_element,svelte_element_data)},m(target,anchor){insert$1(target,svelte_element,anchor),default_slot&&default_slot.m(svelte_element,null),ctx[20](svelte_element),current=!0,mounted||(dispose=[action_destroyer(use_action=ctx[4].call(null,svelte_element,ctx[5])),listen(svelte_element,"click",ctx[15]),listen(svelte_element,"mouseenter",ctx[16]),listen(svelte_element,"mouseleave",ctx[17]),listen(svelte_element,"focusin",ctx[18]),listen(svelte_element,"focusout",ctx[19])],mounted=!0)},p(new_ctx,dirty){ctx=new_ctx,default_slot&&default_slot.p&&(!current||8192&dirty)&&update_slot_base(default_slot,default_slot_template,ctx,ctx[13],current?get_slot_changes(default_slot_template,ctx[13],dirty,null):get_all_dirty_from_scope(ctx[13]),null),set_dynamic_element_data(ctx[1])(svelte_element,svelte_element_data=get_spread_update(svelte_element_levels,[256&dirty&&ctx[8],(!current||128&dirty)&&{class:ctx[7]},(!current||64&dirty)&&{role:ctx[6]}])),use_action&&is_function(use_action.update)&&32&dirty&&use_action.update.call(null,ctx[5])},i(local){current||(transition_in(default_slot,local),local&&add_render_callback((()=>{current&&(svelte_element_transition||(svelte_element_transition=create_bidirectional_transition(svelte_element,ctx[2],ctx[3],!0)),svelte_element_transition.run(1))})),current=!0)},o(local){transition_out(default_slot,local),local&&(svelte_element_transition||(svelte_element_transition=create_bidirectional_transition(svelte_element,ctx[2],ctx[3],!1)),svelte_element_transition.run(0)),current=!1},d(detaching){detaching&&detach(svelte_element),default_slot&&default_slot.d(detaching),ctx[20](null),detaching&&svelte_element_transition&&svelte_element_transition.end(),mounted=!1,run_all(dispose)}}}function create_fragment$D(ctx){let svelte_element_anchor,current,previous_tag=ctx[1],tag_will_be_removed=!1,svelte_element=ctx[1]&&create_dynamic_element(ctx);return{c(){svelte_element&&svelte_element.c(),svelte_element_anchor=empty$1()},m(target,anchor){svelte_element&&svelte_element.m(target,anchor),insert$1(target,svelte_element_anchor,anchor),current=!0},p(ctx2,[dirty]){ctx2[1]?previous_tag?safe_not_equal(previous_tag,ctx2[1])?(svelte_element.d(1),svelte_element=create_dynamic_element(ctx2),previous_tag=ctx2[1],svelte_element.c(),tag_will_be_removed&&(tag_will_be_removed=!1,transition_in(svelte_element)),svelte_element.m(svelte_element_anchor.parentNode,svelte_element_anchor)):(tag_will_be_removed&&(tag_will_be_removed=!1,transition_in(svelte_element)),svelte_element.p(ctx2,dirty)):(svelte_element=create_dynamic_element(ctx2),previous_tag=ctx2[1],svelte_element.c(),transition_in(svelte_element),svelte_element.m(svelte_element_anchor.parentNode,svelte_element_anchor)):previous_tag&&(tag_will_be_removed=!0,group_outros(),transition_out(svelte_element,1,1,(()=>{svelte_element=null,previous_tag=ctx2[1],tag_will_be_removed=!1})),check_outros())},i(local){current||(transition_in(svelte_element,local),current=!0)},o(local){transition_out(svelte_element,local),current=!1},d(detaching){detaching&&detach(svelte_element_anchor),svelte_element&&svelte_element.d(detaching)}}}function instance$D($$self,$$props,$$invalidate){const omit_props_names=["tag","color","rounded","border","shadow","transition","params","node","use","options","role"];let $$restProps=compute_rest_props($$props,omit_props_names),{$$slots:slots={},$$scope:$$scope}=$$props;const null_transition2=()=>({duration:0}),noop2=()=>{};setContext("background",!0);let{tag:tag=($$restProps.href?"a":"div")}=$$props,{color:color2="default"}=$$props,{rounded:rounded=!1}=$$props,{border:border=!1}=$$props,{shadow:shadow=!1}=$$props,{transition:transition=null_transition2}=$$props,{params:params={}}=$$props,{node:node}=$$props,{use:use=noop2}=$$props,{options:options={}}=$$props,{role:role}=$$props;const bgColors={gray:"bg-gray-50 dark:bg-gray-800",red:"bg-red-50 dark:bg-gray-800",yellow:"bg-yellow-50 dark:bg-gray-800 ",green:"bg-green-50 dark:bg-gray-800 ",indigo:"bg-indigo-50 dark:bg-gray-800 ",purple:"bg-purple-50 dark:bg-gray-800 ",pink:"bg-pink-50 dark:bg-gray-800 ",blue:"bg-blue-50 dark:bg-gray-800 ",light:"bg-gray-50 dark:bg-gray-700",dark:"bg-gray-50 dark:bg-gray-800",default:"bg-white dark:bg-gray-800",dropdown:"bg-white dark:bg-gray-700",navbar:"bg-white dark:bg-gray-900",navbarUl:"bg-gray-50 dark:bg-gray-800",form:"bg-gray-50 dark:bg-gray-700",primary:"bg-primary-50 dark:bg-gray-800 ",orange:"bg-orange-50 dark:bg-orange-800",none:""},textColors={gray:"text-gray-800 dark:text-gray-300",red:"text-red-800 dark:text-red-400",yellow:"text-yellow-800 dark:text-yellow-300",green:"text-green-800 dark:text-green-400",indigo:"text-indigo-800 dark:text-indigo-400",purple:"text-purple-800 dark:text-purple-400",pink:"text-pink-800 dark:text-pink-400",blue:"text-blue-800 dark:text-blue-400",light:"text-gray-700 dark:text-gray-300",dark:"text-gray-700 dark:text-gray-300",default:"text-gray-500 dark:text-gray-400",dropdown:"text-gray-700 dark:text-gray-200",navbar:"text-gray-700 dark:text-gray-200",navbarUl:"text-gray-700 dark:text-gray-400",form:"text-gray-900 dark:text-white",primary:"text-primary-800 dark:text-primary-400",orange:"text-orange-800 dark:text-orange-400",none:""},borderColors={gray:"border-gray-300 dark:border-gray-800 divide-gray-300 dark:divide-gray-800",red:"border-red-300 dark:border-red-800 divide-red-300 dark:divide-red-800",yellow:"border-yellow-300 dark:border-yellow-800 divide-yellow-300 dark:divide-yellow-800",green:"border-green-300 dark:border-green-800 divide-green-300 dark:divide-green-800",indigo:"border-indigo-300 dark:border-indigo-800 divide-indigo-300 dark:divide-indigo-800",purple:"border-purple-300 dark:border-purple-800 divide-purple-300 dark:divide-purple-800",pink:"border-pink-300 dark:border-pink-800 divide-pink-300 dark:divide-pink-800",blue:"border-blue-300 dark:border-blue-800 divide-blue-300 dark:divide-blue-800",light:"border-gray-500 divide-gray-500",dark:"border-gray-500 divide-gray-500",default:"border-gray-200 dark:border-gray-700 divide-gray-200 dark:divide-gray-700",dropdown:"border-gray-100 dark:border-gray-600 divide-gray-100 dark:divide-gray-600",navbar:"border-gray-100 dark:border-gray-700 divide-gray-100 dark:divide-gray-700",navbarUl:"border-gray-100 dark:border-gray-700 divide-gray-100 dark:divide-gray-700",form:"border-gray-300 dark:border-gray-700 divide-gray-300 dark:divide-gray-700",primary:"border-primary-500 dark:border-primary-200  divide-primary-500 dark:divide-primary-200 ",orange:"border-orange-300 dark:border-orange-800 divide-orange-300 dark:divide-orange-800",none:""};let divClass2;return $$self.$$set=$$new_props=>{$$invalidate(26,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),$$invalidate(8,$$restProps=compute_rest_props($$props,omit_props_names)),"tag"in $$new_props&&$$invalidate(1,tag=$$new_props.tag),"color"in $$new_props&&$$invalidate(9,color2=$$new_props.color),"rounded"in $$new_props&&$$invalidate(10,rounded=$$new_props.rounded),"border"in $$new_props&&$$invalidate(11,border=$$new_props.border),"shadow"in $$new_props&&$$invalidate(12,shadow=$$new_props.shadow),"transition"in $$new_props&&$$invalidate(2,transition=$$new_props.transition),"params"in $$new_props&&$$invalidate(3,params=$$new_props.params),"node"in $$new_props&&$$invalidate(0,node=$$new_props.node),"use"in $$new_props&&$$invalidate(4,use=$$new_props.use),"options"in $$new_props&&$$invalidate(5,options=$$new_props.options),"role"in $$new_props&&$$invalidate(6,role=$$new_props.role),"$$scope"in $$new_props&&$$invalidate(13,$$scope=$$new_props.$$scope)},$$self.$$.update=()=>{512&$$self.$$.dirty&&$$invalidate(9,color2=color2??"default"),512&$$self.$$.dirty&&setContext("color",color2),$$invalidate(7,divClass2=twMerge(bgColors[color2],textColors[color2],rounded&&"rounded-lg",border&&"border",borderColors[color2],shadow&&"shadow-md",$$props.class))},$$props=exclude_internal_props($$props),[node,tag,transition,params,use,options,role,divClass2,$$restProps,color2,rounded,border,shadow,$$scope,slots,function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function($$value){binding_callbacks[$$value?"unshift":"push"]((()=>{node=$$value,$$invalidate(0,node)}))}]}class Frame extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$D,create_fragment$D,safe_not_equal,{tag:1,color:9,rounded:10,border:11,shadow:12,transition:2,params:3,node:0,use:4,options:5,role:6})}}function create_default_slot$l(ctx){let current;const default_slot_template=ctx[7].default,default_slot=create_slot(default_slot_template,ctx,ctx[8],null);return{c(){default_slot&&default_slot.c()},m(target,anchor){default_slot&&default_slot.m(target,anchor),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||256&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[8],current?get_slot_changes(default_slot_template,ctx2[8],dirty,null):get_all_dirty_from_scope(ctx2[8]),null)},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){default_slot&&default_slot.d(detaching)}}}function create_fragment$C(ctx){let frame,current;const frame_spread_levels=[ctx[1],{class:ctx[0]},{color:"none"}];let frame_props={$$slots:{default:[create_default_slot$l]},$$scope:{ctx:ctx}};for(let i2=0;i2<frame_spread_levels.length;i2+=1)frame_props=assign(frame_props,frame_spread_levels[i2]);return frame=new Frame({props:frame_props}),{c(){create_component(frame.$$.fragment)},m(target,anchor){mount_component(frame,target,anchor),current=!0},p(ctx2,[dirty]){const frame_changes=3&dirty?get_spread_update(frame_spread_levels,[2&dirty&&get_spread_object(ctx2[1]),1&dirty&&{class:ctx2[0]},frame_spread_levels[2]]):{};256&dirty&&(frame_changes.$$scope={dirty:dirty,ctx:ctx2}),frame.$set(frame_changes)},i(local){current||(transition_in(frame.$$.fragment,local),current=!0)},o(local){transition_out(frame.$$.fragment,local),current=!1},d(detaching){destroy_component(frame,detaching)}}}function instance$C($$self,$$props,$$invalidate){const omit_props_names=["multiple","flush","activeClass","inactiveClass","defaultClass"];let $$restProps=compute_rest_props($$props,omit_props_names),{$$slots:slots={},$$scope:$$scope}=$$props,{multiple:multiple=!1}=$$props,{flush:flush2=!1}=$$props,{activeClass:activeClass="bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800"}=$$props,{inactiveClass:inactiveClass="text-gray-500 dark:text-gray-400 hover:bg-gray-100 hover:dark:bg-gray-800"}=$$props,{defaultClass:defaultClass2="text-gray-500 dark:text-gray-400"}=$$props;setContext("ctx",{flush:flush2,activeClass:twMerge(activeClass,$$props.classActive),inactiveClass:twMerge(inactiveClass,$$props.classInactive),selected:multiple?void 0:writable()});let frameClass=twMerge(defaultClass2,$$props.class);return $$self.$$set=$$new_props=>{$$invalidate(10,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),$$invalidate(1,$$restProps=compute_rest_props($$props,omit_props_names)),"multiple"in $$new_props&&$$invalidate(2,multiple=$$new_props.multiple),"flush"in $$new_props&&$$invalidate(3,flush2=$$new_props.flush),"activeClass"in $$new_props&&$$invalidate(4,activeClass=$$new_props.activeClass),"inactiveClass"in $$new_props&&$$invalidate(5,inactiveClass=$$new_props.inactiveClass),"defaultClass"in $$new_props&&$$invalidate(6,defaultClass2=$$new_props.defaultClass),"$$scope"in $$new_props&&$$invalidate(8,$$scope=$$new_props.$$scope)},$$props=exclude_internal_props($$props),[frameClass,$$restProps,multiple,flush2,activeClass,inactiveClass,defaultClass2,slots,$$scope]}class Accordion extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$C,create_fragment$C,safe_not_equal,{multiple:2,flush:3,activeClass:4,inactiveClass:5,defaultClass:6})}}function create_fragment$B(ctx){let svg2,svg_class_value,mounted,dispose,svg_levels=[{xmlns:"http://www.w3.org/2000/svg"},{width:ctx[0]},{height:ctx[0]},{class:svg_class_value=ctx[5].class},ctx[6],{"aria-label":ctx[1]},{fill:"none"},{viewBox:ctx[3]},{role:ctx[2]},{"stroke-width":"2"}],svg_data={};for(let i2=0;i2<svg_levels.length;i2+=1)svg_data=assign(svg_data,svg_levels[i2]);return{c(){svg2=svg_element("svg"),set_svg_attributes(svg2,svg_data)},m(target,anchor){insert$1(target,svg2,anchor),svg2.innerHTML=ctx[4],mounted||(dispose=listen(svg2,"click",ctx[9]),mounted=!0)},p(ctx2,[dirty]){16&dirty&&(svg2.innerHTML=ctx2[4]),set_svg_attributes(svg2,svg_data=get_spread_update(svg_levels,[{xmlns:"http://www.w3.org/2000/svg"},1&dirty&&{width:ctx2[0]},1&dirty&&{height:ctx2[0]},32&dirty&&svg_class_value!==(svg_class_value=ctx2[5].class)&&{class:svg_class_value},64&dirty&&ctx2[6],2&dirty&&{"aria-label":ctx2[1]},{fill:"none"},8&dirty&&{viewBox:ctx2[3]},4&dirty&&{role:ctx2[2]},{"stroke-width":"2"}]))},i:noop,o:noop,d(detaching){detaching&&detach(svg2),mounted=!1,dispose()}}}function instance$B($$self,$$props,$$invalidate){const omit_props_names=["size","color","variation","ariaLabel","role"];let viewBox,svgpath,$$restProps=compute_rest_props($$props,omit_props_names),{size:size="20"}=$$props,{color:color2="currentColor"}=$$props,{variation:variation="outline"}=$$props,{ariaLabel:ariaLabel="chevron down"}=$$props,{role:role="img"}=$$props,svgoutline=`<path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" stroke="${color2}"></path>`,svgsolid=`<path clip-rule="evenodd" fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" fill="${color2}"></path>`;return $$self.$$set=$$new_props=>{$$invalidate(5,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),$$invalidate(6,$$restProps=compute_rest_props($$props,omit_props_names)),"size"in $$new_props&&$$invalidate(0,size=$$new_props.size),"color"in $$new_props&&$$invalidate(7,color2=$$new_props.color),"variation"in $$new_props&&$$invalidate(8,variation=$$new_props.variation),"ariaLabel"in $$new_props&&$$invalidate(1,ariaLabel=$$new_props.ariaLabel),"role"in $$new_props&&$$invalidate(2,role=$$new_props.role)},$$self.$$.update=()=>{if(256&$$self.$$.dirty)switch(variation){case"outline":default:$$invalidate(4,svgpath=svgoutline),$$invalidate(3,viewBox="0 0 20 20");break;case"solid":$$invalidate(4,svgpath=svgsolid),$$invalidate(3,viewBox="0 0 20 20")}},$$props=exclude_internal_props($$props),[size,ariaLabel,role,viewBox,svgpath,$$props,$$restProps,color2,variation,function(event){bubble.call(this,$$self,event)}]}class ChevronDown extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$B,create_fragment$B,safe_not_equal,{size:0,color:7,variation:8,ariaLabel:1,role:2})}}function create_fragment$A(ctx){let svg2,svg_class_value,mounted,dispose,svg_levels=[{xmlns:"http://www.w3.org/2000/svg"},{width:ctx[0]},{height:ctx[0]},{class:svg_class_value=ctx[5].class},ctx[6],{"aria-label":ctx[1]},{fill:"none"},{viewBox:ctx[3]},{role:ctx[2]},{"stroke-width":"2"}],svg_data={};for(let i2=0;i2<svg_levels.length;i2+=1)svg_data=assign(svg_data,svg_levels[i2]);return{c(){svg2=svg_element("svg"),set_svg_attributes(svg2,svg_data)},m(target,anchor){insert$1(target,svg2,anchor),svg2.innerHTML=ctx[4],mounted||(dispose=listen(svg2,"click",ctx[9]),mounted=!0)},p(ctx2,[dirty]){16&dirty&&(svg2.innerHTML=ctx2[4]),set_svg_attributes(svg2,svg_data=get_spread_update(svg_levels,[{xmlns:"http://www.w3.org/2000/svg"},1&dirty&&{width:ctx2[0]},1&dirty&&{height:ctx2[0]},32&dirty&&svg_class_value!==(svg_class_value=ctx2[5].class)&&{class:svg_class_value},64&dirty&&ctx2[6],2&dirty&&{"aria-label":ctx2[1]},{fill:"none"},8&dirty&&{viewBox:ctx2[3]},4&dirty&&{role:ctx2[2]},{"stroke-width":"2"}]))},i:noop,o:noop,d(detaching){detaching&&detach(svg2),mounted=!1,dispose()}}}function instance$A($$self,$$props,$$invalidate){const omit_props_names=["size","color","variation","ariaLabel","role"];let viewBox,svgpath,$$restProps=compute_rest_props($$props,omit_props_names),{size:size="20"}=$$props,{color:color2="currentColor"}=$$props,{variation:variation="outline"}=$$props,{ariaLabel:ariaLabel="chevron up"}=$$props,{role:role="img"}=$$props,svgoutline=`<path clip-rule="evenodd" fill-rule="evenodd" d="M4.5 15.75L12 8.25L19.5 15.75" stroke="${color2}"></path>`,svgsolid=`<path clip-rule="evenodd" fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" fill="${color2}"></path>`;return $$self.$$set=$$new_props=>{$$invalidate(5,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),$$invalidate(6,$$restProps=compute_rest_props($$props,omit_props_names)),"size"in $$new_props&&$$invalidate(0,size=$$new_props.size),"color"in $$new_props&&$$invalidate(7,color2=$$new_props.color),"variation"in $$new_props&&$$invalidate(8,variation=$$new_props.variation),"ariaLabel"in $$new_props&&$$invalidate(1,ariaLabel=$$new_props.ariaLabel),"role"in $$new_props&&$$invalidate(2,role=$$new_props.role)},$$self.$$.update=()=>{if(256&$$self.$$.dirty)switch(variation){case"outline":default:$$invalidate(4,svgpath=svgoutline),$$invalidate(3,viewBox="0 0 20 20");break;case"solid":$$invalidate(4,svgpath=svgsolid),$$invalidate(3,viewBox="0 0 20 20")}},$$props=exclude_internal_props($$props),[size,ariaLabel,role,viewBox,svgpath,$$props,$$restProps,color2,variation,function(event){bubble.call(this,$$self,event)}]}class ChevronUp extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$A,create_fragment$A,safe_not_equal,{size:0,color:7,variation:8,ariaLabel:1,role:2})}}function cubicInOut(t2){return t2<.5?4*t2*t2*t2:.5*Math.pow(2*t2-2,3)+1}function cubicOut(t2){const f=t2-1;return f*f*f+1}function blur(node,{delay:delay=0,duration:duration=400,easing:easing=cubicInOut,amount:amount=5,opacity:opacity=0}={}){const style=getComputedStyle(node),target_opacity=+style.opacity,f="none"===style.filter?"":style.filter,od=target_opacity*(1-opacity),[value,unit]=split_css_unit(amount);return{delay:delay,duration:duration,easing:easing,css:(_t,u)=>`opacity: ${target_opacity-od*u}; filter: ${f} blur(${u*value}${unit});`}}const get_arrowdown_slot_changes=dirty=>({}),get_arrowdown_slot_context=ctx=>({}),get_arrowup_slot_changes=dirty=>({}),get_arrowup_slot_context=ctx=>({}),get_header_slot_changes=dirty=>({}),get_header_slot_context=ctx=>({});function create_else_block_1$1(ctx){let current;const arrowdown_slot_template=ctx[22].arrowdown,arrowdown_slot=create_slot(arrowdown_slot_template,ctx,ctx[21],get_arrowdown_slot_context),arrowdown_slot_or_fallback=arrowdown_slot||function(ctx){let chevrondown,current;return chevrondown=new ChevronDown({}),{c(){create_component(chevrondown.$$.fragment)},m(target,anchor){mount_component(chevrondown,target,anchor),current=!0},i(local){current||(transition_in(chevrondown.$$.fragment,local),current=!0)},o(local){transition_out(chevrondown.$$.fragment,local),current=!1},d(detaching){destroy_component(chevrondown,detaching)}}}();return{c(){arrowdown_slot_or_fallback&&arrowdown_slot_or_fallback.c()},m(target,anchor){arrowdown_slot_or_fallback&&arrowdown_slot_or_fallback.m(target,anchor),current=!0},p(ctx2,dirty){arrowdown_slot&&arrowdown_slot.p&&(!current||2097152&dirty)&&update_slot_base(arrowdown_slot,arrowdown_slot_template,ctx2,ctx2[21],current?get_slot_changes(arrowdown_slot_template,ctx2[21],dirty,get_arrowdown_slot_changes):get_all_dirty_from_scope(ctx2[21]),get_arrowdown_slot_context)},i(local){current||(transition_in(arrowdown_slot_or_fallback,local),current=!0)},o(local){transition_out(arrowdown_slot_or_fallback,local),current=!1},d(detaching){arrowdown_slot_or_fallback&&arrowdown_slot_or_fallback.d(detaching)}}}function create_if_block_1$e(ctx){let current;const arrowup_slot_template=ctx[22].arrowup,arrowup_slot=create_slot(arrowup_slot_template,ctx,ctx[21],get_arrowup_slot_context),arrowup_slot_or_fallback=arrowup_slot||function(ctx){let chevronup,current;return chevronup=new ChevronUp({}),{c(){create_component(chevronup.$$.fragment)},m(target,anchor){mount_component(chevronup,target,anchor),current=!0},i(local){current||(transition_in(chevronup.$$.fragment,local),current=!0)},o(local){transition_out(chevronup.$$.fragment,local),current=!1},d(detaching){destroy_component(chevronup,detaching)}}}();return{c(){arrowup_slot_or_fallback&&arrowup_slot_or_fallback.c()},m(target,anchor){arrowup_slot_or_fallback&&arrowup_slot_or_fallback.m(target,anchor),current=!0},p(ctx2,dirty){arrowup_slot&&arrowup_slot.p&&(!current||2097152&dirty)&&update_slot_base(arrowup_slot,arrowup_slot_template,ctx2,ctx2[21],current?get_slot_changes(arrowup_slot_template,ctx2[21],dirty,get_arrowup_slot_changes):get_all_dirty_from_scope(ctx2[21]),get_arrowup_slot_context)},i(local){current||(transition_in(arrowup_slot_or_fallback,local),current=!0)},o(local){transition_out(arrowup_slot_or_fallback,local),current=!1},d(detaching){arrowup_slot_or_fallback&&arrowup_slot_or_fallback.d(detaching)}}}function create_else_block$8(ctx){let div1,div0,current;const default_slot_template=ctx[22].default,default_slot=create_slot(default_slot_template,ctx,ctx[21],null);return{c(){div1=element("div"),div0=element("div"),default_slot&&default_slot.c(),attr(div0,"class",ctx[3]),attr(div1,"class","hidden")},m(target,anchor){insert$1(target,div1,anchor),append(div1,div0),default_slot&&default_slot.m(div0,null),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||2097152&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[21],current?get_slot_changes(default_slot_template,ctx2[21],dirty,null):get_all_dirty_from_scope(ctx2[21]),null),(!current||8&dirty)&&attr(div0,"class",ctx2[3])},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){detaching&&detach(div1),default_slot&&default_slot.d(detaching)}}}function create_if_block$p(ctx){let div1,div0,div1_transition,current;const default_slot_template=ctx[22].default,default_slot=create_slot(default_slot_template,ctx,ctx[21],null);return{c(){div1=element("div"),div0=element("div"),default_slot&&default_slot.c(),attr(div0,"class",ctx[3])},m(target,anchor){insert$1(target,div1,anchor),append(div1,div0),default_slot&&default_slot.m(div0,null),current=!0},p(new_ctx,dirty){ctx=new_ctx,default_slot&&default_slot.p&&(!current||2097152&dirty)&&update_slot_base(default_slot,default_slot_template,ctx,ctx[21],current?get_slot_changes(default_slot_template,ctx[21],dirty,null):get_all_dirty_from_scope(ctx[21]),null),(!current||8&dirty)&&attr(div0,"class",ctx[3])},i(local){current||(transition_in(default_slot,local),local&&add_render_callback((()=>{current&&(div1_transition||(div1_transition=create_bidirectional_transition(div1,ctx[4],ctx[1],!0)),div1_transition.run(1))})),current=!0)},o(local){transition_out(default_slot,local),local&&(div1_transition||(div1_transition=create_bidirectional_transition(div1,ctx[4],ctx[1],!1)),div1_transition.run(0)),current=!1},d(detaching){detaching&&detach(div1),default_slot&&default_slot.d(detaching),detaching&&div1_transition&&div1_transition.end()}}}function create_fragment$z(ctx){let h2,button,t0,current_block_type_index,if_block0,t1,current_block_type_index_1,if_block1,if_block1_anchor,current,mounted,dispose;const header_slot_template=ctx[22].header,header_slot=create_slot(header_slot_template,ctx,ctx[21],get_header_slot_context),if_block_creators=[create_if_block_1$e,create_else_block_1$1],if_blocks=[];function select_block_type(ctx2,dirty){return ctx2[0]?0:1}current_block_type_index=select_block_type(ctx),if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);const if_block_creators_1=[create_if_block$p,create_else_block$8],if_blocks_1=[];function select_block_type_1(ctx2,dirty){return ctx2[0]?0:1}return current_block_type_index_1=select_block_type_1(ctx),if_block1=if_blocks_1[current_block_type_index_1]=if_block_creators_1[current_block_type_index_1](ctx),{c(){h2=element("h2"),button=element("button"),header_slot&&header_slot.c(),t0=space(),if_block0.c(),t1=space(),if_block1.c(),if_block1_anchor=empty$1(),attr(button,"type","button"),attr(button,"class",ctx[2]),attr(button,"aria-expanded",ctx[0]),attr(h2,"class","group")},m(target,anchor){insert$1(target,h2,anchor),append(h2,button),header_slot&&header_slot.m(button,null),append(button,t0),if_blocks[current_block_type_index].m(button,null),insert$1(target,t1,anchor),if_blocks_1[current_block_type_index_1].m(target,anchor),insert$1(target,if_block1_anchor,anchor),current=!0,mounted||(dispose=listen(button,"click",ctx[6]),mounted=!0)},p(ctx2,[dirty]){header_slot&&header_slot.p&&(!current||2097152&dirty)&&update_slot_base(header_slot,header_slot_template,ctx2,ctx2[21],current?get_slot_changes(header_slot_template,ctx2[21],dirty,get_header_slot_changes):get_all_dirty_from_scope(ctx2[21]),get_header_slot_context);let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx2),current_block_type_index===previous_block_index?if_blocks[current_block_type_index].p(ctx2,dirty):(group_outros(),transition_out(if_blocks[previous_block_index],1,1,(()=>{if_blocks[previous_block_index]=null})),check_outros(),if_block0=if_blocks[current_block_type_index],if_block0?if_block0.p(ctx2,dirty):(if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx2),if_block0.c()),transition_in(if_block0,1),if_block0.m(button,null)),(!current||4&dirty)&&attr(button,"class",ctx2[2]),(!current||1&dirty)&&attr(button,"aria-expanded",ctx2[0]);let previous_block_index_1=current_block_type_index_1;current_block_type_index_1=select_block_type_1(ctx2),current_block_type_index_1===previous_block_index_1?if_blocks_1[current_block_type_index_1].p(ctx2,dirty):(group_outros(),transition_out(if_blocks_1[previous_block_index_1],1,1,(()=>{if_blocks_1[previous_block_index_1]=null})),check_outros(),if_block1=if_blocks_1[current_block_type_index_1],if_block1?if_block1.p(ctx2,dirty):(if_block1=if_blocks_1[current_block_type_index_1]=if_block_creators_1[current_block_type_index_1](ctx2),if_block1.c()),transition_in(if_block1,1),if_block1.m(if_block1_anchor.parentNode,if_block1_anchor))},i(local){current||(transition_in(header_slot,local),transition_in(if_block0),transition_in(if_block1),current=!0)},o(local){transition_out(header_slot,local),transition_out(if_block0),transition_out(if_block1),current=!1},d(detaching){detaching&&(detach(h2),detach(t1),detach(if_block1_anchor)),header_slot&&header_slot.d(detaching),if_blocks[current_block_type_index].d(),if_blocks_1[current_block_type_index_1].d(detaching),mounted=!1,dispose()}}}function instance$z($$self,$$props,$$invalidate){let contentClass,$selected,{$$slots:slots={},$$scope:$$scope}=$$props,{open:open=!1}=$$props,{activeClass:activeClass}=$$props,{inactiveClass:inactiveClass}=$$props,{defaultClass:defaultClass2="flex items-center justify-between w-full font-medium text-left group-first:rounded-t-xl border-gray-200 dark:border-gray-700"}=$$props,{transitionType:transitionType="slide"}=$$props,{transitionParams:transitionParams={}}=$$props,{paddingFlush:paddingFlush="py-5"}=$$props,{paddingDefault:paddingDefault="p-5"}=$$props,{textFlushOpen:textFlushOpen="text-gray-900 dark:text-white"}=$$props,{textFlushDefault:textFlushDefault="text-gray-500 dark:text-gray-400"}=$$props,{borderClass:borderClass="border-l border-r group-first:border-t"}=$$props,{borderOpenClass:borderOpenClass="border-l border-r"}=$$props,{borderBottomClass:borderBottomClass="border-b"}=$$props,{borderSharedClass:borderSharedClass="border-gray-200 dark:border-gray-700"}=$$props,{classActive:classActive}=$$props,{classInactive:classInactive}=$$props,activeCls=twMerge(activeClass,classActive),inactiveCls=twMerge(inactiveClass,classInactive);const ctx=getContext("ctx")??{},self2={},selected=ctx.selected??writable();component_subscribe($$self,selected,(value=>$$invalidate(23,$selected=value)));let _open=open;open=!1,onMount((()=>{var value;return _open&&($selected=self2,value=$selected,selected.set(value)),selected.subscribe((x=>$$invalidate(0,open=x===self2)))}));let buttonClass;return $$self.$$set=$$new_props=>{$$invalidate(29,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),"open"in $$new_props&&$$invalidate(0,open=$$new_props.open),"activeClass"in $$new_props&&$$invalidate(7,activeClass=$$new_props.activeClass),"inactiveClass"in $$new_props&&$$invalidate(8,inactiveClass=$$new_props.inactiveClass),"defaultClass"in $$new_props&&$$invalidate(9,defaultClass2=$$new_props.defaultClass),"transitionType"in $$new_props&&$$invalidate(10,transitionType=$$new_props.transitionType),"transitionParams"in $$new_props&&$$invalidate(1,transitionParams=$$new_props.transitionParams),"paddingFlush"in $$new_props&&$$invalidate(11,paddingFlush=$$new_props.paddingFlush),"paddingDefault"in $$new_props&&$$invalidate(12,paddingDefault=$$new_props.paddingDefault),"textFlushOpen"in $$new_props&&$$invalidate(13,textFlushOpen=$$new_props.textFlushOpen),"textFlushDefault"in $$new_props&&$$invalidate(14,textFlushDefault=$$new_props.textFlushDefault),"borderClass"in $$new_props&&$$invalidate(15,borderClass=$$new_props.borderClass),"borderOpenClass"in $$new_props&&$$invalidate(16,borderOpenClass=$$new_props.borderOpenClass),"borderBottomClass"in $$new_props&&$$invalidate(17,borderBottomClass=$$new_props.borderBottomClass),"borderSharedClass"in $$new_props&&$$invalidate(18,borderSharedClass=$$new_props.borderSharedClass),"classActive"in $$new_props&&$$invalidate(19,classActive=$$new_props.classActive),"classInactive"in $$new_props&&$$invalidate(20,classInactive=$$new_props.classInactive),"$$scope"in $$new_props&&$$invalidate(21,$$scope=$$new_props.$$scope)},$$self.$$.update=()=>{$$invalidate(2,buttonClass=twMerge([defaultClass2,ctx.flush||borderClass,borderBottomClass,borderSharedClass,ctx.flush?paddingFlush:paddingDefault,open&&(ctx.flush?textFlushOpen:activeCls||ctx.activeClass),!open&&(ctx.flush?textFlushDefault:inactiveCls||ctx.inactiveClass),$$props.class])),464896&$$self.$$.dirty&&$$invalidate(3,contentClass=twMerge([ctx.flush?paddingFlush:paddingDefault,ctx.flush?"":borderOpenClass,borderBottomClass,borderSharedClass]))},$$props=exclude_internal_props($$props),[open,transitionParams,buttonClass,contentClass,(node,params)=>{switch(transitionType){case"blur":return blur(node,params);case"fly":return function(node,{delay:delay=0,duration:duration=400,easing:easing=cubicOut,x:x=0,y:y=0,opacity:opacity=0}={}){const style=getComputedStyle(node),target_opacity=+style.opacity,transform="none"===style.transform?"":style.transform,od=target_opacity*(1-opacity),[xValue,xUnit]=split_css_unit(x),[yValue,yUnit]=split_css_unit(y);return{delay:delay,duration:duration,easing:easing,css:(t2,u)=>`\n\t\t\ttransform: ${transform} translate(${(1-t2)*xValue}${xUnit}, ${(1-t2)*yValue}${yUnit});\n\t\t\topacity: ${target_opacity-od*u}`}}(node,params);case"fade":return function(node,{delay:delay=0,duration:duration=400,easing:easing=identity}={}){const o=+getComputedStyle(node).opacity;return{delay:delay,duration:duration,easing:easing,css:t2=>"opacity: "+t2*o}}(node,params);default:return function(node,{delay:delay=0,duration:duration=400,easing:easing=cubicOut,axis:axis="y"}={}){const style=getComputedStyle(node),opacity=+style.opacity,primary_property="y"===axis?"height":"width",primary_property_value=parseFloat(style[primary_property]),secondary_properties="y"===axis?["top","bottom"]:["left","right"],capitalized_secondary_properties=secondary_properties.map((e=>`${e[0].toUpperCase()}${e.slice(1)}`)),padding_start_value=parseFloat(style[`padding${capitalized_secondary_properties[0]}`]),padding_end_value=parseFloat(style[`padding${capitalized_secondary_properties[1]}`]),margin_start_value=parseFloat(style[`margin${capitalized_secondary_properties[0]}`]),margin_end_value=parseFloat(style[`margin${capitalized_secondary_properties[1]}`]),border_width_start_value=parseFloat(style[`border${capitalized_secondary_properties[0]}Width`]),border_width_end_value=parseFloat(style[`border${capitalized_secondary_properties[1]}Width`]);return{delay:delay,duration:duration,easing:easing,css:t2=>`overflow: hidden;opacity: ${Math.min(20*t2,1)*opacity};${primary_property}: ${t2*primary_property_value}px;padding-${secondary_properties[0]}: ${t2*padding_start_value}px;padding-${secondary_properties[1]}: ${t2*padding_end_value}px;margin-${secondary_properties[0]}: ${t2*margin_start_value}px;margin-${secondary_properties[1]}: ${t2*margin_end_value}px;border-${secondary_properties[0]}-width: ${t2*border_width_start_value}px;border-${secondary_properties[1]}-width: ${t2*border_width_end_value}px;`}}(node,params)}},selected,_=>selected.set(open?{}:self2),activeClass,inactiveClass,defaultClass2,transitionType,paddingFlush,paddingDefault,textFlushOpen,textFlushDefault,borderClass,borderOpenClass,borderBottomClass,borderSharedClass,classActive,classInactive,$$scope,slots]}class AccordionItem extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$z,create_fragment$z,safe_not_equal,{open:0,activeClass:7,inactiveClass:8,defaultClass:9,transitionType:10,transitionParams:1,paddingFlush:11,paddingDefault:12,textFlushOpen:13,textFlushDefault:14,borderClass:15,borderOpenClass:16,borderBottomClass:17,borderSharedClass:18,classActive:19,classInactive:20})}}var top$1="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[top$1,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce((function(acc,placement){return acc.concat([placement+"-"+start,placement+"-"+end])}),[]),placements=[].concat(basePlacements,[auto]).reduce((function(acc,placement){return acc.concat([placement,placement+"-"+start,placement+"-"+end])}),[]),modifierPhases=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function getNodeName(element2){return element2?(element2.nodeName||"").toLowerCase():null}function getWindow(node){if(null==node)return window;if("[object Window]"!==node.toString()){var ownerDocument=node.ownerDocument;return ownerDocument&&ownerDocument.defaultView||window}return node}function isElement(node){return node instanceof getWindow(node).Element||node instanceof Element}function isHTMLElement(node){return node instanceof getWindow(node).HTMLElement||node instanceof HTMLElement}function isShadowRoot(node){return"undefined"!=typeof ShadowRoot&&(node instanceof getWindow(node).ShadowRoot||node instanceof ShadowRoot)}const applyStyles$1={name:"applyStyles",enabled:!0,phase:"write",fn:function(_ref){var state=_ref.state;Object.keys(state.elements).forEach((function(name2){var style=state.styles[name2]||{},attributes=state.attributes[name2]||{},element2=state.elements[name2];isHTMLElement(element2)&&getNodeName(element2)&&(Object.assign(element2.style,style),Object.keys(attributes).forEach((function(name3){var value=attributes[name3];!1===value?element2.removeAttribute(name3):element2.setAttribute(name3,!0===value?"":value)})))}))},effect:function(_ref2){var state=_ref2.state,initialStyles={popper:{position:state.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(state.elements.popper.style,initialStyles.popper),state.styles=initialStyles,state.elements.arrow&&Object.assign(state.elements.arrow.style,initialStyles.arrow),function(){Object.keys(state.elements).forEach((function(name2){var element2=state.elements[name2],attributes=state.attributes[name2]||{},style=Object.keys(state.styles.hasOwnProperty(name2)?state.styles[name2]:initialStyles[name2]).reduce((function(style2,property){return style2[property]="",style2}),{});isHTMLElement(element2)&&getNodeName(element2)&&(Object.assign(element2.style,style),Object.keys(attributes).forEach((function(attribute){element2.removeAttribute(attribute)})))}))}},requires:["computeStyles"]};function getBasePlacement(placement){return placement.split("-")[0]}var max=Math.max,min=Math.min,round=Math.round;function getUAString(){var uaData=navigator.userAgentData;return null!=uaData&&uaData.brands&&Array.isArray(uaData.brands)?uaData.brands.map((function(item){return item.brand+"/"+item.version})).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(element2,includeScale,isFixedStrategy){void 0===includeScale&&(includeScale=!1),void 0===isFixedStrategy&&(isFixedStrategy=!1);var clientRect=element2.getBoundingClientRect(),scaleX=1,scaleY=1;includeScale&&isHTMLElement(element2)&&(scaleX=element2.offsetWidth>0&&round(clientRect.width)/element2.offsetWidth||1,scaleY=element2.offsetHeight>0&&round(clientRect.height)/element2.offsetHeight||1);var visualViewport=(isElement(element2)?getWindow(element2):window).visualViewport,addVisualOffsets=!isLayoutViewport()&&isFixedStrategy,x=(clientRect.left+(addVisualOffsets&&visualViewport?visualViewport.offsetLeft:0))/scaleX,y=(clientRect.top+(addVisualOffsets&&visualViewport?visualViewport.offsetTop:0))/scaleY,width=clientRect.width/scaleX,height=clientRect.height/scaleY;return{width:width,height:height,top:y,right:x+width,bottom:y+height,left:x,x:x,y:y}}function getLayoutRect(element2){var clientRect=getBoundingClientRect(element2),width=element2.offsetWidth,height=element2.offsetHeight;return Math.abs(clientRect.width-width)<=1&&(width=clientRect.width),Math.abs(clientRect.height-height)<=1&&(height=clientRect.height),{x:element2.offsetLeft,y:element2.offsetTop,width:width,height:height}}function contains$2(parent,child){var rootNode=child.getRootNode&&child.getRootNode();if(parent.contains(child))return!0;if(rootNode&&isShadowRoot(rootNode)){var next=child;do{if(next&&parent.isSameNode(next))return!0;next=next.parentNode||next.host}while(next)}return!1}function getComputedStyle$1(element2){return getWindow(element2).getComputedStyle(element2)}function isTableElement(element2){return["table","td","th"].indexOf(getNodeName(element2))>=0}function getDocumentElement(element2){return((isElement(element2)?element2.ownerDocument:element2.document)||window.document).documentElement}function getParentNode(element2){return"html"===getNodeName(element2)?element2:element2.assignedSlot||element2.parentNode||(isShadowRoot(element2)?element2.host:null)||getDocumentElement(element2)}function getTrueOffsetParent(element2){return isHTMLElement(element2)&&"fixed"!==getComputedStyle$1(element2).position?element2.offsetParent:null}function getOffsetParent(element2){for(var window2=getWindow(element2),offsetParent=getTrueOffsetParent(element2);offsetParent&&isTableElement(offsetParent)&&"static"===getComputedStyle$1(offsetParent).position;)offsetParent=getTrueOffsetParent(offsetParent);return offsetParent&&("html"===getNodeName(offsetParent)||"body"===getNodeName(offsetParent)&&"static"===getComputedStyle$1(offsetParent).position)?window2:offsetParent||function(element2){var isFirefox2=/firefox/i.test(getUAString());if(/Trident/i.test(getUAString())&&isHTMLElement(element2)&&"fixed"===getComputedStyle$1(element2).position)return null;var currentNode=getParentNode(element2);for(isShadowRoot(currentNode)&&(currentNode=currentNode.host);isHTMLElement(currentNode)&&["html","body"].indexOf(getNodeName(currentNode))<0;){var css=getComputedStyle$1(currentNode);if("none"!==css.transform||"none"!==css.perspective||"paint"===css.contain||-1!==["transform","perspective"].indexOf(css.willChange)||isFirefox2&&"filter"===css.willChange||isFirefox2&&css.filter&&"none"!==css.filter)return currentNode;currentNode=currentNode.parentNode}return null}(element2)||window2}function getMainAxisFromPlacement(placement){return["top","bottom"].indexOf(placement)>=0?"x":"y"}function within(min$1,value,max$1){return max(min$1,min(value,max$1))}function mergePaddingObject(paddingObject){return Object.assign({},{top:0,right:0,bottom:0,left:0},paddingObject)}function expandToHashMap(value,keys2){return keys2.reduce((function(hashMap,key){return hashMap[key]=value,hashMap}),{})}function getVariation(placement){return placement.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function mapToStyles(_ref2){var _Object$assign2,popper2=_ref2.popper,popperRect=_ref2.popperRect,placement=_ref2.placement,variation=_ref2.variation,offsets=_ref2.offsets,position=_ref2.position,gpuAcceleration=_ref2.gpuAcceleration,adaptive=_ref2.adaptive,roundOffsets=_ref2.roundOffsets,isFixed=_ref2.isFixed,_offsets$x=offsets.x,x=void 0===_offsets$x?0:_offsets$x,_offsets$y=offsets.y,y=void 0===_offsets$y?0:_offsets$y,_ref3="function"==typeof roundOffsets?roundOffsets({x:x,y:y}):{x:x,y:y};x=_ref3.x,y=_ref3.y;var hasX=offsets.hasOwnProperty("x"),hasY=offsets.hasOwnProperty("y"),sideX=left,sideY=top$1,win=window;if(adaptive){var offsetParent=getOffsetParent(popper2),heightProp="clientHeight",widthProp="clientWidth";if(offsetParent===getWindow(popper2)&&"static"!==getComputedStyle$1(offsetParent=getDocumentElement(popper2)).position&&"absolute"===position&&(heightProp="scrollHeight",widthProp="scrollWidth"),placement===top$1||(placement===left||placement===right)&&variation===end)sideY=bottom,y-=(isFixed&&offsetParent===win&&win.visualViewport?win.visualViewport.height:offsetParent[heightProp])-popperRect.height,y*=gpuAcceleration?1:-1;if(placement===left||(placement===top$1||placement===bottom)&&variation===end)sideX=right,x-=(isFixed&&offsetParent===win&&win.visualViewport?win.visualViewport.width:offsetParent[widthProp])-popperRect.width,x*=gpuAcceleration?1:-1}var _Object$assign,commonStyles=Object.assign({position:position},adaptive&&unsetSides),_ref4=!0===roundOffsets?function(_ref,win){var x=_ref.x,y=_ref.y,dpr=win.devicePixelRatio||1;return{x:round(x*dpr)/dpr||0,y:round(y*dpr)/dpr||0}}({x:x,y:y},getWindow(popper2)):{x:x,y:y};return x=_ref4.x,y=_ref4.y,gpuAcceleration?Object.assign({},commonStyles,((_Object$assign={})[sideY]=hasY?"0":"",_Object$assign[sideX]=hasX?"0":"",_Object$assign.transform=(win.devicePixelRatio||1)<=1?"translate("+x+"px, "+y+"px)":"translate3d("+x+"px, "+y+"px, 0)",_Object$assign)):Object.assign({},commonStyles,((_Object$assign2={})[sideY]=hasY?y+"px":"",_Object$assign2[sideX]=hasX?x+"px":"",_Object$assign2.transform="",_Object$assign2))}var passive={passive:!0};var hash$1={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(placement){return placement.replace(/left|right|bottom|top/g,(function(matched){return hash$1[matched]}))}var hash={start:"end",end:"start"};function getOppositeVariationPlacement(placement){return placement.replace(/start|end/g,(function(matched){return hash[matched]}))}function getWindowScroll(node){var win=getWindow(node);return{scrollLeft:win.pageXOffset,scrollTop:win.pageYOffset}}function getWindowScrollBarX(element2){return getBoundingClientRect(getDocumentElement(element2)).left+getWindowScroll(element2).scrollLeft}function isScrollParent(element2){var _getComputedStyle=getComputedStyle$1(element2),overflow=_getComputedStyle.overflow,overflowX=_getComputedStyle.overflowX,overflowY=_getComputedStyle.overflowY;return/auto|scroll|overlay|hidden/.test(overflow+overflowY+overflowX)}function getScrollParent(node){return["html","body","#document"].indexOf(getNodeName(node))>=0?node.ownerDocument.body:isHTMLElement(node)&&isScrollParent(node)?node:getScrollParent(getParentNode(node))}function listScrollParents(element2,list){var _element$ownerDocumen;void 0===list&&(list=[]);var scrollParent=getScrollParent(element2),isBody=scrollParent===(null==(_element$ownerDocumen=element2.ownerDocument)?void 0:_element$ownerDocumen.body),win=getWindow(scrollParent),target=isBody?[win].concat(win.visualViewport||[],isScrollParent(scrollParent)?scrollParent:[]):scrollParent,updatedList=list.concat(target);return isBody?updatedList:updatedList.concat(listScrollParents(getParentNode(target)))}function rectToClientRect(rect){return Object.assign({},rect,{left:rect.x,top:rect.y,right:rect.x+rect.width,bottom:rect.y+rect.height})}function getClientRectFromMixedType(element2,clippingParent,strategy){return clippingParent===viewport?rectToClientRect(function(element2,strategy){var win=getWindow(element2),html=getDocumentElement(element2),visualViewport=win.visualViewport,width=html.clientWidth,height=html.clientHeight,x=0,y=0;if(visualViewport){width=visualViewport.width,height=visualViewport.height;var layoutViewport=isLayoutViewport();(layoutViewport||!layoutViewport&&"fixed"===strategy)&&(x=visualViewport.offsetLeft,y=visualViewport.offsetTop)}return{width:width,height:height,x:x+getWindowScrollBarX(element2),y:y}}(element2,strategy)):isElement(clippingParent)?function(element2,strategy){var rect=getBoundingClientRect(element2,!1,"fixed"===strategy);return rect.top=rect.top+element2.clientTop,rect.left=rect.left+element2.clientLeft,rect.bottom=rect.top+element2.clientHeight,rect.right=rect.left+element2.clientWidth,rect.width=element2.clientWidth,rect.height=element2.clientHeight,rect.x=rect.left,rect.y=rect.top,rect}(clippingParent,strategy):rectToClientRect(function(element2){var _element$ownerDocumen,html=getDocumentElement(element2),winScroll=getWindowScroll(element2),body=null==(_element$ownerDocumen=element2.ownerDocument)?void 0:_element$ownerDocumen.body,width=max(html.scrollWidth,html.clientWidth,body?body.scrollWidth:0,body?body.clientWidth:0),height=max(html.scrollHeight,html.clientHeight,body?body.scrollHeight:0,body?body.clientHeight:0),x=-winScroll.scrollLeft+getWindowScrollBarX(element2),y=-winScroll.scrollTop;return"rtl"===getComputedStyle$1(body||html).direction&&(x+=max(html.clientWidth,body?body.clientWidth:0)-width),{width:width,height:height,x:x,y:y}}(getDocumentElement(element2)))}function getClippingRect(element2,boundary,rootBoundary,strategy){var mainClippingParents="clippingParents"===boundary?function(element2){var clippingParents2=listScrollParents(getParentNode(element2)),clipperElement=["absolute","fixed"].indexOf(getComputedStyle$1(element2).position)>=0&&isHTMLElement(element2)?getOffsetParent(element2):element2;return isElement(clipperElement)?clippingParents2.filter((function(clippingParent){return isElement(clippingParent)&&contains$2(clippingParent,clipperElement)&&"body"!==getNodeName(clippingParent)})):[]}(element2):[].concat(boundary),clippingParents2=[].concat(mainClippingParents,[rootBoundary]),firstClippingParent=clippingParents2[0],clippingRect=clippingParents2.reduce((function(accRect,clippingParent){var rect=getClientRectFromMixedType(element2,clippingParent,strategy);return accRect.top=max(rect.top,accRect.top),accRect.right=min(rect.right,accRect.right),accRect.bottom=min(rect.bottom,accRect.bottom),accRect.left=max(rect.left,accRect.left),accRect}),getClientRectFromMixedType(element2,firstClippingParent,strategy));return clippingRect.width=clippingRect.right-clippingRect.left,clippingRect.height=clippingRect.bottom-clippingRect.top,clippingRect.x=clippingRect.left,clippingRect.y=clippingRect.top,clippingRect}function computeOffsets(_ref){var offsets,reference2=_ref.reference,element2=_ref.element,placement=_ref.placement,basePlacement=placement?getBasePlacement(placement):null,variation=placement?getVariation(placement):null,commonX=reference2.x+reference2.width/2-element2.width/2,commonY=reference2.y+reference2.height/2-element2.height/2;switch(basePlacement){case top$1:offsets={x:commonX,y:reference2.y-element2.height};break;case bottom:offsets={x:commonX,y:reference2.y+reference2.height};break;case right:offsets={x:reference2.x+reference2.width,y:commonY};break;case left:offsets={x:reference2.x-element2.width,y:commonY};break;default:offsets={x:reference2.x,y:reference2.y}}var mainAxis=basePlacement?getMainAxisFromPlacement(basePlacement):null;if(null!=mainAxis){var len="y"===mainAxis?"height":"width";switch(variation){case start:offsets[mainAxis]=offsets[mainAxis]-(reference2[len]/2-element2[len]/2);break;case end:offsets[mainAxis]=offsets[mainAxis]+(reference2[len]/2-element2[len]/2)}}return offsets}function detectOverflow(state,options){void 0===options&&(options={});var _options=options,_options$placement=_options.placement,placement=void 0===_options$placement?state.placement:_options$placement,_options$strategy=_options.strategy,strategy=void 0===_options$strategy?state.strategy:_options$strategy,_options$boundary=_options.boundary,boundary=void 0===_options$boundary?clippingParents:_options$boundary,_options$rootBoundary=_options.rootBoundary,rootBoundary=void 0===_options$rootBoundary?viewport:_options$rootBoundary,_options$elementConte=_options.elementContext,elementContext=void 0===_options$elementConte?popper:_options$elementConte,_options$altBoundary=_options.altBoundary,altBoundary=void 0!==_options$altBoundary&&_options$altBoundary,_options$padding=_options.padding,padding=void 0===_options$padding?0:_options$padding,paddingObject=mergePaddingObject("number"!=typeof padding?padding:expandToHashMap(padding,basePlacements)),altContext=elementContext===popper?reference:popper,popperRect=state.rects.popper,element2=state.elements[altBoundary?altContext:elementContext],clippingClientRect=getClippingRect(isElement(element2)?element2:element2.contextElement||getDocumentElement(state.elements.popper),boundary,rootBoundary,strategy),referenceClientRect=getBoundingClientRect(state.elements.reference),popperOffsets2=computeOffsets({reference:referenceClientRect,element:popperRect,strategy:"absolute",placement:placement}),popperClientRect=rectToClientRect(Object.assign({},popperRect,popperOffsets2)),elementClientRect=elementContext===popper?popperClientRect:referenceClientRect,overflowOffsets={top:clippingClientRect.top-elementClientRect.top+paddingObject.top,bottom:elementClientRect.bottom-clippingClientRect.bottom+paddingObject.bottom,left:clippingClientRect.left-elementClientRect.left+paddingObject.left,right:elementClientRect.right-clippingClientRect.right+paddingObject.right},offsetData=state.modifiersData.offset;if(elementContext===popper&&offsetData){var offset2=offsetData[placement];Object.keys(overflowOffsets).forEach((function(key){var multiply=[right,bottom].indexOf(key)>=0?1:-1,axis=[top$1,bottom].indexOf(key)>=0?"y":"x";overflowOffsets[key]+=offset2[axis]*multiply}))}return overflowOffsets}function getSideOffsets(overflow,rect,preventedOffsets){return void 0===preventedOffsets&&(preventedOffsets={x:0,y:0}),{top:overflow.top-rect.height-preventedOffsets.y,right:overflow.right-rect.width+preventedOffsets.x,bottom:overflow.bottom-rect.height+preventedOffsets.y,left:overflow.left-rect.width-preventedOffsets.x}}function isAnySideFullyClipped(overflow){return[top$1,right,bottom,left].some((function(side){return overflow[side]>=0}))}function getCompositeRect(elementOrVirtualElement,offsetParent,isFixed){void 0===isFixed&&(isFixed=!1);var node,element2,isOffsetParentAnElement=isHTMLElement(offsetParent),offsetParentIsScaled=isHTMLElement(offsetParent)&&function(element2){var rect=element2.getBoundingClientRect(),scaleX=round(rect.width)/element2.offsetWidth||1,scaleY=round(rect.height)/element2.offsetHeight||1;return 1!==scaleX||1!==scaleY}(offsetParent),documentElement=getDocumentElement(offsetParent),rect=getBoundingClientRect(elementOrVirtualElement,offsetParentIsScaled,isFixed),scroll={scrollLeft:0,scrollTop:0},offsets={x:0,y:0};return(isOffsetParentAnElement||!isOffsetParentAnElement&&!isFixed)&&(("body"!==getNodeName(offsetParent)||isScrollParent(documentElement))&&(scroll=(node=offsetParent)!==getWindow(node)&&isHTMLElement(node)?{scrollLeft:(element2=node).scrollLeft,scrollTop:element2.scrollTop}:getWindowScroll(node)),isHTMLElement(offsetParent)?((offsets=getBoundingClientRect(offsetParent,!0)).x+=offsetParent.clientLeft,offsets.y+=offsetParent.clientTop):documentElement&&(offsets.x=getWindowScrollBarX(documentElement))),{x:rect.left+scroll.scrollLeft-offsets.x,y:rect.top+scroll.scrollTop-offsets.y,width:rect.width,height:rect.height}}function order(modifiers2){var map=new Map,visited=new Set,result=[];function sort(modifier){visited.add(modifier.name),[].concat(modifier.requires||[],modifier.requiresIfExists||[]).forEach((function(dep){if(!visited.has(dep)){var depModifier=map.get(dep);depModifier&&sort(depModifier)}})),result.push(modifier)}return modifiers2.forEach((function(modifier){map.set(modifier.name,modifier)})),modifiers2.forEach((function(modifier){visited.has(modifier.name)||sort(modifier)})),result}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return!args.some((function(element2){return!(element2&&"function"==typeof element2.getBoundingClientRect)}))}function popperGenerator(generatorOptions){void 0===generatorOptions&&(generatorOptions={});var _generatorOptions=generatorOptions,_generatorOptions$def=_generatorOptions.defaultModifiers,defaultModifiers2=void 0===_generatorOptions$def?[]:_generatorOptions$def,_generatorOptions$def2=_generatorOptions.defaultOptions,defaultOptions=void 0===_generatorOptions$def2?DEFAULT_OPTIONS:_generatorOptions$def2;return function(reference2,popper2,options){void 0===options&&(options=defaultOptions);var fn,pending,state={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,defaultOptions),modifiersData:{},elements:{reference:reference2,popper:popper2},attributes:{},styles:{}},effectCleanupFns=[],isDestroyed=!1,instance2={state:state,setOptions:function(setOptionsAction){var options2="function"==typeof setOptionsAction?setOptionsAction(state.options):setOptionsAction;cleanupModifierEffects(),state.options=Object.assign({},defaultOptions,state.options,options2),state.scrollParents={reference:isElement(reference2)?listScrollParents(reference2):reference2.contextElement?listScrollParents(reference2.contextElement):[],popper:listScrollParents(popper2)};var modifiers2,merged,orderedModifiers=function(modifiers2){var orderedModifiers=order(modifiers2);return modifierPhases.reduce((function(acc,phase){return acc.concat(orderedModifiers.filter((function(modifier){return modifier.phase===phase})))}),[])}((modifiers2=[].concat(defaultModifiers2,state.options.modifiers),merged=modifiers2.reduce((function(merged2,current){var existing=merged2[current.name];return merged2[current.name]=existing?Object.assign({},existing,current,{options:Object.assign({},existing.options,current.options),data:Object.assign({},existing.data,current.data)}):current,merged2}),{}),Object.keys(merged).map((function(key){return merged[key]}))));return state.orderedModifiers=orderedModifiers.filter((function(m){return m.enabled})),state.orderedModifiers.forEach((function(_ref){var name2=_ref.name,_ref$options=_ref.options,options2=void 0===_ref$options?{}:_ref$options,effect2=_ref.effect;if("function"==typeof effect2){var cleanupFn=effect2({state:state,name:name2,instance:instance2,options:options2}),noopFn=function(){};effectCleanupFns.push(cleanupFn||noopFn)}})),instance2.update()},forceUpdate:function(){if(!isDestroyed){var _state$elements=state.elements,reference3=_state$elements.reference,popper3=_state$elements.popper;if(areValidElements(reference3,popper3)){state.rects={reference:getCompositeRect(reference3,getOffsetParent(popper3),"fixed"===state.options.strategy),popper:getLayoutRect(popper3)},state.reset=!1,state.placement=state.options.placement,state.orderedModifiers.forEach((function(modifier){return state.modifiersData[modifier.name]=Object.assign({},modifier.data)}));for(var index=0;index<state.orderedModifiers.length;index++)if(!0!==state.reset){var _state$orderedModifie=state.orderedModifiers[index],fn=_state$orderedModifie.fn,_state$orderedModifie2=_state$orderedModifie.options,_options=void 0===_state$orderedModifie2?{}:_state$orderedModifie2,name2=_state$orderedModifie.name;"function"==typeof fn&&(state=fn({state:state,options:_options,name:name2,instance:instance2})||state)}else state.reset=!1,index=-1}}},update:(fn=function(){return new Promise((function(resolve){instance2.forceUpdate(),resolve(state)}))},function(){return pending||(pending=new Promise((function(resolve){Promise.resolve().then((function(){pending=void 0,resolve(fn())}))}))),pending}),destroy:function(){cleanupModifierEffects(),isDestroyed=!0}};if(!areValidElements(reference2,popper2))return instance2;function cleanupModifierEffects(){effectCleanupFns.forEach((function(fn){return fn()})),effectCleanupFns=[]}return instance2.setOptions(options).then((function(state2){!isDestroyed&&options.onFirstUpdate&&options.onFirstUpdate(state2)})),instance2}}var createPopper=popperGenerator({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(_ref){var state=_ref.state,instance2=_ref.instance,options=_ref.options,_options$scroll=options.scroll,scroll=void 0===_options$scroll||_options$scroll,_options$resize=options.resize,resize=void 0===_options$resize||_options$resize,window2=getWindow(state.elements.popper),scrollParents=[].concat(state.scrollParents.reference,state.scrollParents.popper);return scroll&&scrollParents.forEach((function(scrollParent){scrollParent.addEventListener("scroll",instance2.update,passive)})),resize&&window2.addEventListener("resize",instance2.update,passive),function(){scroll&&scrollParents.forEach((function(scrollParent){scrollParent.removeEventListener("scroll",instance2.update,passive)})),resize&&window2.removeEventListener("resize",instance2.update,passive)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(_ref){var state=_ref.state,name2=_ref.name;state.modifiersData[name2]=computeOffsets({reference:state.rects.reference,element:state.rects.popper,strategy:"absolute",placement:state.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(_ref5){var state=_ref5.state,options=_ref5.options,_options$gpuAccelerat=options.gpuAcceleration,gpuAcceleration=void 0===_options$gpuAccelerat||_options$gpuAccelerat,_options$adaptive=options.adaptive,adaptive=void 0===_options$adaptive||_options$adaptive,_options$roundOffsets=options.roundOffsets,roundOffsets=void 0===_options$roundOffsets||_options$roundOffsets,commonStyles={placement:getBasePlacement(state.placement),variation:getVariation(state.placement),popper:state.elements.popper,popperRect:state.rects.popper,gpuAcceleration:gpuAcceleration,isFixed:"fixed"===state.options.strategy};null!=state.modifiersData.popperOffsets&&(state.styles.popper=Object.assign({},state.styles.popper,mapToStyles(Object.assign({},commonStyles,{offsets:state.modifiersData.popperOffsets,position:state.options.strategy,adaptive:adaptive,roundOffsets:roundOffsets})))),null!=state.modifiersData.arrow&&(state.styles.arrow=Object.assign({},state.styles.arrow,mapToStyles(Object.assign({},commonStyles,{offsets:state.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:roundOffsets})))),state.attributes.popper=Object.assign({},state.attributes.popper,{"data-popper-placement":state.placement})},data:{}},applyStyles$1,{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(_ref2){var state=_ref2.state,options=_ref2.options,name2=_ref2.name,_options$offset=options.offset,offset2=void 0===_options$offset?[0,0]:_options$offset,data2=placements.reduce((function(acc,placement){return acc[placement]=function(placement,rects,offset2){var basePlacement=getBasePlacement(placement),invertDistance=[left,top$1].indexOf(basePlacement)>=0?-1:1,_ref="function"==typeof offset2?offset2(Object.assign({},rects,{placement:placement})):offset2,skidding=_ref[0],distance=_ref[1];return skidding=skidding||0,distance=(distance||0)*invertDistance,[left,right].indexOf(basePlacement)>=0?{x:distance,y:skidding}:{x:skidding,y:distance}}(placement,state.rects,offset2),acc}),{}),_data$state$placement=data2[state.placement],x=_data$state$placement.x,y=_data$state$placement.y;null!=state.modifiersData.popperOffsets&&(state.modifiersData.popperOffsets.x+=x,state.modifiersData.popperOffsets.y+=y),state.modifiersData[name2]=data2}},{name:"flip",enabled:!0,phase:"main",fn:function(_ref){var state=_ref.state,options=_ref.options,name2=_ref.name;if(!state.modifiersData[name2]._skip){for(var _options$mainAxis=options.mainAxis,checkMainAxis=void 0===_options$mainAxis||_options$mainAxis,_options$altAxis=options.altAxis,checkAltAxis=void 0===_options$altAxis||_options$altAxis,specifiedFallbackPlacements=options.fallbackPlacements,padding=options.padding,boundary=options.boundary,rootBoundary=options.rootBoundary,altBoundary=options.altBoundary,_options$flipVariatio=options.flipVariations,flipVariations=void 0===_options$flipVariatio||_options$flipVariatio,allowedAutoPlacements=options.allowedAutoPlacements,preferredPlacement=state.options.placement,basePlacement=getBasePlacement(preferredPlacement),fallbackPlacements=specifiedFallbackPlacements||(basePlacement===preferredPlacement||!flipVariations?[getOppositePlacement(preferredPlacement)]:function(placement){if(getBasePlacement(placement)===auto)return[];var oppositePlacement=getOppositePlacement(placement);return[getOppositeVariationPlacement(placement),oppositePlacement,getOppositeVariationPlacement(oppositePlacement)]}(preferredPlacement)),placements2=[preferredPlacement].concat(fallbackPlacements).reduce((function(acc,placement2){return acc.concat(getBasePlacement(placement2)===auto?function(state,options){void 0===options&&(options={});var _options=options,placement=_options.placement,boundary=_options.boundary,rootBoundary=_options.rootBoundary,padding=_options.padding,flipVariations=_options.flipVariations,_options$allowedAutoP=_options.allowedAutoPlacements,allowedAutoPlacements=void 0===_options$allowedAutoP?placements:_options$allowedAutoP,variation=getVariation(placement),placements$1=variation?flipVariations?variationPlacements:variationPlacements.filter((function(placement2){return getVariation(placement2)===variation})):basePlacements,allowedPlacements=placements$1.filter((function(placement2){return allowedAutoPlacements.indexOf(placement2)>=0}));0===allowedPlacements.length&&(allowedPlacements=placements$1);var overflows=allowedPlacements.reduce((function(acc,placement2){return acc[placement2]=detectOverflow(state,{placement:placement2,boundary:boundary,rootBoundary:rootBoundary,padding:padding})[getBasePlacement(placement2)],acc}),{});return Object.keys(overflows).sort((function(a,b){return overflows[a]-overflows[b]}))}(state,{placement:placement2,boundary:boundary,rootBoundary:rootBoundary,padding:padding,flipVariations:flipVariations,allowedAutoPlacements:allowedAutoPlacements}):placement2)}),[]),referenceRect=state.rects.reference,popperRect=state.rects.popper,checksMap=new Map,makeFallbackChecks=!0,firstFittingPlacement=placements2[0],i2=0;i2<placements2.length;i2++){var placement=placements2[i2],_basePlacement=getBasePlacement(placement),isStartVariation=getVariation(placement)===start,isVertical=[top$1,bottom].indexOf(_basePlacement)>=0,len=isVertical?"width":"height",overflow=detectOverflow(state,{placement:placement,boundary:boundary,rootBoundary:rootBoundary,altBoundary:altBoundary,padding:padding}),mainVariationSide=isVertical?isStartVariation?right:left:isStartVariation?bottom:top$1;referenceRect[len]>popperRect[len]&&(mainVariationSide=getOppositePlacement(mainVariationSide));var altVariationSide=getOppositePlacement(mainVariationSide),checks=[];if(checkMainAxis&&checks.push(overflow[_basePlacement]<=0),checkAltAxis&&checks.push(overflow[mainVariationSide]<=0,overflow[altVariationSide]<=0),checks.every((function(check){return check}))){firstFittingPlacement=placement,makeFallbackChecks=!1;break}checksMap.set(placement,checks)}if(makeFallbackChecks)for(var _loop=function(_i2){var fittingPlacement=placements2.find((function(placement2){var checks2=checksMap.get(placement2);if(checks2)return checks2.slice(0,_i2).every((function(check){return check}))}));if(fittingPlacement)return firstFittingPlacement=fittingPlacement,"break"},_i=flipVariations?3:1;_i>0;_i--){if("break"===_loop(_i))break}state.placement!==firstFittingPlacement&&(state.modifiersData[name2]._skip=!0,state.placement=firstFittingPlacement,state.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(_ref){var state=_ref.state,options=_ref.options,name2=_ref.name,_options$mainAxis=options.mainAxis,checkMainAxis=void 0===_options$mainAxis||_options$mainAxis,_options$altAxis=options.altAxis,checkAltAxis=void 0!==_options$altAxis&&_options$altAxis,boundary=options.boundary,rootBoundary=options.rootBoundary,altBoundary=options.altBoundary,padding=options.padding,_options$tether=options.tether,tether=void 0===_options$tether||_options$tether,_options$tetherOffset=options.tetherOffset,tetherOffset=void 0===_options$tetherOffset?0:_options$tetherOffset,overflow=detectOverflow(state,{boundary:boundary,rootBoundary:rootBoundary,padding:padding,altBoundary:altBoundary}),basePlacement=getBasePlacement(state.placement),variation=getVariation(state.placement),isBasePlacement=!variation,mainAxis=getMainAxisFromPlacement(basePlacement),altAxis="x"===mainAxis?"y":"x",popperOffsets2=state.modifiersData.popperOffsets,referenceRect=state.rects.reference,popperRect=state.rects.popper,tetherOffsetValue="function"==typeof tetherOffset?tetherOffset(Object.assign({},state.rects,{placement:state.placement})):tetherOffset,normalizedTetherOffsetValue="number"==typeof tetherOffsetValue?{mainAxis:tetherOffsetValue,altAxis:tetherOffsetValue}:Object.assign({mainAxis:0,altAxis:0},tetherOffsetValue),offsetModifierState=state.modifiersData.offset?state.modifiersData.offset[state.placement]:null,data2={x:0,y:0};if(popperOffsets2){if(checkMainAxis){var _offsetModifierState$,mainSide="y"===mainAxis?top$1:left,altSide="y"===mainAxis?bottom:right,len="y"===mainAxis?"height":"width",offset2=popperOffsets2[mainAxis],min$1=offset2+overflow[mainSide],max$1=offset2-overflow[altSide],additive=tether?-popperRect[len]/2:0,minLen=variation===start?referenceRect[len]:popperRect[len],maxLen=variation===start?-popperRect[len]:-referenceRect[len],arrowElement=state.elements.arrow,arrowRect=tether&&arrowElement?getLayoutRect(arrowElement):{width:0,height:0},arrowPaddingObject=state.modifiersData["arrow#persistent"]?state.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},arrowPaddingMin=arrowPaddingObject[mainSide],arrowPaddingMax=arrowPaddingObject[altSide],arrowLen=within(0,referenceRect[len],arrowRect[len]),minOffset=isBasePlacement?referenceRect[len]/2-additive-arrowLen-arrowPaddingMin-normalizedTetherOffsetValue.mainAxis:minLen-arrowLen-arrowPaddingMin-normalizedTetherOffsetValue.mainAxis,maxOffset2=isBasePlacement?-referenceRect[len]/2+additive+arrowLen+arrowPaddingMax+normalizedTetherOffsetValue.mainAxis:maxLen+arrowLen+arrowPaddingMax+normalizedTetherOffsetValue.mainAxis,arrowOffsetParent=state.elements.arrow&&getOffsetParent(state.elements.arrow),clientOffset=arrowOffsetParent?"y"===mainAxis?arrowOffsetParent.clientTop||0:arrowOffsetParent.clientLeft||0:0,offsetModifierValue=null!=(_offsetModifierState$=null==offsetModifierState?void 0:offsetModifierState[mainAxis])?_offsetModifierState$:0,tetherMax=offset2+maxOffset2-offsetModifierValue,preventedOffset=within(tether?min(min$1,offset2+minOffset-offsetModifierValue-clientOffset):min$1,offset2,tether?max(max$1,tetherMax):max$1);popperOffsets2[mainAxis]=preventedOffset,data2[mainAxis]=preventedOffset-offset2}if(checkAltAxis){var _offsetModifierState$2,_mainSide="x"===mainAxis?top$1:left,_altSide="x"===mainAxis?bottom:right,_offset=popperOffsets2[altAxis],_len="y"===altAxis?"height":"width",_min=_offset+overflow[_mainSide],_max=_offset-overflow[_altSide],isOriginSide=-1!==[top$1,left].indexOf(basePlacement),_offsetModifierValue=null!=(_offsetModifierState$2=null==offsetModifierState?void 0:offsetModifierState[altAxis])?_offsetModifierState$2:0,_tetherMin=isOriginSide?_min:_offset-referenceRect[_len]-popperRect[_len]-_offsetModifierValue+normalizedTetherOffsetValue.altAxis,_tetherMax=isOriginSide?_offset+referenceRect[_len]+popperRect[_len]-_offsetModifierValue-normalizedTetherOffsetValue.altAxis:_max,_preventedOffset=tether&&isOriginSide?(v=within(_tetherMin,_offset,max2=_tetherMax))>max2?max2:v:within(tether?_tetherMin:_min,_offset,tether?_tetherMax:_max);popperOffsets2[altAxis]=_preventedOffset,data2[altAxis]=_preventedOffset-_offset}var max2,v;state.modifiersData[name2]=data2}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(_ref){var _state$modifiersData$,state=_ref.state,name2=_ref.name,options=_ref.options,arrowElement=state.elements.arrow,popperOffsets2=state.modifiersData.popperOffsets,basePlacement=getBasePlacement(state.placement),axis=getMainAxisFromPlacement(basePlacement),len=[left,right].indexOf(basePlacement)>=0?"height":"width";if(arrowElement&&popperOffsets2){var paddingObject=function(padding,state){return mergePaddingObject("number"!=typeof(padding="function"==typeof padding?padding(Object.assign({},state.rects,{placement:state.placement})):padding)?padding:expandToHashMap(padding,basePlacements))}(options.padding,state),arrowRect=getLayoutRect(arrowElement),minProp="y"===axis?top$1:left,maxProp="y"===axis?bottom:right,endDiff=state.rects.reference[len]+state.rects.reference[axis]-popperOffsets2[axis]-state.rects.popper[len],startDiff=popperOffsets2[axis]-state.rects.reference[axis],arrowOffsetParent=getOffsetParent(arrowElement),clientSize=arrowOffsetParent?"y"===axis?arrowOffsetParent.clientHeight||0:arrowOffsetParent.clientWidth||0:0,centerToReference=endDiff/2-startDiff/2,min2=paddingObject[minProp],max2=clientSize-arrowRect[len]-paddingObject[maxProp],center=clientSize/2-arrowRect[len]/2+centerToReference,offset2=within(min2,center,max2),axisProp=axis;state.modifiersData[name2]=((_state$modifiersData$={})[axisProp]=offset2,_state$modifiersData$.centerOffset=offset2-center,_state$modifiersData$)}},effect:function(_ref2){var state=_ref2.state,_options$element=_ref2.options.element,arrowElement=void 0===_options$element?"[data-popper-arrow]":_options$element;null!=arrowElement&&("string"!=typeof arrowElement||(arrowElement=state.elements.popper.querySelector(arrowElement)))&&contains$2(state.elements.popper,arrowElement)&&(state.elements.arrow=arrowElement)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(_ref){var state=_ref.state,name2=_ref.name,referenceRect=state.rects.reference,popperRect=state.rects.popper,preventedOffsets=state.modifiersData.preventOverflow,referenceOverflow=detectOverflow(state,{elementContext:"reference"}),popperAltOverflow=detectOverflow(state,{altBoundary:!0}),referenceClippingOffsets=getSideOffsets(referenceOverflow,referenceRect),popperEscapeOffsets=getSideOffsets(popperAltOverflow,popperRect,preventedOffsets),isReferenceHidden=isAnySideFullyClipped(referenceClippingOffsets),hasPopperEscaped=isAnySideFullyClipped(popperEscapeOffsets);state.modifiersData[name2]={referenceClippingOffsets:referenceClippingOffsets,popperEscapeOffsets:popperEscapeOffsets,isReferenceHidden:isReferenceHidden,hasPopperEscaped:hasPopperEscaped},state.attributes.popper=Object.assign({},state.attributes.popper,{"data-popper-reference-hidden":isReferenceHidden,"data-popper-escaped":hasPopperEscaped})}}]});function create_if_block_2$6(ctx){let div;return{c(){div=element("div")},m(target,anchor){insert$1(target,div,anchor),ctx[21](div)},p:noop,d(detaching){detaching&&detach(div),ctx[21](null)}}}function create_if_block$o(ctx){let frame,current;const frame_spread_levels=[{use:ctx[9]},{options:ctx[3]},{role:"tooltip"},{tabindex:ctx[1]?-1:void 0},ctx[11],{class:twMerge("outline-none",ctx[10].class)}];let frame_props={$$slots:{default:[create_default_slot$k]},$$scope:{ctx:ctx}};for(let i2=0;i2<frame_spread_levels.length;i2+=1)frame_props=assign(frame_props,frame_spread_levels[i2]);return frame=new Frame({props:frame_props}),frame.$on("focusin",(function(){is_function(optional(ctx[1],ctx[7]))&&optional(ctx[1],ctx[7]).apply(this,arguments)})),frame.$on("focusout",(function(){is_function(optional(ctx[1],ctx[8]))&&optional(ctx[1],ctx[8]).apply(this,arguments)})),frame.$on("mouseenter",(function(){is_function(optional(ctx[1]&&!ctx[4],ctx[7]))&&optional(ctx[1]&&!ctx[4],ctx[7]).apply(this,arguments)})),frame.$on("mouseleave",(function(){is_function(optional(ctx[1]&&!ctx[4],ctx[8]))&&optional(ctx[1]&&!ctx[4],ctx[8]).apply(this,arguments)})),{c(){create_component(frame.$$.fragment)},m(target,anchor){mount_component(frame,target,anchor),current=!0},p(new_ctx,dirty){ctx=new_ctx;const frame_changes=3594&dirty?get_spread_update(frame_spread_levels,[512&dirty&&{use:ctx[9]},8&dirty&&{options:ctx[3]},frame_spread_levels[2],2&dirty&&{tabindex:ctx[1]?-1:void 0},2048&dirty&&get_spread_object(ctx[11]),1024&dirty&&{class:twMerge("outline-none",ctx[10].class)}]):{};4194372&dirty&&(frame_changes.$$scope={dirty:dirty,ctx:ctx}),frame.$set(frame_changes)},i(local){current||(transition_in(frame.$$.fragment,local),current=!0)},o(local){transition_out(frame.$$.fragment,local),current=!1},d(detaching){destroy_component(frame,detaching)}}}function create_if_block_1$d(ctx){let div;return{c(){div=element("div"),attr(div,"class",ctx[6])},m(target,anchor){insert$1(target,div,anchor)},p(ctx2,dirty){64&dirty&&attr(div,"class",ctx2[6])},d(detaching){detaching&&detach(div)}}}function create_default_slot$k(ctx){let t2,if_block_anchor,current;const default_slot_template=ctx[20].default,default_slot=create_slot(default_slot_template,ctx,ctx[22],null);let if_block=ctx[2]&&create_if_block_1$d(ctx);return{c(){default_slot&&default_slot.c(),t2=space(),if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){default_slot&&default_slot.m(target,anchor),insert$1(target,t2,anchor),if_block&&if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||4194304&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[22],current?get_slot_changes(default_slot_template,ctx2[22],dirty,null):get_all_dirty_from_scope(ctx2[22]),null),ctx2[2]?if_block?if_block.p(ctx2,dirty):(if_block=create_if_block_1$d(ctx2),if_block.c(),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block&&(if_block.d(1),if_block=null)},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){detaching&&(detach(t2),detach(if_block_anchor)),default_slot&&default_slot.d(detaching),if_block&&if_block.d(detaching)}}}function create_fragment$y(ctx){let t2,if_block1_anchor,current,if_block0=!ctx[3]&&create_if_block_2$6(ctx),if_block1=ctx[0]&&ctx[3]&&create_if_block$o(ctx);return{c(){if_block0&&if_block0.c(),t2=space(),if_block1&&if_block1.c(),if_block1_anchor=empty$1()},m(target,anchor){if_block0&&if_block0.m(target,anchor),insert$1(target,t2,anchor),if_block1&&if_block1.m(target,anchor),insert$1(target,if_block1_anchor,anchor),current=!0},p(ctx2,[dirty]){ctx2[3]?if_block0&&(if_block0.d(1),if_block0=null):if_block0?if_block0.p(ctx2,dirty):(if_block0=create_if_block_2$6(ctx2),if_block0.c(),if_block0.m(t2.parentNode,t2)),ctx2[0]&&ctx2[3]?if_block1?(if_block1.p(ctx2,dirty),9&dirty&&transition_in(if_block1,1)):(if_block1=create_if_block$o(ctx2),if_block1.c(),transition_in(if_block1,1),if_block1.m(if_block1_anchor.parentNode,if_block1_anchor)):if_block1&&(group_outros(),transition_out(if_block1,1,1,(()=>{if_block1=null})),check_outros())},i(local){current||(transition_in(if_block1),current=!0)},o(local){transition_out(if_block1),current=!1},d(detaching){detaching&&(detach(t2),detach(if_block1_anchor)),if_block0&&if_block0.d(detaching),if_block1&&if_block1.d(detaching)}}}function optional(pred,func2){return pred?func2:()=>{}}function instance$y($$self,$$props,$$invalidate){const omit_props_names=["activeContent","arrow","offset","placement","trigger","triggeredBy","strategy","open","yOnly"];let $$restProps=compute_rest_props($$props,omit_props_names),{$$slots:slots={},$$scope:$$scope}=$$props,{activeContent:activeContent=!1}=$$props,{arrow:arrow2=!0}=$$props,{offset:offset2=8}=$$props,{placement:placement="top"}=$$props,{trigger:trigger="hover"}=$$props,{triggeredBy:triggeredBy}=$$props,{strategy:strategy="absolute"}=$$props,{open:open=!1}=$$props,{yOnly:yOnly=!1}=$$props;const dispatch2=function(){const component=get_current_component();return(type2,target,detail)=>{const callbacks=component.$$.callbacks[type2];if(callbacks){const event=new CustomEvent(type2,{detail:detail});target.dispatchEvent(event),callbacks.slice().forEach((fn=>{fn.call(component,event)}))}}}();let clickable,triggerEl,contentEl,popper2,triggerEls=[],_blocked=!1;const block=()=>(_blocked=!0,setTimeout((()=>_blocked=!1),250)),showHandler=ev=>{void 0===triggerEl&&console.error("trigger undefined"),triggerEls.includes(ev.target)&&triggerEl!==ev.target&&($$invalidate(3,triggerEl=ev.target),block()),clickable&&"focusin"===ev.type&&!open&&block(),$$invalidate(0,open=!(clickable&&"click"===ev.type&&!_blocked)||!open)},hasHover=el=>el.matches&&el.matches(":hover"),hasFocus=el=>el.contains&&el.contains(document.activeElement),hideHandler=ev=>{activeContent?setTimeout((()=>{const elements=Object.values((null==popper2?void 0:popper2.state.elements)??{});"mouseleave"===ev.type&&elements.some(hasHover)||"focusout"===ev.type&&elements.some(hasFocus)||$$invalidate(0,open=!1)}),100):$$invalidate(0,open=!1)};onMount((()=>{const events=[["focusin",showHandler,!0],["focusout",hideHandler,!0],["click",showHandler,clickable],["mouseenter",showHandler,!clickable],["mouseleave",hideHandler,!clickable]];return triggerEls=triggeredBy?[...document.querySelectorAll(triggeredBy)]:contentEl.previousElementSibling?[contentEl.previousElementSibling]:[],triggerEls.length||console.error("No triggers found."),triggerEls.forEach((element2=>{element2.tabIndex<0&&(element2.tabIndex=0);for(const[name2,handler,cond]of events)cond&&element2.addEventListener(name2,handler)})),$$invalidate(3,triggerEl=triggerEls[0]),()=>{triggerEls.forEach((element2=>{if(element2)for(const[name2,handler]of events)element2.removeEventListener(name2,handler)}))}}));let arrowClass,position="bottom";return $$self.$$set=$$new_props=>{$$invalidate(10,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),$$invalidate(11,$$restProps=compute_rest_props($$props,omit_props_names)),"activeContent"in $$new_props&&$$invalidate(1,activeContent=$$new_props.activeContent),"arrow"in $$new_props&&$$invalidate(2,arrow2=$$new_props.arrow),"offset"in $$new_props&&$$invalidate(12,offset2=$$new_props.offset),"placement"in $$new_props&&$$invalidate(13,placement=$$new_props.placement),"trigger"in $$new_props&&$$invalidate(14,trigger=$$new_props.trigger),"triggeredBy"in $$new_props&&$$invalidate(15,triggeredBy=$$new_props.triggeredBy),"strategy"in $$new_props&&$$invalidate(16,strategy=$$new_props.strategy),"open"in $$new_props&&$$invalidate(0,open=$$new_props.open),"yOnly"in $$new_props&&$$invalidate(17,yOnly=$$new_props.yOnly),"$$scope"in $$new_props&&$$invalidate(22,$$scope=$$new_props.$$scope)},$$self.$$.update=()=>{16384&$$self.$$.dirty&&$$invalidate(4,clickable="click"===trigger),9&$$self.$$.dirty&&dispatch2("show",triggerEl,open),270336&$$self.$$.dirty&&popper2&&popper2.setOptions({placement:placement}),8192&$$self.$$.dirty&&$$invalidate(19,position=placement.split("-",1)[0]),$$invalidate(6,arrowClass=twMerge("after:w-[9px] after:h-[9px] after:rotate-45 bg-inherit after:bg-inherit invisible after:visible after:block border-inherit after:border-inherit","top"===position&&($$props.border?"after:border-b after:border-r -bottom-[5px]":"-bottom-[4px]"),"bottom"===position&&($$props.border?"after:border-t after:border-l -top-[5px]":"-top-[4px]"),"left"===position&&($$props.border?"after:border-t after:border-r -right-[5px]":"-right-[4px]"),"right"===position&&($$props.border?"after:border-b after:border-l -left-[5px]":"-left-[4px]")))},$$props=exclude_internal_props($$props),[open,activeContent,arrow2,triggerEl,clickable,contentEl,arrowClass,showHandler,hideHandler,function(node,_triggerEl){const arrowEl=arrow2?node.lastElementChild:void 0;return $$invalidate(18,popper2=createPopper(_triggerEl,node,{placement:placement,strategy:strategy,modifiers:[{name:"offset",options:{offset:({reference:reference2,popper:popper3})=>[yOnly?popper3.width/2-reference2.width/2-reference2.x:0,offset2]}},{name:"eventListeners",enabled:open},{name:"flip",enabled:!1},{name:"arrow",enabled:arrow2,options:{element:arrowEl,padding:10}}]})),{update(_triggerEl2){$$invalidate(18,popper2.state.elements.reference=_triggerEl2,popper2),popper2.update()},destroy(){popper2.destroy()}}},$$props,$$restProps,offset2,placement,trigger,triggeredBy,strategy,yOnly,popper2,position,slots,function($$value){binding_callbacks[$$value?"unshift":"push"]((()=>{contentEl=$$value,$$invalidate(5,contentEl)}))},$$scope]}class Popper extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$y,create_fragment$y,safe_not_equal,{activeContent:1,arrow:2,offset:12,placement:13,trigger:14,triggeredBy:15,strategy:16,open:0,yOnly:17})}}function create_else_block$7(ctx){let current;const default_slot_template=ctx[7].default,default_slot=create_slot(default_slot_template,ctx,ctx[6],null);return{c(){default_slot&&default_slot.c()},m(target,anchor){default_slot&&default_slot.m(target,anchor),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||64&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[6],current?get_slot_changes(default_slot_template,ctx2[6],dirty,null):get_all_dirty_from_scope(ctx2[6]),null)},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){default_slot&&default_slot.d(detaching)}}}function create_if_block$n(ctx){let label,current;const default_slot_template=ctx[7].default,default_slot=create_slot(default_slot_template,ctx,ctx[6],null);let label_levels=[ctx[3],{class:ctx[2]}],label_data={};for(let i2=0;i2<label_levels.length;i2+=1)label_data=assign(label_data,label_levels[i2]);return{c(){label=element("label"),default_slot&&default_slot.c(),set_attributes(label,label_data)},m(target,anchor){insert$1(target,label,anchor),default_slot&&default_slot.m(label,null),ctx[8](label),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||64&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[6],current?get_slot_changes(default_slot_template,ctx2[6],dirty,null):get_all_dirty_from_scope(ctx2[6]),null),set_attributes(label,label_data=get_spread_update(label_levels,[8&dirty&&ctx2[3],(!current||4&dirty)&&{class:ctx2[2]}]))},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){detaching&&detach(label),default_slot&&default_slot.d(detaching),ctx[8](null)}}}function create_fragment$x(ctx){let current_block_type_index,if_block,if_block_anchor,current;const if_block_creators=[create_if_block$n,create_else_block$7],if_blocks=[];function select_block_type(ctx2,dirty){return ctx2[0]?0:1}return current_block_type_index=select_block_type(ctx),if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx),{c(){if_block.c(),if_block_anchor=empty$1()},m(target,anchor){if_blocks[current_block_type_index].m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,[dirty]){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx2),current_block_type_index===previous_block_index?if_blocks[current_block_type_index].p(ctx2,dirty):(group_outros(),transition_out(if_blocks[previous_block_index],1,1,(()=>{if_blocks[previous_block_index]=null})),check_outros(),if_block=if_blocks[current_block_type_index],if_block?if_block.p(ctx2,dirty):(if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx2),if_block.c()),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor))},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(if_block_anchor),if_blocks[current_block_type_index].d(detaching)}}}function instance$x($$self,$$props,$$invalidate){let labelClass2;const omit_props_names=["color","defaultClass","show"];let node,$$restProps=compute_rest_props($$props,omit_props_names),{$$slots:slots={},$$scope:$$scope}=$$props,{color:color2="gray"}=$$props,{defaultClass:defaultClass2="text-sm font-medium block"}=$$props,{show:show=!0}=$$props;const colorClasses2={gray:"text-gray-900 dark:text-gray-300",green:"text-green-700 dark:text-green-500",red:"text-red-700 dark:text-red-500",disabled:"text-gray-400 dark:text-gray-500"};return $$self.$$set=$$new_props=>{$$invalidate(10,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),$$invalidate(3,$$restProps=compute_rest_props($$props,omit_props_names)),"color"in $$new_props&&$$invalidate(4,color2=$$new_props.color),"defaultClass"in $$new_props&&$$invalidate(5,defaultClass2=$$new_props.defaultClass),"show"in $$new_props&&$$invalidate(0,show=$$new_props.show),"$$scope"in $$new_props&&$$invalidate(6,$$scope=$$new_props.$$scope)},$$self.$$.update=()=>{if(18&$$self.$$.dirty){const control=null==node?void 0:node.control;$$invalidate(4,color2=(null==control?void 0:control.disabled)?"disabled":color2)}$$invalidate(2,labelClass2=twMerge(defaultClass2,colorClasses2[color2],$$props.class))},$$props=exclude_internal_props($$props),[show,node,labelClass2,$$restProps,color2,defaultClass2,$$scope,slots,function($$value){binding_callbacks[$$value?"unshift":"push"]((()=>{node=$$value,$$invalidate(1,node)}))}]}class Label extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$x,create_fragment$x,safe_not_equal,{color:4,defaultClass:5,show:0})}}function create_default_slot$j(ctx){let input,input_class_value,current,binding_group,mounted,dispose,input_levels=[{type:"radio"},{__value:ctx[4]},ctx[8],{class:input_class_value=inputClass$3(ctx[2],ctx[1],!1,ctx[5],ctx[7].default||ctx[6].class)}],input_data={};for(let i2=0;i2<input_levels.length;i2+=1)input_data=assign(input_data,input_levels[i2]);const default_slot_template=ctx[9].default,default_slot=create_slot(default_slot_template,ctx,ctx[23],null);return binding_group=function(group){let _inputs;return{p(...inputs){_inputs=inputs,_inputs.forEach((input=>group.push(input)))},r(){_inputs.forEach((input=>group.splice(group.indexOf(input),1)))}}}(ctx[22][0]),{c(){input=element("input"),default_slot&&default_slot.c(),set_attributes(input,input_data),binding_group.p(input)},m(target,anchor){insert$1(target,input,anchor),input.autofocus&&input.focus(),input.checked=input.__value===ctx[0],default_slot&&default_slot.m(target,anchor),current=!0,mounted||(dispose=[listen(input,"change",ctx[21]),listen(input,"blur",ctx[10]),listen(input,"change",ctx[11]),listen(input,"click",ctx[12]),listen(input,"focus",ctx[13]),listen(input,"keydown",ctx[14]),listen(input,"keypress",ctx[15]),listen(input,"keyup",ctx[16]),listen(input,"mouseenter",ctx[17]),listen(input,"mouseleave",ctx[18]),listen(input,"mouseover",ctx[19]),listen(input,"paste",ctx[20])],mounted=!0)},p(ctx2,dirty){set_attributes(input,input_data=get_spread_update(input_levels,[{type:"radio"},(!current||16&dirty)&&{__value:ctx2[4]},256&dirty&&ctx2[8],(!current||198&dirty&&input_class_value!==(input_class_value=inputClass$3(ctx2[2],ctx2[1],!1,ctx2[5],ctx2[7].default||ctx2[6].class)))&&{class:input_class_value}])),1&dirty&&(input.checked=input.__value===ctx2[0]),default_slot&&default_slot.p&&(!current||8388608&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[23],current?get_slot_changes(default_slot_template,ctx2[23],dirty,null):get_all_dirty_from_scope(ctx2[23]),null)},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){detaching&&detach(input),default_slot&&default_slot.d(detaching),binding_group.r(),mounted=!1,run_all(dispose)}}}function create_fragment$w(ctx){let label,current;return label=new Label({props:{class:labelClass(ctx[3],ctx[6].class),show:ctx[7].default,$$slots:{default:[create_default_slot$j]},$$scope:{ctx:ctx}}}),{c(){create_component(label.$$.fragment)},m(target,anchor){mount_component(label,target,anchor),current=!0},p(ctx2,[dirty]){const label_changes={};72&dirty&&(label_changes.class=labelClass(ctx2[3],ctx2[6].class)),128&dirty&&(label_changes.show=ctx2[7].default),8389079&dirty&&(label_changes.$$scope={dirty:dirty,ctx:ctx2}),label.$set(label_changes)},i(local){current||(transition_in(label.$$.fragment,local),current=!0)},o(local){transition_out(label.$$.fragment,local),current=!1},d(detaching){destroy_component(label,detaching)}}}const colorClasses={primary:"text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600",secondary:"text-secondary-600 focus:ring-secondary-500 dark:focus:ring-secondary-600",red:"text-red-600 focus:ring-red-500 dark:focus:ring-red-600",green:"text-green-600 focus:ring-green-500 dark:focus:ring-green-600",purple:"text-purple-600 focus:ring-purple-500 dark:focus:ring-purple-600",teal:"text-teal-600 focus:ring-teal-500 dark:focus:ring-teal-600",yellow:"text-yellow-400 focus:ring-yellow-500 dark:focus:ring-yellow-600",orange:"text-orange-500 focus:ring-orange-500 dark:focus:ring-orange-600",blue:"text-blue-600 focus:ring-blue-500 dark:focus:ring-blue-600"},labelClass=(inline,extraClass)=>twMerge(inline?"inline-flex":"flex","items-center",extraClass);const inputClass$3=(custom2,color2,rounded,tinted,extraClass)=>twMerge("w-4 h-4 bg-gray-100 border-gray-300 dark:ring-offset-gray-800 focus:ring-2","mr-2",tinted?"dark:bg-gray-600 dark:border-gray-500":"dark:bg-gray-700 dark:border-gray-600",custom2&&"sr-only peer",rounded&&"rounded",colorClasses[color2],extraClass);function instance$w($$self,$$props,$$invalidate){const omit_props_names=["color","custom","inline","group","value"];let $$restProps=compute_rest_props($$props,omit_props_names),{$$slots:slots={},$$scope:$$scope}=$$props;const $$slots=compute_slots(slots);let{color:color2="primary"}=$$props,{custom:custom2=!1}=$$props,{inline:inline=!1}=$$props,{group:group=""}=$$props,{value:value=""}=$$props,background2=getContext("background");return $$self.$$set=$$new_props=>{$$invalidate(6,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),$$invalidate(8,$$restProps=compute_rest_props($$props,omit_props_names)),"color"in $$new_props&&$$invalidate(1,color2=$$new_props.color),"custom"in $$new_props&&$$invalidate(2,custom2=$$new_props.custom),"inline"in $$new_props&&$$invalidate(3,inline=$$new_props.inline),"group"in $$new_props&&$$invalidate(0,group=$$new_props.group),"value"in $$new_props&&$$invalidate(4,value=$$new_props.value),"$$scope"in $$new_props&&$$invalidate(23,$$scope=$$new_props.$$scope)},$$props=exclude_internal_props($$props),[group,color2,custom2,inline,value,background2,$$props,$$slots,$$restProps,slots,function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(){group=this.__value,$$invalidate(0,group)},[[]],$$scope]}class Radio extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$w,create_fragment$w,safe_not_equal,{color:1,custom:2,inline:3,group:0,value:4})}}function create_default_slot$i(ctx){let input,input_class_value,init_action,current,mounted,dispose,input_levels=[{type:"checkbox"},{__value:ctx[5]},ctx[12],{class:input_class_value=twMerge(ctx[6],inputClass$3(ctx[3],ctx[2],!0,ctx[7],ctx[11].default||ctx[10].class))}],input_data={};for(let i2=0;i2<input_levels.length;i2+=1)input_data=assign(input_data,input_levels[i2]);const default_slot_template=ctx[13].default,default_slot=create_slot(default_slot_template,ctx,ctx[26],null);return{c(){input=element("input"),default_slot&&default_slot.c(),set_attributes(input,input_data)},m(target,anchor){insert$1(target,input,anchor),input.autofocus&&input.focus(),input.checked=ctx[1],default_slot&&default_slot.m(target,anchor),current=!0,mounted||(dispose=[action_destroyer(init_action=ctx[8].call(null,input,ctx[0])),listen(input,"change",ctx[25]),listen(input,"keyup",ctx[14]),listen(input,"keydown",ctx[15]),listen(input,"keypress",ctx[16]),listen(input,"focus",ctx[17]),listen(input,"blur",ctx[18]),listen(input,"click",ctx[19]),listen(input,"mouseover",ctx[20]),listen(input,"mouseenter",ctx[21]),listen(input,"mouseleave",ctx[22]),listen(input,"paste",ctx[23]),listen(input,"change",ctx[9]),listen(input,"change",ctx[24])],mounted=!0)},p(ctx2,dirty){set_attributes(input,input_data=get_spread_update(input_levels,[{type:"checkbox"},(!current||32&dirty)&&{__value:ctx2[5]},4096&dirty&&ctx2[12],(!current||3148&dirty&&input_class_value!==(input_class_value=twMerge(ctx2[6],inputClass$3(ctx2[3],ctx2[2],!0,ctx2[7],ctx2[11].default||ctx2[10].class))))&&{class:input_class_value}])),init_action&&is_function(init_action.update)&&1&dirty&&init_action.update.call(null,ctx2[0]),2&dirty&&(input.checked=ctx2[1]),default_slot&&default_slot.p&&(!current||67108864&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[26],current?get_slot_changes(default_slot_template,ctx2[26],dirty,null):get_all_dirty_from_scope(ctx2[26]),null)},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){detaching&&detach(input),default_slot&&default_slot.d(detaching),mounted=!1,run_all(dispose)}}}function create_fragment$v(ctx){let label,current;return label=new Label({props:{class:labelClass(ctx[4],ctx[10].class),show:ctx[11].default,$$slots:{default:[create_default_slot$i]},$$scope:{ctx:ctx}}}),{c(){create_component(label.$$.fragment)},m(target,anchor){mount_component(label,target,anchor),current=!0},p(ctx2,[dirty]){const label_changes={};1040&dirty&&(label_changes.class=labelClass(ctx2[4],ctx2[10].class)),2048&dirty&&(label_changes.show=ctx2[11].default),67116143&dirty&&(label_changes.$$scope={dirty:dirty,ctx:ctx2}),label.$set(label_changes)},i(local){current||(transition_in(label.$$.fragment,local),current=!0)},o(local){transition_out(label.$$.fragment,local),current=!1},d(detaching){destroy_component(label,detaching)}}}function instance$v($$self,$$props,$$invalidate){const omit_props_names=["color","custom","inline","group","value","checked","spacing"];let $$restProps=compute_rest_props($$props,omit_props_names),{$$slots:slots={},$$scope:$$scope}=$$props;const $$slots=compute_slots(slots);let{color:color2="primary"}=$$props,{custom:custom2=!1}=$$props,{inline:inline=!1}=$$props,{group:group=[]}=$$props,{value:value="on"}=$$props,{checked:checked}=$$props,{spacing:spacing2="mr-2"}=$$props,background2=getContext("background");function onChange(){const index=group.indexOf(value);void 0===checked&&$$invalidate(1,checked=index>=0),checked?index<0&&(group.push(value),$$invalidate(0,group)):index>=0&&(group.splice(index,1),$$invalidate(0,group))}return $$self.$$set=$$new_props=>{$$invalidate(10,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),$$invalidate(12,$$restProps=compute_rest_props($$props,omit_props_names)),"color"in $$new_props&&$$invalidate(2,color2=$$new_props.color),"custom"in $$new_props&&$$invalidate(3,custom2=$$new_props.custom),"inline"in $$new_props&&$$invalidate(4,inline=$$new_props.inline),"group"in $$new_props&&$$invalidate(0,group=$$new_props.group),"value"in $$new_props&&$$invalidate(5,value=$$new_props.value),"checked"in $$new_props&&$$invalidate(1,checked=$$new_props.checked),"spacing"in $$new_props&&$$invalidate(6,spacing2=$$new_props.spacing),"$$scope"in $$new_props&&$$invalidate(26,$$scope=$$new_props.$$scope)},$$props=exclude_internal_props($$props),[group,checked,color2,custom2,inline,value,spacing2,background2,function(_,_group){return void 0===checked&&$$invalidate(1,checked=_group.includes(value)),onChange(),{update(_group2){$$invalidate(1,checked=_group2.includes(value))}}},onChange,$$props,$$slots,$$restProps,slots,function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(){checked=this.checked,$$invalidate(1,checked)},$$scope]}let Checkbox$1=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$v,create_fragment$v,safe_not_equal,{color:2,custom:3,inline:4,group:0,value:5,checked:1,spacing:6})}};function create_fragment$u(ctx){let input,mounted,dispose,input_levels=[{type:"range"},ctx[2],{class:ctx[1]}],input_data={};for(let i2=0;i2<input_levels.length;i2+=1)input_data=assign(input_data,input_levels[i2]);return{c(){input=element("input"),set_attributes(input,input_data)},m(target,anchor){insert$1(target,input,anchor),input.autofocus&&input.focus(),set_input_value(input,ctx[0]),mounted||(dispose=[listen(input,"change",ctx[9]),listen(input,"input",ctx[9]),listen(input,"change",ctx[4]),listen(input,"click",ctx[5]),listen(input,"keydown",ctx[6]),listen(input,"keypress",ctx[7]),listen(input,"keyup",ctx[8])],mounted=!0)},p(ctx2,[dirty]){set_attributes(input,input_data=get_spread_update(input_levels,[{type:"range"},4&dirty&&ctx2[2],2&dirty&&{class:ctx2[1]}])),1&dirty&&set_input_value(input,ctx2[0])},i:noop,o:noop,d(detaching){detaching&&detach(input),mounted=!1,run_all(dispose)}}}function instance$u($$self,$$props,$$invalidate){const omit_props_names=["value","size"];let $$restProps=compute_rest_props($$props,omit_props_names),{value:value}=$$props,{size:size="md"}=$$props;const sizes={sm:"h-1 range-sm",md:"h-2",lg:"h-3 range-lg"};let inputClass2;return $$self.$$set=$$new_props=>{$$invalidate(11,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),$$invalidate(2,$$restProps=compute_rest_props($$props,omit_props_names)),"value"in $$new_props&&$$invalidate(0,value=$$new_props.value),"size"in $$new_props&&$$invalidate(3,size=$$new_props.size)},$$self.$$.update=()=>{$$invalidate(1,inputClass2=twMerge("w-full bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700",sizes[size]??sizes.md,$$props.class))},$$props=exclude_internal_props($$props),[value,inputClass2,$$restProps,size,function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},function(){value=to_number(this.value),$$invalidate(0,value)}]}let Range$2=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$u,create_fragment$u,safe_not_equal,{value:0,size:3})}};function create_default_slot$h(ctx){let span,t2,current;const default_slot_template=ctx[8].default,default_slot=create_slot(default_slot_template,ctx,ctx[13],null);return{c(){span=element("span"),t2=space(),default_slot&&default_slot.c(),attr(span,"class",ctx[3])},m(target,anchor){insert$1(target,span,anchor),insert$1(target,t2,anchor),default_slot&&default_slot.m(target,anchor),current=!0},p(ctx2,dirty){(!current||8&dirty)&&attr(span,"class",ctx2[3]),default_slot&&default_slot.p&&(!current||8192&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[13],current?get_slot_changes(default_slot_template,ctx2[13],dirty,null):get_all_dirty_from_scope(ctx2[13]),null)},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){detaching&&(detach(span),detach(t2)),default_slot&&default_slot.d(detaching)}}}function create_fragment$t(ctx){let checkbox,updating_checked,updating_group,current;const checkbox_spread_levels=[{custom:!0},ctx[4],{class:ctx[5].class},{value:ctx[2]}];function checkbox_checked_binding(value){ctx[9](value)}function checkbox_group_binding(value){ctx[10](value)}let checkbox_props={$$slots:{default:[create_default_slot$h]},$$scope:{ctx:ctx}};for(let i2=0;i2<checkbox_spread_levels.length;i2+=1)checkbox_props=assign(checkbox_props,checkbox_spread_levels[i2]);return void 0!==ctx[1]&&(checkbox_props.checked=ctx[1]),void 0!==ctx[0]&&(checkbox_props.group=ctx[0]),checkbox=new Checkbox$1({props:checkbox_props}),binding_callbacks.push((()=>bind(checkbox,"checked",checkbox_checked_binding))),binding_callbacks.push((()=>bind(checkbox,"group",checkbox_group_binding))),checkbox.$on("click",ctx[11]),checkbox.$on("change",ctx[12]),{c(){create_component(checkbox.$$.fragment)},m(target,anchor){mount_component(checkbox,target,anchor),current=!0},p(ctx2,[dirty]){const checkbox_changes=52&dirty?get_spread_update(checkbox_spread_levels,[checkbox_spread_levels[0],16&dirty&&get_spread_object(ctx2[4]),32&dirty&&{class:ctx2[5].class},4&dirty&&{value:ctx2[2]}]):{};8200&dirty&&(checkbox_changes.$$scope={dirty:dirty,ctx:ctx2}),!updating_checked&&2&dirty&&(updating_checked=!0,checkbox_changes.checked=ctx2[1],add_flush_callback((()=>updating_checked=!1))),!updating_group&&1&dirty&&(updating_group=!0,checkbox_changes.group=ctx2[0],add_flush_callback((()=>updating_group=!1))),checkbox.$set(checkbox_changes)},i(local){current||(transition_in(checkbox.$$.fragment,local),current=!0)},o(local){transition_out(checkbox.$$.fragment,local),current=!1},d(detaching){destroy_component(checkbox,detaching)}}}function instance$t($$self,$$props,$$invalidate){const omit_props_names=["size","group","value","checked","customSize"];let $$restProps=compute_rest_props($$props,omit_props_names),{$$slots:slots={},$$scope:$$scope}=$$props,{size:size="default"}=$$props,{group:group=[]}=$$props,{value:value=""}=$$props,{checked:checked}=$$props,{customSize:customSize=""}=$$props,background2=getContext("background");const colors={primary:"peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 peer-checked:bg-primary-600",secondary:"peer-focus:ring-secondary-300 dark:peer-focus:ring-secondary-800 peer-checked:bg-secondary-600",red:"peer-focus:ring-red-300 dark:peer-focus:ring-red-800 peer-checked:bg-red-600",green:"peer-focus:ring-green-300 dark:peer-focus:ring-green-800 peer-checked:bg-green-600",purple:"peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 peer-checked:bg-purple-600",yellow:"peer-focus:ring-yellow-300 dark:peer-focus:ring-yellow-800 peer-checked:bg-yellow-400",teal:"peer-focus:ring-teal-300 dark:peer-focus:ring-teal-800 peer-checked:bg-teal-600",orange:"peer-focus:ring-orange-300 dark:peer-focus:ring-orange-800 peer-checked:bg-orange-500",blue:"peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 peer-checked:bg-blue-600"},sizes={small:"w-9 h-5 after:top-[2px] after:left-[2px] after:h-4 after:w-4",default:"w-11 h-6 after:top-0.5 after:left-[2px] after:h-5 after:w-5",large:"w-14 h-7 after:top-0.5 after:left-[4px]  after:h-6 after:w-6",custom:customSize};let divClass2;return $$self.$$set=$$new_props=>{$$invalidate(5,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),$$invalidate(4,$$restProps=compute_rest_props($$props,omit_props_names)),"size"in $$new_props&&$$invalidate(6,size=$$new_props.size),"group"in $$new_props&&$$invalidate(0,group=$$new_props.group),"value"in $$new_props&&$$invalidate(2,value=$$new_props.value),"checked"in $$new_props&&$$invalidate(1,checked=$$new_props.checked),"customSize"in $$new_props&&$$invalidate(7,customSize=$$new_props.customSize),"$$scope"in $$new_props&&$$invalidate(13,$$scope=$$new_props.$$scope)},$$self.$$.update=()=>{$$invalidate(3,divClass2=twMerge("mr-3 shrink-0 bg-gray-200 rounded-full peer-focus:ring-4 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:bg-white after:border-gray-300 after:border after:rounded-full after:transition-all",background2?"dark:bg-gray-600 dark:border-gray-500":"dark:bg-gray-700 dark:border-gray-600",colors[$$restProps.color??"primary"],sizes[size],"relative"))},$$props=exclude_internal_props($$props),[group,checked,value,divClass2,$$restProps,$$props,size,customSize,slots,function(value2){checked=value2,$$invalidate(1,checked)},function(value2){group=value2,$$invalidate(0,group)},function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},$$scope]}class Toggle extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$t,create_fragment$t,safe_not_equal,{size:6,group:0,value:2,checked:1,customSize:7})}}const get_title_slot_changes=dirty=>({}),get_title_slot_context=ctx=>({});function create_if_block$m(ctx){let div,current;const title_slot_template=ctx[5].title,title_slot=create_slot(title_slot_template,ctx,ctx[7],get_title_slot_context),title_slot_or_fallback=title_slot||function(ctx){let h3,t2;return{c(){h3=element("h3"),t2=text(ctx[0]),attr(h3,"class","font-semibold text-gray-900 dark:text-white")},m(target,anchor){insert$1(target,h3,anchor),append(h3,t2)},p(ctx2,dirty){1&dirty&&set_data(t2,ctx2[0])},d(detaching){detaching&&detach(h3)}}}(ctx);return{c(){div=element("div"),title_slot_or_fallback&&title_slot_or_fallback.c(),attr(div,"class","py-2 px-3 bg-gray-100 rounded-t-md border-b border-gray-200 dark:border-gray-600 dark:bg-gray-700")},m(target,anchor){insert$1(target,div,anchor),title_slot_or_fallback&&title_slot_or_fallback.m(div,null),current=!0},p(ctx2,dirty){title_slot?title_slot.p&&(!current||128&dirty)&&update_slot_base(title_slot,title_slot_template,ctx2,ctx2[7],current?get_slot_changes(title_slot_template,ctx2[7],dirty,get_title_slot_changes):get_all_dirty_from_scope(ctx2[7]),get_title_slot_context):title_slot_or_fallback&&title_slot_or_fallback.p&&(!current||1&dirty)&&title_slot_or_fallback.p(ctx2,current?dirty:-1)},i(local){current||(transition_in(title_slot_or_fallback,local),current=!0)},o(local){transition_out(title_slot_or_fallback,local),current=!1},d(detaching){detaching&&detach(div),title_slot_or_fallback&&title_slot_or_fallback.d(detaching)}}}function create_default_slot$g(ctx){let t2,div,current,if_block=(ctx[4].title||ctx[0])&&create_if_block$m(ctx);const default_slot_template=ctx[5].default,default_slot=create_slot(default_slot_template,ctx,ctx[7],null);return{c(){if_block&&if_block.c(),t2=space(),div=element("div"),default_slot&&default_slot.c(),attr(div,"class",ctx[1])},m(target,anchor){if_block&&if_block.m(target,anchor),insert$1(target,t2,anchor),insert$1(target,div,anchor),default_slot&&default_slot.m(div,null),current=!0},p(ctx2,dirty){ctx2[4].title||ctx2[0]?if_block?(if_block.p(ctx2,dirty),17&dirty&&transition_in(if_block,1)):(if_block=create_if_block$m(ctx2),if_block.c(),transition_in(if_block,1),if_block.m(t2.parentNode,t2)):if_block&&(group_outros(),transition_out(if_block,1,1,(()=>{if_block=null})),check_outros()),default_slot&&default_slot.p&&(!current||128&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[7],current?get_slot_changes(default_slot_template,ctx2[7],dirty,null):get_all_dirty_from_scope(ctx2[7]),null),(!current||2&dirty)&&attr(div,"class",ctx2[1])},i(local){current||(transition_in(if_block),transition_in(default_slot,local),current=!0)},o(local){transition_out(if_block),transition_out(default_slot,local),current=!1},d(detaching){detaching&&(detach(t2),detach(div)),if_block&&if_block.d(detaching),default_slot&&default_slot.d(detaching)}}}function create_fragment$s(ctx){let popper2,current;const popper_spread_levels=[{activeContent:!0},{border:!0},{shadow:!0},{rounded:!0},ctx[2],{class:"dark:!border-gray-600 "+ctx[3].class}];let popper_props={$$slots:{default:[create_default_slot$g]},$$scope:{ctx:ctx}};for(let i2=0;i2<popper_spread_levels.length;i2+=1)popper_props=assign(popper_props,popper_spread_levels[i2]);return popper2=new Popper({props:popper_props}),popper2.$on("show",ctx[6]),{c(){create_component(popper2.$$.fragment)},m(target,anchor){mount_component(popper2,target,anchor),current=!0},p(ctx2,[dirty]){const popper_changes=12&dirty?get_spread_update(popper_spread_levels,[popper_spread_levels[0],popper_spread_levels[1],popper_spread_levels[2],popper_spread_levels[3],4&dirty&&get_spread_object(ctx2[2]),8&dirty&&{class:"dark:!border-gray-600 "+ctx2[3].class}]):{};147&dirty&&(popper_changes.$$scope={dirty:dirty,ctx:ctx2}),popper2.$set(popper_changes)},i(local){current||(transition_in(popper2.$$.fragment,local),current=!0)},o(local){transition_out(popper2.$$.fragment,local),current=!1},d(detaching){destroy_component(popper2,detaching)}}}function instance$s($$self,$$props,$$invalidate){const omit_props_names=["title","defaultClass"];let $$restProps=compute_rest_props($$props,omit_props_names),{$$slots:slots={},$$scope:$$scope}=$$props;const $$slots=compute_slots(slots);let{title:title=""}=$$props,{defaultClass:defaultClass2="py-2 px-3"}=$$props;return $$self.$$set=$$new_props=>{$$invalidate(3,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),$$invalidate(2,$$restProps=compute_rest_props($$props,omit_props_names)),"title"in $$new_props&&$$invalidate(0,title=$$new_props.title),"defaultClass"in $$new_props&&$$invalidate(1,defaultClass2=$$new_props.defaultClass),"$$scope"in $$new_props&&$$invalidate(7,$$scope=$$new_props.$$scope)},$$props=exclude_internal_props($$props),[title,defaultClass2,$$restProps,$$props,$$slots,slots,function(event){bubble.call(this,$$self,event)},$$scope]}class Popover extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$s,create_fragment$s,safe_not_equal,{title:0,defaultClass:1})}}function create_default_slot$f(ctx){let current;const default_slot_template=ctx[4].default,default_slot=create_slot(default_slot_template,ctx,ctx[6],null);return{c(){default_slot&&default_slot.c()},m(target,anchor){default_slot&&default_slot.m(target,anchor),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||64&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[6],current?get_slot_changes(default_slot_template,ctx2[6],dirty,null):get_all_dirty_from_scope(ctx2[6]),null)},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){default_slot&&default_slot.d(detaching)}}}function create_fragment$r(ctx){let popper2,current;const popper_spread_levels=[{rounded:!0},{shadow:!0},ctx[1],{class:ctx[0]}];let popper_props={$$slots:{default:[create_default_slot$f]},$$scope:{ctx:ctx}};for(let i2=0;i2<popper_spread_levels.length;i2+=1)popper_props=assign(popper_props,popper_spread_levels[i2]);return popper2=new Popper({props:popper_props}),popper2.$on("show",ctx[5]),{c(){create_component(popper2.$$.fragment)},m(target,anchor){mount_component(popper2,target,anchor),current=!0},p(ctx2,[dirty]){const popper_changes=3&dirty?get_spread_update(popper_spread_levels,[popper_spread_levels[0],popper_spread_levels[1],2&dirty&&get_spread_object(ctx2[1]),1&dirty&&{class:ctx2[0]}]):{};64&dirty&&(popper_changes.$$scope={dirty:dirty,ctx:ctx2}),popper2.$set(popper_changes)},i(local){current||(transition_in(popper2.$$.fragment,local),current=!0)},o(local){transition_out(popper2.$$.fragment,local),current=!1},d(detaching){destroy_component(popper2,detaching)}}}function instance$r($$self,$$props,$$invalidate){const omit_props_names=["type","defaultClass"];let $$restProps=compute_rest_props($$props,omit_props_names),{$$slots:slots={},$$scope:$$scope}=$$props,{type:type2="dark"}=$$props,{defaultClass:defaultClass2="py-2 px-3 text-sm font-medium"}=$$props;const types2={dark:"bg-gray-900 text-white dark:bg-gray-700",light:"border border-gray-200 bg-white text-gray-900",auto:" bg-white text-gray-900 dark:bg-gray-700 dark:text-white border border-gray-200 dark:border-0",custom:""};let toolTipClass;return $$self.$$set=$$new_props=>{$$invalidate(8,$$props=assign(assign({},$$props),exclude_internal_props($$new_props))),$$invalidate(1,$$restProps=compute_rest_props($$props,omit_props_names)),"type"in $$new_props&&$$invalidate(2,type2=$$new_props.type),"defaultClass"in $$new_props&&$$invalidate(3,defaultClass2=$$new_props.defaultClass),"$$scope"in $$new_props&&$$invalidate(6,$$scope=$$new_props.$$scope)},$$self.$$.update=()=>{$$restProps.color?$$invalidate(2,type2="custom"):$$invalidate(1,$$restProps.color="none",$$restProps),$$invalidate(0,toolTipClass=twMerge("tooltip",defaultClass2,types2[type2],$$props.class))},$$props=exclude_internal_props($$props),[toolTipClass,$$restProps,type2,defaultClass2,slots,function(event){bubble.call(this,$$self,event)},$$scope]}class Tooltip extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$r,create_fragment$r,safe_not_equal,{type:2,defaultClass:3})}}const parseNumber=parseFloat;function joinCss(obj,separator=";"){let texts;if(Array.isArray(obj))texts=obj.filter((text2=>text2));else{texts=[];for(const prop in obj)obj[prop]&&texts.push(`${prop}:${obj[prop]}`)}return texts.join(separator)}function create_if_block$l(ctx){let svg2,g1,g0,g1_transform_value,g1_transform_origin_value,svg_id_value,svg_class_value,svg_viewBox_value;function select_block_type(ctx2,dirty){return"string"==typeof ctx2[10][4]?create_if_block_1$c:create_else_block$6}let current_block_type=select_block_type(ctx),if_block=current_block_type(ctx);return{c(){svg2=svg_element("svg"),g1=svg_element("g"),g0=svg_element("g"),if_block.c(),attr(g0,"transform",ctx[12]),attr(g1,"transform",g1_transform_value="translate("+ctx[10][0]/2+" "+ctx[10][1]/2+")"),attr(g1,"transform-origin",g1_transform_origin_value=ctx[10][0]/4+" 0"),attr(svg2,"id",svg_id_value=ctx[1]||void 0),attr(svg2,"class",svg_class_value="svelte-fa "+ctx[0]+" svelte-1cj2gr0"),attr(svg2,"style",ctx[11]),attr(svg2,"viewBox",svg_viewBox_value="0 0 "+ctx[10][0]+" "+ctx[10][1]),attr(svg2,"aria-hidden","true"),attr(svg2,"role","img"),attr(svg2,"xmlns","http://www.w3.org/2000/svg"),toggle_class(svg2,"pulse",ctx[4]),toggle_class(svg2,"spin",ctx[3])},m(target,anchor){insert$1(target,svg2,anchor),append(svg2,g1),append(g1,g0),if_block.m(g0,null)},p(ctx2,dirty){current_block_type===(current_block_type=select_block_type(ctx2))&&if_block?if_block.p(ctx2,dirty):(if_block.d(1),if_block=current_block_type(ctx2),if_block&&(if_block.c(),if_block.m(g0,null))),4096&dirty&&attr(g0,"transform",ctx2[12]),1024&dirty&&g1_transform_value!==(g1_transform_value="translate("+ctx2[10][0]/2+" "+ctx2[10][1]/2+")")&&attr(g1,"transform",g1_transform_value),1024&dirty&&g1_transform_origin_value!==(g1_transform_origin_value=ctx2[10][0]/4+" 0")&&attr(g1,"transform-origin",g1_transform_origin_value),2&dirty&&svg_id_value!==(svg_id_value=ctx2[1]||void 0)&&attr(svg2,"id",svg_id_value),1&dirty&&svg_class_value!==(svg_class_value="svelte-fa "+ctx2[0]+" svelte-1cj2gr0")&&attr(svg2,"class",svg_class_value),2048&dirty&&attr(svg2,"style",ctx2[11]),1024&dirty&&svg_viewBox_value!==(svg_viewBox_value="0 0 "+ctx2[10][0]+" "+ctx2[10][1])&&attr(svg2,"viewBox",svg_viewBox_value),17&dirty&&toggle_class(svg2,"pulse",ctx2[4]),9&dirty&&toggle_class(svg2,"spin",ctx2[3])},d(detaching){detaching&&detach(svg2),if_block.d()}}}function create_else_block$6(ctx){let path0,path0_d_value,path0_fill_value,path0_fill_opacity_value,path0_transform_value,path1,path1_d_value,path1_fill_value,path1_fill_opacity_value,path1_transform_value;return{c(){path0=svg_element("path"),path1=svg_element("path"),attr(path0,"d",path0_d_value=ctx[10][4][0]),attr(path0,"fill",path0_fill_value=ctx[6]||ctx[2]||"currentColor"),attr(path0,"fill-opacity",path0_fill_opacity_value=0!=ctx[9]?ctx[7]:ctx[8]),attr(path0,"transform",path0_transform_value="translate("+ctx[10][0]/-2+" "+ctx[10][1]/-2+")"),attr(path1,"d",path1_d_value=ctx[10][4][1]),attr(path1,"fill",path1_fill_value=ctx[5]||ctx[2]||"currentColor"),attr(path1,"fill-opacity",path1_fill_opacity_value=0!=ctx[9]?ctx[8]:ctx[7]),attr(path1,"transform",path1_transform_value="translate("+ctx[10][0]/-2+" "+ctx[10][1]/-2+")")},m(target,anchor){insert$1(target,path0,anchor),insert$1(target,path1,anchor)},p(ctx2,dirty){1024&dirty&&path0_d_value!==(path0_d_value=ctx2[10][4][0])&&attr(path0,"d",path0_d_value),68&dirty&&path0_fill_value!==(path0_fill_value=ctx2[6]||ctx2[2]||"currentColor")&&attr(path0,"fill",path0_fill_value),896&dirty&&path0_fill_opacity_value!==(path0_fill_opacity_value=0!=ctx2[9]?ctx2[7]:ctx2[8])&&attr(path0,"fill-opacity",path0_fill_opacity_value),1024&dirty&&path0_transform_value!==(path0_transform_value="translate("+ctx2[10][0]/-2+" "+ctx2[10][1]/-2+")")&&attr(path0,"transform",path0_transform_value),1024&dirty&&path1_d_value!==(path1_d_value=ctx2[10][4][1])&&attr(path1,"d",path1_d_value),36&dirty&&path1_fill_value!==(path1_fill_value=ctx2[5]||ctx2[2]||"currentColor")&&attr(path1,"fill",path1_fill_value),896&dirty&&path1_fill_opacity_value!==(path1_fill_opacity_value=0!=ctx2[9]?ctx2[8]:ctx2[7])&&attr(path1,"fill-opacity",path1_fill_opacity_value),1024&dirty&&path1_transform_value!==(path1_transform_value="translate("+ctx2[10][0]/-2+" "+ctx2[10][1]/-2+")")&&attr(path1,"transform",path1_transform_value)},d(detaching){detaching&&(detach(path0),detach(path1))}}}function create_if_block_1$c(ctx){let path2,path_d_value,path_fill_value,path_transform_value;return{c(){path2=svg_element("path"),attr(path2,"d",path_d_value=ctx[10][4]),attr(path2,"fill",path_fill_value=ctx[2]||ctx[5]||"currentColor"),attr(path2,"transform",path_transform_value="translate("+ctx[10][0]/-2+" "+ctx[10][1]/-2+")")},m(target,anchor){insert$1(target,path2,anchor)},p(ctx2,dirty){1024&dirty&&path_d_value!==(path_d_value=ctx2[10][4])&&attr(path2,"d",path_d_value),36&dirty&&path_fill_value!==(path_fill_value=ctx2[2]||ctx2[5]||"currentColor")&&attr(path2,"fill",path_fill_value),1024&dirty&&path_transform_value!==(path_transform_value="translate("+ctx2[10][0]/-2+" "+ctx2[10][1]/-2+")")&&attr(path2,"transform",path_transform_value)},d(detaching){detaching&&detach(path2)}}}function create_fragment$q(ctx){let if_block_anchor,if_block=ctx[10][4]&&create_if_block$l(ctx);return{c(){if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){if_block&&if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor)},p(ctx2,[dirty]){ctx2[10][4]?if_block?if_block.p(ctx2,dirty):(if_block=create_if_block$l(ctx2),if_block.c(),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block&&(if_block.d(1),if_block=null)},i:noop,o:noop,d(detaching){detaching&&detach(if_block_anchor),if_block&&if_block.d(detaching)}}}function instance$q($$self,$$props,$$invalidate){let i2,s,transform,{class:clazz=""}=$$props,{id:id2=""}=$$props,{style:style=""}=$$props,{icon:icon}=$$props,{size:size=""}=$$props,{color:color2=""}=$$props,{fw:fw=!1}=$$props,{pull:pull=""}=$$props,{scale:scale=1}=$$props,{translateX:translateX=0}=$$props,{translateY:translateY=0}=$$props,{rotate:rotate=""}=$$props,{flip:flip2=!1}=$$props,{spin:spin=!1}=$$props,{pulse:pulse=!1}=$$props,{primaryColor:primaryColor=""}=$$props,{secondaryColor:secondaryColor=""}=$$props,{primaryOpacity:primaryOpacity=1}=$$props,{secondaryOpacity:secondaryOpacity=.4}=$$props,{swapOpacity:swapOpacity=!1}=$$props;return $$self.$$set=$$props2=>{"class"in $$props2&&$$invalidate(0,clazz=$$props2.class),"id"in $$props2&&$$invalidate(1,id2=$$props2.id),"style"in $$props2&&$$invalidate(13,style=$$props2.style),"icon"in $$props2&&$$invalidate(14,icon=$$props2.icon),"size"in $$props2&&$$invalidate(15,size=$$props2.size),"color"in $$props2&&$$invalidate(2,color2=$$props2.color),"fw"in $$props2&&$$invalidate(16,fw=$$props2.fw),"pull"in $$props2&&$$invalidate(17,pull=$$props2.pull),"scale"in $$props2&&$$invalidate(18,scale=$$props2.scale),"translateX"in $$props2&&$$invalidate(19,translateX=$$props2.translateX),"translateY"in $$props2&&$$invalidate(20,translateY=$$props2.translateY),"rotate"in $$props2&&$$invalidate(21,rotate=$$props2.rotate),"flip"in $$props2&&$$invalidate(22,flip2=$$props2.flip),"spin"in $$props2&&$$invalidate(3,spin=$$props2.spin),"pulse"in $$props2&&$$invalidate(4,pulse=$$props2.pulse),"primaryColor"in $$props2&&$$invalidate(5,primaryColor=$$props2.primaryColor),"secondaryColor"in $$props2&&$$invalidate(6,secondaryColor=$$props2.secondaryColor),"primaryOpacity"in $$props2&&$$invalidate(7,primaryOpacity=$$props2.primaryOpacity),"secondaryOpacity"in $$props2&&$$invalidate(8,secondaryOpacity=$$props2.secondaryOpacity),"swapOpacity"in $$props2&&$$invalidate(9,swapOpacity=$$props2.swapOpacity)},$$self.$$.update=()=>{16384&$$self.$$.dirty&&$$invalidate(10,i2=icon&&icon.icon||[0,0,"",[],""]),237568&$$self.$$.dirty&&$$invalidate(11,s=function(style,size,pull,fw){let float,width,lineHeight,fontSize,textAlign,verticalAlign="-.125em";return fw&&(textAlign="center",width="1.25em"),pull&&(float=pull),size&&("lg"==size?(fontSize="1.33333em",lineHeight=".75em",verticalAlign="-.225em"):fontSize="xs"==size?".75em":"sm"==size?".875em":size.replace("x","em")),joinCss([joinCss({float:float,width:width,height:"1em","line-height":lineHeight,"font-size":fontSize,"text-align":textAlign,"vertical-align":verticalAlign,"transform-origin":"center",overflow:"visible"}),style])}(style,size,pull,fw)),8126464&$$self.$$.dirty&&$$invalidate(12,transform=function(scale,translateX,translateY,rotate,flip2,translateTimes=1,translateUnit="",rotateUnit=""){let flipX=1,flipY=1;return flip2&&("horizontal"==flip2?flipX=-1:"vertical"==flip2?flipY=-1:flipX=flipY=-1),joinCss([`translate(${parseNumber(translateX)*translateTimes}${translateUnit},${parseNumber(translateY)*translateTimes}${translateUnit})`,`scale(${flipX*parseNumber(scale)},${flipY*parseNumber(scale)})`,rotate&&`rotate(${rotate}${rotateUnit})`]," ")}(scale,translateX,translateY,rotate,flip2,512))},[clazz,id2,color2,spin,pulse,primaryColor,secondaryColor,primaryOpacity,secondaryOpacity,swapOpacity,i2,s,transform,style,icon,size,fw,pull,scale,translateX,translateY,rotate,flip2]}class Fa extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$q,create_fragment$q,safe_not_equal,{class:0,id:1,style:13,icon:14,size:15,color:2,fw:16,pull:17,scale:18,translateX:19,translateY:20,rotate:21,flip:22,spin:3,pulse:4,primaryColor:5,secondaryColor:6,primaryOpacity:7,secondaryOpacity:8,swapOpacity:9})}}var faInfo={prefix:"fas",iconName:"info",icon:[192,512,[],"f129","M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32H96c17.7 0 32 14.3 32 32V448h32c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H64V256H32c-17.7 0-32-14.3-32-32z"]},faCircleExclamation={prefix:"fas",iconName:"circle-exclamation",icon:[512,512,["exclamation-circle"],"f06a","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24V264c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"]},faCircleCheck={prefix:"fas",iconName:"circle-check",icon:[512,512,[61533,"check-circle"],"f058","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"]},faCheckCircle=faCircleCheck,faCircleQuestion={prefix:"fas",iconName:"circle-question",icon:[512,512,[62108,"question-circle"],"f059","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM169.8 165.3c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24V250.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1H222.6c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"]},faTrash={prefix:"fas",iconName:"trash",icon:[448,512,[],"f1f8","M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"]},faCircleInfo={prefix:"fas",iconName:"circle-info",icon:[512,512,["info-circle"],"f05a","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"]},faCopy={prefix:"fas",iconName:"copy",icon:[448,512,[],"f0c5","M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"]},faAdd={prefix:"fas",iconName:"plus",icon:[448,512,[10133,61543,"add"],"2b","M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"]},faTriangleExclamation={prefix:"fas",iconName:"triangle-exclamation",icon:[512,512,[9888,"exclamation-triangle","warning"],"f071","M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"]};const colorList={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var chroma$1={exports:{}};!function(module,exports){module.exports=function(){for(var limit$2=function(x,min3,max3){return void 0===min3&&(min3=0),void 0===max3&&(max3=1),x<min3?min3:x>max3?max3:x},limit$1=limit$2,clip_rgb$3=function(rgb2){rgb2._clipped=!1,rgb2._unclipped=rgb2.slice(0);for(var i3=0;i3<=3;i3++)i3<3?((rgb2[i3]<0||rgb2[i3]>255)&&(rgb2._clipped=!0),rgb2[i3]=limit$1(rgb2[i3],0,255)):3===i3&&(rgb2[i3]=limit$1(rgb2[i3],0,1));return rgb2},classToType={},i$1=0,list$1=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];i$1<list$1.length;i$1+=1){var name2=list$1[i$1];classToType["[object "+name2+"]"]=name2.toLowerCase()}var type$p=function(obj){return classToType[Object.prototype.toString.call(obj)]||"object"},type$o=type$p,unpack$B=function(args,keyOrder){return void 0===keyOrder&&(keyOrder=null),args.length>=3?Array.prototype.slice.call(args):"object"==type$o(args[0])&&keyOrder?keyOrder.split("").filter((function(k){return void 0!==args[0][k]})).map((function(k){return args[0][k]})):args[0]},type$n=type$p,last$4=function(args){if(args.length<2)return null;var l=args.length-1;return"string"==type$n(args[l])?args[l].toLowerCase():null},PI$2=Math.PI,utils={clip_rgb:clip_rgb$3,limit:limit$2,type:type$p,unpack:unpack$B,last:last$4,PI:PI$2,TWOPI:2*PI$2,PITHIRD:PI$2/3,DEG2RAD:PI$2/180,RAD2DEG:180/PI$2},input$h={format:{},autodetect:[]},last$3=utils.last,clip_rgb$2=utils.clip_rgb,type$m=utils.type,_input=input$h,Color$D=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var me=this;if("object"===type$m(args[0])&&args[0].constructor&&args[0].constructor===this.constructor)return args[0];var mode=last$3(args),autodetect=!1;if(!mode){autodetect=!0,_input.sorted||(_input.autodetect=_input.autodetect.sort((function(a,b){return b.p-a.p})),_input.sorted=!0);for(var i3=0,list2=_input.autodetect;i3<list2.length;i3+=1){var chk=list2[i3];if(mode=chk.test.apply(chk,args))break}}if(!_input.format[mode])throw new Error("unknown format: "+args);var rgb2=_input.format[mode].apply(null,autodetect?args:args.slice(0,-1));me._rgb=clip_rgb$2(rgb2),3===me._rgb.length&&me._rgb.push(1)};Color$D.prototype.toString=function(){return"function"==type$m(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var Color_1=Color$D,chroma$k=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(chroma$k.Color,[null].concat(args)))};chroma$k.Color=Color_1,chroma$k.version="2.4.2";var chroma_1=chroma$k,unpack$A=utils.unpack,max$2=Math.max,rgb2cmyk$1=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var ref=unpack$A(args,"rgb"),r=ref[0],g=ref[1],b=ref[2],k=1-max$2(r/=255,max$2(g/=255,b/=255)),f=k<1?1/(1-k):0;return[(1-r-k)*f,(1-g-k)*f,(1-b-k)*f,k]},rgb2cmyk_1=rgb2cmyk$1,unpack$z=utils.unpack,cmyk2rgb=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var c=(args=unpack$z(args,"cmyk"))[0],m=args[1],y=args[2],k=args[3],alpha=args.length>4?args[4]:1;return 1===k?[0,0,0,alpha]:[c>=1?0:255*(1-c)*(1-k),m>=1?0:255*(1-m)*(1-k),y>=1?0:255*(1-y)*(1-k),alpha]},cmyk2rgb_1=cmyk2rgb,chroma$j=chroma_1,Color$C=Color_1,input$g=input$h,unpack$y=utils.unpack,type$l=utils.type,rgb2cmyk=rgb2cmyk_1;Color$C.prototype.cmyk=function(){return rgb2cmyk(this._rgb)},chroma$j.cmyk=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$C,[null].concat(args,["cmyk"])))},input$g.format.cmyk=cmyk2rgb_1,input$g.autodetect.push({p:2,test:function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];if(args=unpack$y(args,"cmyk"),"array"===type$l(args)&&4===args.length)return"cmyk"}});var unpack$x=utils.unpack,last$2=utils.last,rnd=function(a){return Math.round(100*a)/100},hsl2css$1=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var hsla=unpack$x(args,"hsla"),mode=last$2(args)||"lsa";return hsla[0]=rnd(hsla[0]||0),hsla[1]=rnd(100*hsla[1])+"%",hsla[2]=rnd(100*hsla[2])+"%","hsla"===mode||hsla.length>3&&hsla[3]<1?(hsla[3]=hsla.length>3?hsla[3]:1,mode="hsla"):hsla.length=3,mode+"("+hsla.join(",")+")"},hsl2css_1=hsl2css$1,unpack$w=utils.unpack,rgb2hsl$3=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var r=(args=unpack$w(args,"rgba"))[0],g=args[1],b=args[2];r/=255,g/=255,b/=255;var s,h,min3=Math.min(r,g,b),max3=Math.max(r,g,b),l=(max3+min3)/2;return max3===min3?(s=0,h=Number.NaN):s=l<.5?(max3-min3)/(max3+min3):(max3-min3)/(2-max3-min3),r==max3?h=(g-b)/(max3-min3):g==max3?h=2+(b-r)/(max3-min3):b==max3&&(h=4+(r-g)/(max3-min3)),(h*=60)<0&&(h+=360),args.length>3&&void 0!==args[3]?[h,s,l,args[3]]:[h,s,l]},rgb2hsl_1=rgb2hsl$3,unpack$v=utils.unpack,last$1=utils.last,hsl2css=hsl2css_1,rgb2hsl$2=rgb2hsl_1,round$6=Math.round,rgb2css$1=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var rgba=unpack$v(args,"rgba"),mode=last$1(args)||"rgb";return"hsl"==mode.substr(0,3)?hsl2css(rgb2hsl$2(rgba),mode):(rgba[0]=round$6(rgba[0]),rgba[1]=round$6(rgba[1]),rgba[2]=round$6(rgba[2]),("rgba"===mode||rgba.length>3&&rgba[3]<1)&&(rgba[3]=rgba.length>3?rgba[3]:1,mode="rgba"),mode+"("+rgba.slice(0,"rgb"===mode?3:4).join(",")+")")},rgb2css_1=rgb2css$1,unpack$u=utils.unpack,round$5=Math.round,hsl2rgb$1=function(){for(var assign2,args=[],len=arguments.length;len--;)args[len]=arguments[len];var r,g,b,h=(args=unpack$u(args,"hsl"))[0],s=args[1],l=args[2];if(0===s)r=g=b=255*l;else{var t3=[0,0,0],c=[0,0,0],t2=l<.5?l*(1+s):l+s-l*s,t1=2*l-t2,h_=h/360;t3[0]=h_+1/3,t3[1]=h_,t3[2]=h_-1/3;for(var i3=0;i3<3;i3++)t3[i3]<0&&(t3[i3]+=1),t3[i3]>1&&(t3[i3]-=1),6*t3[i3]<1?c[i3]=t1+6*(t2-t1)*t3[i3]:2*t3[i3]<1?c[i3]=t2:3*t3[i3]<2?c[i3]=t1+(t2-t1)*(2/3-t3[i3])*6:c[i3]=t1;r=(assign2=[round$5(255*c[0]),round$5(255*c[1]),round$5(255*c[2])])[0],g=assign2[1],b=assign2[2]}return args.length>3?[r,g,b,args[3]]:[r,g,b,1]},hsl2rgb_1=hsl2rgb$1,hsl2rgb=hsl2rgb_1,input$f=input$h,RE_RGB=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,RE_RGBA=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,RE_RGB_PCT=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,RE_RGBA_PCT=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,RE_HSL=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,RE_HSLA=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,round$4=Math.round,css2rgb$1=function(css){var m;if(css=css.toLowerCase().trim(),input$f.format.named)try{return input$f.format.named(css)}catch(e){}if(m=css.match(RE_RGB)){for(var rgb2=m.slice(1,4),i3=0;i3<3;i3++)rgb2[i3]=+rgb2[i3];return rgb2[3]=1,rgb2}if(m=css.match(RE_RGBA)){for(var rgb$1=m.slice(1,5),i$12=0;i$12<4;i$12++)rgb$1[i$12]=+rgb$1[i$12];return rgb$1}if(m=css.match(RE_RGB_PCT)){for(var rgb$2=m.slice(1,4),i$2=0;i$2<3;i$2++)rgb$2[i$2]=round$4(2.55*rgb$2[i$2]);return rgb$2[3]=1,rgb$2}if(m=css.match(RE_RGBA_PCT)){for(var rgb$3=m.slice(1,5),i$3=0;i$3<3;i$3++)rgb$3[i$3]=round$4(2.55*rgb$3[i$3]);return rgb$3[3]=+rgb$3[3],rgb$3}if(m=css.match(RE_HSL)){var hsl2=m.slice(1,4);hsl2[1]*=.01,hsl2[2]*=.01;var rgb$4=hsl2rgb(hsl2);return rgb$4[3]=1,rgb$4}if(m=css.match(RE_HSLA)){var hsl$1=m.slice(1,4);hsl$1[1]*=.01,hsl$1[2]*=.01;var rgb$5=hsl2rgb(hsl$1);return rgb$5[3]=+m[4],rgb$5}};css2rgb$1.test=function(s){return RE_RGB.test(s)||RE_RGBA.test(s)||RE_RGB_PCT.test(s)||RE_RGBA_PCT.test(s)||RE_HSL.test(s)||RE_HSLA.test(s)};var css2rgb_1=css2rgb$1,chroma$i=chroma_1,Color$B=Color_1,input$e=input$h,type$k=utils.type,rgb2css=rgb2css_1,css2rgb=css2rgb_1;Color$B.prototype.css=function(mode){return rgb2css(this._rgb,mode)},chroma$i.css=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$B,[null].concat(args,["css"])))},input$e.format.css=css2rgb,input$e.autodetect.push({p:5,test:function(h){for(var rest=[],len=arguments.length-1;len-- >0;)rest[len]=arguments[len+1];if(!rest.length&&"string"===type$k(h)&&css2rgb.test(h))return"css"}});var Color$A=Color_1,chroma$h=chroma_1,input$d=input$h,unpack$t=utils.unpack;input$d.format.gl=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var rgb2=unpack$t(args,"rgba");return rgb2[0]*=255,rgb2[1]*=255,rgb2[2]*=255,rgb2},chroma$h.gl=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$A,[null].concat(args,["gl"])))},Color$A.prototype.gl=function(){var rgb2=this._rgb;return[rgb2[0]/255,rgb2[1]/255,rgb2[2]/255,rgb2[3]]};var unpack$s=utils.unpack,rgb2hcg$1=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var h,ref=unpack$s(args,"rgb"),r=ref[0],g=ref[1],b=ref[2],min3=Math.min(r,g,b),max3=Math.max(r,g,b),delta=max3-min3,c=100*delta/255,_g=min3/(255-delta)*100;return 0===delta?h=Number.NaN:(r===max3&&(h=(g-b)/delta),g===max3&&(h=2+(b-r)/delta),b===max3&&(h=4+(r-g)/delta),(h*=60)<0&&(h+=360)),[h,c,_g]},rgb2hcg_1=rgb2hcg$1,unpack$r=utils.unpack,floor$3=Math.floor,hcg2rgb=function(){for(var assign2,assign$1,assign$2,assign$3,assign$4,assign$5,args=[],len=arguments.length;len--;)args[len]=arguments[len];var r,g,b,h=(args=unpack$r(args,"hcg"))[0],c=args[1],_g=args[2];_g*=255;var _c=255*c;if(0===c)r=g=b=_g;else{360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360);var i3=floor$3(h/=60),f=h-i3,p=_g*(1-c),q=p+_c*(1-f),t2=p+_c*f,v=p+_c;switch(i3){case 0:r=(assign2=[v,t2,p])[0],g=assign2[1],b=assign2[2];break;case 1:r=(assign$1=[q,v,p])[0],g=assign$1[1],b=assign$1[2];break;case 2:r=(assign$2=[p,v,t2])[0],g=assign$2[1],b=assign$2[2];break;case 3:r=(assign$3=[p,q,v])[0],g=assign$3[1],b=assign$3[2];break;case 4:r=(assign$4=[t2,p,v])[0],g=assign$4[1],b=assign$4[2];break;case 5:r=(assign$5=[v,p,q])[0],g=assign$5[1],b=assign$5[2]}}return[r,g,b,args.length>3?args[3]:1]},hcg2rgb_1=hcg2rgb,unpack$q=utils.unpack,type$j=utils.type,chroma$g=chroma_1,Color$z=Color_1,input$c=input$h,rgb2hcg=rgb2hcg_1;Color$z.prototype.hcg=function(){return rgb2hcg(this._rgb)},chroma$g.hcg=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$z,[null].concat(args,["hcg"])))},input$c.format.hcg=hcg2rgb_1,input$c.autodetect.push({p:1,test:function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];if(args=unpack$q(args,"hcg"),"array"===type$j(args)&&3===args.length)return"hcg"}});var unpack$p=utils.unpack,last=utils.last,round$3=Math.round,rgb2hex$2=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var ref=unpack$p(args,"rgba"),r=ref[0],g=ref[1],b=ref[2],a=ref[3],mode=last(args)||"auto";void 0===a&&(a=1),"auto"===mode&&(mode=a<1?"rgba":"rgb");var str="000000"+((r=round$3(r))<<16|(g=round$3(g))<<8|(b=round$3(b))).toString(16);str=str.substr(str.length-6);var hxa="0"+round$3(255*a).toString(16);switch(hxa=hxa.substr(hxa.length-2),mode.toLowerCase()){case"rgba":return"#"+str+hxa;case"argb":return"#"+hxa+str;default:return"#"+str}},rgb2hex_1=rgb2hex$2,RE_HEX=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,RE_HEXA=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,hex2rgb_1=function(hex){if(hex.match(RE_HEX)){4!==hex.length&&7!==hex.length||(hex=hex.substr(1)),3===hex.length&&(hex=(hex=hex.split(""))[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]);var u=parseInt(hex,16);return[u>>16,u>>8&255,255&u,1]}if(hex.match(RE_HEXA)){5!==hex.length&&9!==hex.length||(hex=hex.substr(1)),4===hex.length&&(hex=(hex=hex.split(""))[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]+hex[3]+hex[3]);var u$1=parseInt(hex,16);return[u$1>>24&255,u$1>>16&255,u$1>>8&255,Math.round((255&u$1)/255*100)/100]}throw new Error("unknown hex color: "+hex)},chroma$f=chroma_1,Color$y=Color_1,type$i=utils.type,input$b=input$h,rgb2hex$1=rgb2hex_1;Color$y.prototype.hex=function(mode){return rgb2hex$1(this._rgb,mode)},chroma$f.hex=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$y,[null].concat(args,["hex"])))},input$b.format.hex=hex2rgb_1,input$b.autodetect.push({p:4,test:function(h){for(var rest=[],len=arguments.length-1;len-- >0;)rest[len]=arguments[len+1];if(!rest.length&&"string"===type$i(h)&&[3,4,5,6,7,8,9].indexOf(h.length)>=0)return"hex"}});var unpack$o=utils.unpack,TWOPI$2=utils.TWOPI,min$2=Math.min,sqrt$4=Math.sqrt,acos=Math.acos,rgb2hsi$1=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var h,ref=unpack$o(args,"rgb"),r=ref[0],g=ref[1],b=ref[2],min_=min$2(r/=255,g/=255,b/=255),i3=(r+g+b)/3,s=i3>0?1-min_/i3:0;return 0===s?h=NaN:(h=(r-g+(r-b))/2,h/=sqrt$4((r-g)*(r-g)+(r-b)*(g-b)),h=acos(h),b>g&&(h=TWOPI$2-h),h/=TWOPI$2),[360*h,s,i3]},rgb2hsi_1=rgb2hsi$1,unpack$n=utils.unpack,limit=utils.limit,TWOPI$1=utils.TWOPI,PITHIRD=utils.PITHIRD,cos$4=Math.cos,hsi2rgb=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var r,g,b,h=(args=unpack$n(args,"hsi"))[0],s=args[1],i3=args[2];return isNaN(h)&&(h=0),isNaN(s)&&(s=0),h>360&&(h-=360),h<0&&(h+=360),(h/=360)<1/3?g=1-((b=(1-s)/3)+(r=(1+s*cos$4(TWOPI$1*h)/cos$4(PITHIRD-TWOPI$1*h))/3)):h<2/3?b=1-((r=(1-s)/3)+(g=(1+s*cos$4(TWOPI$1*(h-=1/3))/cos$4(PITHIRD-TWOPI$1*h))/3)):r=1-((g=(1-s)/3)+(b=(1+s*cos$4(TWOPI$1*(h-=2/3))/cos$4(PITHIRD-TWOPI$1*h))/3)),[255*(r=limit(i3*r*3)),255*(g=limit(i3*g*3)),255*(b=limit(i3*b*3)),args.length>3?args[3]:1]},hsi2rgb_1=hsi2rgb,unpack$m=utils.unpack,type$h=utils.type,chroma$e=chroma_1,Color$x=Color_1,input$a=input$h,rgb2hsi=rgb2hsi_1;Color$x.prototype.hsi=function(){return rgb2hsi(this._rgb)},chroma$e.hsi=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$x,[null].concat(args,["hsi"])))},input$a.format.hsi=hsi2rgb_1,input$a.autodetect.push({p:2,test:function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];if(args=unpack$m(args,"hsi"),"array"===type$h(args)&&3===args.length)return"hsi"}});var unpack$l=utils.unpack,type$g=utils.type,chroma$d=chroma_1,Color$w=Color_1,input$9=input$h,rgb2hsl$1=rgb2hsl_1;Color$w.prototype.hsl=function(){return rgb2hsl$1(this._rgb)},chroma$d.hsl=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$w,[null].concat(args,["hsl"])))},input$9.format.hsl=hsl2rgb_1,input$9.autodetect.push({p:2,test:function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];if(args=unpack$l(args,"hsl"),"array"===type$g(args)&&3===args.length)return"hsl"}});var unpack$k=utils.unpack,min$1=Math.min,max$1=Math.max,rgb2hsl=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var h,s,v,r=(args=unpack$k(args,"rgb"))[0],g=args[1],b=args[2],min_=min$1(r,g,b),max_=max$1(r,g,b),delta=max_-min_;return v=max_/255,0===max_?(h=Number.NaN,s=0):(s=delta/max_,r===max_&&(h=(g-b)/delta),g===max_&&(h=2+(b-r)/delta),b===max_&&(h=4+(r-g)/delta),(h*=60)<0&&(h+=360)),[h,s,v]},rgb2hsv$1=rgb2hsl,unpack$j=utils.unpack,floor$2=Math.floor,hsv2rgb=function(){for(var assign2,assign$1,assign$2,assign$3,assign$4,assign$5,args=[],len=arguments.length;len--;)args[len]=arguments[len];var r,g,b,h=(args=unpack$j(args,"hsv"))[0],s=args[1],v=args[2];if(v*=255,0===s)r=g=b=v;else{360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360);var i3=floor$2(h/=60),f=h-i3,p=v*(1-s),q=v*(1-s*f),t2=v*(1-s*(1-f));switch(i3){case 0:r=(assign2=[v,t2,p])[0],g=assign2[1],b=assign2[2];break;case 1:r=(assign$1=[q,v,p])[0],g=assign$1[1],b=assign$1[2];break;case 2:r=(assign$2=[p,v,t2])[0],g=assign$2[1],b=assign$2[2];break;case 3:r=(assign$3=[p,q,v])[0],g=assign$3[1],b=assign$3[2];break;case 4:r=(assign$4=[t2,p,v])[0],g=assign$4[1],b=assign$4[2];break;case 5:r=(assign$5=[v,p,q])[0],g=assign$5[1],b=assign$5[2]}}return[r,g,b,args.length>3?args[3]:1]},hsv2rgb_1=hsv2rgb,unpack$i=utils.unpack,type$f=utils.type,chroma$c=chroma_1,Color$v=Color_1,input$8=input$h,rgb2hsv=rgb2hsv$1;Color$v.prototype.hsv=function(){return rgb2hsv(this._rgb)},chroma$c.hsv=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$v,[null].concat(args,["hsv"])))},input$8.format.hsv=hsv2rgb_1,input$8.autodetect.push({p:2,test:function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];if(args=unpack$i(args,"hsv"),"array"===type$f(args)&&3===args.length)return"hsv"}});var labConstants={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},LAB_CONSTANTS$3=labConstants,unpack$h=utils.unpack,pow$a=Math.pow,rgb2lab$2=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var ref=unpack$h(args,"rgb"),r=ref[0],g=ref[1],b=ref[2],ref$1=rgb2xyz(r,g,b),x=ref$1[0],y=ref$1[1],l=116*y-16;return[l<0?0:l,500*(x-y),200*(y-ref$1[2])]},rgb_xyz=function(r){return(r/=255)<=.04045?r/12.92:pow$a((r+.055)/1.055,2.4)},xyz_lab=function(t2){return t2>LAB_CONSTANTS$3.t3?pow$a(t2,1/3):t2/LAB_CONSTANTS$3.t2+LAB_CONSTANTS$3.t0},rgb2xyz=function(r,g,b){return r=rgb_xyz(r),g=rgb_xyz(g),b=rgb_xyz(b),[xyz_lab((.4124564*r+.3575761*g+.1804375*b)/LAB_CONSTANTS$3.Xn),xyz_lab((.2126729*r+.7151522*g+.072175*b)/LAB_CONSTANTS$3.Yn),xyz_lab((.0193339*r+.119192*g+.9503041*b)/LAB_CONSTANTS$3.Zn)]},rgb2lab_1=rgb2lab$2,LAB_CONSTANTS$2=labConstants,unpack$g=utils.unpack,pow$9=Math.pow,lab2rgb$1=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var x,y,z,l=(args=unpack$g(args,"lab"))[0],a=args[1],b=args[2];return y=(l+16)/116,x=isNaN(a)?y:y+a/500,z=isNaN(b)?y:y-b/200,y=LAB_CONSTANTS$2.Yn*lab_xyz(y),x=LAB_CONSTANTS$2.Xn*lab_xyz(x),z=LAB_CONSTANTS$2.Zn*lab_xyz(z),[xyz_rgb(3.2404542*x-1.5371385*y-.4985314*z),xyz_rgb(-.969266*x+1.8760108*y+.041556*z),xyz_rgb(.0556434*x-.2040259*y+1.0572252*z),args.length>3?args[3]:1]},xyz_rgb=function(r){return 255*(r<=.00304?12.92*r:1.055*pow$9(r,1/2.4)-.055)},lab_xyz=function(t2){return t2>LAB_CONSTANTS$2.t1?t2*t2*t2:LAB_CONSTANTS$2.t2*(t2-LAB_CONSTANTS$2.t0)},lab2rgb_1=lab2rgb$1,unpack$f=utils.unpack,type$e=utils.type,chroma$b=chroma_1,Color$u=Color_1,input$7=input$h,rgb2lab$1=rgb2lab_1;Color$u.prototype.lab=function(){return rgb2lab$1(this._rgb)},chroma$b.lab=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$u,[null].concat(args,["lab"])))},input$7.format.lab=lab2rgb_1,input$7.autodetect.push({p:2,test:function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];if(args=unpack$f(args,"lab"),"array"===type$e(args)&&3===args.length)return"lab"}});var unpack$e=utils.unpack,RAD2DEG=utils.RAD2DEG,sqrt$3=Math.sqrt,atan2$2=Math.atan2,round$2=Math.round,lab2lch$2=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var ref=unpack$e(args,"lab"),l=ref[0],a=ref[1],b=ref[2],c=sqrt$3(a*a+b*b),h=(atan2$2(b,a)*RAD2DEG+360)%360;return 0===round$2(1e4*c)&&(h=Number.NaN),[l,c,h]},lab2lch_1=lab2lch$2,unpack$d=utils.unpack,rgb2lab=rgb2lab_1,lab2lch$1=lab2lch_1,rgb2lch$1=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var ref=unpack$d(args,"rgb"),r=ref[0],g=ref[1],b=ref[2],ref$1=rgb2lab(r,g,b),l=ref$1[0],a=ref$1[1],b_=ref$1[2];return lab2lch$1(l,a,b_)},rgb2lch_1=rgb2lch$1,unpack$c=utils.unpack,DEG2RAD=utils.DEG2RAD,sin$3=Math.sin,cos$3=Math.cos,lch2lab$2=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var ref=unpack$c(args,"lch"),l=ref[0],c=ref[1],h=ref[2];return isNaN(h)&&(h=0),[l,cos$3(h*=DEG2RAD)*c,sin$3(h)*c]},lch2lab_1=lch2lab$2,unpack$b=utils.unpack,lch2lab$1=lch2lab_1,lab2rgb=lab2rgb_1,lch2rgb$1=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var l=(args=unpack$b(args,"lch"))[0],c=args[1],h=args[2],ref=lch2lab$1(l,c,h),L=ref[0],a=ref[1],b_=ref[2],ref$1=lab2rgb(L,a,b_);return[ref$1[0],ref$1[1],ref$1[2],args.length>3?args[3]:1]},lch2rgb_1=lch2rgb$1,unpack$a=utils.unpack,lch2rgb=lch2rgb_1,hcl2rgb=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var hcl=unpack$a(args,"hcl").reverse();return lch2rgb.apply(void 0,hcl)},hcl2rgb_1=hcl2rgb,unpack$9=utils.unpack,type$d=utils.type,chroma$a=chroma_1,Color$t=Color_1,input$6=input$h,rgb2lch=rgb2lch_1;Color$t.prototype.lch=function(){return rgb2lch(this._rgb)},Color$t.prototype.hcl=function(){return rgb2lch(this._rgb).reverse()},chroma$a.lch=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$t,[null].concat(args,["lch"])))},chroma$a.hcl=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$t,[null].concat(args,["hcl"])))},input$6.format.lch=lch2rgb_1,input$6.format.hcl=hcl2rgb_1,["lch","hcl"].forEach((function(m){return input$6.autodetect.push({p:2,test:function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];if(args=unpack$9(args,m),"array"===type$d(args)&&3===args.length)return m}})}));var w3cx11_1={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Color$s=Color_1,input$5=input$h,type$c=utils.type,w3cx11=w3cx11_1,hex2rgb=hex2rgb_1,rgb2hex=rgb2hex_1;Color$s.prototype.name=function(){for(var hex=rgb2hex(this._rgb,"rgb"),i3=0,list2=Object.keys(w3cx11);i3<list2.length;i3+=1){var n=list2[i3];if(w3cx11[n]===hex)return n.toLowerCase()}return hex},input$5.format.named=function(name3){if(name3=name3.toLowerCase(),w3cx11[name3])return hex2rgb(w3cx11[name3]);throw new Error("unknown color name: "+name3)},input$5.autodetect.push({p:5,test:function(h){for(var rest=[],len=arguments.length-1;len-- >0;)rest[len]=arguments[len+1];if(!rest.length&&"string"===type$c(h)&&w3cx11[h.toLowerCase()])return"named"}});var unpack$8=utils.unpack,rgb2num$1=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var ref=unpack$8(args,"rgb");return(ref[0]<<16)+(ref[1]<<8)+ref[2]},rgb2num_1=rgb2num$1,type$b=utils.type,num2rgb_1=function(num2){if("number"==type$b(num2)&&num2>=0&&num2<=16777215)return[num2>>16,num2>>8&255,255&num2,1];throw new Error("unknown num color: "+num2)},chroma$9=chroma_1,Color$r=Color_1,input$4=input$h,type$a=utils.type,rgb2num=rgb2num_1;Color$r.prototype.num=function(){return rgb2num(this._rgb)},chroma$9.num=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$r,[null].concat(args,["num"])))},input$4.format.num=num2rgb_1,input$4.autodetect.push({p:5,test:function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];if(1===args.length&&"number"===type$a(args[0])&&args[0]>=0&&args[0]<=16777215)return"num"}});var chroma$8=chroma_1,Color$q=Color_1,input$3=input$h,unpack$7=utils.unpack,type$9=utils.type,round$1=Math.round;Color$q.prototype.rgb=function(rnd2){return void 0===rnd2&&(rnd2=!0),!1===rnd2?this._rgb.slice(0,3):this._rgb.slice(0,3).map(round$1)},Color$q.prototype.rgba=function(rnd2){return void 0===rnd2&&(rnd2=!0),this._rgb.slice(0,4).map((function(v,i3){return i3<3?!1===rnd2?v:round$1(v):v}))},chroma$8.rgb=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$q,[null].concat(args,["rgb"])))},input$3.format.rgb=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var rgba=unpack$7(args,"rgba");return void 0===rgba[3]&&(rgba[3]=1),rgba},input$3.autodetect.push({p:3,test:function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];if(args=unpack$7(args,"rgba"),"array"===type$9(args)&&(3===args.length||4===args.length&&"number"==type$9(args[3])&&args[3]>=0&&args[3]<=1))return"rgb"}});var log$1=Math.log,temperature2rgb_1=function(kelvin){var r,g,b,temp=kelvin/100;return temp<66?(r=255,g=temp<6?0:-155.25485562709179-.44596950469579133*(g=temp-2)+104.49216199393888*log$1(g),b=temp<20?0:.8274096064007395*(b=temp-10)-254.76935184120902+115.67994401066147*log$1(b)):(r=351.97690566805693+.114206453784165*(r=temp-55)-40.25366309332127*log$1(r),g=325.4494125711974+.07943456536662342*(g=temp-50)-28.0852963507957*log$1(g),b=255),[r,g,b,1]},temperature2rgb=temperature2rgb_1,unpack$6=utils.unpack,round2=Math.round,rgb2temperature$1=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];for(var temp,rgb2=unpack$6(args,"rgb"),r=rgb2[0],b=rgb2[2],minTemp=1e3,maxTemp=4e4,eps=.4;maxTemp-minTemp>eps;){var rgb$1=temperature2rgb(temp=.5*(maxTemp+minTemp));rgb$1[2]/rgb$1[0]>=b/r?maxTemp=temp:minTemp=temp}return round2(temp)},chroma$7=chroma_1,Color$p=Color_1,input$2=input$h,rgb2temperature=rgb2temperature$1;Color$p.prototype.temp=Color$p.prototype.kelvin=Color$p.prototype.temperature=function(){return rgb2temperature(this._rgb)},chroma$7.temp=chroma$7.kelvin=chroma$7.temperature=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$p,[null].concat(args,["temp"])))},input$2.format.temp=input$2.format.kelvin=input$2.format.temperature=temperature2rgb_1;var unpack$5=utils.unpack,cbrt=Math.cbrt,pow$8=Math.pow,sign$1=Math.sign,rgb2oklab$2=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var ref=unpack$5(args,"rgb"),r=ref[0],g=ref[1],b=ref[2],ref$1=[rgb2lrgb(r/255),rgb2lrgb(g/255),rgb2lrgb(b/255)],lr=ref$1[0],lg=ref$1[1],lb=ref$1[2],l=cbrt(.4122214708*lr+.5363325363*lg+.0514459929*lb),m=cbrt(.2119034982*lr+.6806995451*lg+.1073969566*lb),s=cbrt(.0883024619*lr+.2817188376*lg+.6299787005*lb);return[.2104542553*l+.793617785*m-.0040720468*s,1.9779984951*l-2.428592205*m+.4505937099*s,.0259040371*l+.7827717662*m-.808675766*s]},rgb2oklab_1=rgb2oklab$2;function rgb2lrgb(c){var abs2=Math.abs(c);return abs2<.04045?c/12.92:(sign$1(c)||1)*pow$8((abs2+.055)/1.055,2.4)}var unpack$4=utils.unpack,pow$7=Math.pow,sign=Math.sign,oklab2rgb$1=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var L=(args=unpack$4(args,"lab"))[0],a=args[1],b=args[2],l=pow$7(L+.3963377774*a+.2158037573*b,3),m=pow$7(L-.1055613458*a-.0638541728*b,3),s=pow$7(L-.0894841775*a-1.291485548*b,3);return[255*lrgb2rgb(4.0767416621*l-3.3077115913*m+.2309699292*s),255*lrgb2rgb(-1.2684380046*l+2.6097574011*m-.3413193965*s),255*lrgb2rgb(-.0041960863*l-.7034186147*m+1.707614701*s),args.length>3?args[3]:1]},oklab2rgb_1=oklab2rgb$1;function lrgb2rgb(c){var abs2=Math.abs(c);return abs2>.0031308?(sign(c)||1)*(1.055*pow$7(abs2,1/2.4)-.055):12.92*c}var unpack$3=utils.unpack,type$8=utils.type,chroma$6=chroma_1,Color$o=Color_1,input$1=input$h,rgb2oklab$1=rgb2oklab_1;Color$o.prototype.oklab=function(){return rgb2oklab$1(this._rgb)},chroma$6.oklab=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$o,[null].concat(args,["oklab"])))},input$1.format.oklab=oklab2rgb_1,input$1.autodetect.push({p:3,test:function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];if(args=unpack$3(args,"oklab"),"array"===type$8(args)&&3===args.length)return"oklab"}});var unpack$2=utils.unpack,rgb2oklab=rgb2oklab_1,lab2lch=lab2lch_1,rgb2oklch$1=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var ref=unpack$2(args,"rgb"),r=ref[0],g=ref[1],b=ref[2],ref$1=rgb2oklab(r,g,b),l=ref$1[0],a=ref$1[1],b_=ref$1[2];return lab2lch(l,a,b_)},rgb2oklch_1=rgb2oklch$1,unpack$1=utils.unpack,lch2lab=lch2lab_1,oklab2rgb=oklab2rgb_1,oklch2rgb=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var l=(args=unpack$1(args,"lch"))[0],c=args[1],h=args[2],ref=lch2lab(l,c,h),L=ref[0],a=ref[1],b_=ref[2],ref$1=oklab2rgb(L,a,b_);return[ref$1[0],ref$1[1],ref$1[2],args.length>3?args[3]:1]},oklch2rgb_1=oklch2rgb,unpack=utils.unpack,type$7=utils.type,chroma$5=chroma_1,Color$n=Color_1,input=input$h,rgb2oklch=rgb2oklch_1;Color$n.prototype.oklch=function(){return rgb2oklch(this._rgb)},chroma$5.oklch=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return new(Function.prototype.bind.apply(Color$n,[null].concat(args,["oklch"])))},input.format.oklch=oklch2rgb_1,input.autodetect.push({p:3,test:function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];if(args=unpack(args,"oklch"),"array"===type$7(args)&&3===args.length)return"oklch"}});var Color$m=Color_1,type$6=utils.type;Color$m.prototype.alpha=function(a,mutate){return void 0===mutate&&(mutate=!1),void 0!==a&&"number"===type$6(a)?mutate?(this._rgb[3]=a,this):new Color$m([this._rgb[0],this._rgb[1],this._rgb[2],a],"rgb"):this._rgb[3]},Color_1.prototype.clipped=function(){return this._rgb._clipped||!1};var Color$k=Color_1,LAB_CONSTANTS$1=labConstants;Color$k.prototype.darken=function(amount){void 0===amount&&(amount=1);var me=this,lab2=me.lab();return lab2[0]-=LAB_CONSTANTS$1.Kn*amount,new Color$k(lab2,"lab").alpha(me.alpha(),!0)},Color$k.prototype.brighten=function(amount){return void 0===amount&&(amount=1),this.darken(-amount)},Color$k.prototype.darker=Color$k.prototype.darken,Color$k.prototype.brighter=Color$k.prototype.brighten,Color_1.prototype.get=function(mc){var ref=mc.split("."),mode=ref[0],channel=ref[1],src=this[mode]();if(channel){var i3=mode.indexOf(channel)-("ok"===mode.substr(0,2)?2:0);if(i3>-1)return src[i3];throw new Error("unknown channel "+channel+" in mode "+mode)}return src};var Color$i=Color_1,type$5=utils.type,pow$6=Math.pow,EPS=1e-7,MAX_ITER=20;Color$i.prototype.luminance=function(lum){if(void 0!==lum&&"number"===type$5(lum)){if(0===lum)return new Color$i([0,0,0,this._rgb[3]],"rgb");if(1===lum)return new Color$i([255,255,255,this._rgb[3]],"rgb");var cur_lum=this.luminance(),mode="rgb",max_iter=MAX_ITER,test=function(low,high){var mid=low.interpolate(high,.5,mode),lm=mid.luminance();return Math.abs(lum-lm)<EPS||!max_iter--?mid:lm>lum?test(low,mid):test(mid,high)},rgb2=(cur_lum>lum?test(new Color$i([0,0,0]),this):test(this,new Color$i([255,255,255]))).rgb();return new Color$i(rgb2.concat([this._rgb[3]]))}return rgb2luminance.apply(void 0,this._rgb.slice(0,3))};var rgb2luminance=function(r,g,b){return.2126*(r=luminance_x(r))+.7152*(g=luminance_x(g))+.0722*(b=luminance_x(b))},luminance_x=function(x){return(x/=255)<=.03928?x/12.92:pow$6((x+.055)/1.055,2.4)},interpolator$1={},Color$h=Color_1,type$4=utils.type,interpolator=interpolator$1,mix$1=function(col1,col2,f){void 0===f&&(f=.5);for(var rest=[],len=arguments.length-3;len-- >0;)rest[len]=arguments[len+3];var mode=rest[0]||"lrgb";if(interpolator[mode]||rest.length||(mode=Object.keys(interpolator)[0]),!interpolator[mode])throw new Error("interpolation mode "+mode+" is not defined");return"object"!==type$4(col1)&&(col1=new Color$h(col1)),"object"!==type$4(col2)&&(col2=new Color$h(col2)),interpolator[mode](col1,col2,f).alpha(col1.alpha()+f*(col2.alpha()-col1.alpha()))},Color$g=Color_1,mix=mix$1;Color$g.prototype.mix=Color$g.prototype.interpolate=function(col2,f){void 0===f&&(f=.5);for(var rest=[],len=arguments.length-2;len-- >0;)rest[len]=arguments[len+2];return mix.apply(void 0,[this,col2,f].concat(rest))};var Color$f=Color_1;Color$f.prototype.premultiply=function(mutate){void 0===mutate&&(mutate=!1);var rgb2=this._rgb,a=rgb2[3];return mutate?(this._rgb=[rgb2[0]*a,rgb2[1]*a,rgb2[2]*a,a],this):new Color$f([rgb2[0]*a,rgb2[1]*a,rgb2[2]*a,a],"rgb")};var Color$e=Color_1,LAB_CONSTANTS=labConstants;Color$e.prototype.saturate=function(amount){void 0===amount&&(amount=1);var me=this,lch2=me.lch();return lch2[1]+=LAB_CONSTANTS.Kn*amount,lch2[1]<0&&(lch2[1]=0),new Color$e(lch2,"lch").alpha(me.alpha(),!0)},Color$e.prototype.desaturate=function(amount){return void 0===amount&&(amount=1),this.saturate(-amount)};var Color$d=Color_1,type$3=utils.type;Color$d.prototype.set=function(mc,value,mutate){void 0===mutate&&(mutate=!1);var ref=mc.split("."),mode=ref[0],channel=ref[1],src=this[mode]();if(channel){var i3=mode.indexOf(channel)-("ok"===mode.substr(0,2)?2:0);if(i3>-1){if("string"==type$3(value))switch(value.charAt(0)){case"+":case"-":src[i3]+=+value;break;case"*":src[i3]*=+value.substr(1);break;case"/":src[i3]/=+value.substr(1);break;default:src[i3]=+value}else{if("number"!==type$3(value))throw new Error("unsupported value for Color.set");src[i3]=value}var out=new Color$d(src,mode);return mutate?(this._rgb=out._rgb,this):out}throw new Error("unknown channel "+channel+" in mode "+mode)}return src};var Color$c=Color_1,rgb=function(col1,col2,f){var xyz0=col1._rgb,xyz1=col2._rgb;return new Color$c(xyz0[0]+f*(xyz1[0]-xyz0[0]),xyz0[1]+f*(xyz1[1]-xyz0[1]),xyz0[2]+f*(xyz1[2]-xyz0[2]),"rgb")};interpolator$1.rgb=rgb;var Color$b=Color_1,sqrt$2=Math.sqrt,pow$5=Math.pow,lrgb=function(col1,col2,f){var ref=col1._rgb,x1=ref[0],y1=ref[1],z1=ref[2],ref$1=col2._rgb,x2=ref$1[0],y2=ref$1[1],z2=ref$1[2];return new Color$b(sqrt$2(pow$5(x1,2)*(1-f)+pow$5(x2,2)*f),sqrt$2(pow$5(y1,2)*(1-f)+pow$5(y2,2)*f),sqrt$2(pow$5(z1,2)*(1-f)+pow$5(z2,2)*f),"rgb")};interpolator$1.lrgb=lrgb;var Color$a=Color_1,lab=function(col1,col2,f){var xyz0=col1.lab(),xyz1=col2.lab();return new Color$a(xyz0[0]+f*(xyz1[0]-xyz0[0]),xyz0[1]+f*(xyz1[1]-xyz0[1]),xyz0[2]+f*(xyz1[2]-xyz0[2]),"lab")};interpolator$1.lab=lab;var Color$9=Color_1,_hsx=function(col1,col2,f,m){var assign2,assign$1,xyz0,xyz1,hue0,hue1,sat0,sat1,lbv0,lbv1,sat,hue,lbv;return"hsl"===m?(xyz0=col1.hsl(),xyz1=col2.hsl()):"hsv"===m?(xyz0=col1.hsv(),xyz1=col2.hsv()):"hcg"===m?(xyz0=col1.hcg(),xyz1=col2.hcg()):"hsi"===m?(xyz0=col1.hsi(),xyz1=col2.hsi()):"lch"===m||"hcl"===m?(m="hcl",xyz0=col1.hcl(),xyz1=col2.hcl()):"oklch"===m&&(xyz0=col1.oklch().reverse(),xyz1=col2.oklch().reverse()),"h"!==m.substr(0,1)&&"oklch"!==m||(hue0=(assign2=xyz0)[0],sat0=assign2[1],lbv0=assign2[2],hue1=(assign$1=xyz1)[0],sat1=assign$1[1],lbv1=assign$1[2]),isNaN(hue0)||isNaN(hue1)?isNaN(hue0)?isNaN(hue1)?hue=Number.NaN:(hue=hue1,1!=lbv0&&0!=lbv0||"hsv"==m||(sat=sat1)):(hue=hue0,1!=lbv1&&0!=lbv1||"hsv"==m||(sat=sat0)):hue=hue0+f*(hue1>hue0&&hue1-hue0>180?hue1-(hue0+360):hue1<hue0&&hue0-hue1>180?hue1+360-hue0:hue1-hue0),void 0===sat&&(sat=sat0+f*(sat1-sat0)),lbv=lbv0+f*(lbv1-lbv0),new Color$9("oklch"===m?[lbv,sat,hue]:[hue,sat,lbv],m)},interpolate_hsx$5=_hsx,lch=function(col1,col2,f){return interpolate_hsx$5(col1,col2,f,"lch")};interpolator$1.lch=lch,interpolator$1.hcl=lch;var Color$8=Color_1,num=function(col1,col2,f){var c1=col1.num(),c2=col2.num();return new Color$8(c1+f*(c2-c1),"num")};interpolator$1.num=num;var interpolate_hsx$4=_hsx,hcg=function(col1,col2,f){return interpolate_hsx$4(col1,col2,f,"hcg")};interpolator$1.hcg=hcg;var interpolate_hsx$3=_hsx,hsi=function(col1,col2,f){return interpolate_hsx$3(col1,col2,f,"hsi")};interpolator$1.hsi=hsi;var interpolate_hsx$2=_hsx,hsl=function(col1,col2,f){return interpolate_hsx$2(col1,col2,f,"hsl")};interpolator$1.hsl=hsl;var interpolate_hsx$1=_hsx,hsv=function(col1,col2,f){return interpolate_hsx$1(col1,col2,f,"hsv")};interpolator$1.hsv=hsv;var Color$7=Color_1,oklab=function(col1,col2,f){var xyz0=col1.oklab(),xyz1=col2.oklab();return new Color$7(xyz0[0]+f*(xyz1[0]-xyz0[0]),xyz0[1]+f*(xyz1[1]-xyz0[1]),xyz0[2]+f*(xyz1[2]-xyz0[2]),"oklab")};interpolator$1.oklab=oklab;var interpolate_hsx=_hsx,oklch=function(col1,col2,f){return interpolate_hsx(col1,col2,f,"oklch")};interpolator$1.oklch=oklch;var Color$6=Color_1,clip_rgb$1=utils.clip_rgb,pow$4=Math.pow,sqrt$1=Math.sqrt,PI$1=Math.PI,cos$2=Math.cos,sin$2=Math.sin,atan2$1=Math.atan2,average=function(colors,mode,weights){void 0===mode&&(mode="lrgb"),void 0===weights&&(weights=null);var l=colors.length;weights||(weights=Array.from(new Array(l)).map((function(){return 1})));var k=l/weights.reduce((function(a,b){return a+b}));if(weights.forEach((function(w,i4){weights[i4]*=k})),colors=colors.map((function(c){return new Color$6(c)})),"lrgb"===mode)return _average_lrgb(colors,weights);for(var first=colors.shift(),xyz=first.get(mode),cnt=[],dx=0,dy=0,i3=0;i3<xyz.length;i3++)if(xyz[i3]=(xyz[i3]||0)*weights[0],cnt.push(isNaN(xyz[i3])?0:weights[0]),"h"===mode.charAt(i3)&&!isNaN(xyz[i3])){var A=xyz[i3]/180*PI$1;dx+=cos$2(A)*weights[0],dy+=sin$2(A)*weights[0]}var alpha=first.alpha()*weights[0];colors.forEach((function(c,ci){var xyz2=c.get(mode);alpha+=c.alpha()*weights[ci+1];for(var i4=0;i4<xyz.length;i4++)if(!isNaN(xyz2[i4]))if(cnt[i4]+=weights[ci+1],"h"===mode.charAt(i4)){var A2=xyz2[i4]/180*PI$1;dx+=cos$2(A2)*weights[ci+1],dy+=sin$2(A2)*weights[ci+1]}else xyz[i4]+=xyz2[i4]*weights[ci+1]}));for(var i$12=0;i$12<xyz.length;i$12++)if("h"===mode.charAt(i$12)){for(var A$1=atan2$1(dy/cnt[i$12],dx/cnt[i$12])/PI$1*180;A$1<0;)A$1+=360;for(;A$1>=360;)A$1-=360;xyz[i$12]=A$1}else xyz[i$12]=xyz[i$12]/cnt[i$12];return alpha/=l,new Color$6(xyz,mode).alpha(alpha>.99999?1:alpha,!0)},_average_lrgb=function(colors,weights){for(var l=colors.length,xyz=[0,0,0,0],i3=0;i3<colors.length;i3++){var col=colors[i3],f=weights[i3]/l,rgb2=col._rgb;xyz[0]+=pow$4(rgb2[0],2)*f,xyz[1]+=pow$4(rgb2[1],2)*f,xyz[2]+=pow$4(rgb2[2],2)*f,xyz[3]+=rgb2[3]*f}return xyz[0]=sqrt$1(xyz[0]),xyz[1]=sqrt$1(xyz[1]),xyz[2]=sqrt$1(xyz[2]),xyz[3]>.9999999&&(xyz[3]=1),new Color$6(clip_rgb$1(xyz))},chroma$4=chroma_1,type$2=utils.type,pow$3=Math.pow,scale$2=function(colors){var _mode="rgb",_nacol=chroma$4("#ccc"),_spread=0,_domain=[0,1],_pos=[],_padding=[0,0],_classes=!1,_colors=[],_out=!1,_min=0,_max=1,_correctLightness=!1,_colorCache={},_useCache=!0,_gamma=1,setColors=function(colors2){if((colors2=colors2||["#fff","#000"])&&"string"===type$2(colors2)&&chroma$4.brewer&&chroma$4.brewer[colors2.toLowerCase()]&&(colors2=chroma$4.brewer[colors2.toLowerCase()]),"array"===type$2(colors2)){1===colors2.length&&(colors2=[colors2[0],colors2[0]]),colors2=colors2.slice(0);for(var c=0;c<colors2.length;c++)colors2[c]=chroma$4(colors2[c]);_pos.length=0;for(var c$1=0;c$1<colors2.length;c$1++)_pos.push(c$1/(colors2.length-1))}return resetCache(),_colors=colors2},getClass=function(value){if(null!=_classes){for(var n=_classes.length-1,i3=0;i3<n&&value>=_classes[i3];)i3++;return i3-1}return 0},tMapLightness=function(t2){return t2},tMapDomain=function(t2){return t2},getColor=function(val,bypassMap){var col,t2;if(null==bypassMap&&(bypassMap=!1),isNaN(val)||null===val)return _nacol;t2=bypassMap?val:_classes&&_classes.length>2?getClass(val)/(_classes.length-2):_max!==_min?(val-_min)/(_max-_min):1,t2=tMapDomain(t2),bypassMap||(t2=tMapLightness(t2)),1!==_gamma&&(t2=pow$3(t2,_gamma)),t2=_padding[0]+t2*(1-_padding[0]-_padding[1]),t2=Math.min(1,Math.max(0,t2));var k=Math.floor(1e4*t2);if(_useCache&&_colorCache[k])col=_colorCache[k];else{if("array"===type$2(_colors))for(var i3=0;i3<_pos.length;i3++){var p=_pos[i3];if(t2<=p){col=_colors[i3];break}if(t2>=p&&i3===_pos.length-1){col=_colors[i3];break}if(t2>p&&t2<_pos[i3+1]){t2=(t2-p)/(_pos[i3+1]-p),col=chroma$4.interpolate(_colors[i3],_colors[i3+1],t2,_mode);break}}else"function"===type$2(_colors)&&(col=_colors(t2));_useCache&&(_colorCache[k]=col)}return col},resetCache=function(){return _colorCache={}};setColors(colors);var f=function(v){var c=chroma$4(getColor(v));return _out&&c[_out]?c[_out]():c};return f.classes=function(classes){if(null!=classes){if("array"===type$2(classes))_classes=classes,_domain=[classes[0],classes[classes.length-1]];else{var d=chroma$4.analyze(_domain);_classes=0===classes?[d.min,d.max]:chroma$4.limits(d,"e",classes)}return f}return _classes},f.domain=function(domain){if(!arguments.length)return _domain;_min=domain[0],_max=domain[domain.length-1],_pos=[];var k=_colors.length;if(domain.length===k&&_min!==_max)for(var i3=0,list2=Array.from(domain);i3<list2.length;i3+=1){var d=list2[i3];_pos.push((d-_min)/(_max-_min))}else{for(var c=0;c<k;c++)_pos.push(c/(k-1));if(domain.length>2){var tOut=domain.map((function(d2,i4){return i4/(domain.length-1)})),tBreaks=domain.map((function(d2){return(d2-_min)/(_max-_min)}));tBreaks.every((function(val,i4){return tOut[i4]===val}))||(tMapDomain=function(t2){if(t2<=0||t2>=1)return t2;for(var i4=0;t2>=tBreaks[i4+1];)i4++;var f2=(t2-tBreaks[i4])/(tBreaks[i4+1]-tBreaks[i4]);return tOut[i4]+f2*(tOut[i4+1]-tOut[i4])})}}return _domain=[_min,_max],f},f.mode=function(_m){return arguments.length?(_mode=_m,resetCache(),f):_mode},f.range=function(colors2,_pos2){return setColors(colors2),f},f.out=function(_o){return _out=_o,f},f.spread=function(val){return arguments.length?(_spread=val,f):_spread},f.correctLightness=function(v){return null==v&&(v=!0),_correctLightness=v,resetCache(),tMapLightness=_correctLightness?function(t2){for(var L0=getColor(0,!0).lab()[0],L1=getColor(1,!0).lab()[0],pol=L0>L1,L_actual=getColor(t2,!0).lab()[0],L_ideal=L0+(L1-L0)*t2,L_diff=L_actual-L_ideal,t0=0,t1=1,max_iter=20;Math.abs(L_diff)>.01&&max_iter-- >0;)pol&&(L_diff*=-1),L_diff<0?(t0=t2,t2+=.5*(t1-t2)):(t1=t2,t2+=.5*(t0-t2)),L_actual=getColor(t2,!0).lab()[0],L_diff=L_actual-L_ideal;return t2}:function(t2){return t2},f},f.padding=function(p){return null!=p?("number"===type$2(p)&&(p=[p,p]),_padding=p,f):_padding},f.colors=function(numColors,out){arguments.length<2&&(out="hex");var result=[];if(0===arguments.length)result=_colors.slice(0);else if(1===numColors)result=[f(.5)];else if(numColors>1){var dm=_domain[0],dd=_domain[1]-dm;result=__range__(0,numColors,!1).map((function(i4){return f(dm+i4/(numColors-1)*dd)}))}else{colors=[];var samples=[];if(_classes&&_classes.length>2)for(var i3=1,end2=_classes.length,asc=1<=end2;asc?i3<end2:i3>end2;asc?i3++:i3--)samples.push(.5*(_classes[i3-1]+_classes[i3]));else samples=_domain;result=samples.map((function(v){return f(v)}))}return chroma$4[out]&&(result=result.map((function(c){return c[out]()}))),result},f.cache=function(c){return null!=c?(_useCache=c,f):_useCache},f.gamma=function(g){return null!=g?(_gamma=g,f):_gamma},f.nodata=function(d){return null!=d?(_nacol=chroma$4(d),f):_nacol},f};function __range__(left2,right2,inclusive){for(var range=[],ascending=left2<right2,end2=inclusive?ascending?right2+1:right2-1:right2,i3=left2;ascending?i3<end2:i3>end2;ascending?i3++:i3--)range.push(i3);return range}var Color$5=Color_1,scale$1=scale$2,binom_row=function(n){for(var row=[1,1],i3=1;i3<n;i3++){for(var newrow=[1],j=1;j<=row.length;j++)newrow[j]=(row[j]||0)+row[j-1];row=newrow}return row},bezier=function(colors){var assign2,assign$1,assign$2,I,lab0,lab1,lab2;if(2===(colors=colors.map((function(c){return new Color$5(c)}))).length)assign2=colors.map((function(c){return c.lab()})),lab0=assign2[0],lab1=assign2[1],I=function(t2){var lab4=[0,1,2].map((function(i3){return lab0[i3]+t2*(lab1[i3]-lab0[i3])}));return new Color$5(lab4,"lab")};else if(3===colors.length)assign$1=colors.map((function(c){return c.lab()})),lab0=assign$1[0],lab1=assign$1[1],lab2=assign$1[2],I=function(t2){var lab4=[0,1,2].map((function(i3){return(1-t2)*(1-t2)*lab0[i3]+2*(1-t2)*t2*lab1[i3]+t2*t2*lab2[i3]}));return new Color$5(lab4,"lab")};else if(4===colors.length){var lab3;assign$2=colors.map((function(c){return c.lab()})),lab0=assign$2[0],lab1=assign$2[1],lab2=assign$2[2],lab3=assign$2[3],I=function(t2){var lab4=[0,1,2].map((function(i3){return(1-t2)*(1-t2)*(1-t2)*lab0[i3]+3*(1-t2)*(1-t2)*t2*lab1[i3]+3*(1-t2)*t2*t2*lab2[i3]+t2*t2*t2*lab3[i3]}));return new Color$5(lab4,"lab")}}else{if(!(colors.length>=5))throw new RangeError("No point in running bezier with only one color.");var labs,row,n;labs=colors.map((function(c){return c.lab()})),n=colors.length-1,row=binom_row(n),I=function(t2){var u=1-t2,lab4=[0,1,2].map((function(i3){return labs.reduce((function(sum,el,j){return sum+row[j]*Math.pow(u,n-j)*Math.pow(t2,j)*el[i3]}),0)}));return new Color$5(lab4,"lab")}}return I},bezier_1=function(colors){var f=bezier(colors);return f.scale=function(){return scale$1(f)},f},chroma$3=chroma_1,blend=function(bottom2,top2,mode){if(!blend[mode])throw new Error("unknown blend mode "+mode);return blend[mode](bottom2,top2)},blend_f=function(f){return function(bottom2,top2){var c0=chroma$3(top2).rgb(),c1=chroma$3(bottom2).rgb();return chroma$3.rgb(f(c0,c1))}},each=function(f){return function(c0,c1){var out=[];return out[0]=f(c0[0],c1[0]),out[1]=f(c0[1],c1[1]),out[2]=f(c0[2],c1[2]),out}},normal=function(a){return a},multiply=function(a,b){return a*b/255},darken=function(a,b){return a>b?b:a},lighten=function(a,b){return a>b?a:b},screen=function(a,b){return 255*(1-(1-a/255)*(1-b/255))},overlay=function(a,b){return b<128?2*a*b/255:255*(1-2*(1-a/255)*(1-b/255))},burn=function(a,b){return 255*(1-(1-b/255)/(a/255))},dodge=function(a,b){return 255===a||(a=b/255*255/(1-a/255))>255?255:a};blend.normal=blend_f(each(normal)),blend.multiply=blend_f(each(multiply)),blend.screen=blend_f(each(screen)),blend.overlay=blend_f(each(overlay)),blend.darken=blend_f(each(darken)),blend.lighten=blend_f(each(lighten)),blend.dodge=blend_f(each(dodge)),blend.burn=blend_f(each(burn));for(var blend_1=blend,type$12=utils.type,clip_rgb=utils.clip_rgb,TWOPI=utils.TWOPI,pow$2=Math.pow,sin$1=Math.sin,cos$1=Math.cos,chroma$2=chroma_1,cubehelix=function(start2,rotations,hue,gamma,lightness){void 0===start2&&(start2=300),void 0===rotations&&(rotations=-1.5),void 0===hue&&(hue=1),void 0===gamma&&(gamma=1),void 0===lightness&&(lightness=[0,1]);var dl,dh=0;"array"===type$12(lightness)?dl=lightness[1]-lightness[0]:(dl=0,lightness=[lightness,lightness]);var f=function(fract){var a=TWOPI*((start2+120)/360+rotations*fract),l=pow$2(lightness[0]+dl*fract,gamma),amp=(0!==dh?hue[0]+fract*dh:hue)*l*(1-l)/2,cos_a=cos$1(a),sin_a=sin$1(a);return chroma$2(clip_rgb([255*(l+amp*(-.14861*cos_a+1.78277*sin_a)),255*(l+amp*(-.29227*cos_a-.90649*sin_a)),255*(l+amp*(1.97294*cos_a)),1]))};return f.start=function(s){return null==s?start2:(start2=s,f)},f.rotations=function(r){return null==r?rotations:(rotations=r,f)},f.gamma=function(g){return null==g?gamma:(gamma=g,f)},f.hue=function(h){return null==h?hue:("array"===type$12(hue=h)?0==(dh=hue[1]-hue[0])&&(hue=hue[1]):dh=0,f)},f.lightness=function(h){return null==h?lightness:("array"===type$12(h)?(lightness=h,dl=h[1]-h[0]):(lightness=[h,h],dl=0),f)},f.scale=function(){return chroma$2.scale(f)},f.hue(hue),f},Color$4=Color_1,digits="0123456789abcdef",floor$1=Math.floor,random=Math.random,random_1=function(){for(var code2="#",i3=0;i3<6;i3++)code2+=digits.charAt(floor$1(16*random()));return new Color$4(code2,"hex")},type2=type$p,log=Math.log,pow$1=Math.pow,floor=Math.floor,abs$1=Math.abs,analyze=function(data2,key2){void 0===key2&&(key2=null);var r={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===type2(data2)&&(data2=Object.values(data2)),data2.forEach((function(val){key2&&"object"===type2(val)&&(val=val[key2]),null==val||isNaN(val)||(r.values.push(val),r.sum+=val,val<r.min&&(r.min=val),val>r.max&&(r.max=val),r.count+=1)})),r.domain=[r.min,r.max],r.limits=function(mode,num2){return limits(r,mode,num2)},r},limits=function(data2,mode,num2){void 0===mode&&(mode="equal"),void 0===num2&&(num2=7),"array"==type2(data2)&&(data2=analyze(data2));var min3=data2.min,max3=data2.max,values=data2.values.sort((function(a,b){return a-b}));if(1===num2)return[min3,max3];var limits2=[];if("c"===mode.substr(0,1)&&(limits2.push(min3),limits2.push(max3)),"e"===mode.substr(0,1)){limits2.push(min3);for(var i3=1;i3<num2;i3++)limits2.push(min3+i3/num2*(max3-min3));limits2.push(max3)}else if("l"===mode.substr(0,1)){if(min3<=0)throw new Error("Logarithmic scales are only possible for values > 0");var min_log=Math.LOG10E*log(min3),max_log=Math.LOG10E*log(max3);limits2.push(min3);for(var i$12=1;i$12<num2;i$12++)limits2.push(pow$1(10,min_log+i$12/num2*(max_log-min_log)));limits2.push(max3)}else if("q"===mode.substr(0,1)){limits2.push(min3);for(var i$2=1;i$2<num2;i$2++){var p=(values.length-1)*i$2/num2,pb=floor(p);if(pb===p)limits2.push(values[pb]);else{var pr=p-pb;limits2.push(values[pb]*(1-pr)+values[pb+1]*pr)}}limits2.push(max3)}else if("k"===mode.substr(0,1)){var cluster,n=values.length,assignments=new Array(n),clusterSizes=new Array(num2),repeat=!0,nb_iters=0,centroids=null;(centroids=[]).push(min3);for(var i$3=1;i$3<num2;i$3++)centroids.push(min3+i$3/num2*(max3-min3));for(centroids.push(max3);repeat;){for(var j=0;j<num2;j++)clusterSizes[j]=0;for(var i$4=0;i$4<n;i$4++)for(var value=values[i$4],mindist=Number.MAX_VALUE,best=void 0,j$1=0;j$1<num2;j$1++){var dist2=abs$1(centroids[j$1]-value);dist2<mindist&&(mindist=dist2,best=j$1),clusterSizes[best]++,assignments[i$4]=best}for(var newCentroids=new Array(num2),j$2=0;j$2<num2;j$2++)newCentroids[j$2]=null;for(var i$5=0;i$5<n;i$5++)null===newCentroids[cluster=assignments[i$5]]?newCentroids[cluster]=values[i$5]:newCentroids[cluster]+=values[i$5];for(var j$3=0;j$3<num2;j$3++)newCentroids[j$3]*=1/clusterSizes[j$3];repeat=!1;for(var j$4=0;j$4<num2;j$4++)if(newCentroids[j$4]!==centroids[j$4]){repeat=!0;break}centroids=newCentroids,++nb_iters>200&&(repeat=!1)}for(var kClusters={},j$5=0;j$5<num2;j$5++)kClusters[j$5]=[];for(var i$6=0;i$6<n;i$6++)kClusters[cluster=assignments[i$6]].push(values[i$6]);for(var tmpKMeansBreaks=[],j$6=0;j$6<num2;j$6++)tmpKMeansBreaks.push(kClusters[j$6][0]),tmpKMeansBreaks.push(kClusters[j$6][kClusters[j$6].length-1]);tmpKMeansBreaks=tmpKMeansBreaks.sort((function(a,b){return a-b})),limits2.push(tmpKMeansBreaks[0]);for(var i$7=1;i$7<tmpKMeansBreaks.length;i$7+=2){var v=tmpKMeansBreaks[i$7];isNaN(v)||-1!==limits2.indexOf(v)||limits2.push(v)}}return limits2},analyze_1={analyze:analyze,limits:limits},Color$3=Color_1,contrast=function(a,b){a=new Color$3(a),b=new Color$3(b);var l1=a.luminance(),l2=b.luminance();return l1>l2?(l1+.05)/(l2+.05):(l2+.05)/(l1+.05)},Color$2=Color_1,sqrt=Math.sqrt,pow=Math.pow,min2=Math.min,max2=Math.max,atan2=Math.atan2,abs=Math.abs,cos=Math.cos,sin=Math.sin,exp=Math.exp,PI=Math.PI,deltaE=function(a,b,Kl,Kc,Kh){void 0===Kl&&(Kl=1),void 0===Kc&&(Kc=1),void 0===Kh&&(Kh=1);var rad2deg=function(rad){return 360*rad/(2*PI)},deg2rad=function(deg){return 2*PI*deg/360};a=new Color$2(a),b=new Color$2(b);var ref=Array.from(a.lab()),L1=ref[0],a1=ref[1],b1=ref[2],ref$1=Array.from(b.lab()),L2=ref$1[0],a2=ref$1[1],b2=ref$1[2],avgL=(L1+L2)/2,avgC=(sqrt(pow(a1,2)+pow(b1,2))+sqrt(pow(a2,2)+pow(b2,2)))/2,G=.5*(1-sqrt(pow(avgC,7)/(pow(avgC,7)+pow(25,7)))),a1p=a1*(1+G),a2p=a2*(1+G),C1p=sqrt(pow(a1p,2)+pow(b1,2)),C2p=sqrt(pow(a2p,2)+pow(b2,2)),avgCp=(C1p+C2p)/2,arctan1=rad2deg(atan2(b1,a1p)),arctan2=rad2deg(atan2(b2,a2p)),h1p=arctan1>=0?arctan1:arctan1+360,h2p=arctan2>=0?arctan2:arctan2+360,avgHp=abs(h1p-h2p)>180?(h1p+h2p+360)/2:(h1p+h2p)/2,T=1-.17*cos(deg2rad(avgHp-30))+.24*cos(deg2rad(2*avgHp))+.32*cos(deg2rad(3*avgHp+6))-.2*cos(deg2rad(4*avgHp-63)),deltaHp=h2p-h1p;deltaHp=abs(deltaHp)<=180?deltaHp:h2p<=h1p?deltaHp+360:deltaHp-360,deltaHp=2*sqrt(C1p*C2p)*sin(deg2rad(deltaHp)/2);var deltaL=L2-L1,deltaCp=C2p-C1p,sl=1+.015*pow(avgL-50,2)/sqrt(20+pow(avgL-50,2)),sc=1+.045*avgCp,sh=1+.015*avgCp*T,deltaTheta=30*exp(-pow((avgHp-275)/25,2)),Rt=-2*sqrt(pow(avgCp,7)/(pow(avgCp,7)+pow(25,7)))*sin(2*deg2rad(deltaTheta)),result=sqrt(pow(deltaL/(Kl*sl),2)+pow(deltaCp/(Kc*sc),2)+pow(deltaHp/(Kh*sh),2)+Rt*(deltaCp/(Kc*sc))*(deltaHp/(Kh*sh)));return max2(0,min2(100,result))},Color$1=Color_1,distance=function(a,b,mode){void 0===mode&&(mode="lab"),a=new Color$1(a),b=new Color$1(b);var l1=a.get(mode),l2=b.get(mode),sum_sq=0;for(var i3 in l1){var d=(l1[i3]||0)-(l2[i3]||0);sum_sq+=d*d}return Math.sqrt(sum_sq)},Color=Color_1,valid=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];try{return new(Function.prototype.bind.apply(Color,[null].concat(args))),!0}catch(e){return!1}},chroma$12=chroma_1,scale=scale$2,scales={cool:function(){return scale([chroma$12.hsl(180,1,.9),chroma$12.hsl(250,.7,.4)])},hot:function(){return scale(["#000","#f00","#ff0","#fff"]).mode("rgb")}},colorbrewer={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},i2=0,list=Object.keys(colorbrewer);i2<list.length;i2+=1){var key=list[i2];colorbrewer[key.toLowerCase()]=colorbrewer[key]}var colorbrewer_1=colorbrewer,chroma2=chroma_1;return chroma2.average=average,chroma2.bezier=bezier_1,chroma2.blend=blend_1,chroma2.cubehelix=cubehelix,chroma2.mix=chroma2.interpolate=mix$1,chroma2.random=random_1,chroma2.scale=scale$2,chroma2.analyze=analyze_1.analyze,chroma2.contrast=contrast,chroma2.deltaE=deltaE,chroma2.distance=distance,chroma2.limits=analyze_1.limits,chroma2.valid=valid,chroma2.scales=scales,chroma2.colors=w3cx11_1,chroma2.brewer=colorbrewer_1,chroma2}()}(chroma$1);const chroma=getDefaultExportFromCjs(chroma$1.exports),toRgb=color2=>{"transparent"===color2&&(color2="#00000000");const arr=chroma(color2).rgb();return`rgb(${arr[0]}, ${arr[1]}, ${arr[2]})`},toHex=color2=>("transparent"===color2&&(color2="#00000000"),chroma(color2).hex()),arrayToRgbaString=colorArray=>{if(colorArray.length<3||colorArray.length>4)throw new Error("The color array must have 3 or 4 components (R, G, B [, A])");const hasAlpha=4===colorArray.length,alpha=hasAlpha?colorArray[3]:1;if(alpha<0||alpha>1)throw new Error("The alpha value must be between 0 and 1.");return hasAlpha?`rgba(${colorArray[0]}, ${colorArray[1]}, ${colorArray[2]}, ${alpha})`:`rgba(${colorArray[0]}, ${colorArray[1]}, ${colorArray[2]}, 1)`},deepCopy=obj=>{if(null===obj||"object"!=typeof obj)return obj;let copy;if(Array.isArray(obj)){copy=[];for(let i2=0;i2<obj.length;i2++)copy[i2]=deepCopy(obj[i2]);return copy}copy={};for(const key in obj)"object"==typeof obj&&Object.prototype.hasOwnProperty.call(obj,key)&&(copy[key]=deepCopy(obj[key]));return copy},isObject=item=>item&&"object"==typeof item&&!Array.isArray(item),isObjectAndArray=item=>item&&"object"==typeof item,mergeDeep=(target,...sources)=>{if(!sources.length)return target;const source=sources.shift();if(isObject(target)&&isObject(source))for(const key in source)isObject(source[key])?(target[key]||Object.assign(target,{[key]:{}}),mergeDeep(target[key],source[key])):Object.assign(target,{[key]:source[key]});return mergeDeep(target,...sources)},deepEqual=(object1,object2)=>{const objKeys1=Object.keys(object1),objKeys2=Object.keys(object2);if(objKeys1.length!==objKeys2.length)return!1;for(const key of objKeys1){const value1=object1[key],value2=object2[key],isObjects=isObjectAndArray(value1)&&isObjectAndArray(value2);if(isObjects&&!deepEqual(value1,value2)||!isObjects&&value1!==value2)return!1}return!0},functs={color:{getHexDarken:color2=>chroma(color2).darken().hex(),getRandom:()=>{const randomColor=(obj=>{const keys2=Object.keys(obj),randomKey=keys2[Math.floor(Math.random()*keys2.length)];return{key:randomKey,value:obj[randomKey]}})(colorList),colorValue=arrayToRgbaString(randomColor.value);return{name:randomColor.key,value:colorValue}},arrayToRgbaString:arrayToRgbaString,getOpacity:color2=>{"transparent"===color2&&(color2="#00000000");const rgbaArr=chroma(color2).rgba();return rgbaArr[rgbaArr.length-1]},toRgba:(color2,opacity)=>{"transparent"===color2&&(color2="#00000000");const rgbaArr=chroma(color2).alpha(opacity/100).rgba();return arrayToRgbaString(rgbaArr)},toRgb:toRgb,toHex:toHex,toHexWithoutOpacity:color2=>toHex(toRgb(color2))},deepEqual:deepEqual,clickOutside:node=>{const handleClick=event=>{!node||node.contains(event.target)||event.defaultPrevented||node.dispatchEvent(new CustomEvent("click_outside",node))};return document.addEventListener("click",handleClick,!0),{destroy(){document.removeEventListener("click",handleClick,!0)}}},mergeDeep:mergeDeep,mergeDeepById:(arr1,arr2)=>{const merged={};for(const item of arr1)merged[item.id]?merged[item.id]=mergeDeep(merged[item.id],item):merged[item.id]={...item};for(const item of arr2)merged[item.id]?merged[item.id]=mergeDeep(merged[item.id],item):merged[item.id]={...item};return Object.values(merged)},isObjectEmpty:obj=>{for(const key in obj)if(key in obj)return!1;return!0},copyText:async text2=>{if("clipboard"in navigator)await navigator.clipboard.writeText(text2);else{const element2=document.createElement("input");element2.type="text",element2.disabled=!0,element2.style.setProperty("position","fixed"),element2.style.setProperty("z-index","-100"),element2.style.setProperty("pointer-events","none"),element2.style.setProperty("opacity","0"),element2.value=text2,document.body.appendChild(element2),element2.click(),element2.select(),document.execCommand("copy"),document.body.removeChild(element2)}},generateRamdomID:()=>`${Date.now().toString(36)}_${Math.random().toString(36).substr(2,8)}`,isJsonString:str=>{try{const obj=JSON.parse(str);return"object"==typeof obj&&null!==obj}catch(e){return!1}},isObjectAndArray:isObjectAndArray,jsonToObj:v=>JSON.parse(v),objectToJson:v=>JSON.stringify(v,null,2),deepCopy:deepCopy,addStyleToHead:(id2,styleString)=>{let styleElement=document.getElementById(id2);styleElement?styleElement.innerHTML=styleString:(styleElement=document.createElement("style"),styleElement.id=id2,styleElement.innerHTML=styleString,document.head.appendChild(styleElement))}},componentTypes={btn:{light:"light",neutral:"neutral",primary:"primary",secondary:"secondary",gray:"gray",grayReverse:"grayReverse",success:"success",error:"error",none:"none"},checkbox:{native:"native",toggle:"toggle"},codeEditor:{json:"json"},colorPicker:{native:"native",nativeAndOpacity:"native-opacity"},text:{main:"main",native:"native",transparent:"transparent"},number:{native:"native",transparent:"transparent"},radio:{native:"native"},range:{native:"native"},select:{native:"native",transparent:"transparent"},option:{btn:"btn",section:"section",checkbox:"checkbox",codeEditor:"code-ditor",colorPicker:"color-picker",text:"text",number:"number",radio:"radio",range:"range",select:"select"},filters:{sidebar:"sidebar",main:"main"},accordion:{section:"section",item:"item"},badge:{primary:"primary",secondary:"secondary",gray:"gray",neutral:"neutral",transparent:"transparent",success:"success",error:"error",warning:"warning"},notification:{error:"error",warn:"warn",success:"success",info:"info"},tooltip:{main:"main",info:"info"},title:{tooltipLeft:"tooltip-left",tooltipRight:"tooltip-right"},indicator:{main:"main",error:"error",warn:"warn",success:"success",info:"info",neutral:"neutral"}},componentPositions={tooltip:{topStart:"top-start",top:"top",topEnd:"top-end",rightStart:"right-start",right:"right",rightEnd:"right-end",bottomStart:"bottom-start",bottom:"bottom",bottomEnd:"bottom-end",leftStart:"left-start",left:"left",leftEnd:"left-end"},indicator:{bottom:"bottom",right:"right",left:"left",top:"top",bottomLeft:"bottom-left",bottomRight:"bottom-right",topLeft:"top-left",topRight:"top-right"},filters:{sidebar:{bottom:"bottom",right:"right",left:"left",top:"top",none:"none"},btn:{bottomLeft:"bottom-left",bottomRight:"bottom-right",topLeft:"top-left",topRight:"top-right",none:"none"}}},allowedFilterTabs={custom:1,preset:2,more:3,btn:4},filtersSectionsIds={custom:{filter:"filter",border:"border",shadow:"box-shadow",animation:"animation"},presets:{official:"official",user:"user"},more:{copy:"copy",addPreset:"add-preset"}},filterCustomIds={borderWidth:"border-width",borderStyle:"border-style",borderRadius:"border-radius",borderColor:"border-color",shadowX:"box-shadow--x",shadowY:"box-shadow--y",shadowSpread:"box-shadow--spread",shadowBlur:"box-shadow--blur",shadowInset:"box-shadow--inset",shadowColor:"box-shadow--color",filterBlur:"filter--blur",filterBrightness:"filter--brightness",filterContrast:"filter--contrast",filterGrayscale:"filter--grayscale",filterHueRotate:"filter--hue-rotate",filterInvert:"filter--invert",filterOpacity:"filter--opacity",filterSaturation:"filter--saturate",filterSepia:"filter--sepia"},filterCustomTypesIds_range="range",filterCustomTypesIds_colorPicker="color-picker",unitValues_px="px",unitValues_x100="%",sizeValues_extraSmall="extra-small",sizeValues_small="small",sizeValues_medium="medium",sizeValues_large="large",sizeValues_extraLarge="extra-large",customBorder=[{id:filterCustomIds.borderWidth,type:filterCustomTypesIds_range,title:{value:"Size"},value:0,opts:{step:1,min:0,max:100,unit:unitValues_px}},{id:filterCustomIds.borderRadius,type:filterCustomTypesIds_range,title:{value:"Radius"},value:0,opts:{step:1,min:0,max:200,unit:{opts:[{value:unitValues_x100},{value:unitValues_px}],value:unitValues_x100}}},{id:filterCustomIds.borderStyle,type:"select",title:{value:"Style"},value:"solid",opts:[{value:"solid",name:"Solid"},{value:"dashed",name:"Dashed"},{value:"groove",name:"Groove"},{value:"dotted",name:"Dotted"},{value:"double",name:"Double"}]},{id:filterCustomIds.borderColor,type:filterCustomTypesIds_colorPicker,title:{value:"Color"},value:"rgba(255, 255, 255, 1)"}],customFilter=[{id:filterCustomIds.filterBrightness,type:filterCustomTypesIds_range,title:{value:"Brightness"},value:100,opts:{step:1,min:0,max:300,unit:unitValues_x100}},{id:filterCustomIds.filterContrast,type:filterCustomTypesIds_range,title:{value:"Contrast"},value:100,opts:{step:1,min:0,max:1e3,unit:unitValues_x100}},{id:filterCustomIds.filterGrayscale,type:filterCustomTypesIds_range,title:{value:"Grayscale"},value:0,opts:{step:1,min:0,max:100,unit:unitValues_x100}},{id:filterCustomIds.filterHueRotate,type:filterCustomTypesIds_range,title:{value:"Hue rotate"},value:0,opts:{step:1,min:0,max:360,unit:"deg"}},{id:filterCustomIds.filterInvert,type:filterCustomTypesIds_range,title:{value:"Invert"},value:0,opts:{step:1,min:0,max:100,unit:unitValues_x100}},{id:filterCustomIds.filterOpacity,type:filterCustomTypesIds_range,title:{value:"Opacity"},value:100,opts:{step:1,min:0,max:100,unit:unitValues_x100}},{id:filterCustomIds.filterSaturation,type:filterCustomTypesIds_range,title:{value:"Saturate"},value:100,opts:{step:1,min:0,max:1e3,unit:unitValues_x100}},{id:filterCustomIds.filterSepia,type:filterCustomTypesIds_range,title:{value:"Sepia"},value:0,opts:{step:1,min:0,max:100,unit:unitValues_x100}},{id:filterCustomIds.filterBlur,type:filterCustomTypesIds_range,title:{value:"Blur",desc:"Lorem ipsum"},value:0,opts:{step:1,min:0,max:100,unit:unitValues_px}}],customShadow=[{id:filterCustomIds.shadowX,type:filterCustomTypesIds_range,title:{value:"Shift horizontal"},value:0,opts:{step:1,min:-100,max:100,unit:unitValues_px}},{id:filterCustomIds.shadowY,type:filterCustomTypesIds_range,title:{value:"Shift vertical"},value:0,opts:{step:1,min:-100,max:100,unit:unitValues_px}},{id:filterCustomIds.shadowSpread,type:filterCustomTypesIds_range,title:{value:"Spread"},value:0,opts:{step:1,min:-100,max:100,unit:unitValues_px}},{id:filterCustomIds.shadowBlur,type:filterCustomTypesIds_range,title:{value:"Blur"},value:0,opts:{step:1,min:0,max:300,unit:unitValues_px}},{id:filterCustomIds.shadowInset,type:"checkbox",title:{value:"Inset"},value:!1},{id:filterCustomIds.shadowColor,type:filterCustomTypesIds_colorPicker,title:{value:"Color"},value:"rgba(77, 78, 55, 1)"}],filters$1={presets:[{id:"sepia",name:"Sepia",opts:{color:"#BAAE92"},value:[{id:filterCustomIds.filterBrightness,value:90},{id:filterCustomIds.filterContrast,value:70},{id:filterCustomIds.filterSaturation,value:90},{id:filterCustomIds.filterSepia,value:100}]},{id:"mullholland",name:"Mullholland",opts:{color:"#D63032"},value:[{id:filterCustomIds.filterContrast,value:70},{id:filterCustomIds.filterHueRotate,value:350},{id:filterCustomIds.filterSaturation,value:300}]},{id:"neon",name:"Neon",opts:{color:"#802B7C"},value:[{id:filterCustomIds.filterContrast,value:200},{id:filterCustomIds.filterHueRotate,value:300},{id:filterCustomIds.filterSaturation,value:90}]},{id:"sunset",name:"Sunset",opts:{color:"#F1AA47"},value:[{id:filterCustomIds.filterBrightness,value:100},{id:filterCustomIds.filterContrast,value:60},{id:filterCustomIds.filterSaturation,value:200}]},{id:"road",name:"Road",opts:{color:"#DF542F"},value:[{id:filterCustomIds.filterContrast,value:90},{id:filterCustomIds.filterHueRotate,value:25}]},{id:"tokio",name:"Tokio",opts:{color:"#286AA6"},value:[{id:filterCustomIds.filterBrightness,value:100},{id:filterCustomIds.filterContrast,value:140},{id:filterCustomIds.filterSaturation,value:100}]},{id:"sense",name:"Sense",opts:{color:"#283278"},value:[{id:filterCustomIds.filterBrightness,value:80},{id:filterCustomIds.filterContrast,value:60},{id:filterCustomIds.filterSaturation,value:200}]},{id:"boat",name:"Boat",opts:{color:"#4D4D4C"},value:[{id:filterCustomIds.filterContrast,value:90},{id:filterCustomIds.filterGrayscale,value:100}]},{id:"vintage",name:"Vintage",opts:{color:"#51341D"},value:[{id:filterCustomIds.filterBrightness,value:80},{id:filterCustomIds.filterHueRotate,value:323},{id:filterCustomIds.filterSepia,value:40}]},{id:"arctic",name:"Arctic",opts:{color:"#35A0CD"},value:[{id:filterCustomIds.filterBrightness,value:90},{id:filterCustomIds.filterContrast,value:120},{id:filterCustomIds.filterHueRotate,value:33}]},{id:"tech",name:"Tech",opts:{color:"#009849"},value:[{id:filterCustomIds.filterBrightness,value:90},{id:filterCustomIds.filterContrast,value:100},{id:filterCustomIds.filterHueRotate,value:30}]},{id:"raw",name:"Raw",opts:{color:"#B4B5B4"},value:[{id:filterCustomIds.filterContrast,value:150},{id:filterCustomIds.filterGrayscale,value:100}]}],custom:{filter:{title:{value:"Filters",desc:"Add filters to video"},value:customFilter},border:{title:{value:"Border",desc:"Change border style to video"},value:customBorder},shadow:{title:{value:"Shadow",desc:"Change shadow to video"},value:customShadow}},allCustom:[...customBorder,...customShadow,...customFilter]},locales$1={reset:{title:"Reset",desc:"Reset custom filters"},limit:{optionBlock:"Limit exceeded",limitAllowed:"Number of options allowed:",nots:{onLimit:"You have set the limit of allowed options in the settings. Reset if you want to try new settings."}},hide:{title:"Hide",desc:""},show:{title:"Show",desc:""},presets:{title:"Presets",desc:"",official:{title:"Official presets",desc:""},user:{title:"User presets",desc:"",none:"Any custom preset is set.",btnRemove:"Remove preset"}},more:{title:"+",desc:"Extra tools",copy:{title:"Custom values",desc:"",btn:{title:"Copy values",onClick:"Copied succesfully"},nots:{success:"Values copied successfully"}},addPresets:{title:"Create user preset",desc:"If you dont know how its work, check out our guide page",inputName:{title:"Name",desc:"Add name of your preset",placeholder:"Add name of your preset"},inputObject:{title:"Custom values",desc:"Add object of custom values for your preset. Remember that the values that are omitted in your configuration will be added with the default values. For this reason, it is always better to add all fields to your configuration",placeholder:"// Write or copy custom presets"},btn:{title:"Create user preset"},nots:{success:"Preset added successfully",errorName:"Is invalid text value",errorObject:"Is invalid object value"}}},custom:{title:"Custom",desc:"",border:{title:"Border",desc:"Change border style to video",values:{[filterCustomIds.borderWidth]:{title:"Size",desc:""},[filterCustomIds.borderRadius]:{title:"Radius",desc:""},[filterCustomIds.borderStyle]:{title:"Style",desc:""},[filterCustomIds.borderColor]:{title:"Color",desc:""}}},shadow:{title:"Shadow",desc:"Change shadow to video",values:{[filterCustomIds.shadowX]:{title:"Shift horizontal",desc:""},[filterCustomIds.shadowY]:{title:"Shift Vertical",desc:""},[filterCustomIds.shadowSpread]:{title:"Spread",desc:""},[filterCustomIds.shadowBlur]:{title:"Blur",desc:""},[filterCustomIds.shadowInset]:{title:"Inset",desc:""},[filterCustomIds.shadowColor]:{title:"Color",desc:""}}},filter:{title:"Filters",desc:"Add filters to video",values:{[filterCustomIds.filterBlur]:{title:"Blur",desc:""},[filterCustomIds.filterBrightness]:{title:"Brightness",desc:""},[filterCustomIds.filterContrast]:{title:"Contrast",desc:""},[filterCustomIds.filterGrayscale]:{title:"Grayscale",desc:""},[filterCustomIds.filterHueRotate]:{title:"Hue Rotate",desc:""},[filterCustomIds.filterInvert]:{title:"Invert",desc:""},[filterCustomIds.filterOpacity]:{title:"Opacity",desc:""},[filterCustomIds.filterSaturation]:{title:"Saturate",desc:""},[filterCustomIds.filterSepia]:{title:"Sepia",desc:""}}},animation:{title:"Animation",desc:"Add animations",nots:{comingsoon:{title:"Coming soon",desc:"This section will be available in later versions. Consider contributing to the project if you want it to be available as quickly as possible."}}},addPreset:{title:"Create user preset",desc:"Create user preset with the custom config that you set."}}},locales=(()=>{const defaultValues=locales$1,value=writable(functs.deepCopy(defaultValues));return{...value,add:locales2=>{const actualValue=get_store_value(value),res=functs.mergeDeep(actualValue,locales2);value.set(res)}}})(),sectionFunct=(keys2,openDefault)=>{if(!Array.isArray(keys2))throw"Value must be an array";const defaultValue=(keys3=>{const res={};return keys3.forEach((key=>{res[String(key)]=!1})),res})(keys2),value=writable(defaultValue),open=id2=>{if(!id2||"string"!=typeof id2||!Object.keys(defaultValue).includes(id2))return;const currValues=get_store_value(value);for(const prop in currValues)currValues[prop]=prop===id2;value.set(currValues)};return openDefault&&open(openDefault),{...value,open:open,reset:()=>value.set(defaultValue),closeAll:()=>{const currValues=get_store_value(value);for(const prop of Object.keys(currValues))currValues[prop]=!1;value.set(currValues)}}},custom=(()=>{const defaultValues=filters$1.custom,value=writable(functs.deepCopy(defaultValues)),valuesInArray=values2=>{let res=[];for(const filts of Object.values(values2))filts&&filts.value&&(res=[...res,...filts.value]);return res},valuesToExportInArray=values2=>values2.map((({id:id2,value:value2,opts:opts})=>opts&&"object"==typeof opts&&"unit"in opts&&null!==opts.unit&&"object"==typeof opts.unit&&"value"in opts.unit?{id:id2,value:value2,unit:opts.unit.value}:{id:id2,value:value2})),defaultValuesInArray=valuesInArray(functs.deepCopy(defaultValues)),defaultValuesToExportInArray=valuesToExportInArray(defaultValuesInArray),valuesWithLocales=derived([value,locales],(([$value,$locales])=>{const custom2=$locales.custom;for(const[key,value2]of Object.entries($value)){const customSection=custom2[key],valueSection=$value[key];if("object"==typeof customSection&&(value2&&value2.title.value&&(valueSection.title.value=customSection.title),value2&&value2.title.desc&&(valueSection.title.desc=customSection.desc),value2&&value2.value&&"values"in customSection))for(const filtValue of value2.value)if("object"==typeof customSection.values&&filtValue.id in customSection.values){const customFilter2=customSection.values[filtValue.id];filtValue.title.value&&(filtValue.title.value=customFilter2.title),filtValue.title.desc=customFilter2.desc}}return $value})),values=derived([value],(([$value])=>valuesInArray($value))),objectValues=derived([values],(([$values])=>valuesToExportInArray($values))),jsonValues=derived([objectValues],(([$values])=>functs.objectToJson($values))),defaultValuesToExport=valuesToExportInArray(valuesInArray(defaultValues)),valuesNotInDefault=derived([objectValues],(([$values])=>{const res={};for(const filter of Object.values($values)){const defaultFilter=defaultValuesToExport.find((defaultFilter2=>defaultFilter2.id===filter.id));if(defaultFilter){const valuesMatch=filter.value===defaultFilter.value&&(filter.unit===defaultFilter.unit||void 0===filter.unit);res[filter.id]=!valuesMatch}else res[filter.id]=!0}return res})),getValueCountBySection=(id2,value2)=>Object.entries(value2).filter((([k,v])=>!0===v&&k.startsWith(id2))).length,valuesNotInDefaultCount=derived(valuesNotInDefault,($values=>Object.values($values).filter((value2=>!0===value2)).length)),valuesNotInDefaultCountBySection=derived(valuesNotInDefault,($values=>({[filtersSectionsIds.custom.shadow]:getValueCountBySection(filtersSectionsIds.custom.shadow,$values),[filtersSectionsIds.custom.border]:getValueCountBySection(filtersSectionsIds.custom.border,$values),[filtersSectionsIds.custom.filter]:getValueCountBySection(filtersSectionsIds.custom.filter,$values),[filtersSectionsIds.custom.animation]:0}))),limit=writable(void 0),isBlocked=derived([valuesNotInDefaultCount,limit],(([$values,$limit])=>!!$limit&&$values>=$limit));return{default:defaultValues,defaultInArray:defaultValuesInArray,defaultToExport:defaultValuesToExportInArray,...value,updateValue:(id2,newValue)=>{if(!id2||!newValue)return;const filters2=get_store_value(value);for(const filter of Object.values(filters2))for(const fil of filter.value)fil.id===id2&&fil.value!==newValue&&(fil.value=newValue);value.set(filters2)},values:values,reset:()=>{value.set(functs.deepCopy(defaultValues))},resetValue:id2=>{value.update((filters2=>{for(const[key,filterArray]of Object.entries(filters2))filterArray.value&&(filterArray.value=filterArray.value.map((filter=>{if(filter.id===id2){const defaultValue=defaultValues[key].value.find((defaultFilter=>defaultFilter.id===id2));defaultValue&&(filter.value=defaultValue.value)}return filter})));return filters2}))},updateValues:filters2=>{value.update((oldFilters=>{for(const filter of Object.values(oldFilters))filter.value=filter.value.map((filter2=>{const update2=filters2.find((item=>item.id===filter2.id));return update2&&(filter2.value=update2.value),filter2}));return oldFilters}))},getDefaultValue:id2=>{const filters2=defaultValuesToExport;for(const filter of Object.values(filters2))if(filter.id===id2)return filter.value},resetWithValues:filters2=>{value.update((oldFilters=>{oldFilters=functs.deepCopy(defaultValues);for(const filter of Object.values(oldFilters))filter.value=filter.value.map((filter2=>{const update2=filters2.find((item=>item.id===filter2.id));return update2&&(filter2.value=update2.value),filter2}));return oldFilters}))},objectValues:objectValues,jsonValues:jsonValues,valuesWithLocales:valuesWithLocales,valuesNotInDefault:{list:valuesNotInDefault,count:valuesNotInDefaultCount,countBySection:valuesNotInDefaultCountBySection},section:sectionFunct(Object.values(filtersSectionsIds.custom),filtersSectionsIds.custom.filter),limit:limit,isBlocked:isBlocked}})(),presets=(()=>{const presetList=filters$1.presets,customList=writable(functs.deepCopy([])),valueID=writable(functs.deepCopy("")),reset=()=>valueID.set(""),getDefaultlistValue=id2=>{const filteredList=presetList.filter((d=>d.id===id2));return filteredList.length>0?filteredList[0]:void 0},getCustomListValue=id2=>{const list=get_store_value(customList),filteredList=!!(Array.isArray(list)&&list.length>0)&&list.filter((d=>d.id===id2));return filteredList&&filteredList.length>0?filteredList[0]:void 0},getlistValue=id2=>getDefaultlistValue(id2)||getCustomListValue(id2),allList=derived([customList],(([$customList])=>functs.mergeDeep($customList,presetList))),value=derived([valueID],(([$valueID])=>$valueID&&""!==$valueID?getlistValue($valueID):void 0)),awaitForValue=writable(!1),isValueSet=derived([value,valueID,custom.objectValues],(([$presetValues,$presetID,$customValues])=>{const fullPresetValue=void 0!==$presetValues&&"object"==typeof $presetValues&&"value"in $presetValues?functs.mergeDeepById(custom.defaultToExport,$presetValues.value):void 0,valuesAreEqual=void 0!==fullPresetValue&&functs.deepEqual(fullPresetValue,$customValues);valuesAreEqual&&awaitForValue.set(!0);const isSettingId=get_store_value(awaitForValue);return void 0!==$presetID&&isSettingId&&!valuesAreEqual&&reset(),valuesAreEqual}));return{isValidObjStyle:obj=>{if("string"==typeof obj){if(!functs.isJsonString(obj))return!1;obj=functs.jsonToObj(obj)}if(!Array.isArray(obj))return!1;for(const item of obj)if("object"!=typeof item||!("id"in item)||!("value"in item)||"string"!=typeof item.id||!Object.values(filterCustomIds).includes(item.id)||"string"!=typeof item.value&&"number"!=typeof item.value&&"boolean"!=typeof item.value)return!1;return!0},isInDefaultlist:id2=>!!getDefaultlistValue(id2),isInCustomList:id2=>!!getCustomListValue(id2),isInlist:id2=>!!getlistValue(id2),getDefaultlistValue:getDefaultlistValue,getCustomListValue:getCustomListValue,getlistValue:getlistValue,default:"",list:presetList,...value,valueID:valueID,isValueSet:isValueSet,update:preset=>{get_store_value(valueID)===preset.id?valueID.set(""):preset.id&&(valueID.set(preset.id),preset.value&&custom.resetWithValues(preset.value))},addCustom:({name:name2,color:color2,value:value2})=>{let customL=get_store_value(customList);const customIndex=customL.findIndex((d=>d.name===name2));-1!==customIndex?customL[customIndex]={...customL[customIndex],opts:{color:color2},value:value2}:customL=[...customL,{id:name2,name:name2,opts:{color:color2},value:value2}],customList.set(customL)},removeCustom:id2=>{get_store_value(valueID)===id2&&valueID.set("");const newCustomL=get_store_value(customList).filter((d=>d.id!==id2));customList.set(newCustomL)},customList:customList,allList:allList,reset:reset}})();class StylesCSS{constructor({customValues:customValues,presetsValue:presetsValue,selectors:selectors,isHide:isHide,id:id2,document:document2}){__privateAdd(this,_addStyleTagToHeadHtml),__privateAdd(this,_transformDataToCSS),__publicField(this,"customValues"),__publicField(this,"presetsValue"),__publicField(this,"selectors"),__publicField(this,"isHide"),__publicField(this,"id"),__publicField(this,"document"),this.customValues=customValues,this.presetsValue=presetsValue,this.selectors=selectors,this.isHide=isHide,this.id=id2,this.document=document2}addStylesToHTML(){let res;res=this.isHide?"":`${this.selectors.join(", ")} {\n\t\t\t${__privateMethod(this,_transformDataToCSS,transformDataToCSS_fn).call(this)}\n\t\t}`,__privateMethod(this,_addStyleTagToHeadHtml,addStyleTagToHeadHtml_fn).call(this,res)}}_addStyleTagToHeadHtml=new WeakSet,addStyleTagToHeadHtml_fn=function(styleString){let styleElement=this.document.getElementById(this.id);styleElement?styleElement.innerHTML=styleString:(styleElement=this.document.createElement("style"),styleElement.id=this.id,styleElement.innerHTML=styleString,this.document.head.appendChild(styleElement))},_transformDataToCSS=new WeakSet,transformDataToCSS_fn=function(){let boxShadowCSS=`${filterCustomIds.shadowInset} ${filterCustomIds.shadowX} ${filterCustomIds.shadowY} ${filterCustomIds.shadowBlur} ${filterCustomIds.shadowSpread} ${filterCustomIds.shadowColor}`,filterCSS="",borderCSS="";for(const style of this.customValues){const{id:id2,opts:opts,value:value}=style;let unit,op;if((option=>null!==option&&"object"==typeof option&&!Array.isArray(option)&&"unit"in option)(opts)&&(op=opts,"object"==typeof op.unit&&"opts"in op.unit&&"value"in op.unit?unit=op.unit.value:"string"==typeof op.unit&&(unit=op.unit)),unit=unit||"",id2.startsWith(filtersSectionsIds.custom.shadow))boxShadowCSS=filterCustomIds.shadowInset===id2?boxShadowCSS.replace(filterCustomIds.shadowInset,!0===value?"inset":""):boxShadowCSS.replace(id2,`${value}${unit}`);else if(id2.startsWith(filtersSectionsIds.custom.filter)){filterCSS+=`${id2.replace(filtersSectionsIds.custom.filter+"--","")}(${value}${unit}) `}else if(id2.startsWith(filtersSectionsIds.custom.border)){borderCSS+=`border-${id2.replace(filtersSectionsIds.custom.border+"-","")}: ${value}${unit} !important;\n`}}return`box-shadow: ${boxShadowCSS} !important;\n\t\tfilter: ${filterCSS} !important;\n\t\t${borderCSS}`};const styles=(()=>{const sels=(()=>{const defaultValues=["video"];return{default:defaultValues,...writable(defaultValues)}})(),isHide=writable(!1),id2=writable(functs.generateRamdomID());return{...derived([custom.values,presets.valueID,sels,isHide,id2],(([$values,$preset,$selectors,$hide,$id])=>({customValues:$values,presetsValue:$preset,selectors:$selectors,isHide:$hide,id:$id}))),add:opts=>{new StylesCSS(opts).addStylesToHTML()},sels:sels,reset:()=>custom.reset(),hide:()=>{get_store_value(isHide)?isHide.set(!1):isHide.set(!0)},isHide:isHide,id:id2}})(),tabs={...writable(void 0)},section=sectionFunct(Object.values(filtersSectionsIds.more),filtersSectionsIds.more.addPreset),addPresetFunct=()=>{const randomColor=functs.color.getRandom(),isAdded=writable(!1),defaultAddPreset={name:randomColor.name,color:randomColor.value,value:"[]"},addPreset=writable(functs.deepCopy(defaultAddPreset)),update2=(key,value)=>{addPreset.update((prevPreset=>({...prevPreset,[key]:value})))},isInvalidName=derived(addPreset,($addPreset=>"string"!=typeof $addPreset.name||""===$addPreset.name||$addPreset.name.includes(" ")||presets.isInDefaultlist($addPreset.name))),isInvalidValue=derived(addPreset,($addPreset=>!presets.isValidObjStyle($addPreset.value)));return{...addPreset,update:update2,isAdded:isAdded,isInvalidName:isInvalidName,isInvalidValue:isInvalidValue,addFunct:async()=>{const invalidName=get_store_value(isInvalidName),invalidValue=get_store_value(isInvalidValue);if(!invalidName&&!invalidValue){const preset=get_store_value(addPreset);isAdded.set(!0),presets.addCustom({name:preset.name,color:preset.color,value:functs.jsonToObj(preset.value)}),setTimeout((()=>isAdded.set(!1)),2e3),tabs.set(allowedFilterTabs.preset),addPreset.set(functs.deepCopy(defaultAddPreset))}},addCurrConfig:()=>{tabs.set(allowedFilterTabs.more),section.open(filtersSectionsIds.more.addPreset);const currValue=get_store_value(custom.jsonValues);currValue&&update2("value",currValue)}}},copyFunct=()=>{const isCopied=writable(!1),copy=derived(custom.jsonValues,($values=>$values));return{...copy,isCopied:isCopied,copyFunct:async()=>{isCopied.set(!0);const copyValues=get_store_value(copy);await functs.copyText(copyValues),setTimeout((()=>isCopied.set(!1)),2e3)}}},more={section:section,addPreset:addPresetFunct(),copy:copyFunct()},active={...writable(!1)};function create_default_slot_3$1(ctx){let fa,t0,t1,current,t1_value=ctx[1].more.addPresets.btn.title+"";return fa=new Fa({props:{icon:ctx[5]?faCheckCircle:faAdd,class:iconClass$3}}),{c(){create_component(fa.$$.fragment),t0=space(),t1=text(t1_value)},m(target,anchor){mount_component(fa,target,anchor),insert$1(target,t0,anchor),insert$1(target,t1,anchor),current=!0},p(ctx2,dirty){const fa_changes={};32&dirty&&(fa_changes.icon=ctx2[5]?faCheckCircle:faAdd),fa.$set(fa_changes),(!current||2&dirty)&&t1_value!==(t1_value=ctx2[1].more.addPresets.btn.title+"")&&set_data(t1,t1_value)},i(local){current||(transition_in(fa.$$.fragment,local),current=!0)},o(local){transition_out(fa.$$.fragment,local),current=!1},d(detaching){detaching&&(detach(t0),detach(t1)),destroy_component(fa,detaching)}}}function create_if_block_2$5(ctx){let not,updating_onHover,current;function not_onHover_binding(value){ctx[15](value)}let not_props={type:componentTypes.notification.success,$$slots:{default:[create_default_slot_2$4]},$$scope:{ctx:ctx}};return void 0!==ctx[0]&&(not_props.onHover=ctx[0]),not=new Main$1({props:not_props}),binding_callbacks.push((()=>bind(not,"onHover",not_onHover_binding))),{c(){create_component(not.$$.fragment)},m(target,anchor){mount_component(not,target,anchor),current=!0},p(ctx2,dirty){const not_changes={};131074&dirty&&(not_changes.$$scope={dirty:dirty,ctx:ctx2}),!updating_onHover&&1&dirty&&(updating_onHover=!0,not_changes.onHover=ctx2[0],add_flush_callback((()=>updating_onHover=!1))),not.$set(not_changes)},i(local){current||(transition_in(not.$$.fragment,local),current=!0)},o(local){transition_out(not.$$.fragment,local),current=!1},d(detaching){destroy_component(not,detaching)}}}function create_default_slot_2$4(ctx){let t2,t_value=ctx[1].more.addPresets.nots.success+"";return{c(){t2=text(t_value)},m(target,anchor){insert$1(target,t2,anchor)},p(ctx2,dirty){2&dirty&&t_value!==(t_value=ctx2[1].more.addPresets.nots.success+"")&&set_data(t2,t_value)},d(detaching){detaching&&detach(t2)}}}function create_if_block_1$b(ctx){let not,current;return not=new Main$1({props:{type:componentTypes.notification.error,$$slots:{default:[create_default_slot_1$8]},$$scope:{ctx:ctx}}}),{c(){create_component(not.$$.fragment)},m(target,anchor){mount_component(not,target,anchor),current=!0},p(ctx2,dirty){const not_changes={};131074&dirty&&(not_changes.$$scope={dirty:dirty,ctx:ctx2}),not.$set(not_changes)},i(local){current||(transition_in(not.$$.fragment,local),current=!0)},o(local){transition_out(not.$$.fragment,local),current=!1},d(detaching){destroy_component(not,detaching)}}}function create_default_slot_1$8(ctx){let t2,t_value=ctx[1].more.addPresets.nots.errorName+"";return{c(){t2=text(t_value)},m(target,anchor){insert$1(target,t2,anchor)},p(ctx2,dirty){2&dirty&&t_value!==(t_value=ctx2[1].more.addPresets.nots.errorName+"")&&set_data(t2,t_value)},d(detaching){detaching&&detach(t2)}}}function create_if_block$k(ctx){let not,current;return not=new Main$1({props:{type:componentTypes.notification.error,$$slots:{default:[create_default_slot$e]},$$scope:{ctx:ctx}}}),{c(){create_component(not.$$.fragment)},m(target,anchor){mount_component(not,target,anchor),current=!0},p(ctx2,dirty){const not_changes={};131074&dirty&&(not_changes.$$scope={dirty:dirty,ctx:ctx2}),not.$set(not_changes)},i(local){current||(transition_in(not.$$.fragment,local),current=!0)},o(local){transition_out(not.$$.fragment,local),current=!1},d(detaching){destroy_component(not,detaching)}}}function create_default_slot$e(ctx){let t2,t_value=ctx[1].more.addPresets.nots.errorObject+"";return{c(){t2=text(t_value)},m(target,anchor){insert$1(target,t2,anchor)},p(ctx2,dirty){2&dirty&&t_value!==(t_value=ctx2[1].more.addPresets.nots.errorObject+"")&&set_data(t2,t_value)},d(detaching){detaching&&detach(t2)}}}function create_fragment$p(ctx){let title0,t0,div,inputtext,updating_value,t1,inputcolor,updating_value_1,t2,title1,t3,codeeditor,updating_value_2,t4,btn,t5,t6,t7,if_block2_anchor,current;function inputtext_value_binding(value){ctx[11](value)}title0=new Main$8({props:{id:functs.generateRamdomID(),value:ctx[1].more.addPresets.inputName.title,desc:ctx[1].more.addPresets.inputName.desc,customClasses:"text-gray-500 my-2"}});let inputtext_props={placeholder:ctx[1].more.addPresets.inputName.placeholder,customClasses:"w-[90%] "+(ctx[3]?isInvalidTextClass:"")};function inputcolor_value_binding(value){ctx[12](value)}void 0!==ctx[2].name&&(inputtext_props.value=ctx[2].name),inputtext=new Text$1({props:inputtext_props}),binding_callbacks.push((()=>bind(inputtext,"value",inputtext_value_binding)));let inputcolor_props={id:functs.generateRamdomID(),type:componentTypes.colorPicker.nativeAndOpacity,customClasses:"ml-2"};function codeeditor_value_binding(value){ctx[13](value)}void 0!==ctx[2].color&&(inputcolor_props.value=ctx[2].color),inputcolor=new Color_picker({props:inputcolor_props}),binding_callbacks.push((()=>bind(inputcolor,"value",inputcolor_value_binding))),title1=new Main$8({props:{id:functs.generateRamdomID(),value:ctx[1].more.addPresets.inputObject.title,desc:ctx[1].more.addPresets.inputObject.desc,customClasses:"text-gray-500 my-2"}});let codeeditor_props={type:componentTypes.codeEditor.json,readonly:!1,placeholder:ctx[1].more.addPresets.inputObject.placeholder,customClasses:ctx[4]?isInvalidObjClass:""};void 0!==ctx[2].value&&(codeeditor_props.value=ctx[2].value),codeeditor=new Code_editor({props:codeeditor_props}),binding_callbacks.push((()=>bind(codeeditor,"value",codeeditor_value_binding))),btn=new Btn({props:{color:componentTypes.btn.neutral,disabled:!!(ctx[3]||ctx[4]||ctx[5]),active:!1,$$slots:{default:[create_default_slot_3$1]},$$scope:{ctx:ctx}}}),btn.$on("click",ctx[14]);let if_block0=(ctx[5]||ctx[0])&&create_if_block_2$5(ctx),if_block1=ctx[3]&&create_if_block_1$b(ctx),if_block2=ctx[4]&&create_if_block$k(ctx);return{c(){create_component(title0.$$.fragment),t0=space(),div=element("div"),create_component(inputtext.$$.fragment),t1=space(),create_component(inputcolor.$$.fragment),t2=space(),create_component(title1.$$.fragment),t3=space(),create_component(codeeditor.$$.fragment),t4=space(),create_component(btn.$$.fragment),t5=space(),if_block0&&if_block0.c(),t6=space(),if_block1&&if_block1.c(),t7=space(),if_block2&&if_block2.c(),if_block2_anchor=empty$1(),attr(div,"class","flex flex-row items-center")},m(target,anchor){mount_component(title0,target,anchor),insert$1(target,t0,anchor),insert$1(target,div,anchor),mount_component(inputtext,div,null),append(div,t1),mount_component(inputcolor,div,null),insert$1(target,t2,anchor),mount_component(title1,target,anchor),insert$1(target,t3,anchor),mount_component(codeeditor,target,anchor),insert$1(target,t4,anchor),mount_component(btn,target,anchor),insert$1(target,t5,anchor),if_block0&&if_block0.m(target,anchor),insert$1(target,t6,anchor),if_block1&&if_block1.m(target,anchor),insert$1(target,t7,anchor),if_block2&&if_block2.m(target,anchor),insert$1(target,if_block2_anchor,anchor),current=!0},p(ctx2,[dirty]){const title0_changes={};2&dirty&&(title0_changes.value=ctx2[1].more.addPresets.inputName.title),2&dirty&&(title0_changes.desc=ctx2[1].more.addPresets.inputName.desc),title0.$set(title0_changes);const inputtext_changes={};2&dirty&&(inputtext_changes.placeholder=ctx2[1].more.addPresets.inputName.placeholder),8&dirty&&(inputtext_changes.customClasses="w-[90%] "+(ctx2[3]?isInvalidTextClass:"")),!updating_value&&4&dirty&&(updating_value=!0,inputtext_changes.value=ctx2[2].name,add_flush_callback((()=>updating_value=!1))),inputtext.$set(inputtext_changes);const inputcolor_changes={};!updating_value_1&&4&dirty&&(updating_value_1=!0,inputcolor_changes.value=ctx2[2].color,add_flush_callback((()=>updating_value_1=!1))),inputcolor.$set(inputcolor_changes);const title1_changes={};2&dirty&&(title1_changes.value=ctx2[1].more.addPresets.inputObject.title),2&dirty&&(title1_changes.desc=ctx2[1].more.addPresets.inputObject.desc),title1.$set(title1_changes);const codeeditor_changes={};2&dirty&&(codeeditor_changes.placeholder=ctx2[1].more.addPresets.inputObject.placeholder),16&dirty&&(codeeditor_changes.customClasses=ctx2[4]?isInvalidObjClass:""),!updating_value_2&&4&dirty&&(updating_value_2=!0,codeeditor_changes.value=ctx2[2].value,add_flush_callback((()=>updating_value_2=!1))),codeeditor.$set(codeeditor_changes);const btn_changes={};56&dirty&&(btn_changes.disabled=!!(ctx2[3]||ctx2[4]||ctx2[5])),131106&dirty&&(btn_changes.$$scope={dirty:dirty,ctx:ctx2}),btn.$set(btn_changes),ctx2[5]||ctx2[0]?if_block0?(if_block0.p(ctx2,dirty),33&dirty&&transition_in(if_block0,1)):(if_block0=create_if_block_2$5(ctx2),if_block0.c(),transition_in(if_block0,1),if_block0.m(t6.parentNode,t6)):if_block0&&(group_outros(),transition_out(if_block0,1,1,(()=>{if_block0=null})),check_outros()),ctx2[3]?if_block1?(if_block1.p(ctx2,dirty),8&dirty&&transition_in(if_block1,1)):(if_block1=create_if_block_1$b(ctx2),if_block1.c(),transition_in(if_block1,1),if_block1.m(t7.parentNode,t7)):if_block1&&(group_outros(),transition_out(if_block1,1,1,(()=>{if_block1=null})),check_outros()),ctx2[4]?if_block2?(if_block2.p(ctx2,dirty),16&dirty&&transition_in(if_block2,1)):(if_block2=create_if_block$k(ctx2),if_block2.c(),transition_in(if_block2,1),if_block2.m(if_block2_anchor.parentNode,if_block2_anchor)):if_block2&&(group_outros(),transition_out(if_block2,1,1,(()=>{if_block2=null})),check_outros())},i(local){current||(transition_in(title0.$$.fragment,local),transition_in(inputtext.$$.fragment,local),transition_in(inputcolor.$$.fragment,local),transition_in(title1.$$.fragment,local),transition_in(codeeditor.$$.fragment,local),transition_in(btn.$$.fragment,local),transition_in(if_block0),transition_in(if_block1),transition_in(if_block2),current=!0)},o(local){transition_out(title0.$$.fragment,local),transition_out(inputtext.$$.fragment,local),transition_out(inputcolor.$$.fragment,local),transition_out(title1.$$.fragment,local),transition_out(codeeditor.$$.fragment,local),transition_out(btn.$$.fragment,local),transition_out(if_block0),transition_out(if_block1),transition_out(if_block2),current=!1},d(detaching){detaching&&(detach(t0),detach(div),detach(t2),detach(t3),detach(t4),detach(t5),detach(t6),detach(t7),detach(if_block2_anchor)),destroy_component(title0,detaching),destroy_component(inputtext),destroy_component(inputcolor),destroy_component(title1,detaching),destroy_component(codeeditor,detaching),destroy_component(btn,detaching),if_block0&&if_block0.d(detaching),if_block1&&if_block1.d(detaching),if_block2&&if_block2.d(detaching)}}}let iconClass$3="mr-2 text-[10px]",isInvalidTextClass="ring-2 ring-red-500/50 focus:ring-2 focus:ring-red-500/50",isInvalidObjClass="rounded-lg ring-2 ring-red-500/50 focus:ring-2 focus:ring-red-500/50";function instance$p($$self,$$props,$$invalidate){let $locales,$addPreset,$isInvalidName,$isInvalidValue,$isAdded;const{locales:locales2,more:more2}=filters;component_subscribe($$self,locales2,(value=>$$invalidate(1,$locales=value)));const{addPreset:addPreset}=more2;component_subscribe($$self,addPreset,(value=>$$invalidate(2,$addPreset=value)));const{isInvalidName:isInvalidName,isInvalidValue:isInvalidValue,isAdded:isAdded}=addPreset;component_subscribe($$self,isInvalidName,(value=>$$invalidate(3,$isInvalidName=value))),component_subscribe($$self,isInvalidValue,(value=>$$invalidate(4,$isInvalidValue=value))),component_subscribe($$self,isAdded,(value=>$$invalidate(5,$isAdded=value)));let notHover=!1;return[notHover,$locales,$addPreset,$isInvalidName,$isInvalidValue,$isAdded,locales2,addPreset,isInvalidName,isInvalidValue,isAdded,function(value){$$self.$$.not_equal($addPreset.name,value)&&($addPreset.name=value,addPreset.set($addPreset))},function(value){$$self.$$.not_equal($addPreset.color,value)&&($addPreset.color=value,addPreset.set($addPreset))},function(value){$$self.$$.not_equal($addPreset.value,value)&&($addPreset.value=value,addPreset.set($addPreset))},e=>{e.stopPropagation(),addPreset.addFunct()},function(value){notHover=value,$$invalidate(0,notHover)}]}class Add_preset extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$p,create_fragment$p,safe_not_equal,{})}}function create_default_slot_1$7(ctx){let fa,t0,t1,current,t1_value=(ctx[2]?ctx[3].more.copy.btn.onClick:ctx[3].more.copy.btn.title)+"";return fa=new Fa({props:{icon:ctx[2]?faCheckCircle:faCopy,class:iconClass$2}}),{c(){create_component(fa.$$.fragment),t0=space(),t1=text(t1_value)},m(target,anchor){mount_component(fa,target,anchor),insert$1(target,t0,anchor),insert$1(target,t1,anchor),current=!0},p(ctx2,dirty){const fa_changes={};4&dirty&&(fa_changes.icon=ctx2[2]?faCheckCircle:faCopy),fa.$set(fa_changes),(!current||12&dirty)&&t1_value!==(t1_value=(ctx2[2]?ctx2[3].more.copy.btn.onClick:ctx2[3].more.copy.btn.title)+"")&&set_data(t1,t1_value)},i(local){current||(transition_in(fa.$$.fragment,local),current=!0)},o(local){transition_out(fa.$$.fragment,local),current=!1},d(detaching){detaching&&(detach(t0),detach(t1)),destroy_component(fa,detaching)}}}function create_if_block$j(ctx){let not,updating_onHover,current;function not_onHover_binding(value){ctx[8](value)}let not_props={type:componentTypes.notification.success,$$slots:{default:[create_default_slot$d]},$$scope:{ctx:ctx}};return void 0!==ctx[0]&&(not_props.onHover=ctx[0]),not=new Main$1({props:not_props}),binding_callbacks.push((()=>bind(not,"onHover",not_onHover_binding))),{c(){create_component(not.$$.fragment)},m(target,anchor){mount_component(not,target,anchor),current=!0},p(ctx2,dirty){const not_changes={};1032&dirty&&(not_changes.$$scope={dirty:dirty,ctx:ctx2}),!updating_onHover&&1&dirty&&(updating_onHover=!0,not_changes.onHover=ctx2[0],add_flush_callback((()=>updating_onHover=!1))),not.$set(not_changes)},i(local){current||(transition_in(not.$$.fragment,local),current=!0)},o(local){transition_out(not.$$.fragment,local),current=!1},d(detaching){destroy_component(not,detaching)}}}function create_default_slot$d(ctx){let t2,t_value=ctx[3].more.copy.nots.success+"";return{c(){t2=text(t_value)},m(target,anchor){insert$1(target,t2,anchor)},p(ctx2,dirty){8&dirty&&t_value!==(t_value=ctx2[3].more.copy.nots.success+"")&&set_data(t2,t_value)},d(detaching){detaching&&detach(t2)}}}function create_fragment$o(ctx){let codeeditor,t0,btn,t1,if_block_anchor,current;codeeditor=new Code_editor({props:{type:componentTypes.codeEditor.json,readonly:!0,value:ctx[1],height:"180px"}}),btn=new Btn({props:{color:componentTypes.btn.neutral,disabled:!!ctx[2],$$slots:{default:[create_default_slot_1$7]},$$scope:{ctx:ctx}}}),btn.$on("click",ctx[7]);let if_block=(ctx[2]||ctx[0])&&create_if_block$j(ctx);return{c(){create_component(codeeditor.$$.fragment),t0=space(),create_component(btn.$$.fragment),t1=space(),if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){mount_component(codeeditor,target,anchor),insert$1(target,t0,anchor),mount_component(btn,target,anchor),insert$1(target,t1,anchor),if_block&&if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,[dirty]){const codeeditor_changes={};2&dirty&&(codeeditor_changes.value=ctx2[1]),codeeditor.$set(codeeditor_changes);const btn_changes={};4&dirty&&(btn_changes.disabled=!!ctx2[2]),1036&dirty&&(btn_changes.$$scope={dirty:dirty,ctx:ctx2}),btn.$set(btn_changes),ctx2[2]||ctx2[0]?if_block?(if_block.p(ctx2,dirty),5&dirty&&transition_in(if_block,1)):(if_block=create_if_block$j(ctx2),if_block.c(),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block&&(group_outros(),transition_out(if_block,1,1,(()=>{if_block=null})),check_outros())},i(local){current||(transition_in(codeeditor.$$.fragment,local),transition_in(btn.$$.fragment,local),transition_in(if_block),current=!0)},o(local){transition_out(codeeditor.$$.fragment,local),transition_out(btn.$$.fragment,local),transition_out(if_block),current=!1},d(detaching){detaching&&(detach(t0),detach(t1),detach(if_block_anchor)),destroy_component(codeeditor,detaching),destroy_component(btn,detaching),if_block&&if_block.d(detaching)}}}let iconClass$2="mr-2 text-[10px]";function instance$o($$self,$$props,$$invalidate){let $copy,$isCopied,$locales;const{locales:locales2,more:more2}=filters;component_subscribe($$self,locales2,(value=>$$invalidate(3,$locales=value)));const{copy:copy}=more2;component_subscribe($$self,copy,(value=>$$invalidate(1,$copy=value)));const{isCopied:isCopied,copyFunct:copyFunct2}=copy;component_subscribe($$self,isCopied,(value=>$$invalidate(2,$isCopied=value)));let notHover=!1;return[notHover,$copy,$isCopied,$locales,locales2,copy,isCopied,copyFunct2,function(value){notHover=value,$$invalidate(0,notHover)}]}class Copy extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$o,create_fragment$o,safe_not_equal,{})}}function create_default_slot_2$3(ctx){let div,copy,current;return copy=new Copy({}),{c(){div=element("div"),create_component(copy.$$.fragment),attr(div,"class",divSection$1)},m(target,anchor){insert$1(target,div,anchor),mount_component(copy,div,null),current=!0},p:noop,i(local){current||(transition_in(copy.$$.fragment,local),current=!0)},o(local){transition_out(copy.$$.fragment,local),current=!1},d(detaching){detaching&&detach(div),destroy_component(copy)}}}function create_default_slot_1$6(ctx){let div,addpreset,current;return addpreset=new Add_preset({}),{c(){div=element("div"),create_component(addpreset.$$.fragment),attr(div,"class",divSection$1)},m(target,anchor){insert$1(target,div,anchor),mount_component(addpreset,div,null),current=!0},p:noop,i(local){current||(transition_in(addpreset.$$.fragment,local),current=!0)},o(local){transition_out(addpreset.$$.fragment,local),current=!1},d(detaching){detaching&&detach(div),destroy_component(addpreset)}}}function create_default_slot$c(ctx){let t2,accordion,updating_open,current,show_if=ctx[3].ifHasValue(allowedFilterTabs.custom),if_block=show_if&&function(ctx){let accordion,updating_open,current;function accordion_open_binding(value){ctx[5](value)}let accordion_props={type:componentTypes.accordion.item,title:{value:ctx[0].more.copy.title,desc:ctx[0].more.copy.desc},$$slots:{default:[create_default_slot_2$3]},$$scope:{ctx:ctx}};return void 0!==ctx[1][filtersSectionsIds.more.copy]&&(accordion_props.open=ctx[1][filtersSectionsIds.more.copy]),accordion=new Main$6({props:accordion_props}),binding_callbacks.push((()=>bind(accordion,"open",accordion_open_binding))),{c(){create_component(accordion.$$.fragment)},m(target,anchor){mount_component(accordion,target,anchor),current=!0},p(ctx2,dirty){const accordion_changes={};1&dirty&&(accordion_changes.title={value:ctx2[0].more.copy.title,desc:ctx2[0].more.copy.desc}),256&dirty&&(accordion_changes.$$scope={dirty:dirty,ctx:ctx2}),!updating_open&&2&dirty&&(updating_open=!0,accordion_changes.open=ctx2[1][filtersSectionsIds.more.copy],add_flush_callback((()=>updating_open=!1))),accordion.$set(accordion_changes)},i(local){current||(transition_in(accordion.$$.fragment,local),current=!0)},o(local){transition_out(accordion.$$.fragment,local),current=!1},d(detaching){destroy_component(accordion,detaching)}}}(ctx);function accordion_open_binding_1(value){ctx[6](value)}let accordion_props={type:componentTypes.accordion.item,title:{value:ctx[0].more.addPresets.title,desc:ctx[0].more.addPresets.desc},$$slots:{default:[create_default_slot_1$6]},$$scope:{ctx:ctx}};return void 0!==ctx[1][filtersSectionsIds.more.addPreset]&&(accordion_props.open=ctx[1][filtersSectionsIds.more.addPreset]),accordion=new Main$6({props:accordion_props}),binding_callbacks.push((()=>bind(accordion,"open",accordion_open_binding_1))),{c(){if_block&&if_block.c(),t2=space(),create_component(accordion.$$.fragment)},m(target,anchor){if_block&&if_block.m(target,anchor),insert$1(target,t2,anchor),mount_component(accordion,target,anchor),current=!0},p(ctx2,dirty){show_if&&if_block.p(ctx2,dirty);const accordion_changes={};1&dirty&&(accordion_changes.title={value:ctx2[0].more.addPresets.title,desc:ctx2[0].more.addPresets.desc}),256&dirty&&(accordion_changes.$$scope={dirty:dirty,ctx:ctx2}),!updating_open&&2&dirty&&(updating_open=!0,accordion_changes.open=ctx2[1][filtersSectionsIds.more.addPreset],add_flush_callback((()=>updating_open=!1))),accordion.$set(accordion_changes)},i(local){current||(transition_in(if_block),transition_in(accordion.$$.fragment,local),current=!0)},o(local){transition_out(if_block),transition_out(accordion.$$.fragment,local),current=!1},d(detaching){detaching&&detach(t2),if_block&&if_block.d(detaching),destroy_component(accordion,detaching)}}}function create_fragment$n(ctx){let accordion,current;return accordion=new Main$6({props:{type:componentTypes.accordion.section,customClasses:"!px-[2px]",$$slots:{default:[create_default_slot$c]},$$scope:{ctx:ctx}}}),{c(){create_component(accordion.$$.fragment)},m(target,anchor){mount_component(accordion,target,anchor),current=!0},p(ctx2,[dirty]){const accordion_changes={};259&dirty&&(accordion_changes.$$scope={dirty:dirty,ctx:ctx2}),accordion.$set(accordion_changes)},i(local){current||(transition_in(accordion.$$.fragment,local),current=!0)},o(local){transition_out(accordion.$$.fragment,local),current=!1},d(detaching){destroy_component(accordion,detaching)}}}let divSection$1="flex flex-col";function instance$n($$self,$$props,$$invalidate){let $locales,$section;const{locales:locales2,more:more2,items:items2}=filters;component_subscribe($$self,locales2,(value=>$$invalidate(0,$locales=value)));const{section:section2}=more2;return component_subscribe($$self,section2,(value=>$$invalidate(1,$section=value))),[$locales,$section,locales2,items2,section2,function(value){$$self.$$.not_equal($section[filtersSectionsIds.more.copy],value)&&($section[filtersSectionsIds.more.copy]=value,section2.set($section))},function(value){$$self.$$.not_equal($section[filtersSectionsIds.more.addPreset],value)&&($section[filtersSectionsIds.more.addPreset]=value,section2.set($section))}]}let Main$9=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$n,create_fragment$n,safe_not_equal,{})}};function get_each_context$3(ctx,list,i2){const child_ctx=ctx.slice();return child_ctx[8]=list[i2],child_ctx}function create_if_block$h(ctx){let each_1_anchor,current,each_value=ensure_array_like(ctx[2]),each_blocks=[];for(let i2=0;i2<each_value.length;i2+=1)each_blocks[i2]=create_each_block$3(get_each_context$3(ctx,each_value,i2));const out=i2=>transition_out(each_blocks[i2],1,1,(()=>{each_blocks[i2]=null}));return{c(){for(let i2=0;i2<each_blocks.length;i2+=1)each_blocks[i2].c();each_1_anchor=empty$1()},m(target,anchor){for(let i2=0;i2<each_blocks.length;i2+=1)each_blocks[i2]&&each_blocks[i2].m(target,anchor);insert$1(target,each_1_anchor,anchor),current=!0},p(ctx2,dirty){if(39&dirty){let i2;for(each_value=ensure_array_like(ctx2[2]),i2=0;i2<each_value.length;i2+=1){const child_ctx=get_each_context$3(ctx2,each_value,i2);each_blocks[i2]?(each_blocks[i2].p(child_ctx,dirty),transition_in(each_blocks[i2],1)):(each_blocks[i2]=create_each_block$3(child_ctx),each_blocks[i2].c(),transition_in(each_blocks[i2],1),each_blocks[i2].m(each_1_anchor.parentNode,each_1_anchor))}for(group_outros(),i2=each_value.length;i2<each_blocks.length;i2+=1)out(i2);check_outros()}},i(local){if(!current){for(let i2=0;i2<each_value.length;i2+=1)transition_in(each_blocks[i2]);current=!0}},o(local){each_blocks=each_blocks.filter(Boolean);for(let i2=0;i2<each_blocks.length;i2+=1)transition_out(each_blocks[i2]);current=!1},d(detaching){detaching&&detach(each_1_anchor),destroy_each(each_blocks,detaching)}}}function create_default_slot$b(ctx){let t0,t1,t0_value=(ctx[8].name?ctx[8].name:ctx[8].value)+"";return{c(){t0=text(t0_value),t1=space()},m(target,anchor){insert$1(target,t0,anchor),insert$1(target,t1,anchor)},p(ctx2,dirty){4&dirty&&t0_value!==(t0_value=(ctx2[8].name?ctx2[8].name:ctx2[8].value)+"")&&set_data(t0,t0_value)},d(detaching){detaching&&(detach(t0),detach(t1))}}}function create_each_block$3(ctx){let radio_1,updating_group,current;function radio_1_group_binding(value){ctx[6](value)}let radio_1_props={value:ctx[8].value,disabled:!!ctx[5]||ctx[8].disabled,name:ctx[1],$$slots:{default:[create_default_slot$b]},$$scope:{ctx:ctx}};return void 0!==ctx[0]&&(radio_1_props.group=ctx[0]),radio_1=new Radio({props:radio_1_props}),binding_callbacks.push((()=>bind(radio_1,"group",radio_1_group_binding))),{c(){create_component(radio_1.$$.fragment)},m(target,anchor){mount_component(radio_1,target,anchor),current=!0},p(ctx2,dirty){const radio_1_changes={};4&dirty&&(radio_1_changes.value=ctx2[8].value),36&dirty&&(radio_1_changes.disabled=!!ctx2[5]||ctx2[8].disabled),2&dirty&&(radio_1_changes.name=ctx2[1]),2052&dirty&&(radio_1_changes.$$scope={dirty:dirty,ctx:ctx2}),!updating_group&&1&dirty&&(updating_group=!0,radio_1_changes.group=ctx2[0],add_flush_callback((()=>updating_group=!1))),radio_1.$set(radio_1_changes)},i(local){current||(transition_in(radio_1.$$.fragment,local),current=!0)},o(local){transition_out(radio_1.$$.fragment,local),current=!1},d(detaching){destroy_component(radio_1,detaching)}}}function create_fragment$m(ctx){let div,div_class_value,current,show_if=ctx[2]&&Array.isArray(ctx[2]),if_block=show_if&&create_if_block$h(ctx);return{c(){div=element("div"),if_block&&if_block.c(),attr(div,"class",div_class_value="pp-s8-radio-"+ctx[4]+" "+ctx[3])},m(target,anchor){insert$1(target,div,anchor),if_block&&if_block.m(div,null),current=!0},p(ctx2,[dirty]){4&dirty&&(show_if=ctx2[2]&&Array.isArray(ctx2[2])),show_if?if_block?(if_block.p(ctx2,dirty),4&dirty&&transition_in(if_block,1)):(if_block=create_if_block$h(ctx2),if_block.c(),transition_in(if_block,1),if_block.m(div,null)):if_block&&(group_outros(),transition_out(if_block,1,1,(()=>{if_block=null})),check_outros()),(!current||24&dirty&&div_class_value!==(div_class_value="pp-s8-radio-"+ctx2[4]+" "+ctx2[3]))&&attr(div,"class",div_class_value)},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(div),if_block&&if_block.d()}}}function instance$m($$self,$$props,$$invalidate){let{id:id2=""}=$$props,{value:value}=$$props,{opts:opts}=$$props,{customClasses:customClasses=""}=$$props,{type:type2=componentTypes.radio.native}=$$props,{disabled:disabled}=$$props,defaultValue=value;return $$self.$$set=$$props2=>{"id"in $$props2&&$$invalidate(1,id2=$$props2.id),"value"in $$props2&&$$invalidate(0,value=$$props2.value),"opts"in $$props2&&$$invalidate(2,opts=$$props2.opts),"customClasses"in $$props2&&$$invalidate(3,customClasses=$$props2.customClasses),"type"in $$props2&&$$invalidate(4,type2=$$props2.type),"disabled"in $$props2&&$$invalidate(5,disabled=$$props2.disabled)},$$self.$$.update=()=>{if(5&$$self.$$.dirty){let allowedValues=opts?opts.map((opt=>opt.value)):[];$$invalidate(0,value=value&&allowedValues.includes(value)?value:defaultValue)}},[value,id2,opts,customClasses,type2,disabled,function(value$1){value=value$1,$$invalidate(0,value),$$invalidate(2,opts),$$invalidate(7,defaultValue)}]}class Radio_1 extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$m,create_fragment$m,safe_not_equal,{id:1,value:0,opts:2,customClasses:3,type:4,disabled:5})}}function get_each_context$2(ctx,list,i2){const child_ctx=ctx.slice();return child_ctx[8]=list[i2],child_ctx}function create_if_block$g(ctx){let each_1_anchor,each_value=ensure_array_like(ctx[2]),each_blocks=[];for(let i2=0;i2<each_value.length;i2+=1)each_blocks[i2]=create_each_block$2(get_each_context$2(ctx,each_value,i2));return{c(){for(let i2=0;i2<each_blocks.length;i2+=1)each_blocks[i2].c();each_1_anchor=empty$1()},m(target,anchor){for(let i2=0;i2<each_blocks.length;i2+=1)each_blocks[i2]&&each_blocks[i2].m(target,anchor);insert$1(target,each_1_anchor,anchor)},p(ctx2,dirty){if(5&dirty){let i2;for(each_value=ensure_array_like(ctx2[2]),i2=0;i2<each_value.length;i2+=1){const child_ctx=get_each_context$2(ctx2,each_value,i2);each_blocks[i2]?each_blocks[i2].p(child_ctx,dirty):(each_blocks[i2]=create_each_block$2(child_ctx),each_blocks[i2].c(),each_blocks[i2].m(each_1_anchor.parentNode,each_1_anchor))}for(;i2<each_blocks.length;i2+=1)each_blocks[i2].d(1);each_blocks.length=each_value.length}},d(detaching){detaching&&detach(each_1_anchor),destroy_each(each_blocks,detaching)}}}function create_each_block$2(ctx){let option,t0,t1,option_value_value,option_selected_value,option_disabled_value,option_hidden_value,t0_value=(ctx[8].name?ctx[8].name:ctx[8].value)+"";return{c(){option=element("option"),t0=text(t0_value),t1=space(),option.__value=option_value_value=ctx[8].value,set_input_value(option,option.__value),option.selected=option_selected_value=ctx[8].value==ctx[0],option.disabled=option_disabled_value=!!ctx[8].disabled,option.hidden=option_hidden_value=!!ctx[8].hidden},m(target,anchor){insert$1(target,option,anchor),append(option,t0),append(option,t1)},p(ctx2,dirty){4&dirty&&t0_value!==(t0_value=(ctx2[8].name?ctx2[8].name:ctx2[8].value)+"")&&set_data(t0,t0_value),4&dirty&&option_value_value!==(option_value_value=ctx2[8].value)&&(option.__value=option_value_value,set_input_value(option,option.__value)),5&dirty&&option_selected_value!==(option_selected_value=ctx2[8].value==ctx2[0])&&(option.selected=option_selected_value),4&dirty&&option_disabled_value!==(option_disabled_value=!!ctx2[8].disabled)&&(option.disabled=option_disabled_value),4&dirty&&option_hidden_value!==(option_hidden_value=!!ctx2[8].hidden)&&(option.hidden=option_hidden_value)},d(detaching){detaching&&detach(option)}}}function create_fragment$l(ctx){let select,select_class_value,mounted,dispose,if_block=ctx[2]&&create_if_block$g(ctx);return{c(){select=element("select"),if_block&&if_block.c(),attr(select,"id",ctx[1]),attr(select,"class",select_class_value=selectClass+" "+ctx[3]+" "+(ctx[4]?"pp-style-"+ctx[4]:"")+" svelte-ahmuak"),select.disabled=ctx[5],void 0===ctx[0]&&add_render_callback((()=>ctx[6].call(select)))},m(target,anchor){insert$1(target,select,anchor),if_block&&if_block.m(select,null),select_option(select,ctx[0],!0),mounted||(dispose=listen(select,"change",ctx[6]),mounted=!0)},p(ctx2,[dirty]){ctx2[2]?if_block?if_block.p(ctx2,dirty):(if_block=create_if_block$g(ctx2),if_block.c(),if_block.m(select,null)):if_block&&(if_block.d(1),if_block=null),2&dirty&&attr(select,"id",ctx2[1]),24&dirty&&select_class_value!==(select_class_value=selectClass+" "+ctx2[3]+" "+(ctx2[4]?"pp-style-"+ctx2[4]:"")+" svelte-ahmuak")&&attr(select,"class",select_class_value),32&dirty&&(select.disabled=ctx2[5]),5&dirty&&select_option(select,ctx2[0])},i:noop,o:noop,d(detaching){detaching&&detach(select),if_block&&if_block.d(),mounted=!1,dispose()}}}let selectClass="cursor-pointer";function instance$l($$self,$$props,$$invalidate){let{id:id2=""}=$$props,{value:value}=$$props,{opts:opts}=$$props,{customClasses:customClasses=""}=$$props,{type:type2="native"}=$$props,{disabled:disabled}=$$props,defaultValue=value;return $$self.$$set=$$props2=>{"id"in $$props2&&$$invalidate(1,id2=$$props2.id),"value"in $$props2&&$$invalidate(0,value=$$props2.value),"opts"in $$props2&&$$invalidate(2,opts=$$props2.opts),"customClasses"in $$props2&&$$invalidate(3,customClasses=$$props2.customClasses),"type"in $$props2&&$$invalidate(4,type2=$$props2.type),"disabled"in $$props2&&$$invalidate(5,disabled=$$props2.disabled)},$$self.$$.update=()=>{if(5&$$self.$$.dirty){let allowedValues=opts?opts.map((opt=>opt.value)):[];$$invalidate(0,value=value&&allowedValues.includes(value)?value:defaultValue)}},[value,id2,opts,customClasses,type2,disabled,function(){value=function(select){const selected_option=select.querySelector(":checked");return selected_option&&selected_option.__value}(this),$$invalidate(0,value),$$invalidate(2,opts),$$invalidate(7,defaultValue),$$invalidate(2,opts)}]}class Select extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$l,create_fragment$l,safe_not_equal,{id:1,value:0,opts:2,customClasses:3,type:4,disabled:5})}}function create_fragment$k(ctx){let input,input_id_value,input_class_value,input_style_value,mounted,dispose;return{c(){input=element("input"),attr(input,"id",input_id_value=ctx[1]+"-value"),attr(input,"type","number"),attr(input,"step",ctx[5].step),attr(input,"min",ctx[5].min),attr(input,"max",ctx[5].max),attr(input,"class",input_class_value=ctx[2]+" "+(ctx[3]?"pp-style-"+ctx[3]:"")+" svelte-1wrvktt"),attr(input,"style",input_style_value=ctx[3]===componentTypes.number.transparent?`width: ${String(ctx[0]).length}ch`:""),input.disabled=ctx[4]},m(target,anchor){insert$1(target,input,anchor),set_input_value(input,ctx[0]),mounted||(dispose=listen(input,"input",ctx[7]),mounted=!0)},p(ctx2,[dirty]){2&dirty&&input_id_value!==(input_id_value=ctx2[1]+"-value")&&attr(input,"id",input_id_value),12&dirty&&input_class_value!==(input_class_value=ctx2[2]+" "+(ctx2[3]?"pp-style-"+ctx2[3]:"")+" svelte-1wrvktt")&&attr(input,"class",input_class_value),9&dirty&&input_style_value!==(input_style_value=ctx2[3]===componentTypes.number.transparent?`width: ${String(ctx2[0]).length}ch`:"")&&attr(input,"style",input_style_value),16&dirty&&(input.disabled=ctx2[4]),1&dirty&&to_number(input.value)!==ctx2[0]&&set_input_value(input,ctx2[0])},i:noop,o:noop,d(detaching){detaching&&detach(input),mounted=!1,dispose()}}}function instance$k($$self,$$props,$$invalidate){let{opts:opts={max:0,min:100,step:1}}=$$props,{id:id2=""}=$$props,{value:value}=$$props,{customClasses:customClasses=""}=$$props,{type:type2=componentTypes.number.native}=$$props,{disabled:disabled}=$$props,attr2=opts||{max:0,min:100,step:1},defaultValue=value;return $$self.$$set=$$props2=>{"opts"in $$props2&&$$invalidate(6,opts=$$props2.opts),"id"in $$props2&&$$invalidate(1,id2=$$props2.id),"value"in $$props2&&$$invalidate(0,value=$$props2.value),"customClasses"in $$props2&&$$invalidate(2,customClasses=$$props2.customClasses),"type"in $$props2&&$$invalidate(3,type2=$$props2.type),"disabled"in $$props2&&$$invalidate(4,disabled=$$props2.disabled)},$$self.$$.update=()=>{if(1&$$self.$$.dirty){let newValue="number"!=typeof value?defaultValue:value;newValue=newValue<attr2.min?attr2.min:newValue,newValue=newValue>attr2.max?attr2.max:newValue,$$invalidate(0,value=newValue)}},[value,id2,customClasses,type2,disabled,attr2,opts,function(){value=to_number(this.value),$$invalidate(0,value),$$invalidate(8,defaultValue),$$invalidate(5,attr2)}]}let Number$1=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$k,create_fragment$k,safe_not_equal,{opts:6,id:1,value:0,customClasses:2,type:3,disabled:4})}};function create_else_block$5(ctx){let span,t2;return{c(){span=element("span"),t2=text(ctx[0])},m(target,anchor){insert$1(target,span,anchor),append(span,t2)},p(ctx2,dirty){1&dirty&&set_data(t2,ctx2[0])},i:noop,o:noop,d(detaching){detaching&&detach(span)}}}function create_if_block_2$4(ctx){let number2,updating_value,current;function number_value_binding(value){ctx[10](value)}let number_props={id:ctx[1]+"-value",opts:ctx[6],customClasses:classText,type:componentTypes.number.transparent,disabled:ctx[5]};return void 0!==ctx[0]&&(number_props.value=ctx[0]),number2=new Number$1({props:number_props}),binding_callbacks.push((()=>bind(number2,"value",number_value_binding))),{c(){create_component(number2.$$.fragment)},m(target,anchor){mount_component(number2,target,anchor),current=!0},p(ctx2,dirty){const number_changes={};2&dirty&&(number_changes.id=ctx2[1]+"-value"),64&dirty&&(number_changes.opts=ctx2[6]),32&dirty&&(number_changes.disabled=ctx2[5]),!updating_value&&1&dirty&&(updating_value=!0,number_changes.value=ctx2[0],add_flush_callback((()=>updating_value=!1))),number2.$set(number_changes)},i(local){current||(transition_in(number2.$$.fragment,local),current=!0)},o(local){transition_out(number2.$$.fragment,local),current=!1},d(detaching){destroy_component(number2,detaching)}}}function create_if_block_1$a(ctx){let span,t2,t_value=ctx[6].unit+"";return{c(){span=element("span"),t2=text(t_value)},m(target,anchor){insert$1(target,span,anchor),append(span,t2)},p(ctx2,dirty){64&dirty&&t_value!==(t_value=ctx2[6].unit+"")&&set_data(t2,t_value)},i:noop,o:noop,d(detaching){detaching&&detach(span)}}}function create_if_block$f(ctx){let select,updating_value,current;function select_value_binding(value){ctx[11](value)}let select_props={id:ctx[1]+"-unit",opts:ctx[6].unit.opts,customClasses:classText,type:componentTypes.select.transparent,disabled:ctx[5]};return void 0!==ctx[6].unit.value&&(select_props.value=ctx[6].unit.value),select=new Select({props:select_props}),binding_callbacks.push((()=>bind(select,"value",select_value_binding))),{c(){create_component(select.$$.fragment)},m(target,anchor){mount_component(select,target,anchor),current=!0},p(ctx2,dirty){const select_changes={};2&dirty&&(select_changes.id=ctx2[1]+"-unit"),64&dirty&&(select_changes.opts=ctx2[6].unit.opts),32&dirty&&(select_changes.disabled=ctx2[5]),!updating_value&&64&dirty&&(updating_value=!0,select_changes.value=ctx2[6].unit.value,add_flush_callback((()=>updating_value=!1))),select.$set(select_changes)},i(local){current||(transition_in(select.$$.fragment,local),current=!0)},o(local){transition_out(select.$$.fragment,local),current=!1},d(detaching){destroy_component(select,detaching)}}}function create_fragment$j(ctx){let range,updating_value,t0,span,current_block_type_index,if_block0,t1,current_block_type_index_1,if_block1,current;function range_value_binding(value){ctx[9](value)}let range_props={id:ctx[1],step:ctx[6].step,min:ctx[6].min,max:ctx[6].max,class:(ctx[4]===componentTypes.range.native?"pp-s8-range":"")+" "+ctx[3],size:"sm",disabled:ctx[5]};void 0!==ctx[0]&&(range_props.value=ctx[0]),range=new Range$2({props:range_props}),binding_callbacks.push((()=>bind(range,"value",range_value_binding)));const if_block_creators=[create_if_block_2$4,create_else_block$5],if_blocks=[];function select_block_type(ctx2,dirty){return ctx2[2]?0:1}current_block_type_index=select_block_type(ctx),if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);const if_block_creators_1=[create_if_block$f,create_if_block_1$a],if_blocks_1=[];function select_block_type_1(ctx2,dirty){return ctx2[6].unit&&"object"==typeof ctx2[6].unit&&ctx2[6].unit.opts&&ctx2[6].unit.value?0:ctx2[6].unit&&"string"==typeof ctx2[6].unit?1:-1}return~(current_block_type_index_1=select_block_type_1(ctx))&&(if_block1=if_blocks_1[current_block_type_index_1]=if_block_creators_1[current_block_type_index_1](ctx)),{c(){create_component(range.$$.fragment),t0=space(),span=element("span"),if_block0.c(),t1=space(),if_block1&&if_block1.c(),attr(span,"class",ctx[7])},m(target,anchor){mount_component(range,target,anchor),insert$1(target,t0,anchor),insert$1(target,span,anchor),if_blocks[current_block_type_index].m(span,null),append(span,t1),~current_block_type_index_1&&if_blocks_1[current_block_type_index_1].m(span,null),current=!0},p(ctx2,[dirty]){const range_changes={};2&dirty&&(range_changes.id=ctx2[1]),64&dirty&&(range_changes.step=ctx2[6].step),64&dirty&&(range_changes.min=ctx2[6].min),64&dirty&&(range_changes.max=ctx2[6].max),24&dirty&&(range_changes.class=(ctx2[4]===componentTypes.range.native?"pp-s8-range":"")+" "+ctx2[3]),32&dirty&&(range_changes.disabled=ctx2[5]),!updating_value&&1&dirty&&(updating_value=!0,range_changes.value=ctx2[0],add_flush_callback((()=>updating_value=!1))),range.$set(range_changes);let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx2),current_block_type_index===previous_block_index?if_blocks[current_block_type_index].p(ctx2,dirty):(group_outros(),transition_out(if_blocks[previous_block_index],1,1,(()=>{if_blocks[previous_block_index]=null})),check_outros(),if_block0=if_blocks[current_block_type_index],if_block0?if_block0.p(ctx2,dirty):(if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx2),if_block0.c()),transition_in(if_block0,1),if_block0.m(span,t1));let previous_block_index_1=current_block_type_index_1;current_block_type_index_1=select_block_type_1(ctx2),current_block_type_index_1===previous_block_index_1?~current_block_type_index_1&&if_blocks_1[current_block_type_index_1].p(ctx2,dirty):(if_block1&&(group_outros(),transition_out(if_blocks_1[previous_block_index_1],1,1,(()=>{if_blocks_1[previous_block_index_1]=null})),check_outros()),~current_block_type_index_1?(if_block1=if_blocks_1[current_block_type_index_1],if_block1?if_block1.p(ctx2,dirty):(if_block1=if_blocks_1[current_block_type_index_1]=if_block_creators_1[current_block_type_index_1](ctx2),if_block1.c()),transition_in(if_block1,1),if_block1.m(span,null)):if_block1=null)},i(local){current||(transition_in(range.$$.fragment,local),transition_in(if_block0),transition_in(if_block1),current=!0)},o(local){transition_out(range.$$.fragment,local),transition_out(if_block0),transition_out(if_block1),current=!1},d(detaching){detaching&&(detach(t0),detach(span)),destroy_component(range,detaching),if_blocks[current_block_type_index].d(),~current_block_type_index_1&&if_blocks_1[current_block_type_index_1].d()}}}let classText="text-[12px]";function instance$j($$self,$$props,$$invalidate){let{opts:opts}=$$props,{id:id2=""}=$$props,{value:value}=$$props,{inputValue:inputValue=!1}=$$props,{customClasses:customClasses=""}=$$props,{type:type2=componentTypes.range.native}=$$props,{disabled:disabled}=$$props,attr2=opts||{max:0,min:100,step:1},classSpan=`${classText} flex flex-row items-center`;return $$self.$$set=$$props2=>{"opts"in $$props2&&$$invalidate(8,opts=$$props2.opts),"id"in $$props2&&$$invalidate(1,id2=$$props2.id),"value"in $$props2&&$$invalidate(0,value=$$props2.value),"inputValue"in $$props2&&$$invalidate(2,inputValue=$$props2.inputValue),"customClasses"in $$props2&&$$invalidate(3,customClasses=$$props2.customClasses),"type"in $$props2&&$$invalidate(4,type2=$$props2.type),"disabled"in $$props2&&$$invalidate(5,disabled=$$props2.disabled)},[value,id2,inputValue,customClasses,type2,disabled,attr2,classSpan,opts,function(value$1){value=value$1,$$invalidate(0,value)},function(value$1){value=value$1,$$invalidate(0,value)},function(value2){$$self.$$.not_equal(attr2.unit.value,value2)&&(attr2.unit.value=value2,$$invalidate(6,attr2))}]}class Range_1 extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$j,create_fragment$j,safe_not_equal,{opts:8,id:1,value:0,inputValue:2,customClasses:3,type:4,disabled:5})}}function create_if_block_1$9(ctx){let input,input_class_value,mounted,dispose;return{c(){input=element("input"),attr(input,"type","checkbox"),attr(input,"id",ctx[2]),attr(input,"class",input_class_value=inputClass$2+" "+ctx[1]),input.disabled=ctx[3]},m(target,anchor){insert$1(target,input,anchor),input.checked=ctx[0],mounted||(dispose=listen(input,"change",ctx[6]),mounted=!0)},p(ctx2,dirty){4&dirty&&attr(input,"id",ctx2[2]),2&dirty&&input_class_value!==(input_class_value=inputClass$2+" "+ctx2[1])&&attr(input,"class",input_class_value),8&dirty&&(input.disabled=ctx2[3]),1&dirty&&(input.checked=ctx2[0])},i:noop,o:noop,d(detaching){detaching&&detach(input),mounted=!1,dispose()}}}function create_if_block$e(ctx){let toggle,updating_checked,current;function toggle_checked_binding(value){ctx[5](value)}let toggle_props={id:ctx[2],class:inputClass$2+" "+ctx[1],size:"small",disabled:ctx[3]};return void 0!==ctx[0]&&(toggle_props.checked=ctx[0]),toggle=new Toggle({props:toggle_props}),binding_callbacks.push((()=>bind(toggle,"checked",toggle_checked_binding))),{c(){create_component(toggle.$$.fragment)},m(target,anchor){mount_component(toggle,target,anchor),current=!0},p(ctx2,dirty){const toggle_changes={};4&dirty&&(toggle_changes.id=ctx2[2]),2&dirty&&(toggle_changes.class=inputClass$2+" "+ctx2[1]),8&dirty&&(toggle_changes.disabled=ctx2[3]),!updating_checked&&1&dirty&&(updating_checked=!0,toggle_changes.checked=ctx2[0],add_flush_callback((()=>updating_checked=!1))),toggle.$set(toggle_changes)},i(local){current||(transition_in(toggle.$$.fragment,local),current=!0)},o(local){transition_out(toggle.$$.fragment,local),current=!1},d(detaching){destroy_component(toggle,detaching)}}}function create_fragment$i(ctx){let current_block_type_index,if_block,if_block_anchor,current;const if_block_creators=[create_if_block$e,create_if_block_1$9],if_blocks=[];function select_block_type(ctx2,dirty){return ctx2[4]===componentTypes.checkbox.toggle?0:ctx2[4]===componentTypes.checkbox.native?1:-1}return~(current_block_type_index=select_block_type(ctx))&&(if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx)),{c(){if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){~current_block_type_index&&if_blocks[current_block_type_index].m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,[dirty]){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx2),current_block_type_index===previous_block_index?~current_block_type_index&&if_blocks[current_block_type_index].p(ctx2,dirty):(if_block&&(group_outros(),transition_out(if_blocks[previous_block_index],1,1,(()=>{if_blocks[previous_block_index]=null})),check_outros()),~current_block_type_index?(if_block=if_blocks[current_block_type_index],if_block?if_block.p(ctx2,dirty):(if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx2),if_block.c()),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block=null)},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(if_block_anchor),~current_block_type_index&&if_blocks[current_block_type_index].d(detaching)}}}let inputClass$2="cursor-pointer";function instance$i($$self,$$props,$$invalidate){let{customClasses:customClasses=""}=$$props,{id:id2=""}=$$props,{value:value}=$$props,{disabled:disabled}=$$props,{type:type2=componentTypes.checkbox.toggle}=$$props;return $$self.$$set=$$props2=>{"customClasses"in $$props2&&$$invalidate(1,customClasses=$$props2.customClasses),"id"in $$props2&&$$invalidate(2,id2=$$props2.id),"value"in $$props2&&$$invalidate(0,value=$$props2.value),"disabled"in $$props2&&$$invalidate(3,disabled=$$props2.disabled),"type"in $$props2&&$$invalidate(4,type2=$$props2.type)},[value,customClasses,id2,disabled,type2,function(value$1){value=value$1,$$invalidate(0,value)},function(){value=this.checked,$$invalidate(0,value)}]}class Checkbox extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$i,create_fragment$i,safe_not_equal,{customClasses:1,id:2,value:0,disabled:3,type:4})}}function create_if_block_1$8(ctx){let input,input_class_value,t2,popover,current,mounted,dispose;return popover=new Popover({props:{triggeredBy:"#"+ctx[2],$$slots:{default:[create_default_slot$a]},$$scope:{ctx:ctx}}}),{c(){input=element("input"),t2=space(),create_component(popover.$$.fragment),attr(input,"id",ctx[2]),attr(input,"class",input_class_value="w-[27px] h-[27px] rounded-full border border-gray-700 text-[0px] "+inputClass$1+" "+ctx[1]),set_style(input,"background-color",ctx[0]),set_style(input,"font-size","0px"),input.disabled=ctx[3]},m(target,anchor){insert$1(target,input,anchor),set_input_value(input,ctx[0]),insert$1(target,t2,anchor),mount_component(popover,target,anchor),current=!0,mounted||(dispose=listen(input,"input",ctx[8]),mounted=!0)},p(ctx2,dirty){(!current||4&dirty)&&attr(input,"id",ctx2[2]),(!current||2&dirty&&input_class_value!==(input_class_value="w-[27px] h-[27px] rounded-full border border-gray-700 text-[0px] "+inputClass$1+" "+ctx2[1]))&&attr(input,"class",input_class_value),(!current||1&dirty)&&set_style(input,"background-color",ctx2[0]),(!current||8&dirty)&&(input.disabled=ctx2[3]),1&dirty&&input.value!==ctx2[0]&&set_input_value(input,ctx2[0]);const popover_changes={};4&dirty&&(popover_changes.triggeredBy="#"+ctx2[2]),2156&dirty&&(popover_changes.$$scope={dirty:dirty,ctx:ctx2}),popover.$set(popover_changes)},i(local){current||(transition_in(popover.$$.fragment,local),current=!0)},o(local){transition_out(popover.$$.fragment,local),current=!1},d(detaching){detaching&&(detach(input),detach(t2)),destroy_component(popover,detaching),mounted=!1,dispose()}}}function create_if_block$d(ctx){let input,input_class_value,mounted,dispose;return{c(){input=element("input"),attr(input,"type","color"),attr(input,"id",ctx[2]),attr(input,"class",input_class_value="colorpicker circle w-[30px] h-[32px]"+inputClass$1+" "+ctx[1]+" svelte-euq75z"),input.disabled=ctx[3]},m(target,anchor){insert$1(target,input,anchor),set_input_value(input,ctx[0]),mounted||(dispose=[listen(input,"input",ctx[7]),listen(input,"click",click_handler)],mounted=!0)},p(ctx2,dirty){4&dirty&&attr(input,"id",ctx2[2]),2&dirty&&input_class_value!==(input_class_value="colorpicker circle w-[30px] h-[32px]"+inputClass$1+" "+ctx2[1]+" svelte-euq75z")&&attr(input,"class",input_class_value),8&dirty&&(input.disabled=ctx2[3]),1&dirty&&set_input_value(input,ctx2[0])},i:noop,o:noop,d(detaching){detaching&&detach(input),mounted=!1,run_all(dispose)}}}function create_default_slot$a(ctx){let input,input_id_value,t2,div,range,updating_value,current,mounted,dispose;function range_value_binding(value){ctx[10](value)}let range_props={id:ctx[2]+"-opacity",opts:{min:0,max:100,step:1,unit:"%"},inputValue:!0,customClasses:"mx-2"};return void 0!==ctx[5]&&(range_props.value=ctx[5]),range=new Range_1({props:range_props}),binding_callbacks.push((()=>bind(range,"value",range_value_binding))),{c(){input=element("input"),t2=space(),div=element("div"),create_component(range.$$.fragment),attr(input,"type","color"),attr(input,"id",input_id_value=ctx[2]+"-color"),attr(input,"class","colorpicker rounded h-[20px] w-full !ring-1 svelte-euq75z"),set_style(input,"background-color",ctx[6]),set_style(input,"--tw-ring-color",functs.color.getHexDarken(ctx[6])),input.disabled=ctx[3],attr(div,"class","flex flex-row items-center")},m(target,anchor){insert$1(target,input,anchor),set_input_value(input,ctx[6]),insert$1(target,t2,anchor),insert$1(target,div,anchor),mount_component(range,div,null),current=!0,mounted||(dispose=[listen(input,"input",ctx[9]),listen(input,"click",click_handler_1)],mounted=!0)},p(ctx2,dirty){(!current||4&dirty&&input_id_value!==(input_id_value=ctx2[2]+"-color"))&&attr(input,"id",input_id_value),(!current||64&dirty)&&set_style(input,"background-color",ctx2[6]),(!current||64&dirty)&&set_style(input,"--tw-ring-color",functs.color.getHexDarken(ctx2[6])),(!current||8&dirty)&&(input.disabled=ctx2[3]),64&dirty&&set_input_value(input,ctx2[6]);const range_changes={};4&dirty&&(range_changes.id=ctx2[2]+"-opacity"),!updating_value&&32&dirty&&(updating_value=!0,range_changes.value=ctx2[5],add_flush_callback((()=>updating_value=!1))),range.$set(range_changes)},i(local){current||(transition_in(range.$$.fragment,local),current=!0)},o(local){transition_out(range.$$.fragment,local),current=!1},d(detaching){detaching&&(detach(input),detach(t2),detach(div)),destroy_component(range),mounted=!1,run_all(dispose)}}}function create_fragment$h(ctx){let current_block_type_index,if_block,if_block_anchor,current;const if_block_creators=[create_if_block$d,create_if_block_1$8],if_blocks=[];function select_block_type(ctx2,dirty){return ctx2[4]===componentTypes.colorPicker.native?0:ctx2[4]===componentTypes.colorPicker.nativeAndOpacity?1:-1}return~(current_block_type_index=select_block_type(ctx))&&(if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx)),{c(){if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){~current_block_type_index&&if_blocks[current_block_type_index].m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,[dirty]){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx2),current_block_type_index===previous_block_index?~current_block_type_index&&if_blocks[current_block_type_index].p(ctx2,dirty):(if_block&&(group_outros(),transition_out(if_blocks[previous_block_index],1,1,(()=>{if_blocks[previous_block_index]=null})),check_outros()),~current_block_type_index?(if_block=if_blocks[current_block_type_index],if_block?if_block.p(ctx2,dirty):(if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx2),if_block.c()),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block=null)},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(if_block_anchor),~current_block_type_index&&if_blocks[current_block_type_index].d(detaching)}}}let inputClass$1="cursor-pointer";const click_handler=e=>e.stopPropagation(),click_handler_1=e=>e.stopPropagation();function instance$h($$self,$$props,$$invalidate){let{customClasses:customClasses=""}=$$props,{id:id2=""}=$$props,{value:value}=$$props,{disabled:disabled=!1}=$$props,{type:type2=componentTypes.colorPicker.native}=$$props,opacityValue=100*functs.color.getOpacity(value)||100,hexValue=functs.color.toHexWithoutOpacity(value);return $$self.$$set=$$props2=>{"customClasses"in $$props2&&$$invalidate(1,customClasses=$$props2.customClasses),"id"in $$props2&&$$invalidate(2,id2=$$props2.id),"value"in $$props2&&$$invalidate(0,value=$$props2.value),"disabled"in $$props2&&$$invalidate(3,disabled=$$props2.disabled),"type"in $$props2&&$$invalidate(4,type2=$$props2.type)},$$self.$$.update=()=>{112&$$self.$$.dirty&&type2===componentTypes.colorPicker.nativeAndOpacity&&$$invalidate(0,value=functs.color.toRgba(hexValue,opacityValue))},[value,customClasses,id2,disabled,type2,opacityValue,hexValue,function(){value=this.value,$$invalidate(0,value),$$invalidate(4,type2),$$invalidate(6,hexValue),$$invalidate(5,opacityValue)},function(){value=this.value,$$invalidate(0,value),$$invalidate(4,type2),$$invalidate(6,hexValue),$$invalidate(5,opacityValue)},function(){hexValue=this.value,$$invalidate(6,hexValue)},function(value2){opacityValue=value2,$$invalidate(5,opacityValue)}]}class Color_picker extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$h,create_fragment$h,safe_not_equal,{customClasses:1,id:2,value:0,disabled:3,type:4})}}function create_fragment$g(ctx){let input,input_class_value,input_style_value,mounted,dispose;return{c(){input=element("input"),attr(input,"id",ctx[1]),attr(input,"type","text"),attr(input,"class",input_class_value=inputClass+" "+(ctx[3]?"pp-style-"+ctx[3]:"")+" "+ctx[2]+" svelte-1uoeq7r"),attr(input,"style",input_style_value=ctx[3]===componentTypes.text.transparent?`width: ${String(ctx[0]).length}ch`:""),input.disabled=ctx[4],attr(input,"placeholder",ctx[5])},m(target,anchor){insert$1(target,input,anchor),set_input_value(input,ctx[0]),mounted||(dispose=listen(input,"input",ctx[6]),mounted=!0)},p(ctx2,[dirty]){2&dirty&&attr(input,"id",ctx2[1]),12&dirty&&input_class_value!==(input_class_value=inputClass+" "+(ctx2[3]?"pp-style-"+ctx2[3]:"")+" "+ctx2[2]+" svelte-1uoeq7r")&&attr(input,"class",input_class_value),9&dirty&&input_style_value!==(input_style_value=ctx2[3]===componentTypes.text.transparent?`width: ${String(ctx2[0]).length}ch`:"")&&attr(input,"style",input_style_value),16&dirty&&(input.disabled=ctx2[4]),32&dirty&&attr(input,"placeholder",ctx2[5]),1&dirty&&input.value!==ctx2[0]&&set_input_value(input,ctx2[0])},i:noop,o:noop,d(detaching){detaching&&detach(input),mounted=!1,dispose()}}}let inputClass="bg-gray-200/50 dark:bg-gray-800 border-none rounded-lg focus:ring-primary-500 focus:border-primary-500 py-1 px-2";function instance$g($$self,$$props,$$invalidate){let{id:id2=""}=$$props,{value:value}=$$props,{customClasses:customClasses=""}=$$props,{type:type2=componentTypes.text.native}=$$props,{disabled:disabled}=$$props,{placeholder:placeholder2=""}=$$props;return $$self.$$set=$$props2=>{"id"in $$props2&&$$invalidate(1,id2=$$props2.id),"value"in $$props2&&$$invalidate(0,value=$$props2.value),"customClasses"in $$props2&&$$invalidate(2,customClasses=$$props2.customClasses),"type"in $$props2&&$$invalidate(3,type2=$$props2.type),"disabled"in $$props2&&$$invalidate(4,disabled=$$props2.disabled),"placeholder"in $$props2&&$$invalidate(5,placeholder2=$$props2.placeholder)},[value,id2,customClasses,type2,disabled,placeholder2,function(){value=this.value,$$invalidate(0,value)}]}let Text$1=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$g,create_fragment$g,safe_not_equal,{id:1,value:0,customClasses:2,type:3,disabled:4,placeholder:5})}};class Text{lineAt(pos){if(pos<0||pos>this.length)throw new RangeError(`Invalid position ${pos} in document of length ${this.length}`);return this.lineInner(pos,!1,1,0)}line(n){if(n<1||n>this.lines)throw new RangeError(`Invalid line number ${n} in ${this.lines}-line document`);return this.lineInner(n,!0,1,0)}replace(from,to,text2){let parts=[];return this.decompose(0,from,parts,2),text2.length&&text2.decompose(0,text2.length,parts,3),this.decompose(to,this.length,parts,1),TextNode.from(parts,this.length-(to-from)+text2.length)}append(other){return this.replace(this.length,this.length,other)}slice(from,to=this.length){let parts=[];return this.decompose(from,to,parts,0),TextNode.from(parts,to-from)}eq(other){if(other==this)return!0;if(other.length!=this.length||other.lines!=this.lines)return!1;let start2=this.scanIdentical(other,1),end2=this.length-this.scanIdentical(other,-1),a=new RawTextCursor(this),b=new RawTextCursor(other);for(let skip=start2,pos=start2;;){if(a.next(skip),b.next(skip),skip=0,a.lineBreak!=b.lineBreak||a.done!=b.done||a.value!=b.value)return!1;if(pos+=a.value.length,a.done||pos>=end2)return!0}}iter(dir=1){return new RawTextCursor(this,dir)}iterRange(from,to=this.length){return new PartialTextCursor(this,from,to)}iterLines(from,to){let inner;if(null==from)inner=this.iter();else{null==to&&(to=this.lines+1);let start2=this.line(from).from;inner=this.iterRange(start2,Math.max(start2,to==this.lines+1?this.length:to<=1?0:this.line(to-1).to))}return new LineCursor(inner)}toString(){return this.sliceString(0)}toJSON(){let lines=[];return this.flatten(lines),lines}constructor(){}static of(text2){if(0==text2.length)throw new RangeError("A document must have at least one line");return 1!=text2.length||text2[0]?text2.length<=32?new TextLeaf(text2):TextNode.from(TextLeaf.split(text2,[])):Text.empty}}class TextLeaf extends Text{constructor(text2,length=function(text2){let length=-1;for(let line of text2)length+=line.length+1;return length}(text2)){super(),this.text=text2,this.length=length}get lines(){return this.text.length}get children(){return null}lineInner(target,isLine,line,offset2){for(let i2=0;;i2++){let string2=this.text[i2],end2=offset2+string2.length;if((isLine?line:end2)>=target)return new Line(offset2,end2,line,string2);offset2=end2+1,line++}}decompose(from,to,target,open){let text2=from<=0&&to>=this.length?this:new TextLeaf(sliceText(this.text,from,to),Math.min(to,this.length)-Math.max(0,from));if(1&open){let prev=target.pop(),joined=appendText(text2.text,prev.text.slice(),0,text2.length);if(joined.length<=32)target.push(new TextLeaf(joined,prev.length+text2.length));else{let mid=joined.length>>1;target.push(new TextLeaf(joined.slice(0,mid)),new TextLeaf(joined.slice(mid)))}}else target.push(text2)}replace(from,to,text2){if(!(text2 instanceof TextLeaf))return super.replace(from,to,text2);let lines=appendText(this.text,appendText(text2.text,sliceText(this.text,0,from)),to),newLen=this.length+text2.length-(to-from);return lines.length<=32?new TextLeaf(lines,newLen):TextNode.from(TextLeaf.split(lines,[]),newLen)}sliceString(from,to=this.length,lineSep="\n"){let result="";for(let pos=0,i2=0;pos<=to&&i2<this.text.length;i2++){let line=this.text[i2],end2=pos+line.length;pos>from&&i2&&(result+=lineSep),from<end2&&to>pos&&(result+=line.slice(Math.max(0,from-pos),to-pos)),pos=end2+1}return result}flatten(target){for(let line of this.text)target.push(line)}scanIdentical(){return 0}static split(text2,target){let part=[],len=-1;for(let line of text2)part.push(line),len+=line.length+1,32==part.length&&(target.push(new TextLeaf(part,len)),part=[],len=-1);return len>-1&&target.push(new TextLeaf(part,len)),target}}class TextNode extends Text{constructor(children2,length){super(),this.children=children2,this.length=length,this.lines=0;for(let child of children2)this.lines+=child.lines}lineInner(target,isLine,line,offset2){for(let i2=0;;i2++){let child=this.children[i2],end2=offset2+child.length,endLine=line+child.lines-1;if((isLine?endLine:end2)>=target)return child.lineInner(target,isLine,line,offset2);offset2=end2+1,line=endLine+1}}decompose(from,to,target,open){for(let i2=0,pos=0;pos<=to&&i2<this.children.length;i2++){let child=this.children[i2],end2=pos+child.length;if(from<=end2&&to>=pos){let childOpen=open&((pos<=from?1:0)|(end2>=to?2:0));pos>=from&&end2<=to&&!childOpen?target.push(child):child.decompose(from-pos,to-pos,target,childOpen)}pos=end2+1}}replace(from,to,text2){if(text2.lines<this.lines)for(let i2=0,pos=0;i2<this.children.length;i2++){let child=this.children[i2],end2=pos+child.length;if(from>=pos&&to<=end2){let updated=child.replace(from-pos,to-pos,text2),totalLines=this.lines-child.lines+updated.lines;if(updated.lines<totalLines>>4&&updated.lines>totalLines>>6){let copy=this.children.slice();return copy[i2]=updated,new TextNode(copy,this.length-(to-from)+text2.length)}return super.replace(pos,end2,updated)}pos=end2+1}return super.replace(from,to,text2)}sliceString(from,to=this.length,lineSep="\n"){let result="";for(let i2=0,pos=0;i2<this.children.length&&pos<=to;i2++){let child=this.children[i2],end2=pos+child.length;pos>from&&i2&&(result+=lineSep),from<end2&&to>pos&&(result+=child.sliceString(from-pos,to-pos,lineSep)),pos=end2+1}return result}flatten(target){for(let child of this.children)child.flatten(target)}scanIdentical(other,dir){if(!(other instanceof TextNode))return 0;let length=0,[iA,iB,eA,eB]=dir>0?[0,0,this.children.length,other.children.length]:[this.children.length-1,other.children.length-1,-1,-1];for(;;iA+=dir,iB+=dir){if(iA==eA||iB==eB)return length;let chA=this.children[iA],chB=other.children[iB];if(chA!=chB)return length+chA.scanIdentical(chB,dir);length+=chA.length+1}}static from(children2,length=children2.reduce(((l,ch)=>l+ch.length+1),-1)){let lines=0;for(let ch of children2)lines+=ch.lines;if(lines<32){let flat=[];for(let ch of children2)ch.flatten(flat);return new TextLeaf(flat,length)}let chunk=Math.max(32,lines>>5),maxChunk=chunk<<1,minChunk=chunk>>1,chunked=[],currentLines=0,currentLen=-1,currentChunk=[];function add2(child){let last;if(child.lines>maxChunk&&child instanceof TextNode)for(let node of child.children)add2(node);else child.lines>minChunk&&(currentLines>minChunk||!currentLines)?(flush2(),chunked.push(child)):child instanceof TextLeaf&&currentLines&&(last=currentChunk[currentChunk.length-1])instanceof TextLeaf&&child.lines+last.lines<=32?(currentLines+=child.lines,currentLen+=child.length+1,currentChunk[currentChunk.length-1]=new TextLeaf(last.text.concat(child.text),last.length+1+child.length)):(currentLines+child.lines>chunk&&flush2(),currentLines+=child.lines,currentLen+=child.length+1,currentChunk.push(child))}function flush2(){0!=currentLines&&(chunked.push(1==currentChunk.length?currentChunk[0]:TextNode.from(currentChunk,currentLen)),currentLen=-1,currentLines=currentChunk.length=0)}for(let child of children2)add2(child);return flush2(),1==chunked.length?chunked[0]:new TextNode(chunked,length)}}function appendText(text2,target,from=0,to=1e9){for(let pos=0,i2=0,first=!0;i2<text2.length&&pos<=to;i2++){let line=text2[i2],end2=pos+line.length;end2>=from&&(end2>to&&(line=line.slice(0,to-pos)),pos<from&&(line=line.slice(from-pos)),first?(target[target.length-1]+=line,first=!1):target.push(line)),pos=end2+1}return target}function sliceText(text2,from,to){return appendText(text2,[""],from,to)}Text.empty=new TextLeaf([""],0);class RawTextCursor{constructor(text2,dir=1){this.dir=dir,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[text2],this.offsets=[dir>0?1:(text2 instanceof TextLeaf?text2.text.length:text2.children.length)<<1]}nextInner(skip,dir){for(this.done=this.lineBreak=!1;;){let last=this.nodes.length-1,top2=this.nodes[last],offsetValue=this.offsets[last],offset2=offsetValue>>1,size=top2 instanceof TextLeaf?top2.text.length:top2.children.length;if(offset2==(dir>0?size:0)){if(0==last)return this.done=!0,this.value="",this;dir>0&&this.offsets[last-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&offsetValue)==(dir>0?0:1)){if(this.offsets[last]+=dir,0==skip)return this.lineBreak=!0,this.value="\n",this;skip--}else if(top2 instanceof TextLeaf){let next=top2.text[offset2+(dir<0?-1:0)];if(this.offsets[last]+=dir,next.length>Math.max(0,skip))return this.value=0==skip?next:dir>0?next.slice(skip):next.slice(0,next.length-skip),this;skip-=next.length}else{let next=top2.children[offset2+(dir<0?-1:0)];skip>next.length?(skip-=next.length,this.offsets[last]+=dir):(dir<0&&this.offsets[last]--,this.nodes.push(next),this.offsets.push(dir>0?1:(next instanceof TextLeaf?next.text.length:next.children.length)<<1))}}}next(skip=0){return skip<0&&(this.nextInner(-skip,-this.dir),skip=this.value.length),this.nextInner(skip,this.dir)}}class PartialTextCursor{constructor(text2,start2,end2){this.value="",this.done=!1,this.cursor=new RawTextCursor(text2,start2>end2?-1:1),this.pos=start2>end2?text2.length:0,this.from=Math.min(start2,end2),this.to=Math.max(start2,end2)}nextInner(skip,dir){if(dir<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;skip+=Math.max(0,dir<0?this.pos-this.to:this.from-this.pos);let limit=dir<0?this.pos-this.from:this.to-this.pos;skip>limit&&(skip=limit),limit-=skip;let{value:value}=this.cursor.next(skip);return this.pos+=(value.length+skip)*dir,this.value=value.length<=limit?value:dir<0?value.slice(value.length-limit):value.slice(0,limit),this.done=!this.value,this}next(skip=0){return skip<0?skip=Math.max(skip,this.from-this.pos):skip>0&&(skip=Math.min(skip,this.to-this.pos)),this.nextInner(skip,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class LineCursor{constructor(inner){this.inner=inner,this.afterBreak=!0,this.value="",this.done=!1}next(skip=0){let{done:done,lineBreak:lineBreak,value:value}=this.inner.next(skip);return done?(this.done=!0,this.value=""):lineBreak?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=value,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(Text.prototype[Symbol.iterator]=function(){return this.iter()},RawTextCursor.prototype[Symbol.iterator]=PartialTextCursor.prototype[Symbol.iterator]=LineCursor.prototype[Symbol.iterator]=function(){return this});class Line{constructor(from,to,number2,text2){this.from=from,this.to=to,this.number=number2,this.text=text2}get length(){return this.to-this.from}}let extend="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((s=>s?parseInt(s,36):1));for(let i2=1;i2<extend.length;i2++)extend[i2]+=extend[i2-1];function isExtendingChar(code2){for(let i2=1;i2<extend.length;i2+=2)if(extend[i2]>code2)return extend[i2-1]<=code2;return!1}function isRegionalIndicator(code2){return code2>=127462&&code2<=127487}const ZWJ=8205;function findClusterBreak(str,pos,forward=!0,includeExtending=!0){return(forward?nextClusterBreak:prevClusterBreak)(str,pos,includeExtending)}function nextClusterBreak(str,pos,includeExtending){if(pos==str.length)return pos;pos&&surrogateLow(str.charCodeAt(pos))&&surrogateHigh(str.charCodeAt(pos-1))&&pos--;let prev=codePointAt(str,pos);for(pos+=codePointSize(prev);pos<str.length;){let next=codePointAt(str,pos);if(prev==ZWJ||next==ZWJ||includeExtending&&isExtendingChar(next))pos+=codePointSize(next),prev=next;else{if(!isRegionalIndicator(next))break;{let countBefore=0,i2=pos-2;for(;i2>=0&&isRegionalIndicator(codePointAt(str,i2));)countBefore++,i2-=2;if(countBefore%2==0)break;pos+=2}}}return pos}function prevClusterBreak(str,pos,includeExtending){for(;pos>0;){let found=nextClusterBreak(str,pos-2,includeExtending);if(found<pos)return found;pos--}return 0}function surrogateLow(ch){return ch>=56320&&ch<57344}function surrogateHigh(ch){return ch>=55296&&ch<56320}function codePointAt(str,pos){let code0=str.charCodeAt(pos);if(!surrogateHigh(code0)||pos+1==str.length)return code0;let code1=str.charCodeAt(pos+1);return surrogateLow(code1)?code1-56320+(code0-55296<<10)+65536:code0}function fromCodePoint(code2){return code2<=65535?String.fromCharCode(code2):(code2-=65536,String.fromCharCode(55296+(code2>>10),56320+(1023&code2)))}function codePointSize(code2){return code2<65536?1:2}const DefaultSplit=/\r\n?|\n/;var MapMode=function(MapMode2){return MapMode2[MapMode2.Simple=0]="Simple",MapMode2[MapMode2.TrackDel=1]="TrackDel",MapMode2[MapMode2.TrackBefore=2]="TrackBefore",MapMode2[MapMode2.TrackAfter=3]="TrackAfter",MapMode2}(MapMode||(MapMode={}));class ChangeDesc{constructor(sections){this.sections=sections}get length(){let result=0;for(let i2=0;i2<this.sections.length;i2+=2)result+=this.sections[i2];return result}get newLength(){let result=0;for(let i2=0;i2<this.sections.length;i2+=2){let ins=this.sections[i2+1];result+=ins<0?this.sections[i2]:ins}return result}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(f){for(let i2=0,posA=0,posB=0;i2<this.sections.length;){let len=this.sections[i2++],ins=this.sections[i2++];ins<0?(f(posA,posB,len),posB+=len):posB+=ins,posA+=len}}iterChangedRanges(f,individual=!1){iterChanges(this,f,individual)}get invertedDesc(){let sections=[];for(let i2=0;i2<this.sections.length;){let len=this.sections[i2++],ins=this.sections[i2++];ins<0?sections.push(len,ins):sections.push(ins,len)}return new ChangeDesc(sections)}composeDesc(other){return this.empty?other:other.empty?this:composeSets(this,other)}mapDesc(other,before=!1){return other.empty?this:mapSet(this,other,before)}mapPos(pos,assoc=-1,mode=MapMode.Simple){let posA=0,posB=0;for(let i2=0;i2<this.sections.length;){let len=this.sections[i2++],ins=this.sections[i2++],endA=posA+len;if(ins<0){if(endA>pos)return posB+(pos-posA);posB+=len}else{if(mode!=MapMode.Simple&&endA>=pos&&(mode==MapMode.TrackDel&&posA<pos&&endA>pos||mode==MapMode.TrackBefore&&posA<pos||mode==MapMode.TrackAfter&&endA>pos))return null;if(endA>pos||endA==pos&&assoc<0&&!len)return pos==posA||assoc<0?posB:posB+ins;posB+=ins}posA=endA}if(pos>posA)throw new RangeError(`Position ${pos} is out of range for changeset of length ${posA}`);return posB}touchesRange(from,to=from){for(let i2=0,pos=0;i2<this.sections.length&&pos<=to;){let end2=pos+this.sections[i2++];if(this.sections[i2++]>=0&&pos<=to&&end2>=from)return!(pos<from&&end2>to)||"cover";pos=end2}return!1}toString(){let result="";for(let i2=0;i2<this.sections.length;){let len=this.sections[i2++],ins=this.sections[i2++];result+=(result?" ":"")+len+(ins>=0?":"+ins:"")}return result}toJSON(){return this.sections}static fromJSON(json2){if(!Array.isArray(json2)||json2.length%2||json2.some((a=>"number"!=typeof a)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ChangeDesc(json2)}static create(sections){return new ChangeDesc(sections)}}class ChangeSet extends ChangeDesc{constructor(sections,inserted){super(sections),this.inserted=inserted}apply(doc2){if(this.length!=doc2.length)throw new RangeError("Applying change set to a document with the wrong length");return iterChanges(this,((fromA,toA,fromB,_toB,text2)=>doc2=doc2.replace(fromB,fromB+(toA-fromA),text2)),!1),doc2}mapDesc(other,before=!1){return mapSet(this,other,before,!0)}invert(doc2){let sections=this.sections.slice(),inserted=[];for(let i2=0,pos=0;i2<sections.length;i2+=2){let len=sections[i2],ins=sections[i2+1];if(ins>=0){sections[i2]=ins,sections[i2+1]=len;let index=i2>>1;for(;inserted.length<index;)inserted.push(Text.empty);inserted.push(len?doc2.slice(pos,pos+len):Text.empty)}pos+=len}return new ChangeSet(sections,inserted)}compose(other){return this.empty?other:other.empty?this:composeSets(this,other,!0)}map(other,before=!1){return other.empty?this:mapSet(this,other,before,!0)}iterChanges(f,individual=!1){iterChanges(this,f,individual)}get desc(){return ChangeDesc.create(this.sections)}filter(ranges){let resultSections=[],resultInserted=[],filteredSections=[],iter=new SectionIter(this);done:for(let i2=0,pos=0;;){let next=i2==ranges.length?1e9:ranges[i2++];for(;pos<next||pos==next&&0==iter.len;){if(iter.done)break done;let len=Math.min(iter.len,next-pos);addSection(filteredSections,len,-1);let ins=-1==iter.ins?-1:0==iter.off?iter.ins:0;addSection(resultSections,len,ins),ins>0&&addInsert(resultInserted,resultSections,iter.text),iter.forward(len),pos+=len}let end2=ranges[i2++];for(;pos<end2;){if(iter.done)break done;let len=Math.min(iter.len,end2-pos);addSection(resultSections,len,-1),addSection(filteredSections,len,-1==iter.ins?-1:0==iter.off?iter.ins:0),iter.forward(len),pos+=len}}return{changes:new ChangeSet(resultSections,resultInserted),filtered:ChangeDesc.create(filteredSections)}}toJSON(){let parts=[];for(let i2=0;i2<this.sections.length;i2+=2){let len=this.sections[i2],ins=this.sections[i2+1];ins<0?parts.push(len):0==ins?parts.push([len]):parts.push([len].concat(this.inserted[i2>>1].toJSON()))}return parts}static of(changes,length,lineSep){let sections=[],inserted=[],pos=0,total=null;function flush2(force=!1){if(!force&&!sections.length)return;pos<length&&addSection(sections,length-pos,-1);let set2=new ChangeSet(sections,inserted);total=total?total.compose(set2.map(total)):set2,sections=[],inserted=[],pos=0}return function process2(spec){if(Array.isArray(spec))for(let sub of spec)process2(sub);else if(spec instanceof ChangeSet){if(spec.length!=length)throw new RangeError(`Mismatched change set length (got ${spec.length}, expected ${length})`);flush2(),total=total?total.compose(spec.map(total)):spec}else{let{from:from,to:to=from,insert:insert2}=spec;if(from>to||from<0||to>length)throw new RangeError(`Invalid change range ${from} to ${to} (in doc of length ${length})`);let insText=insert2?"string"==typeof insert2?Text.of(insert2.split(lineSep||DefaultSplit)):insert2:Text.empty,insLen=insText.length;if(from==to&&0==insLen)return;from<pos&&flush2(),from>pos&&addSection(sections,from-pos,-1),addSection(sections,to-from,insLen),addInsert(inserted,sections,insText),pos=to}}(changes),flush2(!total),total}static empty(length){return new ChangeSet(length?[length,-1]:[],[])}static fromJSON(json2){if(!Array.isArray(json2))throw new RangeError("Invalid JSON representation of ChangeSet");let sections=[],inserted=[];for(let i2=0;i2<json2.length;i2++){let part=json2[i2];if("number"==typeof part)sections.push(part,-1);else{if(!Array.isArray(part)||"number"!=typeof part[0]||part.some(((e,i3)=>i3&&"string"!=typeof e)))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==part.length)sections.push(part[0],0);else{for(;inserted.length<i2;)inserted.push(Text.empty);inserted[i2]=Text.of(part.slice(1)),sections.push(part[0],inserted[i2].length)}}}return new ChangeSet(sections,inserted)}static createSet(sections,inserted){return new ChangeSet(sections,inserted)}}function addSection(sections,len,ins,forceJoin=!1){if(0==len&&ins<=0)return;let last=sections.length-2;last>=0&&ins<=0&&ins==sections[last+1]?sections[last]+=len:0==len&&0==sections[last]?sections[last+1]+=ins:forceJoin?(sections[last]+=len,sections[last+1]+=ins):sections.push(len,ins)}function addInsert(values,sections,value){if(0==value.length)return;let index=sections.length-2>>1;if(index<values.length)values[values.length-1]=values[values.length-1].append(value);else{for(;values.length<index;)values.push(Text.empty);values.push(value)}}function iterChanges(desc,f,individual){let inserted=desc.inserted;for(let posA=0,posB=0,i2=0;i2<desc.sections.length;){let len=desc.sections[i2++],ins=desc.sections[i2++];if(ins<0)posA+=len,posB+=len;else{let endA=posA,endB=posB,text2=Text.empty;for(;endA+=len,endB+=ins,ins&&inserted&&(text2=text2.append(inserted[i2-2>>1])),!(individual||i2==desc.sections.length||desc.sections[i2+1]<0);)len=desc.sections[i2++],ins=desc.sections[i2++];f(posA,endA,posB,endB,text2),posA=endA,posB=endB}}}function mapSet(setA,setB,before,mkSet=!1){let sections=[],insert2=mkSet?[]:null,a=new SectionIter(setA),b=new SectionIter(setB);for(let inserted=-1;;)if(-1==a.ins&&-1==b.ins){let len=Math.min(a.len,b.len);addSection(sections,len,-1),a.forward(len),b.forward(len)}else if(b.ins>=0&&(a.ins<0||inserted==a.i||0==a.off&&(b.len<a.len||b.len==a.len&&!before))){let len=b.len;for(addSection(sections,b.ins,-1);len;){let piece=Math.min(a.len,len);a.ins>=0&&inserted<a.i&&a.len<=piece&&(addSection(sections,0,a.ins),insert2&&addInsert(insert2,sections,a.text),inserted=a.i),a.forward(piece),len-=piece}b.next()}else{if(!(a.ins>=0)){if(a.done&&b.done)return insert2?ChangeSet.createSet(sections,insert2):ChangeDesc.create(sections);throw new Error("Mismatched change set lengths")}{let len=0,left2=a.len;for(;left2;)if(-1==b.ins){let piece=Math.min(left2,b.len);len+=piece,left2-=piece,b.forward(piece)}else{if(!(0==b.ins&&b.len<left2))break;left2-=b.len,b.next()}addSection(sections,len,inserted<a.i?a.ins:0),insert2&&inserted<a.i&&addInsert(insert2,sections,a.text),inserted=a.i,a.forward(a.len-left2)}}}function composeSets(setA,setB,mkSet=!1){let sections=[],insert2=mkSet?[]:null,a=new SectionIter(setA),b=new SectionIter(setB);for(let open=!1;;){if(a.done&&b.done)return insert2?ChangeSet.createSet(sections,insert2):ChangeDesc.create(sections);if(0==a.ins)addSection(sections,a.len,0,open),a.next();else if(0!=b.len||b.done){if(a.done||b.done)throw new Error("Mismatched change set lengths");{let len=Math.min(a.len2,b.len),sectionLen=sections.length;if(-1==a.ins){let insB=-1==b.ins?-1:b.off?0:b.ins;addSection(sections,len,insB,open),insert2&&insB&&addInsert(insert2,sections,b.text)}else-1==b.ins?(addSection(sections,a.off?0:a.len,len,open),insert2&&addInsert(insert2,sections,a.textBit(len))):(addSection(sections,a.off?0:a.len,b.off?0:b.ins,open),insert2&&!b.off&&addInsert(insert2,sections,b.text));open=(a.ins>len||b.ins>=0&&b.len>len)&&(open||sections.length>sectionLen),a.forward2(len),b.forward(len)}}else addSection(sections,0,b.ins,open),insert2&&addInsert(insert2,sections,b.text),b.next()}}class SectionIter{constructor(set2){this.set=set2,this.i=0,this.next()}next(){let{sections:sections}=this.set;this.i<sections.length?(this.len=sections[this.i++],this.ins=sections[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:inserted}=this.set,index=this.i-2>>1;return index>=inserted.length?Text.empty:inserted[index]}textBit(len){let{inserted:inserted}=this.set,index=this.i-2>>1;return index>=inserted.length&&!len?Text.empty:inserted[index].slice(this.off,null==len?void 0:this.off+len)}forward(len){len==this.len?this.next():(this.len-=len,this.off+=len)}forward2(len){-1==this.ins?this.forward(len):len==this.ins?this.next():(this.ins-=len,this.off+=len)}}class SelectionRange{constructor(from,to,flags){this.from=from,this.to=to,this.flags=flags}get anchor(){return 32&this.flags?this.to:this.from}get head(){return 32&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 8&this.flags?-1:16&this.flags?1:0}get bidiLevel(){let level=7&this.flags;return 7==level?null:level}get goalColumn(){let value=this.flags>>6;return 16777215==value?void 0:value}map(change,assoc=-1){let from,to;return this.empty?from=to=change.mapPos(this.from,assoc):(from=change.mapPos(this.from,1),to=change.mapPos(this.to,-1)),from==this.from&&to==this.to?this:new SelectionRange(from,to,this.flags)}extend(from,to=from){if(from<=this.anchor&&to>=this.anchor)return EditorSelection.range(from,to);let head=Math.abs(from-this.anchor)>Math.abs(to-this.anchor)?from:to;return EditorSelection.range(this.anchor,head)}eq(other){return this.anchor==other.anchor&&this.head==other.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(json2){if(!json2||"number"!=typeof json2.anchor||"number"!=typeof json2.head)throw new RangeError("Invalid JSON representation for SelectionRange");return EditorSelection.range(json2.anchor,json2.head)}static create(from,to,flags){return new SelectionRange(from,to,flags)}}class EditorSelection{constructor(ranges,mainIndex){this.ranges=ranges,this.mainIndex=mainIndex}map(change,assoc=-1){return change.empty?this:EditorSelection.create(this.ranges.map((r=>r.map(change,assoc))),this.mainIndex)}eq(other){if(this.ranges.length!=other.ranges.length||this.mainIndex!=other.mainIndex)return!1;for(let i2=0;i2<this.ranges.length;i2++)if(!this.ranges[i2].eq(other.ranges[i2]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new EditorSelection([this.main],0)}addRange(range,main2=!0){return EditorSelection.create([range].concat(this.ranges),main2?0:this.mainIndex+1)}replaceRange(range,which=this.mainIndex){let ranges=this.ranges.slice();return ranges[which]=range,EditorSelection.create(ranges,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((r=>r.toJSON())),main:this.mainIndex}}static fromJSON(json2){if(!json2||!Array.isArray(json2.ranges)||"number"!=typeof json2.main||json2.main>=json2.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new EditorSelection(json2.ranges.map((r=>SelectionRange.fromJSON(r))),json2.main)}static single(anchor,head=anchor){return new EditorSelection([EditorSelection.range(anchor,head)],0)}static create(ranges,mainIndex=0){if(0==ranges.length)throw new RangeError("A selection needs at least one range");for(let pos=0,i2=0;i2<ranges.length;i2++){let range=ranges[i2];if(range.empty?range.from<=pos:range.from<pos)return EditorSelection.normalized(ranges.slice(),mainIndex);pos=range.to}return new EditorSelection(ranges,mainIndex)}static cursor(pos,assoc=0,bidiLevel,goalColumn){return SelectionRange.create(pos,pos,(0==assoc?0:assoc<0?8:16)|(null==bidiLevel?7:Math.min(6,bidiLevel))|(null!=goalColumn?goalColumn:16777215)<<6)}static range(anchor,head,goalColumn,bidiLevel){let flags=(null!=goalColumn?goalColumn:16777215)<<6|(null==bidiLevel?7:Math.min(6,bidiLevel));return head<anchor?SelectionRange.create(head,anchor,48|flags):SelectionRange.create(anchor,head,(head>anchor?8:0)|flags)}static normalized(ranges,mainIndex=0){let main2=ranges[mainIndex];ranges.sort(((a,b)=>a.from-b.from)),mainIndex=ranges.indexOf(main2);for(let i2=1;i2<ranges.length;i2++){let range=ranges[i2],prev=ranges[i2-1];if(range.empty?range.from<=prev.to:range.from<prev.to){let from=prev.from,to=Math.max(range.to,prev.to);i2<=mainIndex&&mainIndex--,ranges.splice(--i2,2,range.anchor>range.head?EditorSelection.range(to,from):EditorSelection.range(from,to))}}return new EditorSelection(ranges,mainIndex)}}function checkSelection(selection2,docLength){for(let range of selection2.ranges)if(range.to>docLength)throw new RangeError("Selection points outside of document")}let nextID=0;class Facet{constructor(combine,compareInput,compare2,isStatic,enables){this.combine=combine,this.compareInput=compareInput,this.compare=compare2,this.isStatic=isStatic,this.id=nextID++,this.default=combine([]),this.extensions="function"==typeof enables?enables(this):enables}get reader(){return this}static define(config2={}){return new Facet(config2.combine||(a=>a),config2.compareInput||((a,b)=>a===b),config2.compare||(config2.combine?(a,b)=>a===b:sameArray$1),!!config2.static,config2.enables)}of(value){return new FacetProvider([],this,0,value)}compute(deps,get2){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(deps,this,1,get2)}computeN(deps,get2){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(deps,this,2,get2)}from(field,get2){return get2||(get2=x=>x),this.compute([field],(state=>get2(state.field(field))))}}function sameArray$1(a,b){return a==b||a.length==b.length&&a.every(((e,i2)=>e===b[i2]))}class FacetProvider{constructor(dependencies,facet,type2,value){this.dependencies=dependencies,this.facet=facet,this.type=type2,this.value=value,this.id=nextID++}dynamicSlot(addresses){var _a2;let getter=this.value,compare2=this.facet.compareInput,id2=this.id,idx=addresses[id2]>>1,multi=2==this.type,depDoc=!1,depSel=!1,depAddrs=[];for(let dep of this.dependencies)"doc"==dep?depDoc=!0:"selection"==dep?depSel=!0:0==(1&(null!==(_a2=addresses[dep.id])&&void 0!==_a2?_a2:1))&&depAddrs.push(addresses[dep.id]);return{create:state=>(state.values[idx]=getter(state),1),update(state,tr){if(depDoc&&tr.docChanged||depSel&&(tr.docChanged||tr.selection)||ensureAll(state,depAddrs)){let newVal=getter(state);if(multi?!compareArray(newVal,state.values[idx],compare2):!compare2(newVal,state.values[idx]))return state.values[idx]=newVal,1}return 0},reconfigure:(state,oldState)=>{let newVal,oldAddr=oldState.config.address[id2];if(null!=oldAddr){let oldVal=getAddr(oldState,oldAddr);if(this.dependencies.every((dep=>dep instanceof Facet?oldState.facet(dep)===state.facet(dep):!(dep instanceof StateField)||oldState.field(dep,!1)==state.field(dep,!1)))||(multi?compareArray(newVal=getter(state),oldVal,compare2):compare2(newVal=getter(state),oldVal)))return state.values[idx]=oldVal,0}else newVal=getter(state);return state.values[idx]=newVal,1}}}}function compareArray(a,b,compare2){if(a.length!=b.length)return!1;for(let i2=0;i2<a.length;i2++)if(!compare2(a[i2],b[i2]))return!1;return!0}function ensureAll(state,addrs){let changed=!1;for(let addr of addrs)1&ensureAddr(state,addr)&&(changed=!0);return changed}function dynamicFacetSlot(addresses,facet,providers){let providerAddrs=providers.map((p=>addresses[p.id])),providerTypes=providers.map((p=>p.type)),dynamic=providerAddrs.filter((p=>!(1&p))),idx=addresses[facet.id]>>1;function get2(state){let values=[];for(let i2=0;i2<providerAddrs.length;i2++){let value=getAddr(state,providerAddrs[i2]);if(2==providerTypes[i2])for(let val of value)values.push(val);else values.push(value)}return facet.combine(values)}return{create(state){for(let addr of providerAddrs)ensureAddr(state,addr);return state.values[idx]=get2(state),1},update(state,tr){if(!ensureAll(state,dynamic))return 0;let value=get2(state);return facet.compare(value,state.values[idx])?0:(state.values[idx]=value,1)},reconfigure(state,oldState){let depChanged=ensureAll(state,providerAddrs),oldProviders=oldState.config.facets[facet.id],oldValue=oldState.facet(facet);if(oldProviders&&!depChanged&&sameArray$1(providers,oldProviders))return state.values[idx]=oldValue,0;let value=get2(state);return facet.compare(value,oldValue)?(state.values[idx]=oldValue,0):(state.values[idx]=value,1)}}}const initField=Facet.define({static:!0});class StateField{constructor(id2,createF,updateF,compareF,spec){this.id=id2,this.createF=createF,this.updateF=updateF,this.compareF=compareF,this.spec=spec,this.provides=void 0}static define(config2){let field=new StateField(nextID++,config2.create,config2.update,config2.compare||((a,b)=>a===b),config2);return config2.provide&&(field.provides=config2.provide(field)),field}create(state){let init2=state.facet(initField).find((i2=>i2.field==this));return((null==init2?void 0:init2.create)||this.createF)(state)}slot(addresses){let idx=addresses[this.id]>>1;return{create:state=>(state.values[idx]=this.create(state),1),update:(state,tr)=>{let oldVal=state.values[idx],value=this.updateF(oldVal,tr);return this.compareF(oldVal,value)?0:(state.values[idx]=value,1)},reconfigure:(state,oldState)=>null!=oldState.config.address[this.id]?(state.values[idx]=oldState.field(this),0):(state.values[idx]=this.create(state),1)}}init(create){return[this,initField.of({field:this,create:create})]}get extension(){return this}}const Prec__lowest=4,Prec__low=3,Prec__default=2,Prec__high=1;function prec(value){return ext=>new PrecExtension(ext,value)}const Prec={highest:prec(0),high:prec(Prec__high),default:prec(Prec__default),low:prec(Prec__low),lowest:prec(Prec__lowest)};class PrecExtension{constructor(inner,prec2){this.inner=inner,this.prec=prec2}}class Compartment{of(ext){return new CompartmentInstance(this,ext)}reconfigure(content2){return Compartment.reconfigure.of({compartment:this,extension:content2})}get(state){return state.config.compartments.get(this)}}class CompartmentInstance{constructor(compartment,inner){this.compartment=compartment,this.inner=inner}}class Configuration{constructor(base2,compartments,dynamicSlots,address,staticValues,facets){for(this.base=base2,this.compartments=compartments,this.dynamicSlots=dynamicSlots,this.address=address,this.staticValues=staticValues,this.facets=facets,this.statusTemplate=[];this.statusTemplate.length<dynamicSlots.length;)this.statusTemplate.push(0)}staticFacet(facet){let addr=this.address[facet.id];return null==addr?facet.default:this.staticValues[addr>>1]}static resolve(base2,compartments,oldState){let fields=[],facets=Object.create(null),newCompartments=new Map;for(let ext of function(extension,compartments,newCompartments){let result=[[],[],[],[],[]],seen=new Map;function inner(ext,prec2){let known=seen.get(ext);if(null!=known){if(known<=prec2)return;let found=result[known].indexOf(ext);found>-1&&result[known].splice(found,1),ext instanceof CompartmentInstance&&newCompartments.delete(ext.compartment)}if(seen.set(ext,prec2),Array.isArray(ext))for(let e of ext)inner(e,prec2);else if(ext instanceof CompartmentInstance){if(newCompartments.has(ext.compartment))throw new RangeError("Duplicate use of compartment in extensions");let content2=compartments.get(ext.compartment)||ext.inner;newCompartments.set(ext.compartment,content2),inner(content2,prec2)}else if(ext instanceof PrecExtension)inner(ext.inner,ext.prec);else if(ext instanceof StateField)result[prec2].push(ext),ext.provides&&inner(ext.provides,prec2);else if(ext instanceof FacetProvider)result[prec2].push(ext),ext.facet.extensions&&inner(ext.facet.extensions,Prec__default);else{let content2=ext.extension;if(!content2)throw new Error(`Unrecognized extension value in extension set (${ext}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);inner(content2,prec2)}}return inner(extension,Prec__default),result.reduce(((a,b)=>a.concat(b)))}(base2,compartments,newCompartments))ext instanceof StateField?fields.push(ext):(facets[ext.facet.id]||(facets[ext.facet.id]=[])).push(ext);let address=Object.create(null),staticValues=[],dynamicSlots=[];for(let field of fields)address[field.id]=dynamicSlots.length<<1,dynamicSlots.push((a=>field.slot(a)));let oldFacets=null==oldState?void 0:oldState.config.facets;for(let id2 in facets){let providers=facets[id2],facet=providers[0].facet,oldProviders=oldFacets&&oldFacets[id2]||[];if(providers.every((p=>0==p.type)))if(address[facet.id]=staticValues.length<<1|1,sameArray$1(oldProviders,providers))staticValues.push(oldState.facet(facet));else{let value=facet.combine(providers.map((p=>p.value)));staticValues.push(oldState&&facet.compare(value,oldState.facet(facet))?oldState.facet(facet):value)}else{for(let p of providers)0==p.type?(address[p.id]=staticValues.length<<1|1,staticValues.push(p.value)):(address[p.id]=dynamicSlots.length<<1,dynamicSlots.push((a=>p.dynamicSlot(a))));address[facet.id]=dynamicSlots.length<<1,dynamicSlots.push((a=>dynamicFacetSlot(a,facet,providers)))}}let dynamic=dynamicSlots.map((f=>f(address)));return new Configuration(base2,newCompartments,dynamic,address,staticValues,facets)}}function ensureAddr(state,addr){if(1&addr)return 2;let idx=addr>>1,status=state.status[idx];if(4==status)throw new Error("Cyclic dependency between fields and/or facets");if(2&status)return status;state.status[idx]=4;let changed=state.computeSlot(state,state.config.dynamicSlots[idx]);return state.status[idx]=2|changed}function getAddr(state,addr){return 1&addr?state.config.staticValues[addr>>1]:state.values[addr>>1]}const languageData=Facet.define(),allowMultipleSelections=Facet.define({combine:values=>values.some((v=>v)),static:!0}),lineSeparator=Facet.define({combine:values=>values.length?values[0]:void 0,static:!0}),changeFilter=Facet.define(),transactionFilter=Facet.define(),transactionExtender=Facet.define(),readOnly=Facet.define({combine:values=>!!values.length&&values[0]});class Annotation{constructor(type2,value){this.type=type2,this.value=value}static define(){return new AnnotationType}}class AnnotationType{of(value){return new Annotation(this,value)}}class StateEffectType{constructor(map){this.map=map}of(value){return new StateEffect(this,value)}}class StateEffect{constructor(type2,value){this.type=type2,this.value=value}map(mapping){let mapped=this.type.map(this.value,mapping);return void 0===mapped?void 0:mapped==this.value?this:new StateEffect(this.type,mapped)}is(type2){return this.type==type2}static define(spec={}){return new StateEffectType(spec.map||(v=>v))}static mapEffects(effects,mapping){if(!effects.length)return effects;let result=[];for(let effect2 of effects){let mapped=effect2.map(mapping);mapped&&result.push(mapped)}return result}}StateEffect.reconfigure=StateEffect.define(),StateEffect.appendConfig=StateEffect.define();class Transaction{constructor(startState,changes,selection2,effects,annotations,scrollIntoView2){this.startState=startState,this.changes=changes,this.selection=selection2,this.effects=effects,this.annotations=annotations,this.scrollIntoView=scrollIntoView2,this._doc=null,this._state=null,selection2&&checkSelection(selection2,changes.newLength),annotations.some((a=>a.type==Transaction.time))||(this.annotations=annotations.concat(Transaction.time.of(Date.now())))}static create(startState,changes,selection2,effects,annotations,scrollIntoView2){return new Transaction(startState,changes,selection2,effects,annotations,scrollIntoView2)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(type2){for(let ann of this.annotations)if(ann.type==type2)return ann.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(event){let e=this.annotation(Transaction.userEvent);return!(!e||!(e==event||e.length>event.length&&e.slice(0,event.length)==event&&"."==e[event.length]))}}function joinRanges(a,b){let result=[];for(let iA=0,iB=0;;){let from,to;if(iA<a.length&&(iB==b.length||b[iB]>=a[iA]))from=a[iA++],to=a[iA++];else{if(!(iB<b.length))return result;from=b[iB++],to=b[iB++]}!result.length||result[result.length-1]<from?result.push(from,to):result[result.length-1]<to&&(result[result.length-1]=to)}}function mergeTransaction(a,b,sequential){var _a2;let mapForA,mapForB,changes;return sequential?(mapForA=b.changes,mapForB=ChangeSet.empty(b.changes.length),changes=a.changes.compose(b.changes)):(mapForA=b.changes.map(a.changes),mapForB=a.changes.mapDesc(b.changes,!0),changes=a.changes.compose(mapForA)),{changes:changes,selection:b.selection?b.selection.map(mapForB):null===(_a2=a.selection)||void 0===_a2?void 0:_a2.map(mapForA),effects:StateEffect.mapEffects(a.effects,mapForA).concat(StateEffect.mapEffects(b.effects,mapForB)),annotations:a.annotations.length?a.annotations.concat(b.annotations):b.annotations,scrollIntoView:a.scrollIntoView||b.scrollIntoView}}function resolveTransactionInner(state,spec,docSize){let sel=spec.selection,annotations=asArray$2(spec.annotations);return spec.userEvent&&(annotations=annotations.concat(Transaction.userEvent.of(spec.userEvent))),{changes:spec.changes instanceof ChangeSet?spec.changes:ChangeSet.of(spec.changes||[],docSize,state.facet(lineSeparator)),selection:sel&&(sel instanceof EditorSelection?sel:EditorSelection.single(sel.anchor,sel.head)),effects:asArray$2(spec.effects),annotations:annotations,scrollIntoView:!!spec.scrollIntoView}}function resolveTransaction(state,specs,filter){let s=resolveTransactionInner(state,specs.length?specs[0]:{},state.doc.length);specs.length&&!1===specs[0].filter&&(filter=!1);for(let i2=1;i2<specs.length;i2++){!1===specs[i2].filter&&(filter=!1);let seq=!!specs[i2].sequential;s=mergeTransaction(s,resolveTransactionInner(state,specs[i2],seq?s.changes.newLength:state.doc.length),seq)}let tr=Transaction.create(state,s.changes,s.selection,s.effects,s.annotations,s.scrollIntoView);return function(tr){let state=tr.startState,extenders=state.facet(transactionExtender),spec=tr;for(let i2=extenders.length-1;i2>=0;i2--){let extension=extenders[i2](tr);extension&&Object.keys(extension).length&&(spec=mergeTransaction(spec,resolveTransactionInner(state,extension,tr.changes.newLength),!0))}return spec==tr?tr:Transaction.create(state,tr.changes,tr.selection,spec.effects,spec.annotations,spec.scrollIntoView)}(filter?function(tr){let state=tr.startState,result=!0;for(let filter of state.facet(changeFilter)){let value=filter(tr);if(!1===value){result=!1;break}Array.isArray(value)&&(result=!0===result?value:joinRanges(result,value))}if(!0!==result){let changes,back;if(!1===result)back=tr.changes.invertedDesc,changes=ChangeSet.empty(state.doc.length);else{let filtered=tr.changes.filter(result);changes=filtered.changes,back=filtered.filtered.mapDesc(filtered.changes).invertedDesc}tr=Transaction.create(state,changes,tr.selection&&tr.selection.map(back),StateEffect.mapEffects(tr.effects,back),tr.annotations,tr.scrollIntoView)}let filters2=state.facet(transactionFilter);for(let i2=filters2.length-1;i2>=0;i2--){let filtered=filters2[i2](tr);tr=filtered instanceof Transaction?filtered:Array.isArray(filtered)&&1==filtered.length&&filtered[0]instanceof Transaction?filtered[0]:resolveTransaction(state,asArray$2(filtered),!1)}return tr}(tr):tr)}Transaction.time=Annotation.define(),Transaction.userEvent=Annotation.define(),Transaction.addToHistory=Annotation.define(),Transaction.remote=Annotation.define();const none$2=[];function asArray$2(value){return null==value?none$2:Array.isArray(value)?value:[value]}var CharCategory=function(CharCategory2){return CharCategory2[CharCategory2.Word=0]="Word",CharCategory2[CharCategory2.Space=1]="Space",CharCategory2[CharCategory2.Other=2]="Other",CharCategory2}(CharCategory||(CharCategory={}));const nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let wordChar;try{wordChar=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(_){}function makeCategorizer(wordChars){return char=>{if(!/\S/.test(char))return CharCategory.Space;if(function(str){if(wordChar)return wordChar.test(str);for(let i2=0;i2<str.length;i2++){let ch=str[i2];if(/\w/.test(ch)||ch>"\x80"&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch)))return!0}return!1}(char))return CharCategory.Word;for(let i2=0;i2<wordChars.length;i2++)if(char.indexOf(wordChars[i2])>-1)return CharCategory.Word;return CharCategory.Other}}class EditorState{constructor(config2,doc2,selection2,values,computeSlot,tr){this.config=config2,this.doc=doc2,this.selection=selection2,this.values=values,this.status=config2.statusTemplate.slice(),this.computeSlot=computeSlot,tr&&(tr._state=this);for(let i2=0;i2<this.config.dynamicSlots.length;i2++)ensureAddr(this,i2<<1);this.computeSlot=null}field(field,require2=!0){let addr=this.config.address[field.id];if(null!=addr)return ensureAddr(this,addr),getAddr(this,addr);if(require2)throw new RangeError("Field is not present in this state")}update(...specs){return resolveTransaction(this,specs,!0)}applyTransaction(tr){let startValues,conf=this.config,{base:base2,compartments:compartments}=conf;for(let effect2 of tr.effects)effect2.is(Compartment.reconfigure)?(conf&&(compartments=new Map,conf.compartments.forEach(((val,key)=>compartments.set(key,val))),conf=null),compartments.set(effect2.value.compartment,effect2.value.extension)):effect2.is(StateEffect.reconfigure)?(conf=null,base2=effect2.value):effect2.is(StateEffect.appendConfig)&&(conf=null,base2=asArray$2(base2).concat(effect2.value));if(conf)startValues=tr.startState.values.slice();else{conf=Configuration.resolve(base2,compartments,this),startValues=new EditorState(conf,this.doc,this.selection,conf.dynamicSlots.map((()=>null)),((state,slot)=>slot.reconfigure(state,this)),null).values}new EditorState(conf,tr.newDoc,tr.newSelection,startValues,((state,slot)=>slot.update(state,tr)),tr)}replaceSelection(text2){return"string"==typeof text2&&(text2=this.toText(text2)),this.changeByRange((range=>({changes:{from:range.from,to:range.to,insert:text2},range:EditorSelection.cursor(range.from+text2.length)})))}changeByRange(f){let sel=this.selection,result1=f(sel.ranges[0]),changes=this.changes(result1.changes),ranges=[result1.range],effects=asArray$2(result1.effects);for(let i2=1;i2<sel.ranges.length;i2++){let result=f(sel.ranges[i2]),newChanges=this.changes(result.changes),newMapped=newChanges.map(changes);for(let j=0;j<i2;j++)ranges[j]=ranges[j].map(newMapped);let mapBy=changes.mapDesc(newChanges,!0);ranges.push(result.range.map(mapBy)),changes=changes.compose(newMapped),effects=StateEffect.mapEffects(effects,newMapped).concat(StateEffect.mapEffects(asArray$2(result.effects),mapBy))}return{changes:changes,selection:EditorSelection.create(ranges,sel.mainIndex),effects:effects}}changes(spec=[]){return spec instanceof ChangeSet?spec:ChangeSet.of(spec,this.doc.length,this.facet(EditorState.lineSeparator))}toText(string2){return Text.of(string2.split(this.facet(EditorState.lineSeparator)||DefaultSplit))}sliceDoc(from=0,to=this.doc.length){return this.doc.sliceString(from,to,this.lineBreak)}facet(facet){let addr=this.config.address[facet.id];return null==addr?facet.default:(ensureAddr(this,addr),getAddr(this,addr))}toJSON(fields){let result={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(fields)for(let prop in fields){let value=fields[prop];value instanceof StateField&&null!=this.config.address[value.id]&&(result[prop]=value.spec.toJSON(this.field(fields[prop]),this))}return result}static fromJSON(json2,config2={},fields){if(!json2||"string"!=typeof json2.doc)throw new RangeError("Invalid JSON representation for EditorState");let fieldInit=[];if(fields)for(let prop in fields)if(Object.prototype.hasOwnProperty.call(json2,prop)){let field=fields[prop],value=json2[prop];fieldInit.push(field.init((state=>field.spec.fromJSON(value,state))))}return EditorState.create({doc:json2.doc,selection:EditorSelection.fromJSON(json2.selection),extensions:config2.extensions?fieldInit.concat([config2.extensions]):fieldInit})}static create(config2={}){let configuration=Configuration.resolve(config2.extensions||[],new Map),doc2=config2.doc instanceof Text?config2.doc:Text.of((config2.doc||"").split(configuration.staticFacet(EditorState.lineSeparator)||DefaultSplit)),selection2=config2.selection?config2.selection instanceof EditorSelection?config2.selection:EditorSelection.single(config2.selection.anchor,config2.selection.head):EditorSelection.single(0);return checkSelection(selection2,doc2.length),configuration.staticFacet(allowMultipleSelections)||(selection2=selection2.asSingle()),new EditorState(configuration,doc2,selection2,configuration.dynamicSlots.map((()=>null)),((state,slot)=>slot.create(state)),null)}get tabSize(){return this.facet(EditorState.tabSize)}get lineBreak(){return this.facet(EditorState.lineSeparator)||"\n"}get readOnly(){return this.facet(readOnly)}phrase(phrase2,...insert2){for(let map of this.facet(EditorState.phrases))if(Object.prototype.hasOwnProperty.call(map,phrase2)){phrase2=map[phrase2];break}return insert2.length&&(phrase2=phrase2.replace(/\$(\$|\d*)/g,((m,i2)=>{if("$"==i2)return"$";let n=+(i2||1);return!n||n>insert2.length?m:insert2[n-1]}))),phrase2}languageDataAt(name2,pos,side=-1){let values=[];for(let provider of this.facet(languageData))for(let result of provider(this,pos,side))Object.prototype.hasOwnProperty.call(result,name2)&&values.push(result[name2]);return values}charCategorizer(at){return makeCategorizer(this.languageDataAt("wordChars",at).join(""))}wordAt(pos){let{text:text2,from:from,length:length}=this.doc.lineAt(pos),cat=this.charCategorizer(pos),start2=pos-from,end2=pos-from;for(;start2>0;){let prev=findClusterBreak(text2,start2,!1);if(cat(text2.slice(prev,start2))!=CharCategory.Word)break;start2=prev}for(;end2<length;){let next=findClusterBreak(text2,end2);if(cat(text2.slice(end2,next))!=CharCategory.Word)break;end2=next}return start2==end2?null:EditorSelection.range(start2+from,end2+from)}}function combineConfig(configs,defaults2,combine={}){let result={};for(let config2 of configs)for(let key of Object.keys(config2)){let value=config2[key],current=result[key];if(void 0===current)result[key]=value;else if(current===value||void 0===value);else{if(!Object.hasOwnProperty.call(combine,key))throw new Error("Config merge conflict for field "+key);result[key]=combine[key](current,value)}}for(let key in defaults2)void 0===result[key]&&(result[key]=defaults2[key]);return result}EditorState.allowMultipleSelections=allowMultipleSelections,EditorState.tabSize=Facet.define({combine:values=>values.length?values[0]:4}),EditorState.lineSeparator=lineSeparator,EditorState.readOnly=readOnly,EditorState.phrases=Facet.define({compare(a,b){let kA=Object.keys(a),kB=Object.keys(b);return kA.length==kB.length&&kA.every((k=>a[k]==b[k]))}}),EditorState.languageData=languageData,EditorState.changeFilter=changeFilter,EditorState.transactionFilter=transactionFilter,EditorState.transactionExtender=transactionExtender,Compartment.reconfigure=StateEffect.define();class RangeValue{eq(other){return this==other}range(from,to=from){return Range$1.create(from,to,this)}}RangeValue.prototype.startSide=RangeValue.prototype.endSide=0,RangeValue.prototype.point=!1,RangeValue.prototype.mapMode=MapMode.TrackDel;let Range$1=class Range2{constructor(from,to,value){this.from=from,this.to=to,this.value=value}static create(from,to,value){return new Range2(from,to,value)}};function cmpRange(a,b){return a.from-b.from||a.value.startSide-b.value.startSide}class Chunk{constructor(from,to,value,maxPoint){this.from=from,this.to=to,this.value=value,this.maxPoint=maxPoint}get length(){return this.to[this.to.length-1]}findIndex(pos,side,end2,startAt=0){let arr=end2?this.to:this.from;for(let lo=startAt,hi=arr.length;;){if(lo==hi)return lo;let mid=lo+hi>>1,diff=arr[mid]-pos||(end2?this.value[mid].endSide:this.value[mid].startSide)-side;if(mid==lo)return diff>=0?lo:hi;diff>=0?hi=mid:lo=mid+1}}between(offset2,from,to,f){for(let i2=this.findIndex(from,-1e9,!0),e=this.findIndex(to,1e9,!1,i2);i2<e;i2++)if(!1===f(this.from[i2]+offset2,this.to[i2]+offset2,this.value[i2]))return!1}map(offset2,changes){let value=[],from=[],to=[],newPos=-1,maxPoint=-1;for(let i2=0;i2<this.value.length;i2++){let newFrom,newTo,val=this.value[i2],curFrom=this.from[i2]+offset2,curTo=this.to[i2]+offset2;if(curFrom==curTo){let mapped=changes.mapPos(curFrom,val.startSide,val.mapMode);if(null==mapped)continue;if(newFrom=newTo=mapped,val.startSide!=val.endSide&&(newTo=changes.mapPos(curFrom,val.endSide),newTo<newFrom))continue}else if(newFrom=changes.mapPos(curFrom,val.startSide),newTo=changes.mapPos(curTo,val.endSide),newFrom>newTo||newFrom==newTo&&val.startSide>0&&val.endSide<=0)continue;(newTo-newFrom||val.endSide-val.startSide)<0||(newPos<0&&(newPos=newFrom),val.point&&(maxPoint=Math.max(maxPoint,newTo-newFrom)),value.push(val),from.push(newFrom-newPos),to.push(newTo-newPos))}return{mapped:value.length?new Chunk(from,to,value,maxPoint):null,pos:newPos}}}class RangeSet{constructor(chunkPos,chunk,nextLayer,maxPoint){this.chunkPos=chunkPos,this.chunk=chunk,this.nextLayer=nextLayer,this.maxPoint=maxPoint}static create(chunkPos,chunk,nextLayer,maxPoint){return new RangeSet(chunkPos,chunk,nextLayer,maxPoint)}get length(){let last=this.chunk.length-1;return last<0?0:Math.max(this.chunkEnd(last),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let size=this.nextLayer.size;for(let chunk of this.chunk)size+=chunk.value.length;return size}chunkEnd(index){return this.chunkPos[index]+this.chunk[index].length}update(updateSpec){let{add:add2=[],sort:sort=!1,filterFrom:filterFrom=0,filterTo:filterTo=this.length}=updateSpec,filter=updateSpec.filter;if(0==add2.length&&!filter)return this;if(sort&&(add2=add2.slice().sort(cmpRange)),this.isEmpty)return add2.length?RangeSet.of(add2):this;let cur2=new LayerCursor(this,null,-1).goto(0),i2=0,spill=[],builder=new RangeSetBuilder;for(;cur2.value||i2<add2.length;)if(i2<add2.length&&(cur2.from-add2[i2].from||cur2.startSide-add2[i2].value.startSide)>=0){let range=add2[i2++];builder.addInner(range.from,range.to,range.value)||spill.push(range)}else 1==cur2.rangeIndex&&cur2.chunkIndex<this.chunk.length&&(i2==add2.length||this.chunkEnd(cur2.chunkIndex)<add2[i2].from)&&(!filter||filterFrom>this.chunkEnd(cur2.chunkIndex)||filterTo<this.chunkPos[cur2.chunkIndex])&&builder.addChunk(this.chunkPos[cur2.chunkIndex],this.chunk[cur2.chunkIndex])?cur2.nextChunk():((!filter||filterFrom>cur2.to||filterTo<cur2.from||filter(cur2.from,cur2.to,cur2.value))&&(builder.addInner(cur2.from,cur2.to,cur2.value)||spill.push(Range$1.create(cur2.from,cur2.to,cur2.value))),cur2.next());return builder.finishInner(this.nextLayer.isEmpty&&!spill.length?RangeSet.empty:this.nextLayer.update({add:spill,filter:filter,filterFrom:filterFrom,filterTo:filterTo}))}map(changes){if(changes.empty||this.isEmpty)return this;let chunks=[],chunkPos=[],maxPoint=-1;for(let i2=0;i2<this.chunk.length;i2++){let start2=this.chunkPos[i2],chunk=this.chunk[i2],touch=changes.touchesRange(start2,start2+chunk.length);if(!1===touch)maxPoint=Math.max(maxPoint,chunk.maxPoint),chunks.push(chunk),chunkPos.push(changes.mapPos(start2));else if(!0===touch){let{mapped:mapped,pos:pos}=chunk.map(start2,changes);mapped&&(maxPoint=Math.max(maxPoint,mapped.maxPoint),chunks.push(mapped),chunkPos.push(pos))}}let next=this.nextLayer.map(changes);return 0==chunks.length?next:new RangeSet(chunkPos,chunks,next||RangeSet.empty,maxPoint)}between(from,to,f){if(!this.isEmpty){for(let i2=0;i2<this.chunk.length;i2++){let start2=this.chunkPos[i2],chunk=this.chunk[i2];if(to>=start2&&from<=start2+chunk.length&&!1===chunk.between(start2,from-start2,to-start2,f))return}this.nextLayer.between(from,to,f)}}iter(from=0){return HeapCursor.from([this]).goto(from)}get isEmpty(){return this.nextLayer==this}static iter(sets,from=0){return HeapCursor.from(sets).goto(from)}static compare(oldSets,newSets,textDiff,comparator,minPointSize=-1){let a=oldSets.filter((set2=>set2.maxPoint>0||!set2.isEmpty&&set2.maxPoint>=minPointSize)),b=newSets.filter((set2=>set2.maxPoint>0||!set2.isEmpty&&set2.maxPoint>=minPointSize)),sharedChunks=findSharedChunks(a,b,textDiff),sideA=new SpanCursor(a,sharedChunks,minPointSize),sideB=new SpanCursor(b,sharedChunks,minPointSize);textDiff.iterGaps(((fromA,fromB,length)=>compare(sideA,fromA,sideB,fromB,length,comparator))),textDiff.empty&&0==textDiff.length&&compare(sideA,0,sideB,0,0,comparator)}static eq(oldSets,newSets,from=0,to){null==to&&(to=999999999);let a=oldSets.filter((set2=>!set2.isEmpty&&newSets.indexOf(set2)<0)),b=newSets.filter((set2=>!set2.isEmpty&&oldSets.indexOf(set2)<0));if(a.length!=b.length)return!1;if(!a.length)return!0;let sharedChunks=findSharedChunks(a,b),sideA=new SpanCursor(a,sharedChunks,0).goto(from),sideB=new SpanCursor(b,sharedChunks,0).goto(from);for(;;){if(sideA.to!=sideB.to||!sameValues(sideA.active,sideB.active)||sideA.point&&(!sideB.point||!sideA.point.eq(sideB.point)))return!1;if(sideA.to>to)return!0;sideA.next(),sideB.next()}}static spans(sets,from,to,iterator,minPointSize=-1){let cursor2=new SpanCursor(sets,null,minPointSize).goto(from),pos=from,openRanges=cursor2.openStart;for(;;){let curTo=Math.min(cursor2.to,to);if(cursor2.point){let active2=cursor2.activeForPoint(cursor2.to),openCount=cursor2.pointFrom<from?active2.length+1:Math.min(active2.length,openRanges);iterator.point(pos,curTo,cursor2.point,active2,openCount,cursor2.pointRank),openRanges=Math.min(cursor2.openEnd(curTo),active2.length)}else curTo>pos&&(iterator.span(pos,curTo,cursor2.active,openRanges),openRanges=cursor2.openEnd(curTo));if(cursor2.to>to)return openRanges+(cursor2.point&&cursor2.to>to?1:0);pos=cursor2.to,cursor2.next()}}static of(ranges,sort=!1){let build=new RangeSetBuilder;for(let range of ranges instanceof Range$1?[ranges]:sort?function(ranges){if(ranges.length>1)for(let prev=ranges[0],i2=1;i2<ranges.length;i2++){let cur2=ranges[i2];if(cmpRange(prev,cur2)>0)return ranges.slice().sort(cmpRange);prev=cur2}return ranges}(ranges):ranges)build.add(range.from,range.to,range.value);return build.finish()}}RangeSet.empty=new RangeSet([],[],null,-1),RangeSet.empty.nextLayer=RangeSet.empty;class RangeSetBuilder{finishChunk(newArrays){this.chunks.push(new Chunk(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,newArrays&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(from,to,value){this.addInner(from,to,value)||(this.nextLayer||(this.nextLayer=new RangeSetBuilder)).add(from,to,value)}addInner(from,to,value){let diff=from-this.lastTo||value.startSide-this.last.endSide;if(diff<=0&&(from-this.lastFrom||value.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(diff<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=from),this.from.push(from-this.chunkStart),this.to.push(to-this.chunkStart),this.last=value,this.lastFrom=from,this.lastTo=to,this.value.push(value),value.point&&(this.maxPoint=Math.max(this.maxPoint,to-from)),!0)}addChunk(from,chunk){if((from-this.lastTo||chunk.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,chunk.maxPoint),this.chunks.push(chunk),this.chunkPos.push(from);let last=chunk.value.length-1;return this.last=chunk.value[last],this.lastFrom=chunk.from[last]+from,this.lastTo=chunk.to[last]+from,!0}finish(){return this.finishInner(RangeSet.empty)}finishInner(next){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return next;let result=RangeSet.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(next):next,this.setMaxPoint);return this.from=null,result}}function findSharedChunks(a,b,textDiff){let inA=new Map;for(let set2 of a)for(let i2=0;i2<set2.chunk.length;i2++)set2.chunk[i2].maxPoint<=0&&inA.set(set2.chunk[i2],set2.chunkPos[i2]);let shared=new Set;for(let set2 of b)for(let i2=0;i2<set2.chunk.length;i2++){let known=inA.get(set2.chunk[i2]);null==known||(textDiff?textDiff.mapPos(known):known)!=set2.chunkPos[i2]||(null==textDiff?void 0:textDiff.touchesRange(known,known+set2.chunk[i2].length))||shared.add(set2.chunk[i2])}return shared}class LayerCursor{constructor(layer2,skip,minPoint,rank=0){this.layer=layer2,this.skip=skip,this.minPoint=minPoint,this.rank=rank}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(pos,side=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(pos,side,!1),this}gotoInner(pos,side,forward){for(;this.chunkIndex<this.layer.chunk.length;){let next=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(next)||this.layer.chunkEnd(this.chunkIndex)<pos||next.maxPoint<this.minPoint))break;this.chunkIndex++,forward=!1}if(this.chunkIndex<this.layer.chunk.length){let rangeIndex=this.layer.chunk[this.chunkIndex].findIndex(pos-this.layer.chunkPos[this.chunkIndex],side,!0);(!forward||this.rangeIndex<rangeIndex)&&this.setRangeIndex(rangeIndex)}this.next()}forward(pos,side){(this.to-pos||this.endSide-side)<0&&this.gotoInner(pos,side,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let chunkPos=this.layer.chunkPos[this.chunkIndex],chunk=this.layer.chunk[this.chunkIndex],from=chunkPos+chunk.from[this.rangeIndex];if(this.from=from,this.to=chunkPos+chunk.to[this.rangeIndex],this.value=chunk.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(index){if(index==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=index}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(other){return this.from-other.from||this.startSide-other.startSide||this.rank-other.rank||this.to-other.to||this.endSide-other.endSide}}class HeapCursor{constructor(heap){this.heap=heap}static from(sets,skip=null,minPoint=-1){let heap=[];for(let i2=0;i2<sets.length;i2++)for(let cur2=sets[i2];!cur2.isEmpty;cur2=cur2.nextLayer)cur2.maxPoint>=minPoint&&heap.push(new LayerCursor(cur2,skip,minPoint,i2));return 1==heap.length?heap[0]:new HeapCursor(heap)}get startSide(){return this.value?this.value.startSide:0}goto(pos,side=-1e9){for(let cur2 of this.heap)cur2.goto(pos,side);for(let i2=this.heap.length>>1;i2>=0;i2--)heapBubble(this.heap,i2);return this.next(),this}forward(pos,side){for(let cur2 of this.heap)cur2.forward(pos,side);for(let i2=this.heap.length>>1;i2>=0;i2--)heapBubble(this.heap,i2);(this.to-pos||this.value.endSide-side)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let top2=this.heap[0];this.from=top2.from,this.to=top2.to,this.value=top2.value,this.rank=top2.rank,top2.value&&top2.next(),heapBubble(this.heap,0)}}}function heapBubble(heap,index){for(let cur2=heap[index];;){let childIndex=1+(index<<1);if(childIndex>=heap.length)break;let child=heap[childIndex];if(childIndex+1<heap.length&&child.compare(heap[childIndex+1])>=0&&(child=heap[childIndex+1],childIndex++),cur2.compare(child)<0)break;heap[childIndex]=cur2,heap[index]=child,index=childIndex}}class SpanCursor{constructor(sets,skip,minPoint){this.minPoint=minPoint,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=HeapCursor.from(sets,skip,minPoint)}goto(pos,side=-1e9){return this.cursor.goto(pos,side),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=pos,this.endSide=side,this.openStart=-1,this.next(),this}forward(pos,side){for(;this.minActive>-1&&(this.activeTo[this.minActive]-pos||this.active[this.minActive].endSide-side)<0;)this.removeActive(this.minActive);this.cursor.forward(pos,side)}removeActive(index){remove(this.active,index),remove(this.activeTo,index),remove(this.activeRank,index),this.minActive=findMinIndex(this.active,this.activeTo)}addActive(trackOpen){let i2=0,{value:value,to:to,rank:rank}=this.cursor;for(;i2<this.activeRank.length&&this.activeRank[i2]<=rank;)i2++;insert(this.active,i2,value),insert(this.activeTo,i2,to),insert(this.activeRank,i2,rank),trackOpen&&insert(trackOpen,i2,this.cursor.from),this.minActive=findMinIndex(this.active,this.activeTo)}next(){let from=this.to,wasPoint=this.point;this.point=null;let trackOpen=this.openStart<0?[]:null;for(;;){let a=this.minActive;if(a>-1&&(this.activeTo[a]-this.cursor.from||this.active[a].endSide-this.cursor.startSide)<0){if(this.activeTo[a]>from){this.to=this.activeTo[a],this.endSide=this.active[a].endSide;break}this.removeActive(a),trackOpen&&remove(trackOpen,a)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>from){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let nextVal=this.cursor.value;if(nextVal.point){if(!(wasPoint&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=nextVal,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=nextVal.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(trackOpen),this.cursor.next()}}}if(trackOpen){this.openStart=0;for(let i2=trackOpen.length-1;i2>=0&&trackOpen[i2]<from;i2--)this.openStart++}}activeForPoint(to){if(!this.active.length)return this.active;let active2=[];for(let i2=this.active.length-1;i2>=0&&!(this.activeRank[i2]<this.pointRank);i2--)(this.activeTo[i2]>to||this.activeTo[i2]==to&&this.active[i2].endSide>=this.point.endSide)&&active2.push(this.active[i2]);return active2.reverse()}openEnd(to){let open=0;for(let i2=this.activeTo.length-1;i2>=0&&this.activeTo[i2]>to;i2--)open++;return open}}function compare(a,startA,b,startB,length,comparator){a.goto(startA),b.goto(startB);let endB=startB+length,pos=startB,dPos=startB-startA;for(;;){let diff=a.to+dPos-b.to||a.endSide-b.endSide,end2=diff<0?a.to+dPos:b.to,clipEnd=Math.min(end2,endB);if(a.point||b.point?a.point&&b.point&&(a.point==b.point||a.point.eq(b.point))&&sameValues(a.activeForPoint(a.to),b.activeForPoint(b.to))||comparator.comparePoint(pos,clipEnd,a.point,b.point):clipEnd>pos&&!sameValues(a.active,b.active)&&comparator.compareRange(pos,clipEnd,a.active,b.active),end2>endB)break;pos=end2,diff<=0&&a.next(),diff>=0&&b.next()}}function sameValues(a,b){if(a.length!=b.length)return!1;for(let i2=0;i2<a.length;i2++)if(a[i2]!=b[i2]&&!a[i2].eq(b[i2]))return!1;return!0}function remove(array,index){for(let i2=index,e=array.length-1;i2<e;i2++)array[i2]=array[i2+1];array.pop()}function insert(array,index,value){for(let i2=array.length-1;i2>=index;i2--)array[i2+1]=array[i2];array[index]=value}function findMinIndex(value,array){let found=-1,foundPos=1e9;for(let i2=0;i2<array.length;i2++)(array[i2]-foundPos||value[i2].endSide-value[found].endSide)<0&&(found=i2,foundPos=array[i2]);return found}function countColumn(string2,tabSize,to=string2.length){let n=0;for(let i2=0;i2<to;)9==string2.charCodeAt(i2)?(n+=tabSize-n%tabSize,i2++):(n++,i2=findClusterBreak(string2,i2));return n}function findColumn(string2,col,tabSize,strict){for(let i2=0,n=0;;){if(n>=col)return i2;if(i2==string2.length)break;n+=9==string2.charCodeAt(i2)?tabSize-n%tabSize:1,i2=findClusterBreak(string2,i2)}return!0===strict?-1:string2.length}const COUNT="undefined"==typeof Symbol?"__\u037c":Symbol.for("\u037c"),SET="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),top="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class StyleModule{constructor(spec,options){this.rules=[];let{finish:finish}=options||{};function splitSelector(selector){return/^@/.test(selector)?[selector]:selector.split(/,\s*/)}function render(selectors,spec2,target,isKeyframes){let local=[],isAt=/^@(\w+)\b/.exec(selectors[0]),keyframes=isAt&&"keyframes"==isAt[1];if(isAt&&null==spec2)return target.push(selectors[0]+";");for(let prop in spec2){let value=spec2[prop];if(/&/.test(prop))render(prop.split(/,\s*/).map((part=>selectors.map((sel=>part.replace(/&/,sel))))).reduce(((a,b)=>a.concat(b))),value,target);else if(value&&"object"==typeof value){if(!isAt)throw new RangeError("The value of a property ("+prop+") should be a primitive value.");render(splitSelector(prop),value,local,keyframes)}else null!=value&&local.push(prop.replace(/_.*/,"").replace(/[A-Z]/g,(l=>"-"+l.toLowerCase()))+": "+value+";")}(local.length||keyframes)&&target.push((!finish||isAt||isKeyframes?selectors:selectors.map(finish)).join(", ")+" {"+local.join(" ")+"}")}for(let prop in spec)render(splitSelector(prop),spec[prop],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let id2=top[COUNT]||1;return top[COUNT]=id2+1,"\u037c"+id2.toString(36)}static mount(root,modules,options){let set2=root[SET],nonce=options&&options.nonce;set2?nonce&&set2.setNonce(nonce):set2=new StyleSet(root,nonce),set2.mount(Array.isArray(modules)?modules:[modules])}}let adoptedSet=new Map;class StyleSet{constructor(root,nonce){let doc2=root.ownerDocument||root,win=doc2.defaultView;if(!root.head&&root.adoptedStyleSheets&&win.CSSStyleSheet){let adopted=adoptedSet.get(doc2);if(adopted)return root.adoptedStyleSheets=[adopted.sheet,...root.adoptedStyleSheets],root[SET]=adopted;this.sheet=new win.CSSStyleSheet,root.adoptedStyleSheets=[this.sheet,...root.adoptedStyleSheets],adoptedSet.set(doc2,this)}else{this.styleTag=doc2.createElement("style"),nonce&&this.styleTag.setAttribute("nonce",nonce);let target=root.head||root;target.insertBefore(this.styleTag,target.firstChild)}this.modules=[],root[SET]=this}mount(modules){let sheet=this.sheet,pos=0,j=0;for(let i2=0;i2<modules.length;i2++){let mod=modules[i2],index=this.modules.indexOf(mod);if(index<j&&index>-1&&(this.modules.splice(index,1),j--,index=-1),-1==index){if(this.modules.splice(j++,0,mod),sheet)for(let k=0;k<mod.rules.length;k++)sheet.insertRule(mod.rules[k],pos++)}else{for(;j<index;)pos+=this.modules[j++].rules.length;pos+=mod.rules.length,j++}}if(!sheet){let text2="";for(let i2=0;i2<this.modules.length;i2++)text2+=this.modules[i2].getRules()+"\n";this.styleTag.textContent=text2}}setNonce(nonce){this.styleTag&&this.styleTag.getAttribute("nonce")!=nonce&&this.styleTag.setAttribute("nonce",nonce)}}for(var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},mac="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),ie$2="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),i=0;i<10;i++)base[48+i]=base[96+i]=String(i);for(i=1;i<=24;i++)base[i+111]="F"+i;for(i=65;i<=90;i++)base[i]=String.fromCharCode(i+32),shift[i]=String.fromCharCode(i);for(var code in base)shift.hasOwnProperty(code)||(shift[code]=base[code]);function keyName(event){var name2=!(mac&&event.metaKey&&event.shiftKey&&!event.ctrlKey&&!event.altKey||ie$2&&event.shiftKey&&event.key&&1==event.key.length||"Unidentified"==event.key)&&event.key||(event.shiftKey?shift:base)[event.keyCode]||event.key||"Unidentified";return"Esc"==name2&&(name2="Escape"),"Del"==name2&&(name2="Delete"),"Left"==name2&&(name2="ArrowLeft"),"Up"==name2&&(name2="ArrowUp"),"Right"==name2&&(name2="ArrowRight"),"Down"==name2&&(name2="ArrowDown"),name2}function getSelection$1(root){let target;return target=11==root.nodeType?root.getSelection?root:root.ownerDocument:root,target.getSelection()}function contains$1(dom,node){return!!node&&(dom==node||dom.contains(1!=node.nodeType?node.parentNode:node))}function hasSelection$1(dom,selection2){if(!selection2.anchorNode)return!1;try{return contains$1(dom,selection2.anchorNode)}catch(_){return!1}}function clientRectsFor$1(dom){return 3==dom.nodeType?textRange$1(dom,0,dom.nodeValue.length).getClientRects():1==dom.nodeType?dom.getClientRects():[]}function isEquivalentPosition$1(node,off,targetNode,targetOff){return!!targetNode&&(scanFor$1(node,off,targetNode,targetOff,-1)||scanFor$1(node,off,targetNode,targetOff,1))}function domIndex$1(node){for(var index=0;;index++)if(!(node=node.previousSibling))return index}function scanFor$1(node,off,targetNode,targetOff,dir){for(;;){if(node==targetNode&&off==targetOff)return!0;if(off==(dir<0?0:maxOffset$1(node))){if("DIV"==node.nodeName)return!1;let parent=node.parentNode;if(!parent||1!=parent.nodeType)return!1;off=domIndex$1(node)+(dir<0?0:1),node=parent}else{if(1!=node.nodeType)return!1;if(1==(node=node.childNodes[off+(dir<0?-1:0)]).nodeType&&"false"==node.contentEditable)return!1;off=dir<0?maxOffset$1(node):0}}}function maxOffset$1(node){return 3==node.nodeType?node.nodeValue.length:node.childNodes.length}function flattenRect$1(rect,left2){let x=left2?rect.left:rect.right;return{left:x,right:x,top:rect.top,bottom:rect.bottom}}function windowRect$1(win){return{left:0,right:win.innerWidth,top:0,bottom:win.innerHeight}}let scratchRange$1,DOMSelectionState$1=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(domSel){return this.anchorNode==domSel.anchorNode&&this.anchorOffset==domSel.anchorOffset&&this.focusNode==domSel.focusNode&&this.focusOffset==domSel.focusOffset}setRange(range){let{anchorNode:anchorNode,focusNode:focusNode}=range;this.set(anchorNode,Math.min(range.anchorOffset,anchorNode?maxOffset$1(anchorNode):0),focusNode,Math.min(range.focusOffset,focusNode?maxOffset$1(focusNode):0))}set(anchorNode,anchorOffset,focusNode,focusOffset){this.anchorNode=anchorNode,this.anchorOffset=anchorOffset,this.focusNode=focusNode,this.focusOffset=focusOffset}},preventScrollSupported$1=null;function focusPreventScroll$1(dom){if(dom.setActive)return dom.setActive();if(preventScrollSupported$1)return dom.focus(preventScrollSupported$1);let stack=[];for(let cur2=dom;cur2&&(stack.push(cur2,cur2.scrollTop,cur2.scrollLeft),cur2!=cur2.ownerDocument);cur2=cur2.parentNode);if(dom.focus(null==preventScrollSupported$1?{get preventScroll(){return preventScrollSupported$1={preventScroll:!0},!0}}:void 0),!preventScrollSupported$1){preventScrollSupported$1=!1;for(let i2=0;i2<stack.length;){let elt=stack[i2++],top2=stack[i2++],left2=stack[i2++];elt.scrollTop!=top2&&(elt.scrollTop=top2),elt.scrollLeft!=left2&&(elt.scrollLeft=left2)}}}function textRange$1(node,from,to=from){let range=scratchRange$1||(scratchRange$1=document.createRange());return range.setEnd(node,to),range.setStart(node,from),range}function dispatchKey$1(elt,name2,code2){let options={key:name2,code:name2,keyCode:code2,which:code2,cancelable:!0},down=new KeyboardEvent("keydown",options);down.synthetic=!0,elt.dispatchEvent(down);let up=new KeyboardEvent("keyup",options);return up.synthetic=!0,elt.dispatchEvent(up),down.defaultPrevented||up.defaultPrevented}function clearAttributes$1(node){for(;node.attributes.length;)node.removeAttributeNode(node.attributes[0])}function isScrolledToBottom$1(elt){return elt.scrollTop>Math.max(1,elt.scrollHeight-elt.clientHeight-4)}let DOMPos$1=class DOMPos2{constructor(node,offset2,precise=!0){this.node=node,this.offset=offset2,this.precise=precise}static before(dom,precise){return new DOMPos2(dom.parentNode,domIndex$1(dom),precise)}static after(dom,precise){return new DOMPos2(dom.parentNode,domIndex$1(dom)+1,precise)}};const noChildren$1=[];let ContentView$1=class ContentView2{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(view){let pos=this.posAtStart;for(let child of this.children){if(child==view)return pos;pos+=child.length+child.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(view){return this.posBefore(view)+view.length}sync(view,track){if(2&this.flags){let next,parent=this.dom,prev=null;for(let child of this.children){if(7&child.flags){if(!child.dom&&(next=prev?prev.nextSibling:parent.firstChild)){let contentView=ContentView2.get(next);(!contentView||!contentView.parent&&contentView.canReuseDOM(child))&&child.reuseDOM(next)}child.sync(view,track),child.flags&=-8}if(next=prev?prev.nextSibling:parent.firstChild,track&&!track.written&&track.node==parent&&next!=child.dom&&(track.written=!0),child.dom.parentNode==parent)for(;next&&next!=child.dom;)next=rm$1$1(next);else parent.insertBefore(child.dom,next);prev=child.dom}for(next=prev?prev.nextSibling:parent.firstChild,next&&track&&track.node==parent&&(track.written=!0);next;)next=rm$1$1(next)}else if(1&this.flags)for(let child of this.children)7&child.flags&&(child.sync(view,track),child.flags&=-8)}reuseDOM(_dom){}localPosFromDOM(node,offset2){let after;if(node==this.dom)after=this.dom.childNodes[offset2];else{let bias=0==maxOffset$1(node)?0:0==offset2?-1:1;for(;;){let parent=node.parentNode;if(parent==this.dom)break;0==bias&&parent.firstChild!=parent.lastChild&&(bias=node==parent.firstChild?-1:1),node=parent}after=bias<0?node:node.nextSibling}if(after==this.dom.firstChild)return 0;for(;after&&!ContentView2.get(after);)after=after.nextSibling;if(!after)return this.length;for(let i2=0,pos=0;;i2++){let child=this.children[i2];if(child.dom==after)return pos;pos+=child.length+child.breakAfter}}domBoundsAround(from,to,offset2=0){let fromI=-1,fromStart=-1,toI=-1,toEnd=-1;for(let i2=0,pos=offset2,prevEnd=offset2;i2<this.children.length;i2++){let child=this.children[i2],end2=pos+child.length;if(pos<from&&end2>to)return child.domBoundsAround(from,to,pos);if(end2>=from&&-1==fromI&&(fromI=i2,fromStart=pos),pos>to&&child.dom.parentNode==this.dom){toI=i2,toEnd=prevEnd;break}prevEnd=end2,pos=end2+child.breakAfter}return{from:fromStart,to:toEnd<0?offset2+this.length:toEnd,startDOM:(fromI?this.children[fromI-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:toI<this.children.length&&toI>=0?this.children[toI].dom:null}}markDirty(andParent=!1){this.flags|=2,this.markParentsDirty(andParent)}markParentsDirty(childList){for(let parent=this.parent;parent;parent=parent.parent){if(childList&&(parent.flags|=2),1&parent.flags)return;parent.flags|=1,childList=!1}}setParent(parent){this.parent!=parent&&(this.parent=parent,7&this.flags&&this.markParentsDirty(!0))}setDOM(dom){this.dom!=dom&&(this.dom&&(this.dom.cmView=null),this.dom=dom,dom.cmView=this)}get rootView(){for(let v=this;;){let parent=v.parent;if(!parent)return v;v=parent}}replaceChildren(from,to,children2=noChildren$1){this.markDirty();for(let i2=from;i2<to;i2++){let child=this.children[i2];child.parent==this&&child.destroy()}this.children.splice(from,to-from,...children2);for(let i2=0;i2<children2.length;i2++)children2[i2].setParent(this)}ignoreMutation(_rec){return!1}ignoreEvent(_event){return!1}childCursor(pos=this.length){return new ChildCursor$1(this.children,pos,this.children.length)}childPos(pos,bias=1){return this.childCursor().findPos(pos,bias)}toString(){let name2=this.constructor.name.replace("View","");return name2+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==name2?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(node){return node.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(from,to,source,hasStart,openStart,openEnd){return!1}become(other){return!1}canReuseDOM(other){return other.constructor==this.constructor&&!(8&(this.flags|other.flags))}getSide(){return 0}destroy(){this.parent=null}};function rm$1$1(dom){let next=dom.nextSibling;return dom.parentNode.removeChild(dom),next}ContentView$1.prototype.breakAfter=0;let ChildCursor$1=class{constructor(children2,pos,i2){this.children=children2,this.pos=pos,this.i=i2,this.off=0}findPos(pos,bias=1){for(;;){if(pos>this.pos||pos==this.pos&&(bias>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=pos-this.pos,this;let next=this.children[--this.i];this.pos-=next.length+next.breakAfter}}};function replaceRange$1(parent,fromI,fromOff,toI,toOff,insert2,breakAtStart,openStart,openEnd){let{children:children2}=parent,before=children2.length?children2[fromI]:null,last=insert2.length?insert2[insert2.length-1]:null,breakAtEnd=last?last.breakAfter:breakAtStart;if(!(fromI==toI&&before&&!breakAtStart&&!breakAtEnd&&insert2.length<2&&before.merge(fromOff,toOff,insert2.length?last:null,0==fromOff,openStart,openEnd))){if(toI<children2.length){let after=children2[toI];after&&(toOff<after.length||after.breakAfter&&(null==last?void 0:last.breakAfter))?(fromI==toI&&(after=after.split(toOff),toOff=0),!breakAtEnd&&last&&after.merge(0,toOff,last,!0,0,openEnd)?insert2[insert2.length-1]=after:((toOff||after.children.length&&!after.children[0].length)&&after.merge(0,toOff,null,!1,0,openEnd),insert2.push(after))):(null==after?void 0:after.breakAfter)&&(last?last.breakAfter=1:breakAtStart=1),toI++}for(before&&(before.breakAfter=breakAtStart,fromOff>0&&(!breakAtStart&&insert2.length&&before.merge(fromOff,before.length,insert2[0],!1,openStart,0)?before.breakAfter=insert2.shift().breakAfter:(fromOff<before.length||before.children.length&&0==before.children[before.children.length-1].length)&&before.merge(fromOff,before.length,null,!1,openStart,0),fromI++));fromI<toI&&insert2.length;)if(children2[toI-1].become(insert2[insert2.length-1]))toI--,insert2.pop(),openEnd=insert2.length?0:openStart;else{if(!children2[fromI].become(insert2[0]))break;fromI++,insert2.shift(),openStart=insert2.length?0:openEnd}!insert2.length&&fromI&&toI<children2.length&&!children2[fromI-1].breakAfter&&children2[toI].merge(0,0,children2[fromI-1],!1,openStart,openEnd)&&fromI--,(fromI<toI||insert2.length)&&parent.replaceChildren(fromI,toI,insert2)}}function mergeChildrenInto$1(parent,from,to,insert2,openStart,openEnd){let cur2=parent.childCursor(),{i:toI,off:toOff}=cur2.findPos(to,1),{i:fromI,off:fromOff}=cur2.findPos(from,-1),dLen=from-to;for(let view of insert2)dLen+=view.length;parent.length+=dLen,replaceRange$1(parent,fromI,fromOff,toI,toOff,insert2,0,openStart,openEnd)}let nav$1="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},doc$1="undefined"!=typeof document?document:{documentElement:{style:{}}};const ie_edge$1=/Edge\/(\d+)/.exec(nav$1.userAgent),ie_upto10$1=/MSIE \d/.test(nav$1.userAgent),ie_11up$1=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav$1.userAgent),ie$1=!!(ie_upto10$1||ie_11up$1||ie_edge$1),gecko$1=!ie$1&&/gecko\/(\d+)/i.test(nav$1.userAgent),chrome$2=!ie$1&&/Chrome\/(\d+)/.exec(nav$1.userAgent),webkit$1="webkitFontSmoothing"in doc$1.documentElement.style,safari$1=!ie$1&&/Apple Computer/.test(nav$1.vendor),ios$1=safari$1&&(/Mobile\/\w+/.test(nav$1.userAgent)||nav$1.maxTouchPoints>2);var browser$2={mac:ios$1||/Mac/.test(nav$1.platform),windows:/Win/.test(nav$1.platform),linux:/Linux|X11/.test(nav$1.platform),ie:ie$1,ie_version:ie_upto10$1?doc$1.documentMode||6:ie_11up$1?+ie_11up$1[1]:ie_edge$1?+ie_edge$1[1]:0,gecko:gecko$1,gecko_version:gecko$1?+(/Firefox\/(\d+)/.exec(nav$1.userAgent)||[0,0])[1]:0,chrome:!!chrome$2,chrome_version:chrome$2?+chrome$2[1]:0,ios:ios$1,android:/Android\b/.test(nav$1.userAgent),webkit:webkit$1,safari:safari$1,webkit_version:webkit$1?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=doc$1.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};let TextView$1=class TextView2 extends ContentView$1{constructor(text2){super(),this.text=text2}get length(){return this.text.length}createDOM(textDOM){this.setDOM(textDOM||document.createTextNode(this.text))}sync(view,track){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(track&&track.node==this.dom&&(track.written=!0),this.dom.nodeValue=this.text)}reuseDOM(dom){3==dom.nodeType&&this.createDOM(dom)}merge(from,to,source){return!(8&this.flags||source&&(!(source instanceof TextView2)||this.length-(to-from)+source.length>256||8&source.flags))&&(this.text=this.text.slice(0,from)+(source?source.text:"")+this.text.slice(to),this.markDirty(),!0)}split(from){let result=new TextView2(this.text.slice(from));return this.text=this.text.slice(0,from),this.markDirty(),result.flags|=8&this.flags,result}localPosFromDOM(node,offset2){return node==this.dom?offset2:offset2?this.text.length:0}domAtPos(pos){return new DOMPos$1(this.dom,pos)}domBoundsAround(_from,_to,offset2){return{from:offset2,to:offset2+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(pos,side){return function(text2,pos,side){let length=text2.nodeValue.length;pos>length&&(pos=length);let from=pos,to=pos,flatten2=0;0==pos&&side<0||pos==length&&side>=0?browser$2.chrome||browser$2.gecko||(pos?(from--,flatten2=1):to<length&&(to++,flatten2=-1)):side<0?from--:to<length&&to++;let rects=textRange$1(text2,from,to).getClientRects();if(!rects.length)return null;let rect=rects[(flatten2?flatten2<0:side>=0)?0:rects.length-1];browser$2.safari&&!flatten2&&0==rect.width&&(rect=Array.prototype.find.call(rects,(r=>r.width))||rect);return flatten2?flattenRect$1(rect,flatten2<0):rect||null}(this.dom,pos,side)}},MarkView$1=class MarkView2 extends ContentView$1{constructor(mark,children2=[],length=0){super(),this.mark=mark,this.children=children2,this.length=length;for(let ch of children2)ch.setParent(this)}setAttrs(dom){if(clearAttributes$1(dom),this.mark.class&&(dom.className=this.mark.class),this.mark.attrs)for(let name2 in this.mark.attrs)dom.setAttribute(name2,this.mark.attrs[name2]);return dom}canReuseDOM(other){return super.canReuseDOM(other)&&!(8&(this.flags|other.flags))}reuseDOM(node){node.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(node),this.flags|=6)}sync(view,track){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(view,track)}merge(from,to,source,_hasStart,openStart,openEnd){return(!source||!(!(source instanceof MarkView2&&source.mark.eq(this.mark))||from&&openStart<=0||to<this.length&&openEnd<=0))&&(mergeChildrenInto$1(this,from,to,source?source.children:[],openStart-1,openEnd-1),this.markDirty(),!0)}split(from){let result=[],off=0,detachFrom=-1,i2=0;for(let elt of this.children){let end2=off+elt.length;end2>from&&result.push(off<from?elt.split(from-off):elt),detachFrom<0&&off>=from&&(detachFrom=i2),off=end2,i2++}let length=this.length-from;return this.length=from,detachFrom>-1&&(this.children.length=detachFrom,this.markDirty()),new MarkView2(this.mark,result,length)}domAtPos(pos){return inlineDOMAtPos$1(this,pos)}coordsAt(pos,side){return coordsInChildren$1(this,pos,side)}};let WidgetView$1=class WidgetView2 extends ContentView$1{static create(widget,length,side){return new WidgetView2(widget,length,side)}constructor(widget,length,side){super(),this.widget=widget,this.length=length,this.side=side,this.prevWidget=null}split(from){let result=WidgetView2.create(this.widget,this.length-from,this.side);return this.length-=from,result}sync(view){this.dom&&this.widget.updateDOM(this.dom,view)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(view)),this.dom.contentEditable="false")}getSide(){return this.side}merge(from,to,source,hasStart,openStart,openEnd){return!(source&&(!(source instanceof WidgetView2&&this.widget.compare(source.widget))||from>0&&openStart<=0||to<this.length&&openEnd<=0))&&(this.length=from+(source?source.length:0)+(this.length-to),!0)}become(other){return other instanceof WidgetView2&&other.side==this.side&&this.widget.constructor==other.widget.constructor&&(this.widget.compare(other.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=other.widget,this.length=other.length,!0)}ignoreMutation(){return!0}ignoreEvent(event){return this.widget.ignoreEvent(event)}get overrideDOMText(){if(0==this.length)return Text.empty;let top2=this;for(;top2.parent;)top2=top2.parent;let{view:view}=top2,text2=view&&view.state.doc,start2=this.posAtStart;return text2?text2.slice(start2,start2+this.length):Text.empty}domAtPos(pos){return(this.length?0==pos:this.side>0)?DOMPos$1.before(this.dom):DOMPos$1.after(this.dom,pos==this.length)}domBoundsAround(){return null}coordsAt(pos,side){let custom2=this.widget.coordsAt(this.dom,pos,side);if(custom2)return custom2;let rects=this.dom.getClientRects(),rect=null;if(!rects.length)return null;let fromBack=this.side?this.side<0:pos>0;for(let i2=fromBack?rects.length-1:0;rect=rects[i2],!(pos>0?0==i2:i2==rects.length-1||rect.top<rect.bottom);i2+=fromBack?-1:1);return flattenRect$1(rect,!fromBack)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}},WidgetBufferView$1=class WidgetBufferView2 extends ContentView$1{constructor(side){super(),this.side=side}get length(){return 0}merge(){return!1}become(other){return other instanceof WidgetBufferView2&&other.side==this.side}split(){return new WidgetBufferView2(this.side)}sync(){if(!this.dom){let dom=document.createElement("img");dom.className="cm-widgetBuffer",dom.setAttribute("aria-hidden","true"),this.setDOM(dom)}}getSide(){return this.side}domAtPos(pos){return this.side>0?DOMPos$1.before(this.dom):DOMPos$1.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(pos){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Text.empty}get isHidden(){return!0}};function inlineDOMAtPos$1(parent,pos){let dom=parent.dom,{children:children2}=parent,i2=0;for(let off=0;i2<children2.length;i2++){let child=children2[i2],end2=off+child.length;if(!(end2==off&&child.getSide()<=0)){if(pos>off&&pos<end2&&child.dom.parentNode==dom)return child.domAtPos(pos-off);if(pos<=off)break;off=end2}}for(let j=i2;j>0;j--){let prev=children2[j-1];if(prev.dom.parentNode==dom)return prev.domAtPos(prev.length)}for(let j=i2;j<children2.length;j++){let next=children2[j];if(next.dom.parentNode==dom)return next.domAtPos(0)}return new DOMPos$1(dom,0)}function joinInlineInto$1(parent,view,open){let last,{children:children2}=parent;open>0&&view instanceof MarkView$1&&children2.length&&(last=children2[children2.length-1])instanceof MarkView$1&&last.mark.eq(view.mark)?joinInlineInto$1(last,view.children[0],open-1):(children2.push(view),view.setParent(parent)),parent.length+=view.length}function coordsInChildren$1(view,pos,side){let before=null,beforePos=-1,after=null,afterPos=-1;!function scan(view2,pos2){for(let i2=0,off=0;i2<view2.children.length&&off<=pos2;i2++){let child=view2.children[i2],end2=off+child.length;end2>=pos2&&(child.children.length?scan(child,pos2-off):(!after||after.isHidden&&side>0)&&(end2>pos2||off==end2&&child.getSide()>0)?(after=child,afterPos=pos2-off):(off<pos2||off==end2&&child.getSide()<0&&!child.isHidden)&&(before=child,beforePos=pos2-off)),off=end2}}(view,pos);let target=(side<0?before:after)||before||after;return target?target.coordsAt(Math.max(0,target==before?beforePos:afterPos),side):function(view){let last=view.dom.lastChild;if(!last)return view.dom.getBoundingClientRect();let rects=clientRectsFor$1(last);return rects[rects.length-1]||null}(view)}function combineAttrs$1(source,target){for(let name2 in source)"class"==name2&&target.class?target.class+=" "+source.class:"style"==name2&&target.style?target.style+=";"+source.style:target[name2]=source[name2];return target}TextView$1.prototype.children=WidgetView$1.prototype.children=WidgetBufferView$1.prototype.children=noChildren$1;const noAttrs$1=Object.create(null);function attrsEq$1(a,b,ignore){if(a==b)return!0;a||(a=noAttrs$1),b||(b=noAttrs$1);let keysA=Object.keys(a),keysB=Object.keys(b);if(keysA.length-(ignore&&keysA.indexOf(ignore)>-1?1:0)!=keysB.length-(ignore&&keysB.indexOf(ignore)>-1?1:0))return!1;for(let key of keysA)if(key!=ignore&&(-1==keysB.indexOf(key)||a[key]!==b[key]))return!1;return!0}function updateAttrs$1(dom,prev,attrs){let changed=!1;if(prev)for(let name2 in prev)attrs&&name2 in attrs||(changed=!0,"style"==name2?dom.style.cssText="":dom.removeAttribute(name2));if(attrs)for(let name2 in attrs)prev&&prev[name2]==attrs[name2]||(changed=!0,"style"==name2?dom.style.cssText=attrs[name2]:dom.setAttribute(name2,attrs[name2]));return changed}function getAttrs$1(dom){let attrs=Object.create(null);for(let i2=0;i2<dom.attributes.length;i2++){let attr2=dom.attributes[i2];attrs[attr2.name]=attr2.value}return attrs}let LineView$1=class LineView2 extends ContentView$1{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(from,to,source,hasStart,openStart,openEnd){if(source){if(!(source instanceof LineView2))return!1;this.dom||source.transferDOM(this)}return hasStart&&this.setDeco(source?source.attrs:null),mergeChildrenInto$1(this,from,to,source?source.children:[],openStart,openEnd),!0}split(at){let end2=new LineView2;if(end2.breakAfter=this.breakAfter,0==this.length)return end2;let{i:i2,off:off}=this.childPos(at);off&&(end2.append(this.children[i2].split(off),0),this.children[i2].merge(off,this.children[i2].length,null,!1,0,0),i2++);for(let j=i2;j<this.children.length;j++)end2.append(this.children[j],0);for(;i2>0&&0==this.children[i2-1].length;)this.children[--i2].destroy();return this.children.length=i2,this.markDirty(),this.length=at,end2}transferDOM(other){this.dom&&(this.markDirty(),other.setDOM(this.dom),other.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(attrs){attrsEq$1(this.attrs,attrs)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=attrs)}append(child,openStart){joinInlineInto$1(this,child,openStart)}addLineDeco(deco){let attrs=deco.spec.attributes,cls=deco.spec.class;attrs&&(this.attrs=combineAttrs$1(attrs,this.attrs||{})),cls&&(this.attrs=combineAttrs$1({class:cls},this.attrs||{}))}domAtPos(pos){return inlineDOMAtPos$1(this,pos)}reuseDOM(node){"DIV"==node.nodeName&&(this.setDOM(node),this.flags|=6)}sync(view,track){var _a2;this.dom?4&this.flags&&(clearAttributes$1(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(updateAttrs$1(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(view,track);let last=this.dom.lastChild;for(;last&&ContentView$1.get(last)instanceof MarkView$1;)last=last.lastChild;if(!(last&&this.length&&("BR"==last.nodeName||0!=(null===(_a2=ContentView$1.get(last))||void 0===_a2?void 0:_a2.isEditable)||browser$2.ios&&this.children.some((ch=>ch instanceof TextView$1))))){let hack=document.createElement("BR");hack.cmIgnore=!0,this.dom.appendChild(hack)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let textHeight,totalWidth=0;for(let child of this.children){if(!(child instanceof TextView$1)||/[^ -~]/.test(child.text))return null;let rects=clientRectsFor$1(child.dom);if(1!=rects.length)return null;totalWidth+=rects[0].width,textHeight=rects[0].height}return totalWidth?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:totalWidth/this.length,textHeight:textHeight}:null}coordsAt(pos,side){let rect=coordsInChildren$1(this,pos,side);if(!this.children.length&&rect&&this.parent){let{heightOracle:heightOracle}=this.parent.view.viewState,height=rect.bottom-rect.top;if(Math.abs(height-heightOracle.lineHeight)<2&&heightOracle.textHeight<height){let dist2=(height-heightOracle.textHeight)/2;return{top:rect.top+dist2,bottom:rect.bottom-dist2,left:rect.left,right:rect.left}}}return rect}become(_other){return!1}covers(){return!0}static find(docView,pos){for(let i2=0,off=0;i2<docView.children.length;i2++){let block=docView.children[i2],end2=off+block.length;if(end2>=pos){if(block instanceof LineView2)return block;if(end2>pos)break}off=end2+block.breakAfter}return null}},BlockWidgetView$1=class BlockWidgetView2 extends ContentView$1{constructor(widget,length,deco){super(),this.widget=widget,this.length=length,this.deco=deco,this.breakAfter=0,this.prevWidget=null}merge(from,to,source,_takeDeco,openStart,openEnd){return!(source&&(!(source instanceof BlockWidgetView2&&this.widget.compare(source.widget))||from>0&&openStart<=0||to<this.length&&openEnd<=0))&&(this.length=from+(source?source.length:0)+(this.length-to),!0)}domAtPos(pos){return 0==pos?DOMPos$1.before(this.dom):DOMPos$1.after(this.dom,pos==this.length)}split(at){let len=this.length-at;this.length=at;let end2=new BlockWidgetView2(this.widget,len,this.deco);return end2.breakAfter=this.breakAfter,end2}get children(){return noChildren$1}sync(view){this.dom&&this.widget.updateDOM(this.dom,view)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(view)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Text.empty}domBoundsAround(){return null}become(other){return other instanceof BlockWidgetView2&&other.widget.constructor==this.widget.constructor&&(other.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=other.widget,this.length=other.length,this.deco=other.deco,this.breakAfter=other.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(event){return this.widget.ignoreEvent(event)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(pos,side){return this.widget.coordsAt(this.dom,pos,side)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(side){let{startSide:startSide,endSide:endSide}=this.deco;return startSide!=endSide&&(side<0?startSide<0:endSide>0)}},WidgetType$1=class{eq(widget){return!1}updateDOM(dom,view){return!1}compare(other){return this==other||this.constructor==other.constructor&&this.eq(other)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(event){return!0}coordsAt(dom,pos,side){return null}get isHidden(){return!1}destroy(dom){}};var BlockType$1=function(BlockType2){return BlockType2[BlockType2.Text=0]="Text",BlockType2[BlockType2.WidgetBefore=1]="WidgetBefore",BlockType2[BlockType2.WidgetAfter=2]="WidgetAfter",BlockType2[BlockType2.WidgetRange=3]="WidgetRange",BlockType2}(BlockType$1||(BlockType$1={}));let Decoration$1=class extends RangeValue{constructor(startSide,endSide,widget,spec){super(),this.startSide=startSide,this.endSide=endSide,this.widget=widget,this.spec=spec}get heightRelevant(){return!1}static mark(spec){return new MarkDecoration$1(spec)}static widget(spec){let side=Math.max(-1e4,Math.min(1e4,spec.side||0)),block=!!spec.block;return side+=block&&!spec.inlineOrder?side>0?3e8:-4e8:side>0?1e8:-1e8,new PointDecoration$1(spec,side,side,block,spec.widget||null,!1)}static replace(spec){let startSide,endSide,block=!!spec.block;if(spec.isBlockGap)startSide=-5e8,endSide=4e8;else{let{start:start2,end:end2}=getInclusive$1(spec,block);startSide=(start2?block?-3e8:-1:5e8)-1,endSide=1+(end2?block?2e8:1:-6e8)}return new PointDecoration$1(spec,startSide,endSide,block,spec.widget||null,!0)}static line(spec){return new LineDecoration$1(spec)}static set(of,sort=!1){return RangeSet.of(of,sort)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}};Decoration$1.none=RangeSet.empty;let MarkDecoration$1=class MarkDecoration2 extends Decoration$1{constructor(spec){let{start:start2,end:end2}=getInclusive$1(spec);super(start2?-1:5e8,end2?1:-6e8,null,spec),this.tagName=spec.tagName||"span",this.class=spec.class||"",this.attrs=spec.attributes||null}eq(other){var _a2,_b;return this==other||other instanceof MarkDecoration2&&this.tagName==other.tagName&&(this.class||(null===(_a2=this.attrs)||void 0===_a2?void 0:_a2.class))==(other.class||(null===(_b=other.attrs)||void 0===_b?void 0:_b.class))&&attrsEq$1(this.attrs,other.attrs,"class")}range(from,to=from){if(from>=to)throw new RangeError("Mark decorations may not be empty");return super.range(from,to)}};MarkDecoration$1.prototype.point=!1;let LineDecoration$1=class LineDecoration2 extends Decoration$1{constructor(spec){super(-2e8,-2e8,null,spec)}eq(other){return other instanceof LineDecoration2&&this.spec.class==other.spec.class&&attrsEq$1(this.spec.attributes,other.spec.attributes)}range(from,to=from){if(to!=from)throw new RangeError("Line decoration ranges must be zero-length");return super.range(from,to)}};LineDecoration$1.prototype.mapMode=MapMode.TrackBefore,LineDecoration$1.prototype.point=!0;let PointDecoration$1=class PointDecoration2 extends Decoration$1{constructor(spec,startSide,endSide,block,widget,isReplace){super(startSide,endSide,widget,spec),this.block=block,this.isReplace=isReplace,this.mapMode=block?startSide<=0?MapMode.TrackBefore:MapMode.TrackAfter:MapMode.TrackDel}get type(){return this.startSide!=this.endSide?BlockType$1.WidgetRange:this.startSide<=0?BlockType$1.WidgetBefore:BlockType$1.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(other){return other instanceof PointDecoration2&&(a=this.widget,b=other.widget,a==b||!!(a&&b&&a.compare(b)))&&this.block==other.block&&this.startSide==other.startSide&&this.endSide==other.endSide;var a,b}range(from,to=from){if(this.isReplace&&(from>to||from==to&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&to!=from)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(from,to)}};function getInclusive$1(spec,block=!1){let{inclusiveStart:start2,inclusiveEnd:end2}=spec;return null==start2&&(start2=spec.inclusive),null==end2&&(end2=spec.inclusive),{start:null!=start2?start2:block,end:null!=end2?end2:block}}function addRange$1(from,to,ranges,margin=0){let last=ranges.length-1;last>=0&&ranges[last]+margin>=from?ranges[last]=Math.max(ranges[last],to):ranges.push(from,to)}PointDecoration$1.prototype.point=!0;let ContentBuilder$1=class ContentBuilder2{constructor(doc2,pos,end2,disallowBlockEffectsFor){this.doc=doc2,this.pos=pos,this.end=end2,this.disallowBlockEffectsFor=disallowBlockEffectsFor,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=doc2.iter(),this.skip=pos}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let last=this.content[this.content.length-1];return!(last.breakAfter||last instanceof BlockWidgetView$1&&last.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new LineView$1),this.atCursorPos=!0),this.curLine}flushBuffer(active2=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(wrapMarks$1(new WidgetBufferView$1(-1),active2),active2.length),this.pendingBuffer=0)}addBlockWidget(view){this.flushBuffer(),this.curLine=null,this.content.push(view)}finish(openEnd){this.pendingBuffer&&openEnd<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||openEnd&&this.content.length&&this.content[this.content.length-1]instanceof BlockWidgetView$1||this.getLine()}buildText(length,active2,openStart){for(;length>0;){if(this.textOff==this.text.length){let{value:value,lineBreak:lineBreak,done:done}=this.cursor.next(this.skip);if(this.skip=0,done)throw new Error("Ran out of text content when drawing inline views");if(lineBreak){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,length--;continue}this.text=value,this.textOff=0}let take=Math.min(this.text.length-this.textOff,length,512);this.flushBuffer(active2.slice(active2.length-openStart)),this.getLine().append(wrapMarks$1(new TextView$1(this.text.slice(this.textOff,this.textOff+take)),active2),openStart),this.atCursorPos=!0,this.textOff+=take,length-=take,openStart=0}}span(from,to,active2,openStart){this.buildText(to-from,active2,openStart),this.pos=to,this.openStart<0&&(this.openStart=openStart)}point(from,to,deco,active2,openStart,index){if(this.disallowBlockEffectsFor[index]&&deco instanceof PointDecoration$1){if(deco.block)throw new RangeError("Block decorations may not be specified via plugins");if(to>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let len=to-from;if(deco instanceof PointDecoration$1)if(deco.block)deco.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new BlockWidgetView$1(deco.widget||new NullWidget$1("div"),len,deco));else{let view=WidgetView$1.create(deco.widget||new NullWidget$1("span"),len,len?0:deco.startSide),cursorBefore=this.atCursorPos&&!view.isEditable&&openStart<=active2.length&&(from<to||deco.startSide>0),cursorAfter=!view.isEditable&&(from<to||openStart>active2.length||deco.startSide<=0),line=this.getLine();2!=this.pendingBuffer||cursorBefore||view.isEditable||(this.pendingBuffer=0),this.flushBuffer(active2),cursorBefore&&(line.append(wrapMarks$1(new WidgetBufferView$1(1),active2),openStart),openStart=active2.length+Math.max(0,openStart-active2.length)),line.append(wrapMarks$1(view,active2),openStart),this.atCursorPos=cursorAfter,this.pendingBuffer=cursorAfter?from<to||openStart>active2.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=active2.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(deco);len&&(this.textOff+len<=this.text.length?this.textOff+=len:(this.skip+=len-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=to),this.openStart<0&&(this.openStart=openStart)}static build(text2,from,to,decorations2,dynamicDecorationMap){let builder=new ContentBuilder2(text2,from,to,dynamicDecorationMap);return builder.openEnd=RangeSet.spans(decorations2,from,to,builder),builder.openStart<0&&(builder.openStart=builder.openEnd),builder.finish(builder.openEnd),builder}};function wrapMarks$1(view,active2){for(let mark of active2)view=new MarkView$1(mark,[view],view.length);return view}let NullWidget$1=class extends WidgetType$1{constructor(tag){super(),this.tag=tag}eq(other){return other.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(elt){return elt.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}};const clickAddsSelectionRange$1=Facet.define(),dragMovesSelection$1$1=Facet.define(),mouseSelectionStyle$1=Facet.define(),exceptionSink$1=Facet.define(),updateListener$1=Facet.define(),inputHandler$2=Facet.define(),focusChangeEffect$1=Facet.define(),perLineTextDirection$1=Facet.define({combine:values=>values.some((x=>x))}),nativeSelectionHidden$1=Facet.define({combine:values=>values.some((x=>x))});let ScrollTarget$1=class ScrollTarget2{constructor(range,y="nearest",x="nearest",yMargin=5,xMargin=5,isSnapshot=!1){this.range=range,this.y=y,this.x=x,this.yMargin=yMargin,this.xMargin=xMargin,this.isSnapshot=isSnapshot}map(changes){return changes.empty?this:new ScrollTarget2(this.range.map(changes),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(state){return this.range.to<=state.doc.length?this:new ScrollTarget2(EditorSelection.cursor(state.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}};const scrollIntoView$2=StateEffect.define({map:(t2,ch)=>t2.map(ch)});function logException$1(state,exception,context){let handler=state.facet(exceptionSink$1);handler.length?handler[0](exception):window.onerror?window.onerror(String(exception),context,void 0,void 0,exception):context?console.error(context+":",exception):console.error(exception)}const editable$1=Facet.define({combine:values=>!values.length||values[0]});let nextPluginID$1=0;const viewPlugin$1=Facet.define();let ViewPlugin$1=class ViewPlugin2{constructor(id2,create,domEventHandlers,domEventObservers,buildExtensions){this.id=id2,this.create=create,this.domEventHandlers=domEventHandlers,this.domEventObservers=domEventObservers,this.extension=buildExtensions(this)}static define(create,spec){const{eventHandlers:eventHandlers,eventObservers:eventObservers,provide:provide,decorations:deco}=spec||{};return new ViewPlugin2(nextPluginID$1++,create,eventHandlers,eventObservers,(plugin=>{let ext=[viewPlugin$1.of(plugin)];return deco&&ext.push(decorations$1.of((view=>{let pluginInst=view.plugin(plugin);return pluginInst?deco(pluginInst):Decoration$1.none}))),provide&&ext.push(provide(plugin)),ext}))}static fromClass(cls,spec){return ViewPlugin2.define((view=>new cls(view)),spec)}},PluginInstance$1=class{constructor(spec){this.spec=spec,this.mustUpdate=null,this.value=null}update(view){if(this.value){if(this.mustUpdate){let update2=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(update2)}catch(e){if(logException$1(update2.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(_){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(view)}catch(e){logException$1(view.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(view){var _a2;if(null===(_a2=this.value)||void 0===_a2?void 0:_a2.destroy)try{this.value.destroy()}catch(e){logException$1(view.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}};const editorAttributes$1=Facet.define(),contentAttributes$1=Facet.define(),decorations$1=Facet.define(),atomicRanges$1=Facet.define(),bidiIsolatedRanges$1=Facet.define();function getIsolatedRanges$1(view,from,to){let isolates=view.state.facet(bidiIsolatedRanges$1);if(!isolates.length)return isolates;let sets=isolates.map((i2=>i2 instanceof Function?i2(view):i2)),result=[];return RangeSet.spans(sets,from,to,{point(){},span(from2,to2,active2,open){let level=result;for(let i2=active2.length-1;i2>=0;i2--,open--){let update2,iso=active2[i2].spec.bidiIsolate;if(null!=iso)if(open>0&&level.length&&(update2=level[level.length-1]).to==from2&&update2.direction==iso)update2.to=to2,level=update2.inner;else{let add2={from:from2,to:to2,direction:iso,inner:[]};level.push(add2),level=add2.inner}}}}),result}const scrollMargins$1=Facet.define();function getScrollMargins$1(view){let left2=0,right2=0,top2=0,bottom2=0;for(let source of view.state.facet(scrollMargins$1)){let m=source(view);m&&(null!=m.left&&(left2=Math.max(left2,m.left)),null!=m.right&&(right2=Math.max(right2,m.right)),null!=m.top&&(top2=Math.max(top2,m.top)),null!=m.bottom&&(bottom2=Math.max(bottom2,m.bottom)))}return{left:left2,right:right2,top:top2,bottom:bottom2}}const styleModule$1=Facet.define();let ChangedRange$1=class ChangedRange2{constructor(fromA,toA,fromB,toB){this.fromA=fromA,this.toA=toA,this.fromB=fromB,this.toB=toB}join(other){return new ChangedRange2(Math.min(this.fromA,other.fromA),Math.max(this.toA,other.toA),Math.min(this.fromB,other.fromB),Math.max(this.toB,other.toB))}addToSet(set2){let i2=set2.length,me=this;for(;i2>0;i2--){let range=set2[i2-1];if(!(range.fromA>me.toA)){if(range.toA<me.fromA)break;me=me.join(range),set2.splice(i2-1,1)}}return set2.splice(i2,0,me),set2}static extendWithRanges(diff,ranges){if(0==ranges.length)return diff;let result=[];for(let dI=0,rI=0,posA=0,posB=0;;dI++){let next=dI==diff.length?null:diff[dI],off=posA-posB,end2=next?next.fromB:1e9;for(;rI<ranges.length&&ranges[rI]<end2;){let from=ranges[rI],to=ranges[rI+1],fromB=Math.max(posB,from),toB=Math.min(end2,to);if(fromB<=toB&&new ChangedRange2(fromB+off,toB+off,fromB,toB).addToSet(result),to>end2)break;rI+=2}if(!next)return result;new ChangedRange2(next.fromA,next.toA,next.fromB,next.toB).addToSet(result),posA=next.toA,posB=next.toB}}},ViewUpdate$1=class ViewUpdate2{constructor(view,state,transactions){this.view=view,this.state=state,this.transactions=transactions,this.flags=0,this.startState=view.state,this.changes=ChangeSet.empty(this.startState.doc.length);for(let tr of transactions)this.changes=this.changes.compose(tr.changes);let changedRanges=[];this.changes.iterChangedRanges(((fromA,toA,fromB,toB)=>changedRanges.push(new ChangedRange$1(fromA,toA,fromB,toB)))),this.changedRanges=changedRanges}static create(view,state,transactions){return new ViewUpdate2(view,state,transactions)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((tr=>tr.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}};var Direction$1=function(Direction2){return Direction2[Direction2.LTR=0]="LTR",Direction2[Direction2.RTL=1]="RTL",Direction2}(Direction$1||(Direction$1={}));const LTR$1=Direction$1.LTR,RTL$1=Direction$1.RTL;function dec$1(str){let result=[];for(let i2=0;i2<str.length;i2++)result.push(1<<+str[i2]);return result}const LowTypes$1=dec$1("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ArabicTypes$1=dec$1("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Brackets$1=Object.create(null),BracketStack$1=[];for(let p of["()","[]","{}"]){let l=p.charCodeAt(0),r=p.charCodeAt(1);Brackets$1[l]=r,Brackets$1[r]=-l}const BidiRE$1=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;let BidiSpan$1=class{get dir(){return this.level%2?RTL$1:LTR$1}constructor(from,to,level){this.from=from,this.to=to,this.level=level}side(end2,dir){return this.dir==dir==end2?this.to:this.from}static find(order2,index,level,assoc){let maybe=-1;for(let i2=0;i2<order2.length;i2++){let span=order2[i2];if(span.from<=index&&span.to>=index){if(span.level==level)return i2;(maybe<0||(0!=assoc?assoc<0?span.from<index:span.to>index:order2[maybe].level>span.level))&&(maybe=i2)}}if(maybe<0)throw new RangeError("Index out of range");return maybe}};function isolatesEq$1(a,b){if(a.length!=b.length)return!1;for(let i2=0;i2<a.length;i2++){let iA=a[i2],iB=b[i2];if(iA.from!=iB.from||iA.to!=iB.to||iA.direction!=iB.direction||!isolatesEq$1(iA.inner,iB.inner))return!1}return!0}const types$1=[];function emitSpans$1(line,from,to,level,baseLevel,isolates,order2){let ourType=level%2?2:1;if(level%2==baseLevel%2)for(let iCh=from,iI=0;iCh<to;){let sameDir=!0,isNum=!1;if(iI==isolates.length||iCh<isolates[iI].from){let next=types$1[iCh];next!=ourType&&(sameDir=!1,isNum=16==next)}let recurse=sameDir||1!=ourType?null:[],localLevel=sameDir?level:level+1,iScan=iCh;run:for(;;)if(iI<isolates.length&&iScan==isolates[iI].from){if(isNum)break run;let iso=isolates[iI];if(!sameDir)for(let upto=iso.to,jI=iI+1;;){if(upto==to)break run;if(!(jI<isolates.length&&isolates[jI].from==upto)){if(types$1[upto]==ourType)break run;break}upto=isolates[jI++].to}if(iI++,recurse)recurse.push(iso);else{iso.from>iCh&&order2.push(new BidiSpan$1(iCh,iso.from,localLevel)),computeSectionOrder$1(line,iso.direction==LTR$1!=!(localLevel%2)?level+1:level,baseLevel,iso.inner,iso.from,iso.to,order2),iCh=iso.to}iScan=iso.to}else{if(iScan==to||(sameDir?types$1[iScan]!=ourType:types$1[iScan]==ourType))break;iScan++}recurse?emitSpans$1(line,iCh,iScan,level+1,baseLevel,recurse,order2):iCh<iScan&&order2.push(new BidiSpan$1(iCh,iScan,localLevel)),iCh=iScan}else for(let iCh=to,iI=isolates.length;iCh>from;){let sameDir=!0,isNum=!1;if(!iI||iCh>isolates[iI-1].to){let next=types$1[iCh-1];next!=ourType&&(sameDir=!1,isNum=16==next)}let recurse=sameDir||1!=ourType?null:[],localLevel=sameDir?level:level+1,iScan=iCh;run:for(;;)if(iI&&iScan==isolates[iI-1].to){if(isNum)break run;let iso=isolates[--iI];if(!sameDir)for(let upto=iso.from,jI=iI;;){if(upto==from)break run;if(!jI||isolates[jI-1].to!=upto){if(types$1[upto-1]==ourType)break run;break}upto=isolates[--jI].from}if(recurse)recurse.push(iso);else{iso.to<iCh&&order2.push(new BidiSpan$1(iso.to,iCh,localLevel)),computeSectionOrder$1(line,iso.direction==LTR$1!=!(localLevel%2)?level+1:level,baseLevel,iso.inner,iso.from,iso.to,order2),iCh=iso.from}iScan=iso.from}else{if(iScan==from||(sameDir?types$1[iScan-1]!=ourType:types$1[iScan-1]==ourType))break;iScan--}recurse?emitSpans$1(line,iScan,iCh,level+1,baseLevel,recurse,order2):iScan<iCh&&order2.push(new BidiSpan$1(iScan,iCh,localLevel)),iCh=iScan}}function computeSectionOrder$1(line,level,baseLevel,isolates,from,to,order2){let outerType=level%2?2:1;!function(line,rFrom,rTo,isolates,outerType){for(let iI=0;iI<=isolates.length;iI++){let from=iI?isolates[iI-1].to:rFrom,to=iI<isolates.length?isolates[iI].from:rTo,prevType=iI?256:outerType;for(let i2=from,prev=prevType,prevStrong=prevType;i2<to;i2++){let type2=(ch=line.charCodeAt(i2))<=247?LowTypes$1[ch]:1424<=ch&&ch<=1524?2:1536<=ch&&ch<=1785?ArabicTypes$1[ch-1536]:1774<=ch&&ch<=2220?4:8192<=ch&&ch<=8203?256:64336<=ch&&ch<=65023?4:8204==ch?256:1;512==type2?type2=prev:8==type2&&4==prevStrong&&(type2=16),types$1[i2]=4==type2?2:type2,7&type2&&(prevStrong=type2),prev=type2}for(let i2=from,prev=prevType,prevStrong=prevType;i2<to;i2++){let type2=types$1[i2];if(128==type2)i2<to-1&&prev==types$1[i2+1]&&24&prev?type2=types$1[i2]=prev:types$1[i2]=256;else if(64==type2){let end2=i2+1;for(;end2<to&&64==types$1[end2];)end2++;let replace=i2&&8==prev||end2<rTo&&8==types$1[end2]?1==prevStrong?1:8:256;for(let j=i2;j<end2;j++)types$1[j]=replace;i2=end2-1}else 8==type2&&1==prevStrong&&(types$1[i2]=1);prev=type2,7&type2&&(prevStrong=type2)}}var ch}(line,from,to,isolates,outerType),function(line,rFrom,rTo,isolates,outerType){let oppositeType=1==outerType?2:1;for(let iI=0,sI=0,context=0;iI<=isolates.length;iI++){let from=iI?isolates[iI-1].to:rFrom,to=iI<isolates.length?isolates[iI].from:rTo;for(let ch,br,type2,i2=from;i2<to;i2++)if(br=Brackets$1[ch=line.charCodeAt(i2)])if(br<0){for(let sJ=sI-3;sJ>=0;sJ-=3)if(BracketStack$1[sJ+1]==-br){let flags=BracketStack$1[sJ+2],type3=2&flags?outerType:4&flags?1&flags?oppositeType:outerType:0;type3&&(types$1[i2]=types$1[BracketStack$1[sJ]]=type3),sI=sJ;break}}else{if(189==BracketStack$1.length)break;BracketStack$1[sI++]=i2,BracketStack$1[sI++]=ch,BracketStack$1[sI++]=context}else if(2==(type2=types$1[i2])||1==type2){let embed=type2==outerType;context=embed?0:1;for(let sJ=sI-3;sJ>=0;sJ-=3){let cur2=BracketStack$1[sJ+2];if(2&cur2)break;if(embed)BracketStack$1[sJ+2]|=2;else{if(4&cur2)break;BracketStack$1[sJ+2]|=4}}}}}(line,from,to,isolates,outerType),function(rFrom,rTo,isolates,outerType){for(let iI=0,prev=outerType;iI<=isolates.length;iI++){let from=iI?isolates[iI-1].to:rFrom,to=iI<isolates.length?isolates[iI].from:rTo;for(let i2=from;i2<to;){let type2=types$1[i2];if(256==type2){let end2=i2+1;for(;;)if(end2==to){if(iI==isolates.length)break;end2=isolates[iI++].to,to=iI<isolates.length?isolates[iI].from:rTo}else{if(256!=types$1[end2])break;end2++}let beforeL=1==prev,replace=beforeL==(1==(end2<rTo?types$1[end2]:outerType))?beforeL?1:2:outerType;for(let j=end2,jI=iI,fromJ=jI?isolates[jI-1].to:rFrom;j>i2;)j==fromJ&&(j=isolates[--jI].from,fromJ=jI?isolates[jI-1].to:rFrom),types$1[--j]=replace;i2=end2}else prev=type2,i2++}}}(from,to,isolates,outerType),emitSpans$1(line,from,to,level,baseLevel,isolates,order2)}function trivialOrder$1(length){return[new BidiSpan$1(0,length,0)]}let movedOver$1="";function moveVisually$1(line,order2,dir,start2,forward){var _a2;let startIndex=start2.head-line.from,spanI=-1;if(0==startIndex){if(!forward||!line.length)return null;order2[0].level!=dir&&(startIndex=order2[0].side(!1,dir),spanI=0)}else if(startIndex==line.length){if(forward)return null;let last=order2[order2.length-1];last.level!=dir&&(startIndex=last.side(!0,dir),spanI=order2.length-1)}spanI<0&&(spanI=BidiSpan$1.find(order2,startIndex,null!==(_a2=start2.bidiLevel)&&void 0!==_a2?_a2:-1,start2.assoc));let span=order2[spanI];startIndex==span.side(forward,dir)&&(span=order2[spanI+=forward?1:-1],startIndex=span.side(!forward,dir));let indexForward=forward==(span.dir==dir),nextIndex=findClusterBreak(line.text,startIndex,indexForward);if(movedOver$1=line.text.slice(Math.min(startIndex,nextIndex),Math.max(startIndex,nextIndex)),nextIndex!=span.side(forward,dir))return EditorSelection.cursor(nextIndex+line.from,indexForward?-1:1,span.level);let nextSpan=spanI==(forward?order2.length-1:0)?null:order2[spanI+(forward?1:-1)];return nextSpan||span.level==dir?nextSpan&&nextSpan.level<span.level?EditorSelection.cursor(nextSpan.side(!forward,dir)+line.from,forward?1:-1,nextSpan.level):EditorSelection.cursor(nextIndex+line.from,forward?-1:1,span.level):EditorSelection.cursor(forward?line.to:line.from,forward?-1:1,dir)}let DocView$1=class extends ContentView$1{get length(){return this.view.state.doc.length}constructor(view){super(),this.view=view,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(view.contentDOM),this.children=[new LineView$1],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ChangedRange$1(0,0,0,view.state.doc.length)],0,null)}update(update2){var _a2;let changedRanges=update2.changedRanges;this.minWidth>0&&changedRanges.length&&(changedRanges.every((({fromA:fromA,toA:toA})=>toA<this.minWidthFrom||fromA>this.minWidthTo))?(this.minWidthFrom=update2.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=update2.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let readCompositionAt=-1;this.view.inputState.composing>=0&&((null===(_a2=this.domChanged)||void 0===_a2?void 0:_a2.newSel)?readCompositionAt=this.domChanged.newSel.head:function(changes,composition){let touched=!1;composition&&changes.iterChangedRanges(((from,to)=>{from<composition.to&&to>composition.from&&(touched=!0)}));return touched}(update2.changes,this.hasComposition)||update2.selectionSet||(readCompositionAt=update2.state.selection.main.head));let composition=readCompositionAt>-1?function(view,changes,headPos){let found=findCompositionNode$1(view,headPos);if(!found)return null;let{node:textNode,from:from,to:to}=found,text2=textNode.nodeValue;if(/[\n\r]/.test(text2))return null;if(view.state.doc.sliceString(found.from,found.to)!=text2)return null;let inv=changes.invertedDesc,range=new ChangedRange$1(inv.mapPos(from),inv.mapPos(to),from,to),marks=[];for(let parent=textNode.parentNode;;parent=parent.parentNode){let parentView=ContentView$1.get(parent);if(parentView instanceof MarkView$1)marks.push({node:parent,deco:parentView.mark});else{if(parentView instanceof LineView$1||"DIV"==parent.nodeName&&parent.parentNode==view.contentDOM)return{range:range,text:textNode,marks:marks,line:parent};if(parent==view.contentDOM)return null;marks.push({node:parent,deco:new MarkDecoration$1({inclusive:!0,attributes:getAttrs$1(parent),tagName:parent.tagName.toLowerCase()})})}}}(this.view,update2.changes,readCompositionAt):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:from,to:to}=this.hasComposition;changedRanges=new ChangedRange$1(from,to,update2.changes.mapPos(from,-1),update2.changes.mapPos(to,1)).addToSet(changedRanges.slice())}this.hasComposition=composition?{from:composition.range.fromB,to:composition.range.toB}:null,(browser$2.ie||browser$2.chrome)&&!composition&&update2&&update2.state.doc.lines!=update2.startState.doc.lines&&(this.forceSelection=!0);let decoDiff=function(a,b,diff){let comp=new DecorationComparator$1$1;return RangeSet.compare(a,b,diff,comp),comp.changes}(this.decorations,this.updateDeco(),update2.changes);return changedRanges=ChangedRange$1.extendWithRanges(changedRanges,decoDiff),!!(7&this.flags||0!=changedRanges.length)&&(this.updateInner(changedRanges,update2.startState.doc.length,composition),update2.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(changes,oldLength,composition){this.view.viewState.mustMeasureContent=!0,this.updateChildren(changes,oldLength,composition);let{observer:observer}=this.view;observer.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let track=browser$2.chrome||browser$2.ios?{node:observer.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,track),this.flags&=-8,track&&(track.written||observer.selectionRange.focusNode!=track.node)&&(this.forceSelection=!0),this.dom.style.height=""})),this.markedForComposition.forEach((cView=>cView.flags&=-9));let gaps=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let child of this.children)child instanceof BlockWidgetView$1&&child.widget instanceof BlockGapWidget$1&&gaps.push(child.dom);observer.updateGaps(gaps)}updateChildren(changes,oldLength,composition){let ranges=composition?composition.range.addToSet(changes.slice()):changes,cursor2=this.childCursor(oldLength);for(let i2=ranges.length-1;;i2--){let next=i2>=0?ranges[i2]:null;if(!next)break;let content2,breakAtStart,openStart,openEnd,{fromA:fromA,toA:toA,fromB:fromB,toB:toB}=next;if(composition&&composition.range.fromB<toB&&composition.range.toB>fromB){let before=ContentBuilder$1.build(this.view.state.doc,fromB,composition.range.fromB,this.decorations,this.dynamicDecorationMap),after=ContentBuilder$1.build(this.view.state.doc,composition.range.toB,toB,this.decorations,this.dynamicDecorationMap);breakAtStart=before.breakAtStart,openStart=before.openStart,openEnd=after.openEnd;let compLine=this.compositionView(composition);after.breakAtStart?compLine.breakAfter=1:after.content.length&&compLine.merge(compLine.length,compLine.length,after.content[0],!1,after.openStart,0)&&(compLine.breakAfter=after.content[0].breakAfter,after.content.shift()),before.content.length&&compLine.merge(0,0,before.content[before.content.length-1],!0,0,before.openEnd)&&before.content.pop(),content2=before.content.concat(compLine).concat(after.content)}else({content:content2,breakAtStart:breakAtStart,openStart:openStart,openEnd:openEnd}=ContentBuilder$1.build(this.view.state.doc,fromB,toB,this.decorations,this.dynamicDecorationMap));let{i:toI,off:toOff}=cursor2.findPos(toA,1),{i:fromI,off:fromOff}=cursor2.findPos(fromA,-1);replaceRange$1(this,fromI,fromOff,toI,toOff,content2,breakAtStart,openStart,openEnd)}composition&&this.fixCompositionDOM(composition)}compositionView(composition){let cur2=new TextView$1(composition.text.nodeValue);cur2.flags|=8;for(let{deco:deco}of composition.marks)cur2=new MarkView$1(deco,[cur2],cur2.length);let line=new LineView$1;return line.append(cur2,0),line}fixCompositionDOM(composition){let fix=(dom,cView2)=>{cView2.flags|=8|(cView2.children.some((c=>7&c.flags))?1:0),this.markedForComposition.add(cView2);let prev=ContentView$1.get(dom);prev&&prev!=cView2&&(prev.dom=null),cView2.setDOM(dom)},pos=this.childPos(composition.range.fromB,1),cView=this.children[pos.i];fix(composition.line,cView);for(let i2=composition.marks.length-1;i2>=-1;i2--)pos=cView.childPos(pos.off,1),cView=cView.children[pos.i],fix(i2>=0?composition.marks[i2].node:composition.text,cView)}updateSelection(mustRead=!1,fromPointer=!1){!mustRead&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let activeElt=this.view.root.activeElement,focused=activeElt==this.dom,selectionNotFocus=!focused&&hasSelection$1(this.dom,this.view.observer.selectionRange)&&!(activeElt&&this.dom.contains(activeElt));if(!(focused||fromPointer||selectionNotFocus))return;let force=this.forceSelection;this.forceSelection=!1;let main2=this.view.state.selection.main,anchor=this.moveToLine(this.domAtPos(main2.anchor)),head=main2.empty?anchor:this.moveToLine(this.domAtPos(main2.head));if(browser$2.gecko&&main2.empty&&!this.hasComposition&&(1==(pos=anchor).node.nodeType&&pos.node.firstChild&&(0==pos.offset||"false"==pos.node.childNodes[pos.offset-1].contentEditable)&&(pos.offset==pos.node.childNodes.length||"false"==pos.node.childNodes[pos.offset].contentEditable))){let dummy=document.createTextNode("");this.view.observer.ignore((()=>anchor.node.insertBefore(dummy,anchor.node.childNodes[anchor.offset]||null))),anchor=head=new DOMPos$1(dummy,0),force=!0}var pos;let domSel=this.view.observer.selectionRange;!force&&domSel.focusNode&&isEquivalentPosition$1(anchor.node,anchor.offset,domSel.anchorNode,domSel.anchorOffset)&&isEquivalentPosition$1(head.node,head.offset,domSel.focusNode,domSel.focusOffset)||(this.view.observer.ignore((()=>{browser$2.android&&browser$2.chrome&&this.dom.contains(domSel.focusNode)&&function(node,inside2){for(let cur2=node;cur2&&cur2!=inside2;cur2=cur2.assignedSlot||cur2.parentNode)if(1==cur2.nodeType&&"false"==cur2.contentEditable)return!0;return!1}(domSel.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let rawSel=getSelection$1(this.view.root);if(rawSel)if(main2.empty){if(browser$2.gecko){let nextTo=(node=anchor.node,offset2=anchor.offset,1!=node.nodeType?0:(offset2&&"false"==node.childNodes[offset2-1].contentEditable?1:0)|(offset2<node.childNodes.length&&"false"==node.childNodes[offset2].contentEditable?2:0));if(nextTo&&3!=nextTo){let text2=nearbyTextNode$1(anchor.node,anchor.offset,1==nextTo?1:-1);text2&&(anchor=new DOMPos$1(text2.node,text2.offset))}}rawSel.collapse(anchor.node,anchor.offset),null!=main2.bidiLevel&&void 0!==rawSel.caretBidiLevel&&(rawSel.caretBidiLevel=main2.bidiLevel)}else if(rawSel.extend){rawSel.collapse(anchor.node,anchor.offset);try{rawSel.extend(head.node,head.offset)}catch(_){}}else{let range=document.createRange();main2.anchor>main2.head&&([anchor,head]=[head,anchor]),range.setEnd(head.node,head.offset),range.setStart(anchor.node,anchor.offset),rawSel.removeAllRanges(),rawSel.addRange(range)}else;var node,offset2;selectionNotFocus&&this.view.root.activeElement==this.dom&&(this.dom.blur(),activeElt&&activeElt.focus())})),this.view.observer.setSelectionRange(anchor,head)),this.impreciseAnchor=anchor.precise?null:new DOMPos$1(domSel.anchorNode,domSel.anchorOffset),this.impreciseHead=head.precise?null:new DOMPos$1(domSel.focusNode,domSel.focusOffset)}enforceCursorAssoc(){if(this.hasComposition)return;let{view:view}=this,cursor2=view.state.selection.main,sel=getSelection$1(view.root),{anchorNode:anchorNode,anchorOffset:anchorOffset}=view.observer.selectionRange;if(!(sel&&cursor2.empty&&cursor2.assoc&&sel.modify))return;let line=LineView$1.find(this,cursor2.head);if(!line)return;let lineStart=line.posAtStart;if(cursor2.head==lineStart||cursor2.head==lineStart+line.length)return;let before=this.coordsAt(cursor2.head,-1),after=this.coordsAt(cursor2.head,1);if(!before||!after||before.bottom>after.top)return;let dom=this.domAtPos(cursor2.head+cursor2.assoc);sel.collapse(dom.node,dom.offset),sel.modify("move",cursor2.assoc<0?"forward":"backward","lineboundary"),view.observer.readSelectionRange();let newRange=view.observer.selectionRange;view.docView.posFromDOM(newRange.anchorNode,newRange.anchorOffset)!=cursor2.from&&sel.collapse(anchorNode,anchorOffset)}moveToLine(pos){let newPos,dom=this.dom;if(pos.node!=dom)return pos;for(let i2=pos.offset;!newPos&&i2<dom.childNodes.length;i2++){let view=ContentView$1.get(dom.childNodes[i2]);view instanceof LineView$1&&(newPos=view.domAtPos(0))}for(let i2=pos.offset-1;!newPos&&i2>=0;i2--){let view=ContentView$1.get(dom.childNodes[i2]);view instanceof LineView$1&&(newPos=view.domAtPos(view.length))}return newPos?new DOMPos$1(newPos.node,newPos.offset,!0):pos}nearest(dom){for(let cur2=dom;cur2;){let domView=ContentView$1.get(cur2);if(domView&&domView.rootView==this)return domView;cur2=cur2.parentNode}return null}posFromDOM(node,offset2){let view=this.nearest(node);if(!view)throw new RangeError("Trying to find position for a DOM position outside of the document");return view.localPosFromDOM(node,offset2)+view.posAtStart}domAtPos(pos){let{i:i2,off:off}=this.childCursor().findPos(pos,-1);for(;i2<this.children.length-1;){let child=this.children[i2];if(off<child.length||child instanceof LineView$1)break;i2++,off=0}return this.children[i2].domAtPos(off)}coordsAt(pos,side){let best=null,bestPos=0;for(let off=this.length,i2=this.children.length-1;i2>=0;i2--){let child=this.children[i2],end2=off-child.breakAfter,start2=end2-child.length;if(end2<pos)break;start2<=pos&&(start2<pos||child.covers(-1))&&(end2>pos||child.covers(1))&&(!best||child instanceof LineView$1&&!(best instanceof LineView$1&&side>=0))&&(best=child,bestPos=start2),off=start2}return best?best.coordsAt(pos-bestPos,side):null}coordsForChar(pos){let{i:i2,off:off}=this.childPos(pos,1),child=this.children[i2];if(!(child instanceof LineView$1))return null;for(;child.children.length;){let{i:i3,off:childOff}=child.childPos(off,1);for(;;i3++){if(i3==child.children.length)return null;if((child=child.children[i3]).length)break}off=childOff}if(!(child instanceof TextView$1))return null;let end2=findClusterBreak(child.text,off);if(end2==off)return null;let rects=textRange$1(child.dom,off,end2).getClientRects();for(let i3=0;i3<rects.length;i3++){let rect=rects[i3];if(i3==rects.length-1||rect.top<rect.bottom&&rect.left<rect.right)return rect}return null}measureVisibleLineHeights(viewport2){let result=[],{from:from,to:to}=viewport2,contentWidth=this.view.contentDOM.clientWidth,isWider=contentWidth>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,widest=-1,ltr=this.view.textDirection==Direction$1.LTR;for(let pos=0,i2=0;i2<this.children.length;i2++){let child=this.children[i2],end2=pos+child.length;if(end2>to)break;if(pos>=from){let childRect=child.dom.getBoundingClientRect();if(result.push(childRect.height),isWider){let last=child.dom.lastChild,rects=last?clientRectsFor$1(last):[];if(rects.length){let rect=rects[rects.length-1],width=ltr?rect.right-childRect.left:childRect.right-rect.left;width>widest&&(widest=width,this.minWidth=contentWidth,this.minWidthFrom=pos,this.minWidthTo=end2)}}}pos=end2+child.breakAfter}return result}textDirectionAt(pos){let{i:i2}=this.childPos(pos,1);return"rtl"==getComputedStyle(this.children[i2].dom).direction?Direction$1.RTL:Direction$1.LTR}measureTextSize(){for(let child of this.children)if(child instanceof LineView$1){let measure=child.measureTextSize();if(measure)return measure}let lineHeight,charWidth,textHeight,dummy=document.createElement("div");return dummy.className="cm-line",dummy.style.width="99999px",dummy.style.position="absolute",dummy.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(dummy);let rect=clientRectsFor$1(dummy.firstChild)[0];lineHeight=dummy.getBoundingClientRect().height,charWidth=rect?rect.width/27:7,textHeight=rect?rect.height:lineHeight,dummy.remove()})),{lineHeight:lineHeight,charWidth:charWidth,textHeight:textHeight}}childCursor(pos=this.length){let i2=this.children.length;return i2&&(pos-=this.children[--i2].length),new ChildCursor$1(this.children,pos,i2)}computeBlockGapDeco(){let deco=[],vs=this.view.viewState;for(let pos=0,i2=0;;i2++){let next=i2==vs.viewports.length?null:vs.viewports[i2],end2=next?next.from-1:this.length;if(end2>pos){let height=(vs.lineBlockAt(end2).bottom-vs.lineBlockAt(pos).top)/this.view.scaleY;deco.push(Decoration$1.replace({widget:new BlockGapWidget$1(height),block:!0,inclusive:!0,isBlockGap:!0}).range(pos,end2))}if(!next)break;pos=next.to+1}return Decoration$1.set(deco)}updateDeco(){let allDeco=this.view.state.facet(decorations$1).map(((d,i2)=>(this.dynamicDecorationMap[i2]="function"==typeof d)?d(this.view):d));for(let i2=allDeco.length;i2<allDeco.length+3;i2++)this.dynamicDecorationMap[i2]=!1;return this.decorations=[...allDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(target){if(target.isSnapshot){let ref=this.view.viewState.lineBlockAt(target.range.head);return this.view.scrollDOM.scrollTop=ref.top-target.yMargin,void(this.view.scrollDOM.scrollLeft=target.xMargin)}let other,{range:range}=target,rect=this.coordsAt(range.head,range.empty?range.assoc:range.head>range.anchor?-1:1);if(!rect)return;!range.empty&&(other=this.coordsAt(range.anchor,range.anchor>range.head?-1:1))&&(rect={left:Math.min(rect.left,other.left),top:Math.min(rect.top,other.top),right:Math.max(rect.right,other.right),bottom:Math.max(rect.bottom,other.bottom)});let margins=getScrollMargins$1(this.view),targetRect={left:rect.left-margins.left,top:rect.top-margins.top,right:rect.right+margins.right,bottom:rect.bottom+margins.bottom},{offsetWidth:offsetWidth,offsetHeight:offsetHeight}=this.view.scrollDOM;!function(dom,rect,side,x,y,xMargin,yMargin,ltr){let doc2=dom.ownerDocument,win=doc2.defaultView||window;for(let cur2=dom,stop=!1;cur2&&!stop;)if(1==cur2.nodeType){let bounding,top2=cur2==doc2.body,scaleX=1,scaleY=1;if(top2)bounding=windowRect$1(win);else{if(/^(fixed|sticky)$/.test(getComputedStyle(cur2).position)&&(stop=!0),cur2.scrollHeight<=cur2.clientHeight&&cur2.scrollWidth<=cur2.clientWidth){cur2=cur2.assignedSlot||cur2.parentNode;continue}let rect2=cur2.getBoundingClientRect();scaleX=rect2.width/cur2.offsetWidth,scaleY=rect2.height/cur2.offsetHeight,bounding={left:rect2.left,right:rect2.left+cur2.clientWidth*scaleX,top:rect2.top,bottom:rect2.top+cur2.clientHeight*scaleY}}let moveX=0,moveY=0;if("nearest"==y)rect.top<bounding.top?(moveY=-(bounding.top-rect.top+yMargin),side>0&&rect.bottom>bounding.bottom+moveY&&(moveY=rect.bottom-bounding.bottom+moveY+yMargin)):rect.bottom>bounding.bottom&&(moveY=rect.bottom-bounding.bottom+yMargin,side<0&&rect.top-moveY<bounding.top&&(moveY=-(bounding.top+moveY-rect.top+yMargin)));else{let rectHeight=rect.bottom-rect.top,boundingHeight=bounding.bottom-bounding.top;moveY=("center"==y&&rectHeight<=boundingHeight?rect.top+rectHeight/2-boundingHeight/2:"start"==y||"center"==y&&side<0?rect.top-yMargin:rect.bottom-boundingHeight+yMargin)-bounding.top}if("nearest"==x?rect.left<bounding.left?(moveX=-(bounding.left-rect.left+xMargin),side>0&&rect.right>bounding.right+moveX&&(moveX=rect.right-bounding.right+moveX+xMargin)):rect.right>bounding.right&&(moveX=rect.right-bounding.right+xMargin,side<0&&rect.left<bounding.left+moveX&&(moveX=-(bounding.left+moveX-rect.left+xMargin))):moveX=("center"==x?rect.left+(rect.right-rect.left)/2-(bounding.right-bounding.left)/2:"start"==x==ltr?rect.left-xMargin:rect.right-(bounding.right-bounding.left)+xMargin)-bounding.left,moveX||moveY)if(top2)win.scrollBy(moveX,moveY);else{let movedX=0,movedY=0;if(moveY){let start2=cur2.scrollTop;cur2.scrollTop+=moveY/scaleY,movedY=(cur2.scrollTop-start2)*scaleY}if(moveX){let start2=cur2.scrollLeft;cur2.scrollLeft+=moveX/scaleX,movedX=(cur2.scrollLeft-start2)*scaleX}rect={left:rect.left-movedX,top:rect.top-movedY,right:rect.right-movedX,bottom:rect.bottom-movedY},movedX&&Math.abs(movedX-moveX)<1&&(x="nearest"),movedY&&Math.abs(movedY-moveY)<1&&(y="nearest")}if(top2)break;cur2=cur2.assignedSlot||cur2.parentNode}else{if(11!=cur2.nodeType)break;cur2=cur2.host}}(this.view.scrollDOM,targetRect,range.head<range.anchor?-1:1,target.x,target.y,Math.max(Math.min(target.xMargin,offsetWidth),-offsetWidth),Math.max(Math.min(target.yMargin,offsetHeight),-offsetHeight),this.view.textDirection==Direction$1.LTR)}};let BlockGapWidget$1=class extends WidgetType$1{constructor(height){super(),this.height=height}toDOM(){let elt=document.createElement("div");return this.updateDOM(elt),elt}eq(other){return other.height==this.height}updateDOM(elt){return elt.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}};function findCompositionNode$1(view,headPos){let sel=view.observer.selectionRange,textNode=sel.focusNode&&nearbyTextNode$1(sel.focusNode,sel.focusOffset,0);if(!textNode)return null;let from=headPos-textNode.offset;return{from:from,to:from+textNode.node.nodeValue.length,node:textNode.node}}function nearbyTextNode$1(startNode,startOffset,side){if(side<=0)for(let node=startNode,offset2=startOffset;;){if(3==node.nodeType)return{node:node,offset:offset2};if(!(1==node.nodeType&&offset2>0))break;node=node.childNodes[offset2-1],offset2=maxOffset$1(node)}if(side>=0)for(let node=startNode,offset2=startOffset;;){if(3==node.nodeType)return{node:node,offset:offset2};if(!(1==node.nodeType&&offset2<node.childNodes.length&&side>=0))break;node=node.childNodes[offset2],offset2=0}return null}let DecorationComparator$1$1=class{constructor(){this.changes=[]}compareRange(from,to){addRange$1(from,to,this.changes)}comparePoint(from,to){addRange$1(from,to,this.changes)}};function getdx$1(x,rect){return rect.left>x?rect.left-x:Math.max(0,x-rect.right)}function getdy$1(y,rect){return rect.top>y?rect.top-y:Math.max(0,y-rect.bottom)}function yOverlap$1(a,b){return a.top<b.bottom-1&&a.bottom>b.top+1}function upTop$1(rect,top2){return top2<rect.top?{top:top2,left:rect.left,right:rect.right,bottom:rect.bottom}:rect}function upBot$1(rect,bottom2){return bottom2>rect.bottom?{top:rect.top,left:rect.left,right:rect.right,bottom:bottom2}:rect}function domPosAtCoords$1(parent,x,y){let closest,closestRect,closestX,closestY,above,below,aboveRect,belowRect,closestOverlap=!1;for(let child=parent.firstChild;child;child=child.nextSibling){let rects=clientRectsFor$1(child);for(let i2=0;i2<rects.length;i2++){let rect=rects[i2];closestRect&&yOverlap$1(closestRect,rect)&&(rect=upTop$1(upBot$1(rect,closestRect.bottom),closestRect.top));let dx=getdx$1(x,rect),dy=getdy$1(y,rect);if(0==dx&&0==dy)return 3==child.nodeType?domPosInText$1(child,x,y):domPosAtCoords$1(child,x,y);if(!closest||closestY>dy||closestY==dy&&closestX>dx){closest=child,closestRect=rect,closestX=dx,closestY=dy;let side=dy?y<rect.top?-1:1:dx?x<rect.left?-1:1:0;closestOverlap=!side||(side>0?i2<rects.length-1:i2>0)}0==dx?y>rect.bottom&&(!aboveRect||aboveRect.bottom<rect.bottom)?(above=child,aboveRect=rect):y<rect.top&&(!belowRect||belowRect.top>rect.top)&&(below=child,belowRect=rect):aboveRect&&yOverlap$1(aboveRect,rect)?aboveRect=upBot$1(aboveRect,rect.bottom):belowRect&&yOverlap$1(belowRect,rect)&&(belowRect=upTop$1(belowRect,rect.top))}}if(aboveRect&&aboveRect.bottom>=y?(closest=above,closestRect=aboveRect):belowRect&&belowRect.top<=y&&(closest=below,closestRect=belowRect),!closest)return{node:parent,offset:0};let clipX=Math.max(closestRect.left,Math.min(closestRect.right,x));return 3==closest.nodeType?domPosInText$1(closest,clipX,y):closestOverlap&&"false"!=closest.contentEditable?domPosAtCoords$1(closest,clipX,y):{node:parent,offset:Array.prototype.indexOf.call(parent.childNodes,closest)+(x>=(closestRect.left+closestRect.right)/2?1:0)}}function domPosInText$1(node,x,y){let len=node.nodeValue.length,closestOffset=-1,closestDY=1e9,generalSide=0;for(let i2=0;i2<len;i2++){let rects=textRange$1(node,i2,i2+1).getClientRects();for(let j=0;j<rects.length;j++){let rect=rects[j];if(rect.top==rect.bottom)continue;generalSide||(generalSide=x-rect.left);let dy=(rect.top>y?rect.top-y:y-rect.bottom)-1;if(rect.left-1<=x&&rect.right+1>=x&&dy<closestDY){let right2=x>=(rect.left+rect.right)/2,after=right2;if(browser$2.chrome||browser$2.gecko){textRange$1(node,i2).getBoundingClientRect().left==rect.right&&(after=!right2)}if(dy<=0)return{node:node,offset:i2+(after?1:0)};closestOffset=i2+(after?1:0),closestDY=dy}}}return{node:node,offset:closestOffset>-1?closestOffset:generalSide>0?node.nodeValue.length:0}}function posAtCoords$1(view,coords,precise,bias=-1){var _a2,_b;let block,content2=view.contentDOM.getBoundingClientRect(),docTop=content2.top+view.viewState.paddingTop,{docHeight:docHeight}=view.viewState,{x:x,y:y}=coords,yOffset=y-docTop;if(yOffset<0)return 0;if(yOffset>docHeight)return view.state.doc.length;for(let halfLine=view.viewState.heightOracle.textHeight/2,bounced=!1;block=view.elementAtHeight(yOffset),block.type!=BlockType$1.Text;)for(;yOffset=bias>0?block.bottom+halfLine:block.top-halfLine,!(yOffset>=0&&yOffset<=docHeight);){if(bounced)return precise?null:0;bounced=!0,bias=-bias}y=docTop+yOffset;let lineStart=block.from;if(lineStart<view.viewport.from)return 0==view.viewport.from?0:precise?null:posAtCoordsImprecise$1(view,content2,block,x,y);if(lineStart>view.viewport.to)return view.viewport.to==view.state.doc.length?view.state.doc.length:precise?null:posAtCoordsImprecise$1(view,content2,block,x,y);let doc2=view.dom.ownerDocument,root=view.root.elementFromPoint?view.root:doc2,element2=root.elementFromPoint(x,y);element2&&!view.contentDOM.contains(element2)&&(element2=null),element2||(x=Math.max(content2.left+1,Math.min(content2.right-1,x)),element2=root.elementFromPoint(x,y),element2&&!view.contentDOM.contains(element2)&&(element2=null));let node,offset2=-1;if(element2&&0!=(null===(_a2=view.docView.nearest(element2))||void 0===_a2?void 0:_a2.isEditable))if(doc2.caretPositionFromPoint){let pos=doc2.caretPositionFromPoint(x,y);pos&&({offsetNode:node,offset:offset2}=pos)}else if(doc2.caretRangeFromPoint){let range=doc2.caretRangeFromPoint(x,y);range&&(({startContainer:node,startOffset:offset2}=range),(!view.contentDOM.contains(node)||browser$2.safari&&function(node,offset2,x){let len;if(3!=node.nodeType||offset2!=(len=node.nodeValue.length))return!1;for(let next=node.nextSibling;next;next=next.nextSibling)if(1!=next.nodeType||"BR"!=next.nodeName)return!1;return textRange$1(node,len-1,len).getBoundingClientRect().left>x}(node,offset2,x)||browser$2.chrome&&function(node,offset2,x){if(0!=offset2)return!1;for(let cur2=node;;){let parent=cur2.parentNode;if(!parent||1!=parent.nodeType||parent.firstChild!=cur2)return!1;if(parent.classList.contains("cm-line"))break;cur2=parent}let rect=1==node.nodeType?node.getBoundingClientRect():textRange$1(node,0,Math.max(node.nodeValue.length,1)).getBoundingClientRect();return x-rect.left>5}(node,offset2,x))&&(node=void 0))}if(!node||!view.docView.dom.contains(node)){let line=LineView$1.find(view.docView,lineStart);if(!line)return yOffset>block.top+block.height/2?block.to:block.from;({node:node,offset:offset2}=domPosAtCoords$1(line.dom,x,y))}let nearest=view.docView.nearest(node);if(!nearest)return null;if(nearest.isWidget&&1==(null===(_b=nearest.dom)||void 0===_b?void 0:_b.nodeType)){let rect=nearest.dom.getBoundingClientRect();return coords.y<rect.top||coords.y<=rect.bottom&&coords.x<=(rect.left+rect.right)/2?nearest.posAtStart:nearest.posAtEnd}return nearest.localPosFromDOM(node,offset2)+nearest.posAtStart}function posAtCoordsImprecise$1(view,contentRect,block,x,y){let into=Math.round((x-contentRect.left)*view.defaultCharacterWidth);if(view.lineWrapping&&block.height>1.5*view.defaultLineHeight){let textHeight=view.viewState.heightOracle.textHeight;into+=Math.floor((y-block.top-.5*(view.defaultLineHeight-textHeight))/textHeight)*view.viewState.heightOracle.lineLength}let content2=view.state.sliceDoc(block.from,block.to);return block.from+findColumn(content2,into,view.state.tabSize)}function blockAt$1(view,pos){let line=view.lineBlockAt(pos);if(Array.isArray(line.type))for(let l of line.type)if(l.to>pos||l.to==pos&&(l.to==line.to||l.type==BlockType$1.Text))return l;return line}function moveByChar$1(view,start2,forward,by){let line=view.state.doc.lineAt(start2.head),spans=view.bidiSpans(line),direction=view.textDirectionAt(line.from);for(let cur2=start2,check=null;;){let next=moveVisually$1(line,spans,direction,cur2,forward),char=movedOver$1;if(!next){if(line.number==(forward?view.state.doc.lines:1))return cur2;char="\n",line=view.state.doc.line(line.number+(forward?1:-1)),spans=view.bidiSpans(line),next=EditorSelection.cursor(forward?line.from:line.to)}if(check){if(!check(char))return cur2}else{if(!by)return next;check=by(char)}cur2=next}}function skipAtomicRanges$1(atoms,pos,bias){for(;;){let moved=0;for(let set2 of atoms)set2.between(pos-1,pos+1,((from,to,value)=>{if(pos>from&&pos<to){let side=moved||bias||(pos-from<to-pos?-1:1);pos=side<0?from:to,moved=side}}));if(!moved)return pos}}function skipAtoms$1(view,oldPos,pos){let newPos=skipAtomicRanges$1(view.state.facet(atomicRanges$1).map((f=>f(view))),pos.from,oldPos.head>pos.from?-1:1);return newPos==pos.from?pos:EditorSelection.cursor(newPos,newPos<pos.from?1:-1)}let InputState$1=class{setSelectionOrigin(origin){this.lastSelectionOrigin=origin,this.lastSelectionTime=Date.now()}constructor(view){var doc2;this.view=view,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=view.hasFocus,browser$2.safari&&view.contentDOM.addEventListener("input",(()=>null)),browser$2.gecko&&(doc2=view.contentDOM.ownerDocument,appliedFirefoxHack$1.has(doc2)||(appliedFirefoxHack$1.add(doc2),doc2.addEventListener("copy",(()=>{})),doc2.addEventListener("cut",(()=>{}))))}handleEvent(event){(function(view,event){if(!event.bubbles)return!0;if(event.defaultPrevented)return!1;for(let cView,node=event.target;node!=view.contentDOM;node=node.parentNode)if(!node||11==node.nodeType||(cView=ContentView$1.get(node))&&cView.ignoreEvent(event))return!1;return!0})(this.view,event)&&!this.ignoreDuringComposition(event)&&("keydown"==event.type&&this.keydown(event)||this.runHandlers(event.type,event))}runHandlers(type2,event){let handlers2=this.handlers[type2];if(handlers2){for(let observer of handlers2.observers)observer(this.view,event);for(let handler of handlers2.handlers){if(event.defaultPrevented)break;if(handler(this.view,event)){event.preventDefault();break}}}}ensureHandlers(plugins){let handlers2=function(plugins){let result=Object.create(null);function record(type2){return result[type2]||(result[type2]={observers:[],handlers:[]})}for(let plugin of plugins){let spec=plugin.spec;if(spec&&spec.domEventHandlers)for(let type2 in spec.domEventHandlers){let f=spec.domEventHandlers[type2];f&&record(type2).handlers.push(bindHandler$1(plugin.value,f))}if(spec&&spec.domEventObservers)for(let type2 in spec.domEventObservers){let f=spec.domEventObservers[type2];f&&record(type2).observers.push(bindHandler$1(plugin.value,f))}}for(let type2 in handlers$1)record(type2).handlers.push(handlers$1[type2]);for(let type2 in observers$1)record(type2).observers.push(observers$1[type2]);return result}(plugins),prev=this.handlers,dom=this.view.contentDOM;for(let type2 in handlers2)if("scroll"!=type2){let passive2=!handlers2[type2].handlers.length,exists=prev[type2];exists&&passive2!=!exists.handlers.length&&(dom.removeEventListener(type2,this.handleEvent),exists=null),exists||dom.addEventListener(type2,this.handleEvent,{passive:passive2})}for(let type2 in prev)"scroll"==type2||handlers2[type2]||dom.removeEventListener(type2,this.handleEvent);this.handlers=handlers2}keydown(event){if(this.lastKeyCode=event.keyCode,this.lastKeyTime=Date.now(),9==event.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(27!=event.keyCode&&modifierCodes$1.indexOf(event.keyCode)<0&&(this.view.inputState.lastEscPress=0),browser$2.android&&browser$2.chrome&&!event.synthetic&&(13==event.keyCode||8==event.keyCode))return this.view.observer.delayAndroidKey(event.key,event.keyCode),!0;let pending;return!browser$2.ios||event.synthetic||event.altKey||event.metaKey||!((pending=PendingKeys$1.find((key=>key.keyCode==event.keyCode)))&&!event.ctrlKey||EmacsyPendingKeys$1.indexOf(event.key)>-1&&event.ctrlKey&&!event.shiftKey)?(229!=event.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=pending||event,setTimeout((()=>this.flushIOSKey()),250),!0)}flushIOSKey(){let key=this.pendingIOSKey;return!!key&&(this.pendingIOSKey=void 0,dispatchKey$1(this.view.contentDOM,key.key,key.keyCode))}ignoreDuringComposition(event){return!!/^key/.test(event.type)&&(this.composing>0||!!(browser$2.safari&&!browser$2.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(mouseSelection){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=mouseSelection}update(update2){this.mouseSelection&&this.mouseSelection.update(update2),this.draggedContent&&update2.docChanged&&(this.draggedContent=this.draggedContent.map(update2.changes)),update2.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}};function bindHandler$1(plugin,handler){return(view,event)=>{try{return handler.call(plugin,event,view)}catch(e){logException$1(view.state,e)}}}const PendingKeys$1=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],EmacsyPendingKeys$1="dthko",modifierCodes$1=[16,17,18,20,91,92,224,225];function dragScrollSpeed$1(dist2){return.7*Math.max(0,dist2)+8}let MouseSelection$1=class{constructor(view,startEvent,style,mustSelect){this.view=view,this.startEvent=startEvent,this.style=style,this.mustSelect=mustSelect,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=startEvent,this.scrollParent=function(dom){let doc2=dom.ownerDocument;for(let cur2=dom.parentNode;cur2&&cur2!=doc2.body;)if(1==cur2.nodeType){if(cur2.scrollHeight>cur2.clientHeight||cur2.scrollWidth>cur2.clientWidth)return cur2;cur2=cur2.assignedSlot||cur2.parentNode}else{if(11!=cur2.nodeType)break;cur2=cur2.host}return null}(view.contentDOM),this.atoms=view.state.facet(atomicRanges$1).map((f=>f(view)));let doc2=view.contentDOM.ownerDocument;doc2.addEventListener("mousemove",this.move=this.move.bind(this)),doc2.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=startEvent.shiftKey,this.multiple=view.state.facet(EditorState.allowMultipleSelections)&&function(view,event){let facet=view.state.facet(clickAddsSelectionRange$1);return facet.length?facet[0](event):browser$2.mac?event.metaKey:event.ctrlKey}(view,startEvent),this.dragging=!(!function(view,event){let{main:main2}=view.state.selection;if(main2.empty)return!1;let sel=getSelection$1(view.root);if(!sel||0==sel.rangeCount)return!0;let rects=sel.getRangeAt(0).getClientRects();for(let i2=0;i2<rects.length;i2++){let rect=rects[i2];if(rect.left<=event.clientX&&rect.right>=event.clientX&&rect.top<=event.clientY&&rect.bottom>=event.clientY)return!0}return!1}(view,startEvent)||1!=getClickType$1(startEvent))&&null}start(event){!1===this.dragging&&this.select(event)}move(event){var _a2,a,b;if(0==event.buttons)return this.destroy();if(this.dragging||null==this.dragging&&(a=this.startEvent,b=event,Math.max(Math.abs(a.clientX-b.clientX),Math.abs(a.clientY-b.clientY))<10))return;this.select(this.lastEvent=event);let sx=0,sy=0,rect=(null===(_a2=this.scrollParent)||void 0===_a2?void 0:_a2.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},margins=getScrollMargins$1(this.view);event.clientX-margins.left<=rect.left+6?sx=-dragScrollSpeed$1(rect.left-event.clientX):event.clientX+margins.right>=rect.right-6&&(sx=dragScrollSpeed$1(event.clientX-rect.right)),event.clientY-margins.top<=rect.top+6?sy=-dragScrollSpeed$1(rect.top-event.clientY):event.clientY+margins.bottom>=rect.bottom-6&&(sy=dragScrollSpeed$1(event.clientY-rect.bottom)),this.setScrollSpeed(sx,sy)}up(event){null==this.dragging&&this.select(this.lastEvent),this.dragging||event.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let doc2=this.view.contentDOM.ownerDocument;doc2.removeEventListener("mousemove",this.move),doc2.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(sx,sy){this.scrollSpeed={x:sx,y:sy},sx||sy?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(sel){let ranges=null;for(let i2=0;i2<sel.ranges.length;i2++){let range=sel.ranges[i2],updated=null;if(range.empty){let pos=skipAtomicRanges$1(this.atoms,range.from,0);pos!=range.from&&(updated=EditorSelection.cursor(pos,-1))}else{let from=skipAtomicRanges$1(this.atoms,range.from,-1),to=skipAtomicRanges$1(this.atoms,range.to,1);from==range.from&&to==range.to||(updated=EditorSelection.range(range.from==range.anchor?from:to,range.from==range.head?from:to))}updated&&(ranges||(ranges=sel.ranges.slice()),ranges[i2]=updated)}return ranges?EditorSelection.create(ranges,sel.mainIndex):sel}select(event){let{view:view}=this,selection2=this.skipAtoms(this.style.get(event,this.extend,this.multiple));(this.mustSelect||!selection2.eq(view.state.selection)||selection2.main.assoc!=view.state.selection.main.assoc&&!1===this.dragging)&&this.view.dispatch({selection:selection2,userEvent:"select.pointer"}),this.mustSelect=!1}update(update2){this.style.update(update2)&&setTimeout((()=>this.select(this.lastEvent)),20)}};const handlers$1=Object.create(null),observers$1=Object.create(null),brokenClipboardAPI$1=browser$2.ie&&browser$2.ie_version<15||browser$2.ios&&browser$2.webkit_version<604;function doPaste$1(view,input){let changes,{state:state}=view,i2=1,text2=state.toText(input),byLine=text2.lines==state.selection.ranges.length;if(null!=lastLinewiseCopy$1&&state.selection.ranges.every((r=>r.empty))&&lastLinewiseCopy$1==text2.toString()){let lastLine=-1;changes=state.changeByRange((range=>{let line=state.doc.lineAt(range.from);if(line.from==lastLine)return{range:range};lastLine=line.from;let insert2=state.toText((byLine?text2.line(i2++).text:input)+state.lineBreak);return{changes:{from:line.from,insert:insert2},range:EditorSelection.cursor(range.from+insert2.length)}}))}else changes=byLine?state.changeByRange((range=>{let line=text2.line(i2++);return{changes:{from:range.from,to:range.to,insert:line.text},range:EditorSelection.cursor(range.from+line.length)}})):state.replaceSelection(text2);view.dispatch(changes,{userEvent:"input.paste",scrollIntoView:!0})}function rangeForClick$1(view,pos,bias,type2){if(1==type2)return EditorSelection.cursor(pos,bias);if(2==type2)return function(state,pos,bias=1){let categorize=state.charCategorizer(pos),line=state.doc.lineAt(pos),linePos=pos-line.from;if(0==line.length)return EditorSelection.cursor(pos);0==linePos?bias=1:linePos==line.length&&(bias=-1);let from=linePos,to=linePos;bias<0?from=findClusterBreak(line.text,linePos,!1):to=findClusterBreak(line.text,linePos);let cat=categorize(line.text.slice(from,to));for(;from>0;){let prev=findClusterBreak(line.text,from,!1);if(categorize(line.text.slice(prev,from))!=cat)break;from=prev}for(;to<line.length;){let next=findClusterBreak(line.text,to);if(categorize(line.text.slice(to,next))!=cat)break;to=next}return EditorSelection.range(from+line.from,to+line.from)}(view.state,pos,bias);{let visual=LineView$1.find(view.docView,pos),line=view.state.doc.lineAt(visual?visual.posAtEnd:pos),from=visual?visual.posAtStart:line.from,to=visual?visual.posAtEnd:line.to;return to<view.state.doc.length&&to==line.to&&to++,EditorSelection.range(from,to)}}observers$1.scroll=view=>{view.inputState.lastScrollTop=view.scrollDOM.scrollTop,view.inputState.lastScrollLeft=view.scrollDOM.scrollLeft},handlers$1.keydown=(view,event)=>(view.inputState.setSelectionOrigin("select"),27==event.keyCode&&(view.inputState.lastEscPress=Date.now()),!1),observers$1.touchstart=(view,e)=>{view.inputState.lastTouchTime=Date.now(),view.inputState.setSelectionOrigin("select.pointer")},observers$1.touchmove=view=>{view.inputState.setSelectionOrigin("select.pointer")},handlers$1.mousedown=(view,event)=>{if(view.observer.flush(),view.inputState.lastTouchTime>Date.now()-2e3)return!1;let style=null;for(let makeStyle of view.state.facet(mouseSelectionStyle$1))if(style=makeStyle(view,event),style)break;if(style||0!=event.button||(style=function(view,event){let start2=queryPos$1(view,event),type2=getClickType$1(event),startSel=view.state.selection;return{update(update2){update2.docChanged&&(start2.pos=update2.changes.mapPos(start2.pos),startSel=startSel.map(update2.changes))},get(event2,extend2,multiple){let removed,cur2=queryPos$1(view,event2),range=rangeForClick$1(view,cur2.pos,cur2.bias,type2);if(start2.pos!=cur2.pos&&!extend2){let startRange=rangeForClick$1(view,start2.pos,start2.bias,type2),from=Math.min(startRange.from,range.from),to=Math.max(startRange.to,range.to);range=from<range.from?EditorSelection.range(from,to):EditorSelection.range(to,from)}return extend2?startSel.replaceRange(startSel.main.extend(range.from,range.to)):multiple&&1==type2&&startSel.ranges.length>1&&(removed=function(sel,pos){for(let i2=0;i2<sel.ranges.length;i2++){let{from:from,to:to}=sel.ranges[i2];if(from<=pos&&to>=pos)return EditorSelection.create(sel.ranges.slice(0,i2).concat(sel.ranges.slice(i2+1)),sel.mainIndex==i2?0:sel.mainIndex-(sel.mainIndex>i2?1:0))}return null}(startSel,cur2.pos))?removed:multiple?startSel.addRange(range):EditorSelection.create([range])}}}(view,event)),style){let mustFocus=!view.hasFocus;view.inputState.startMouseSelection(new MouseSelection$1(view,event,style,mustFocus)),mustFocus&&view.observer.ignore((()=>focusPreventScroll$1(view.contentDOM)));let mouseSel=view.inputState.mouseSelection;if(mouseSel)return mouseSel.start(event),!1===mouseSel.dragging}return!1};let insideY$1=(y,rect)=>y>=rect.top&&y<=rect.bottom,inside$1=(x,y,rect)=>insideY$1(y,rect)&&x>=rect.left&&x<=rect.right;function findPositionSide$1(view,pos,x,y){let line=LineView$1.find(view.docView,pos);if(!line)return 1;let off=pos-line.posAtStart;if(0==off)return 1;if(off==line.length)return-1;let before=line.coordsAt(off,-1);if(before&&inside$1(x,y,before))return-1;let after=line.coordsAt(off,1);return after&&inside$1(x,y,after)?1:before&&insideY$1(y,before)?-1:1}function queryPos$1(view,event){let pos=view.posAtCoords({x:event.clientX,y:event.clientY},!1);return{pos:pos,bias:findPositionSide$1(view,pos,event.clientX,event.clientY)}}const BadMouseDetail$1=browser$2.ie&&browser$2.ie_version<=11;let lastMouseDown$1=null,lastMouseDownCount$1=0,lastMouseDownTime$1=0;function getClickType$1(event){if(!BadMouseDetail$1)return event.detail;let last=lastMouseDown$1,lastTime=lastMouseDownTime$1;return lastMouseDown$1=event,lastMouseDownTime$1=Date.now(),lastMouseDownCount$1=!last||lastTime>Date.now()-400&&Math.abs(last.clientX-event.clientX)<2&&Math.abs(last.clientY-event.clientY)<2?(lastMouseDownCount$1+1)%3:1}function dropText$1(view,event,text2,direct){if(!text2)return;let dropPos=view.posAtCoords({x:event.clientX,y:event.clientY},!1),{draggedContent:draggedContent}=view.inputState,del=direct&&draggedContent&&function(view,event){let facet=view.state.facet(dragMovesSelection$1$1);return facet.length?facet[0](event):browser$2.mac?!event.altKey:!event.ctrlKey}(view,event)?{from:draggedContent.from,to:draggedContent.to}:null,ins={from:dropPos,insert:text2},changes=view.state.changes(del?[del,ins]:ins);view.focus(),view.dispatch({changes:changes,selection:{anchor:changes.mapPos(dropPos,-1),head:changes.mapPos(dropPos,1)},userEvent:del?"move.drop":"input.drop"}),view.inputState.draggedContent=null}handlers$1.dragstart=(view,event)=>{let{selection:{main:range}}=view.state;if(event.target.draggable){let cView=view.docView.nearest(event.target);if(cView&&cView.isWidget){let from=cView.posAtStart,to=from+cView.length;(from>=range.to||to<=range.from)&&(range=EditorSelection.range(from,to))}}let{inputState:inputState}=view;return inputState.mouseSelection&&(inputState.mouseSelection.dragging=!0),inputState.draggedContent=range,event.dataTransfer&&(event.dataTransfer.setData("Text",view.state.sliceDoc(range.from,range.to)),event.dataTransfer.effectAllowed="copyMove"),!1},handlers$1.dragend=view=>(view.inputState.draggedContent=null,!1),handlers$1.drop=(view,event)=>{if(!event.dataTransfer)return!1;if(view.state.readOnly)return!0;let files=event.dataTransfer.files;if(files&&files.length){let text2=Array(files.length),read2=0,finishFile=()=>{++read2==files.length&&dropText$1(view,event,text2.filter((s=>null!=s)).join(view.state.lineBreak),!1)};for(let i2=0;i2<files.length;i2++){let reader=new FileReader;reader.onerror=finishFile,reader.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(reader.result)||(text2[i2]=reader.result),finishFile()},reader.readAsText(files[i2])}return!0}{let text2=event.dataTransfer.getData("Text");if(text2)return dropText$1(view,event,text2,!0),!0}return!1},handlers$1.paste=(view,event)=>{if(view.state.readOnly)return!0;view.observer.flush();let data2=brokenClipboardAPI$1?null:event.clipboardData;return data2?(doPaste$1(view,data2.getData("text/plain")||data2.getData("text/uri-text")),!0):(function(view){let parent=view.dom.parentNode;if(!parent)return;let target=parent.appendChild(document.createElement("textarea"));target.style.cssText="position: fixed; left: -10000px; top: 10px",target.focus(),setTimeout((()=>{view.focus(),target.remove(),doPaste$1(view,target.value)}),50)}(view),!1)};let lastLinewiseCopy$1=null;handlers$1.copy=handlers$1.cut=(view,event)=>{let{text:text2,ranges:ranges,linewise:linewise}=function(state){let content2=[],ranges=[],linewise=!1;for(let range of state.selection.ranges)range.empty||(content2.push(state.sliceDoc(range.from,range.to)),ranges.push(range));if(!content2.length){let upto=-1;for(let{from:from}of state.selection.ranges){let line=state.doc.lineAt(from);line.number>upto&&(content2.push(line.text),ranges.push({from:line.from,to:Math.min(state.doc.length,line.to+1)})),upto=line.number}linewise=!0}return{text:content2.join(state.lineBreak),ranges:ranges,linewise:linewise}}(view.state);if(!text2&&!linewise)return!1;lastLinewiseCopy$1=linewise?text2:null,"cut"!=event.type||view.state.readOnly||view.dispatch({changes:ranges,scrollIntoView:!0,userEvent:"delete.cut"});let data2=brokenClipboardAPI$1?null:event.clipboardData;return data2?(data2.clearData(),data2.setData("text/plain",text2),!0):(function(view,text2){let parent=view.dom.parentNode;if(!parent)return;let target=parent.appendChild(document.createElement("textarea"));target.style.cssText="position: fixed; left: -10000px; top: 10px",target.value=text2,target.focus(),target.selectionEnd=text2.length,target.selectionStart=0,setTimeout((()=>{target.remove(),view.focus()}),50)}(view,text2),!1)};const isFocusChange$1=Annotation.define();function focusChangeTransaction$1(state,focus){let effects=[];for(let getEffect of state.facet(focusChangeEffect$1)){let effect2=getEffect(state,focus);effect2&&effects.push(effect2)}return effects?state.update({effects:effects,annotations:isFocusChange$1.of(!0)}):null}function updateForFocusChange$1(view){setTimeout((()=>{let focus=view.hasFocus;if(focus!=view.inputState.notifiedFocused){let tr=focusChangeTransaction$1(view.state,focus);tr?view.dispatch(tr):view.update([])}}),10)}observers$1.focus=view=>{view.inputState.lastFocusTime=Date.now(),view.scrollDOM.scrollTop||!view.inputState.lastScrollTop&&!view.inputState.lastScrollLeft||(view.scrollDOM.scrollTop=view.inputState.lastScrollTop,view.scrollDOM.scrollLeft=view.inputState.lastScrollLeft),updateForFocusChange$1(view)},observers$1.blur=view=>{view.observer.clearSelectionRange(),updateForFocusChange$1(view)},observers$1.compositionstart=observers$1.compositionupdate=view=>{null==view.inputState.compositionFirstChange&&(view.inputState.compositionFirstChange=!0),view.inputState.composing<0&&(view.inputState.composing=0)},observers$1.compositionend=view=>{view.inputState.composing=-1,view.inputState.compositionEndedAt=Date.now(),view.inputState.compositionPendingKey=!0,view.inputState.compositionPendingChange=view.observer.pendingRecords().length>0,view.inputState.compositionFirstChange=null,browser$2.chrome&&browser$2.android?view.observer.flushSoon():view.inputState.compositionPendingChange?Promise.resolve().then((()=>view.observer.flush())):setTimeout((()=>{view.inputState.composing<0&&view.docView.hasComposition&&view.update([])}),50)},observers$1.contextmenu=view=>{view.inputState.lastContextMenu=Date.now()},handlers$1.beforeinput=(view,event)=>{var _a2;let pending;if(browser$2.chrome&&browser$2.android&&(pending=PendingKeys$1.find((key=>key.inputType==event.inputType)))&&(view.observer.delayAndroidKey(pending.key,pending.keyCode),"Backspace"==pending.key||"Delete"==pending.key)){let startViewHeight=(null===(_a2=window.visualViewport)||void 0===_a2?void 0:_a2.height)||0;setTimeout((()=>{var _a3;((null===(_a3=window.visualViewport)||void 0===_a3?void 0:_a3.height)||0)>startViewHeight+10&&view.hasFocus&&(view.contentDOM.blur(),view.focus())}),100)}return!1};const appliedFirefoxHack$1=new Set;const wrappingWhiteSpace$1=["pre-wrap","normal","pre-line","break-spaces"];let HeightOracle$1=class{constructor(lineWrapping){this.lineWrapping=lineWrapping,this.doc=Text.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(from,to){let lines=this.doc.lineAt(to).number-this.doc.lineAt(from).number+1;return this.lineWrapping&&(lines+=Math.max(0,Math.ceil((to-from-lines*this.lineLength*.5)/this.lineLength))),this.lineHeight*lines}heightForLine(length){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((length-this.lineLength)/(this.lineLength-5))))*this.lineHeight}setDoc(doc2){return this.doc=doc2,this}mustRefreshForWrapping(whiteSpace){return wrappingWhiteSpace$1.indexOf(whiteSpace)>-1!=this.lineWrapping}mustRefreshForHeights(lineHeights){let newHeight=!1;for(let i2=0;i2<lineHeights.length;i2++){let h=lineHeights[i2];h<0?i2++:this.heightSamples[Math.floor(10*h)]||(newHeight=!0,this.heightSamples[Math.floor(10*h)]=!0)}return newHeight}refresh(whiteSpace,lineHeight,charWidth,textHeight,lineLength,knownHeights){let lineWrapping=wrappingWhiteSpace$1.indexOf(whiteSpace)>-1,changed=Math.round(lineHeight)!=Math.round(this.lineHeight)||this.lineWrapping!=lineWrapping;if(this.lineWrapping=lineWrapping,this.lineHeight=lineHeight,this.charWidth=charWidth,this.textHeight=textHeight,this.lineLength=lineLength,changed){this.heightSamples={};for(let i2=0;i2<knownHeights.length;i2++){let h=knownHeights[i2];h<0?i2++:this.heightSamples[Math.floor(10*h)]=!0}}return changed}},MeasuredHeights$1=class{constructor(from,heights){this.from=from,this.heights=heights,this.index=0}get more(){return this.index<this.heights.length}},BlockInfo$1=class BlockInfo2{constructor(from,length,top2,height,_content){this.from=from,this.length=length,this.top=top2,this.height=height,this._content=_content}get type(){return"number"==typeof this._content?BlockType$1.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof PointDecoration$1?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(other){let content2=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(other._content)?other._content:[other]);return new BlockInfo2(this.from,this.length+other.length,this.top,this.height+other.height,content2)}};var QueryType$2=function(QueryType2){return QueryType2[QueryType2.ByPos=0]="ByPos",QueryType2[QueryType2.ByHeight=1]="ByHeight",QueryType2[QueryType2.ByPosNoHeight=2]="ByPosNoHeight",QueryType2}(QueryType$2||(QueryType$2={}));let HeightMap$1=class HeightMap2{constructor(length,height,flags=2){this.length=length,this.height=height,this.flags=flags}get outdated(){return(2&this.flags)>0}set outdated(value){this.flags=(value?2:0)|-3&this.flags}setHeight(oracle,height){this.height!=height&&(Math.abs(this.height-height)>.001&&(oracle.heightChanged=!0),this.height=height)}replace(_from,_to,nodes){return HeightMap2.of(nodes)}decomposeLeft(_to,result){result.push(this)}decomposeRight(_from,result){result.push(this)}applyChanges(decorations2,oldDoc,oracle,changes){let me=this,doc2=oracle.doc;for(let i2=changes.length-1;i2>=0;i2--){let{fromA:fromA,toA:toA,fromB:fromB,toB:toB}=changes[i2],start2=me.lineAt(fromA,QueryType$2.ByPosNoHeight,oracle.setDoc(oldDoc),0,0),end2=start2.to>=toA?start2:me.lineAt(toA,QueryType$2.ByPosNoHeight,oracle,0,0);for(toB+=end2.to-toA,toA=end2.to;i2>0&&start2.from<=changes[i2-1].toA;)fromA=changes[i2-1].fromA,fromB=changes[i2-1].fromB,i2--,fromA<start2.from&&(start2=me.lineAt(fromA,QueryType$2.ByPosNoHeight,oracle,0,0));fromB+=start2.from-fromA,fromA=start2.from;let nodes=NodeBuilder$1.build(oracle.setDoc(doc2),decorations2,fromB,toB);me=me.replace(fromA,toA,nodes)}return me.updateHeight(oracle,0)}static empty(){return new HeightMapText$1(0,0)}static of(nodes){if(1==nodes.length)return nodes[0];let i2=0,j=nodes.length,before=0,after=0;for(;;)if(i2==j)if(before>2*after){let split=nodes[i2-1];split.break?nodes.splice(--i2,1,split.left,null,split.right):nodes.splice(--i2,1,split.left,split.right),j+=1+split.break,before-=split.size}else{if(!(after>2*before))break;{let split=nodes[j];split.break?nodes.splice(j,1,split.left,null,split.right):nodes.splice(j,1,split.left,split.right),j+=2+split.break,after-=split.size}}else if(before<after){let next=nodes[i2++];next&&(before+=next.size)}else{let next=nodes[--j];next&&(after+=next.size)}let brk=0;return null==nodes[i2-1]?(brk=1,i2--):null==nodes[i2]&&(brk=1,j++),new HeightMapBranch$1(HeightMap2.of(nodes.slice(0,i2)),brk,HeightMap2.of(nodes.slice(j)))}};HeightMap$1.prototype.size=1;let HeightMapBlock$1=class extends HeightMap$1{constructor(length,height,deco){super(length,height),this.deco=deco}blockAt(_height,_oracle,top2,offset2){return new BlockInfo$1(offset2,this.length,top2,this.height,this.deco||0)}lineAt(_value,_type,oracle,top2,offset2){return this.blockAt(0,oracle,top2,offset2)}forEachLine(from,to,oracle,top2,offset2,f){from<=offset2+this.length&&to>=offset2&&f(this.blockAt(0,oracle,top2,offset2))}updateHeight(oracle,offset2=0,_force=!1,measured){return measured&&measured.from<=offset2&&measured.more&&this.setHeight(oracle,measured.heights[measured.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}},HeightMapText$1=class HeightMapText2 extends HeightMapBlock$1{constructor(length,height){super(length,height,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(_height,_oracle,top2,offset2){return new BlockInfo$1(offset2,this.length,top2,this.height,this.breaks)}replace(_from,_to,nodes){let node=nodes[0];return 1==nodes.length&&(node instanceof HeightMapText2||node instanceof HeightMapGap$1&&4&node.flags)&&Math.abs(this.length-node.length)<10?(node instanceof HeightMapGap$1?node=new HeightMapText2(node.length,this.height):node.height=this.height,this.outdated||(node.outdated=!1),node):HeightMap$1.of(nodes)}updateHeight(oracle,offset2=0,force=!1,measured){return measured&&measured.from<=offset2&&measured.more?this.setHeight(oracle,measured.heights[measured.index++]):(force||this.outdated)&&this.setHeight(oracle,Math.max(this.widgetHeight,oracle.heightForLine(this.length-this.collapsed))+this.breaks*oracle.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}},HeightMapGap$1=class HeightMapGap2 extends HeightMap$1{constructor(length){super(length,0)}heightMetrics(oracle,offset2){let perLine,firstLine=oracle.doc.lineAt(offset2).number,lastLine=oracle.doc.lineAt(offset2+this.length).number,lines=lastLine-firstLine+1,perChar=0;if(oracle.lineWrapping){let totalPerLine=Math.min(this.height,oracle.lineHeight*lines);perLine=totalPerLine/lines,this.length>lines+1&&(perChar=(this.height-totalPerLine)/(this.length-lines-1))}else perLine=this.height/lines;return{firstLine:firstLine,lastLine:lastLine,perLine:perLine,perChar:perChar}}blockAt(height,oracle,top2,offset2){let{firstLine:firstLine,lastLine:lastLine,perLine:perLine,perChar:perChar}=this.heightMetrics(oracle,offset2);if(oracle.lineWrapping){let guess=offset2+Math.round(Math.max(0,Math.min(1,(height-top2)/this.height))*this.length),line=oracle.doc.lineAt(guess),lineHeight=perLine+line.length*perChar,lineTop=Math.max(top2,height-lineHeight/2);return new BlockInfo$1(line.from,line.length,lineTop,lineHeight,0)}{let line=Math.max(0,Math.min(lastLine-firstLine,Math.floor((height-top2)/perLine))),{from:from,length:length}=oracle.doc.line(firstLine+line);return new BlockInfo$1(from,length,top2+perLine*line,perLine,0)}}lineAt(value,type2,oracle,top2,offset2){if(type2==QueryType$2.ByHeight)return this.blockAt(value,oracle,top2,offset2);if(type2==QueryType$2.ByPosNoHeight){let{from:from,to:to}=oracle.doc.lineAt(value);return new BlockInfo$1(from,to-from,0,0,0)}let{firstLine:firstLine,perLine:perLine,perChar:perChar}=this.heightMetrics(oracle,offset2),line=oracle.doc.lineAt(value),lineHeight=perLine+line.length*perChar,linesAbove=line.number-firstLine,lineTop=top2+perLine*linesAbove+perChar*(line.from-offset2-linesAbove);return new BlockInfo$1(line.from,line.length,Math.max(top2,Math.min(lineTop,top2+this.height-lineHeight)),lineHeight,0)}forEachLine(from,to,oracle,top2,offset2,f){from=Math.max(from,offset2),to=Math.min(to,offset2+this.length);let{firstLine:firstLine,perLine:perLine,perChar:perChar}=this.heightMetrics(oracle,offset2);for(let pos=from,lineTop=top2;pos<=to;){let line=oracle.doc.lineAt(pos);if(pos==from){let linesAbove=line.number-firstLine;lineTop+=perLine*linesAbove+perChar*(from-offset2-linesAbove)}let lineHeight=perLine+perChar*line.length;f(new BlockInfo$1(line.from,line.length,lineTop,lineHeight,0)),lineTop+=lineHeight,pos=line.to+1}}replace(from,to,nodes){let after=this.length-to;if(after>0){let last=nodes[nodes.length-1];last instanceof HeightMapGap2?nodes[nodes.length-1]=new HeightMapGap2(last.length+after):nodes.push(null,new HeightMapGap2(after-1))}if(from>0){let first=nodes[0];first instanceof HeightMapGap2?nodes[0]=new HeightMapGap2(from+first.length):nodes.unshift(new HeightMapGap2(from-1),null)}return HeightMap$1.of(nodes)}decomposeLeft(to,result){result.push(new HeightMapGap2(to-1),null)}decomposeRight(from,result){result.push(null,new HeightMapGap2(this.length-from-1))}updateHeight(oracle,offset2=0,force=!1,measured){let end2=offset2+this.length;if(measured&&measured.from<=offset2+this.length&&measured.more){let nodes=[],pos=Math.max(offset2,measured.from),singleHeight=-1;for(measured.from>offset2&&nodes.push(new HeightMapGap2(measured.from-offset2-1).updateHeight(oracle,offset2));pos<=end2&&measured.more;){let len=oracle.doc.lineAt(pos).length;nodes.length&&nodes.push(null);let height=measured.heights[measured.index++];-1==singleHeight?singleHeight=height:Math.abs(height-singleHeight)>=.001&&(singleHeight=-2);let line=new HeightMapText$1(len,height);line.outdated=!1,nodes.push(line),pos+=len+1}pos<=end2&&nodes.push(null,new HeightMapGap2(end2-pos).updateHeight(oracle,pos));let result=HeightMap$1.of(nodes);return(singleHeight<0||Math.abs(result.height-this.height)>=.001||Math.abs(singleHeight-this.heightMetrics(oracle,offset2).perLine)>=.001)&&(oracle.heightChanged=!0),result}return(force||this.outdated)&&(this.setHeight(oracle,oracle.heightForGap(offset2,offset2+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}},HeightMapBranch$1=class extends HeightMap$1{constructor(left2,brk,right2){super(left2.length+brk+right2.length,left2.height+right2.height,brk|(left2.outdated||right2.outdated?2:0)),this.left=left2,this.right=right2,this.size=left2.size+right2.size}get break(){return 1&this.flags}blockAt(height,oracle,top2,offset2){let mid=top2+this.left.height;return height<mid?this.left.blockAt(height,oracle,top2,offset2):this.right.blockAt(height,oracle,mid,offset2+this.left.length+this.break)}lineAt(value,type2,oracle,top2,offset2){let rightTop=top2+this.left.height,rightOffset=offset2+this.left.length+this.break,left2=type2==QueryType$2.ByHeight?value<rightTop:value<rightOffset,base2=left2?this.left.lineAt(value,type2,oracle,top2,offset2):this.right.lineAt(value,type2,oracle,rightTop,rightOffset);if(this.break||(left2?base2.to<rightOffset:base2.from>rightOffset))return base2;let subQuery=type2==QueryType$2.ByPosNoHeight?QueryType$2.ByPosNoHeight:QueryType$2.ByPos;return left2?base2.join(this.right.lineAt(rightOffset,subQuery,oracle,rightTop,rightOffset)):this.left.lineAt(rightOffset,subQuery,oracle,top2,offset2).join(base2)}forEachLine(from,to,oracle,top2,offset2,f){let rightTop=top2+this.left.height,rightOffset=offset2+this.left.length+this.break;if(this.break)from<rightOffset&&this.left.forEachLine(from,to,oracle,top2,offset2,f),to>=rightOffset&&this.right.forEachLine(from,to,oracle,rightTop,rightOffset,f);else{let mid=this.lineAt(rightOffset,QueryType$2.ByPos,oracle,top2,offset2);from<mid.from&&this.left.forEachLine(from,mid.from-1,oracle,top2,offset2,f),mid.to>=from&&mid.from<=to&&f(mid),to>mid.to&&this.right.forEachLine(mid.to+1,to,oracle,rightTop,rightOffset,f)}}replace(from,to,nodes){let rightStart=this.left.length+this.break;if(to<rightStart)return this.balanced(this.left.replace(from,to,nodes),this.right);if(from>this.left.length)return this.balanced(this.left,this.right.replace(from-rightStart,to-rightStart,nodes));let result=[];from>0&&this.decomposeLeft(from,result);let left2=result.length;for(let node of nodes)result.push(node);if(from>0&&mergeGaps$1(result,left2-1),to<this.length){let right2=result.length;this.decomposeRight(to,result),mergeGaps$1(result,right2)}return HeightMap$1.of(result)}decomposeLeft(to,result){let left2=this.left.length;if(to<=left2)return this.left.decomposeLeft(to,result);result.push(this.left),this.break&&(left2++,to>=left2&&result.push(null)),to>left2&&this.right.decomposeLeft(to-left2,result)}decomposeRight(from,result){let left2=this.left.length,right2=left2+this.break;if(from>=right2)return this.right.decomposeRight(from-right2,result);from<left2&&this.left.decomposeRight(from,result),this.break&&from<right2&&result.push(null),result.push(this.right)}balanced(left2,right2){return left2.size>2*right2.size||right2.size>2*left2.size?HeightMap$1.of(this.break?[left2,null,right2]:[left2,right2]):(this.left=left2,this.right=right2,this.height=left2.height+right2.height,this.outdated=left2.outdated||right2.outdated,this.size=left2.size+right2.size,this.length=left2.length+this.break+right2.length,this)}updateHeight(oracle,offset2=0,force=!1,measured){let{left:left2,right:right2}=this,rightStart=offset2+left2.length+this.break,rebalance=null;return measured&&measured.from<=offset2+left2.length&&measured.more?rebalance=left2=left2.updateHeight(oracle,offset2,force,measured):left2.updateHeight(oracle,offset2,force),measured&&measured.from<=rightStart+right2.length&&measured.more?rebalance=right2=right2.updateHeight(oracle,rightStart,force,measured):right2.updateHeight(oracle,rightStart,force),rebalance?this.balanced(left2,right2):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}};function mergeGaps$1(nodes,around){let before,after;null==nodes[around]&&(before=nodes[around-1])instanceof HeightMapGap$1&&(after=nodes[around+1])instanceof HeightMapGap$1&&nodes.splice(around-1,3,new HeightMapGap$1(before.length+1+after.length))}let NodeBuilder$1=class NodeBuilder2{constructor(pos,oracle){this.pos=pos,this.oracle=oracle,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=pos}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(_from,to){if(this.lineStart>-1){let end2=Math.min(to,this.lineEnd),last=this.nodes[this.nodes.length-1];last instanceof HeightMapText$1?last.length+=end2-this.pos:(end2>this.pos||!this.isCovered)&&this.nodes.push(new HeightMapText$1(end2-this.pos,-1)),this.writtenTo=end2,to>end2&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=to}point(from,to,deco){if(from<to||deco.heightRelevant){let height=deco.widget?deco.widget.estimatedHeight:0,breaks=deco.widget?deco.widget.lineBreaks:0;height<0&&(height=this.oracle.lineHeight);let len=to-from;deco.block?this.addBlock(new HeightMapBlock$1(len,height,deco)):(len||breaks||height>=5)&&this.addLineDeco(height,breaks,len)}else to>from&&this.span(from,to);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:from,to:to}=this.oracle.doc.lineAt(this.pos);this.lineStart=from,this.lineEnd=to,this.writtenTo<from&&((this.writtenTo<from-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,from-1)),this.nodes.push(null)),this.pos>from&&this.nodes.push(new HeightMapText$1(this.pos-from,-1)),this.writtenTo=this.pos}blankContent(from,to){let gap=new HeightMapGap$1(to-from);return this.oracle.doc.lineAt(from).to==to&&(gap.flags|=4),gap}ensureLine(){this.enterLine();let last=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(last instanceof HeightMapText$1)return last;let line=new HeightMapText$1(0,-1);return this.nodes.push(line),line}addBlock(block){this.enterLine();let deco=block.deco;deco&&deco.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(block),this.writtenTo=this.pos=this.pos+block.length,deco&&deco.endSide>0&&(this.covering=block)}addLineDeco(height,breaks,length){let line=this.ensureLine();line.length+=length,line.collapsed+=length,line.widgetHeight=Math.max(line.widgetHeight,height),line.breaks+=breaks,this.writtenTo=this.pos=this.pos+length}finish(from){let last=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||last instanceof HeightMapText$1||this.isCovered?(this.writtenTo<this.pos||null==last)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new HeightMapText$1(0,-1));let pos=from;for(let node of this.nodes)node instanceof HeightMapText$1&&node.updateHeight(this.oracle,pos),pos+=node?node.length:1;return this.nodes}static build(oracle,decorations2,from,to){let builder=new NodeBuilder2(from,oracle);return RangeSet.spans(decorations2,from,to,builder,0),builder.finish(from)}};let DecorationComparator$2=class{constructor(){this.changes=[]}compareRange(){}comparePoint(from,to,a,b){(from<to||a&&a.heightRelevant||b&&b.heightRelevant)&&addRange$1(from,to,this.changes,5)}};function visiblePixelRange$1(dom,paddingTop){let rect=dom.getBoundingClientRect(),doc2=dom.ownerDocument,win=doc2.defaultView||window,left2=Math.max(0,rect.left),right2=Math.min(win.innerWidth,rect.right),top2=Math.max(0,rect.top),bottom2=Math.min(win.innerHeight,rect.bottom);for(let parent=dom.parentNode;parent&&parent!=doc2.body;)if(1==parent.nodeType){let elt=parent,style=window.getComputedStyle(elt);if((elt.scrollHeight>elt.clientHeight||elt.scrollWidth>elt.clientWidth)&&"visible"!=style.overflow){let parentRect=elt.getBoundingClientRect();left2=Math.max(left2,parentRect.left),right2=Math.min(right2,parentRect.right),top2=Math.max(top2,parentRect.top),bottom2=parent==dom.parentNode?parentRect.bottom:Math.min(bottom2,parentRect.bottom)}parent="absolute"==style.position||"fixed"==style.position?elt.offsetParent:elt.parentNode}else{if(11!=parent.nodeType)break;parent=parent.host}return{left:left2-rect.left,right:Math.max(left2,right2)-rect.left,top:top2-(rect.top+paddingTop),bottom:Math.max(top2,bottom2)-(rect.top+paddingTop)}}function fullPixelRange$1(dom,paddingTop){let rect=dom.getBoundingClientRect();return{left:0,right:rect.right-rect.left,top:paddingTop,bottom:rect.bottom-(rect.top+paddingTop)}}let LineGap$1=class{constructor(from,to,size){this.from=from,this.to=to,this.size=size}static same(a,b){if(a.length!=b.length)return!1;for(let i2=0;i2<a.length;i2++){let gA=a[i2],gB=b[i2];if(gA.from!=gB.from||gA.to!=gB.to||gA.size!=gB.size)return!1}return!0}draw(viewState,wrapping){return Decoration$1.replace({widget:new LineGapWidget$1(this.size*(wrapping?viewState.scaleY:viewState.scaleX),wrapping)}).range(this.from,this.to)}},LineGapWidget$1=class extends WidgetType$1{constructor(size,vertical){super(),this.size=size,this.vertical=vertical}eq(other){return other.size==this.size&&other.vertical==this.vertical}toDOM(){let elt=document.createElement("div");return this.vertical?elt.style.height=this.size+"px":(elt.style.width=this.size+"px",elt.style.height="2px",elt.style.display="inline-block"),elt}get estimatedHeight(){return this.vertical?this.size:-1}},ViewState$1=class{constructor(state){this.state=state,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=IdScaler$1,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Direction$1.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let guessWrapping=state.facet(contentAttributes$1).some((v=>"function"!=typeof v&&"cm-lineWrapping"==v.class));this.heightOracle=new HeightOracle$1(guessWrapping),this.stateDeco=state.facet(decorations$1).filter((d=>"function"!=typeof d)),this.heightMap=HeightMap$1.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle.setDoc(state.doc),[new ChangedRange$1(0,0,0,state.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Decoration$1.set(this.lineGaps.map((gap=>gap.draw(this,!1)))),this.computeVisibleRanges()}updateForViewport(){let viewports=[this.viewport],{main:main2}=this.state.selection;for(let i2=0;i2<=1;i2++){let pos=i2?main2.head:main2.anchor;if(!viewports.some((({from:from,to:to})=>pos>=from&&pos<=to))){let{from:from,to:to}=this.lineBlockAt(pos);viewports.push(new Viewport$1(from,to))}}this.viewports=viewports.sort(((a,b)=>a.from-b.from)),this.scaler=this.heightMap.height<=7e6?IdScaler$1:new BigScaler$1(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(block=>{this.viewportLines.push(1==this.scaler.scale?block:scaleBlock$1(block,this.scaler))}))}update(update2,scrollTarget=null){this.state=update2.state;let prevDeco=this.stateDeco;this.stateDeco=this.state.facet(decorations$1).filter((d=>"function"!=typeof d));let contentChanges=update2.changedRanges,heightChanges=ChangedRange$1.extendWithRanges(contentChanges,function(a,b,diff){let comp=new DecorationComparator$2;return RangeSet.compare(a,b,diff,comp,0),comp.changes}(prevDeco,this.stateDeco,update2?update2.changes:ChangeSet.empty(this.state.doc.length))),prevHeight=this.heightMap.height,scrollAnchor=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,update2.startState.doc,this.heightOracle.setDoc(this.state.doc),heightChanges),this.heightMap.height!=prevHeight&&(update2.flags|=2),scrollAnchor?(this.scrollAnchorPos=update2.changes.mapPos(scrollAnchor.from,-1),this.scrollAnchorHeight=scrollAnchor.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let viewport2=heightChanges.length?this.mapViewport(this.viewport,update2.changes):this.viewport;(scrollTarget&&(scrollTarget.range.head<viewport2.from||scrollTarget.range.head>viewport2.to)||!this.viewportIsAppropriate(viewport2))&&(viewport2=this.getViewport(0,scrollTarget));let updateLines=!update2.changes.empty||2&update2.flags||viewport2.from!=this.viewport.from||viewport2.to!=this.viewport.to;this.viewport=viewport2,this.updateForViewport(),updateLines&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,update2.changes))),update2.flags|=this.computeVisibleRanges(),scrollTarget&&(this.scrollTarget=scrollTarget),!this.mustEnforceCursorAssoc&&update2.selectionSet&&update2.view.lineWrapping&&update2.state.selection.main.empty&&update2.state.selection.main.assoc&&!update2.state.facet(nativeSelectionHidden$1)&&(this.mustEnforceCursorAssoc=!0)}measure(view){let dom=view.contentDOM,style=window.getComputedStyle(dom),oracle=this.heightOracle,whiteSpace=style.whiteSpace;this.defaultTextDirection="rtl"==style.direction?Direction$1.RTL:Direction$1.LTR;let refresh=this.heightOracle.mustRefreshForWrapping(whiteSpace),domRect=dom.getBoundingClientRect(),measureContent=refresh||this.mustMeasureContent||this.contentDOMHeight!=domRect.height;this.contentDOMHeight=domRect.height,this.mustMeasureContent=!1;let result=0,bias=0;if(domRect.width&&domRect.height){let scaleX=domRect.width/dom.offsetWidth,scaleY=domRect.height/dom.offsetHeight;(scaleX>.995&&scaleX<1.005||!isFinite(scaleX)||Math.abs(domRect.width-dom.offsetWidth)<1)&&(scaleX=1),(scaleY>.995&&scaleY<1.005||!isFinite(scaleY)||Math.abs(domRect.height-dom.offsetHeight)<1)&&(scaleY=1),this.scaleX==scaleX&&this.scaleY==scaleY||(this.scaleX=scaleX,this.scaleY=scaleY,result|=8,refresh=measureContent=!0)}let paddingTop=(parseInt(style.paddingTop)||0)*this.scaleY,paddingBottom=(parseInt(style.paddingBottom)||0)*this.scaleY;this.paddingTop==paddingTop&&this.paddingBottom==paddingBottom||(this.paddingTop=paddingTop,this.paddingBottom=paddingBottom,result|=10),this.editorWidth!=view.scrollDOM.clientWidth&&(oracle.lineWrapping&&(measureContent=!0),this.editorWidth=view.scrollDOM.clientWidth,result|=8);let scrollTop=view.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=scrollTop&&(this.scrollAnchorHeight=-1,this.scrollTop=scrollTop),this.scrolledToBottom=isScrolledToBottom$1(view.scrollDOM);let pixelViewport=(this.printing?fullPixelRange$1:visiblePixelRange$1)(dom,this.paddingTop),dTop=pixelViewport.top-this.pixelViewport.top,dBottom=pixelViewport.bottom-this.pixelViewport.bottom;this.pixelViewport=pixelViewport;let inView=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(inView!=this.inView&&(this.inView=inView,inView&&(measureContent=!0)),!this.inView&&!this.scrollTarget)return 0;let contentWidth=domRect.width;if(this.contentDOMWidth==contentWidth&&this.editorHeight==view.scrollDOM.clientHeight||(this.contentDOMWidth=domRect.width,this.editorHeight=view.scrollDOM.clientHeight,result|=8),measureContent){let lineHeights=view.docView.measureVisibleLineHeights(this.viewport);if(oracle.mustRefreshForHeights(lineHeights)&&(refresh=!0),refresh||oracle.lineWrapping&&Math.abs(contentWidth-this.contentDOMWidth)>oracle.charWidth){let{lineHeight:lineHeight,charWidth:charWidth,textHeight:textHeight}=view.docView.measureTextSize();refresh=lineHeight>0&&oracle.refresh(whiteSpace,lineHeight,charWidth,textHeight,contentWidth/charWidth,lineHeights),refresh&&(view.docView.minWidth=0,result|=8)}dTop>0&&dBottom>0?bias=Math.max(dTop,dBottom):dTop<0&&dBottom<0&&(bias=Math.min(dTop,dBottom)),oracle.heightChanged=!1;for(let vp of this.viewports){let heights=vp.from==this.viewport.from?lineHeights:view.docView.measureVisibleLineHeights(vp);this.heightMap=(refresh?HeightMap$1.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle,[new ChangedRange$1(0,0,0,view.state.doc.length)]):this.heightMap).updateHeight(oracle,0,refresh,new MeasuredHeights$1(vp.from,heights))}oracle.heightChanged&&(result|=2)}let viewportChange=!this.viewportIsAppropriate(this.viewport,bias)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return viewportChange&&(this.viewport=this.getViewport(bias,this.scrollTarget)),this.updateForViewport(),(2&result||viewportChange)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(refresh?[]:this.lineGaps,view)),result|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,view.docView.enforceCursorAssoc()),result}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(bias,scrollTarget){let marginTop=.5-Math.max(-.5,Math.min(.5,bias/1e3/2)),map=this.heightMap,oracle=this.heightOracle,{visibleTop:visibleTop,visibleBottom:visibleBottom}=this,viewport2=new Viewport$1(map.lineAt(visibleTop-1e3*marginTop,QueryType$2.ByHeight,oracle,0,0).from,map.lineAt(visibleBottom+1e3*(1-marginTop),QueryType$2.ByHeight,oracle,0,0).to);if(scrollTarget){let{head:head}=scrollTarget.range;if(head<viewport2.from||head>viewport2.to){let topPos,viewHeight=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),block=map.lineAt(head,QueryType$2.ByPos,oracle,0,0);topPos="center"==scrollTarget.y?(block.top+block.bottom)/2-viewHeight/2:"start"==scrollTarget.y||"nearest"==scrollTarget.y&&head<viewport2.from?block.top:block.bottom-viewHeight,viewport2=new Viewport$1(map.lineAt(topPos-500,QueryType$2.ByHeight,oracle,0,0).from,map.lineAt(topPos+viewHeight+500,QueryType$2.ByHeight,oracle,0,0).to)}}return viewport2}mapViewport(viewport2,changes){let from=changes.mapPos(viewport2.from,-1),to=changes.mapPos(viewport2.to,1);return new Viewport$1(this.heightMap.lineAt(from,QueryType$2.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(to,QueryType$2.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:from,to:to},bias=0){if(!this.inView)return!0;let{top:top2}=this.heightMap.lineAt(from,QueryType$2.ByPos,this.heightOracle,0,0),{bottom:bottom2}=this.heightMap.lineAt(to,QueryType$2.ByPos,this.heightOracle,0,0),{visibleTop:visibleTop,visibleBottom:visibleBottom}=this;return(0==from||top2<=visibleTop-Math.max(10,Math.min(-bias,250)))&&(to==this.state.doc.length||bottom2>=visibleBottom+Math.max(10,Math.min(bias,250)))&&top2>visibleTop-2e3&&bottom2<visibleBottom+2e3}mapLineGaps(gaps,changes){if(!gaps.length||changes.empty)return gaps;let mapped=[];for(let gap of gaps)changes.touchesRange(gap.from,gap.to)||mapped.push(new LineGap$1(changes.mapPos(gap.from),changes.mapPos(gap.to),gap.size));return mapped}ensureLineGaps(current,mayMeasure){let wrapping=this.heightOracle.lineWrapping,margin=wrapping?1e4:2e3,halfMargin=margin>>1,doubleMargin=margin<<1;if(this.defaultTextDirection!=Direction$1.LTR&&!wrapping)return[];let gaps=[],addGap=(from,to,line,structure)=>{if(to-from<halfMargin)return;let sel=this.state.selection.main,avoid=[sel.from];sel.empty||avoid.push(sel.to);for(let pos of avoid)if(pos>from&&pos<to)return addGap(from,pos-10,line,structure),void addGap(pos+10,to,line,structure);let gap=function(array,f){for(let val of array)if(f(val))return val;return}(current,(gap2=>gap2.from>=line.from&&gap2.to<=line.to&&Math.abs(gap2.from-from)<halfMargin&&Math.abs(gap2.to-to)<halfMargin&&!avoid.some((pos=>gap2.from<pos&&gap2.to>pos))));if(!gap){if(to<line.to&&mayMeasure&&wrapping&&mayMeasure.visibleRanges.some((r=>r.from<=to&&r.to>=to))){let lineStart=mayMeasure.moveToLineBoundary(EditorSelection.cursor(to),!1,!0).head;lineStart>from&&(to=lineStart)}gap=new LineGap$1(from,to,this.gapSize(line,from,to,structure))}gaps.push(gap)};for(let line of this.viewportLines){if(line.length<doubleMargin)continue;let structure=lineStructure$1(line.from,line.to,this.stateDeco);if(structure.total<doubleMargin)continue;let viewFrom,viewTo,target=this.scrollTarget?this.scrollTarget.range.head:null;if(wrapping){let top2,bot,marginHeight=margin/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=target){let targetFrac=findFraction$1(structure,target),spaceFrac=((this.visibleBottom-this.visibleTop)/2+marginHeight)/line.height;top2=targetFrac-spaceFrac,bot=targetFrac+spaceFrac}else top2=(this.visibleTop-line.top-marginHeight)/line.height,bot=(this.visibleBottom-line.top+marginHeight)/line.height;viewFrom=findPosition$1(structure,top2),viewTo=findPosition$1(structure,bot)}else{let left2,right2,totalWidth=structure.total*this.heightOracle.charWidth,marginWidth=margin*this.heightOracle.charWidth;if(null!=target){let targetFrac=findFraction$1(structure,target),spaceFrac=((this.pixelViewport.right-this.pixelViewport.left)/2+marginWidth)/totalWidth;left2=targetFrac-spaceFrac,right2=targetFrac+spaceFrac}else left2=(this.pixelViewport.left-marginWidth)/totalWidth,right2=(this.pixelViewport.right+marginWidth)/totalWidth;viewFrom=findPosition$1(structure,left2),viewTo=findPosition$1(structure,right2)}viewFrom>line.from&&addGap(line.from,viewFrom,line,structure),viewTo<line.to&&addGap(viewTo,line.to,line,structure)}return gaps}gapSize(line,from,to,structure){let fraction=findFraction$1(structure,to)-findFraction$1(structure,from);return this.heightOracle.lineWrapping?line.height*fraction:structure.total*this.heightOracle.charWidth*fraction}updateLineGaps(gaps){LineGap$1.same(gaps,this.lineGaps)||(this.lineGaps=gaps,this.lineGapDeco=Decoration$1.set(gaps.map((gap=>gap.draw(this,this.heightOracle.lineWrapping)))))}computeVisibleRanges(){let deco=this.stateDeco;this.lineGaps.length&&(deco=deco.concat(this.lineGapDeco));let ranges=[];RangeSet.spans(deco,this.viewport.from,this.viewport.to,{span(from,to){ranges.push({from:from,to:to})},point(){}},20);let changed=ranges.length!=this.visibleRanges.length||this.visibleRanges.some(((r,i2)=>r.from!=ranges[i2].from||r.to!=ranges[i2].to));return this.visibleRanges=ranges,changed?4:0}lineBlockAt(pos){return pos>=this.viewport.from&&pos<=this.viewport.to&&this.viewportLines.find((b=>b.from<=pos&&b.to>=pos))||scaleBlock$1(this.heightMap.lineAt(pos,QueryType$2.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(height){return scaleBlock$1(this.heightMap.lineAt(this.scaler.fromDOM(height),QueryType$2.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(scrollTop){let block=this.lineBlockAtHeight(scrollTop+8);return block.from>=this.viewport.from||this.viewportLines[0].top-scrollTop>200?block:this.viewportLines[0]}elementAtHeight(height){return scaleBlock$1(this.heightMap.blockAt(this.scaler.fromDOM(height),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}},Viewport$1=class{constructor(from,to){this.from=from,this.to=to}};function lineStructure$1(from,to,stateDeco){let ranges=[],pos=from,total=0;return RangeSet.spans(stateDeco,from,to,{span(){},point(from2,to2){from2>pos&&(ranges.push({from:pos,to:from2}),total+=from2-pos),pos=to2}},20),pos<to&&(ranges.push({from:pos,to:to}),total+=to-pos),{total:total,ranges:ranges}}function findPosition$1({total:total,ranges:ranges},ratio){if(ratio<=0)return ranges[0].from;if(ratio>=1)return ranges[ranges.length-1].to;let dist2=Math.floor(total*ratio);for(let i2=0;;i2++){let{from:from,to:to}=ranges[i2],size=to-from;if(dist2<=size)return from+dist2;dist2-=size}}function findFraction$1(structure,pos){let counted=0;for(let{from:from,to:to}of structure.ranges){if(pos<=to){counted+=pos-from;break}counted+=to-from}return counted/structure.total}const IdScaler$1={toDOM:n=>n,fromDOM:n=>n,scale:1};let BigScaler$1=class{constructor(oracle,heightMap,viewports){let vpHeight=0,base2=0,domBase=0;this.viewports=viewports.map((({from:from,to:to})=>{let top2=heightMap.lineAt(from,QueryType$2.ByPos,oracle,0,0).top,bottom2=heightMap.lineAt(to,QueryType$2.ByPos,oracle,0,0).bottom;return vpHeight+=bottom2-top2,{from:from,to:to,top:top2,bottom:bottom2,domTop:0,domBottom:0}})),this.scale=(7e6-vpHeight)/(heightMap.height-vpHeight);for(let obj of this.viewports)obj.domTop=domBase+(obj.top-base2)*this.scale,domBase=obj.domBottom=obj.domTop+(obj.bottom-obj.top),base2=obj.bottom}toDOM(n){for(let i2=0,base2=0,domBase=0;;i2++){let vp=i2<this.viewports.length?this.viewports[i2]:null;if(!vp||n<vp.top)return domBase+(n-base2)*this.scale;if(n<=vp.bottom)return vp.domTop+(n-vp.top);base2=vp.bottom,domBase=vp.domBottom}}fromDOM(n){for(let i2=0,base2=0,domBase=0;;i2++){let vp=i2<this.viewports.length?this.viewports[i2]:null;if(!vp||n<vp.domTop)return base2+(n-domBase)/this.scale;if(n<=vp.domBottom)return vp.top+(n-vp.domTop);base2=vp.bottom,domBase=vp.domBottom}}};function scaleBlock$1(block,scaler){if(1==scaler.scale)return block;let bTop=scaler.toDOM(block.top),bBottom=scaler.toDOM(block.bottom);return new BlockInfo$1(block.from,block.length,bTop,bBottom-bTop,Array.isArray(block._content)?block._content.map((b=>scaleBlock$1(b,scaler))):block._content)}const theme$1=Facet.define({combine:strs=>strs.join(" ")}),darkTheme$1=Facet.define({combine:values=>values.indexOf(!0)>-1}),baseThemeID$1=StyleModule.newName(),baseLightID$1=StyleModule.newName(),baseDarkID$1=StyleModule.newName(),lightDarkIDs$1={"&light":"."+baseLightID$1,"&dark":"."+baseDarkID$1};function buildTheme$1(main2,spec,scopes){return new StyleModule(spec,{finish:sel=>/&/.test(sel)?sel.replace(/&\w*/,(m=>{if("&"==m)return main2;if(!scopes||!scopes[m])throw new RangeError(`Unsupported selector: ${m}`);return scopes[m]})):main2+" "+sel})}const baseTheme$1$4=buildTheme$1("."+baseThemeID$1,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},lightDarkIDs$1);let DOMReader$1=class{constructor(points,state){this.points=points,this.text="",this.lineSeparator=state.facet(EditorState.lineSeparator)}append(text2){this.text+=text2}lineBreak(){this.text+="\uffff"}readRange(start2,end2){if(!start2)return this;let parent=start2.parentNode;for(let cur2=start2;;){this.findPointBefore(parent,cur2);let oldLen=this.text.length;this.readNode(cur2);let next=cur2.nextSibling;if(next==end2)break;let view=ContentView$1.get(cur2),nextView=ContentView$1.get(next);(view&&nextView?view.breakAfter:(view?view.breakAfter:isBlockElement$1(cur2))||isBlockElement$1(next)&&("BR"!=cur2.nodeName||cur2.cmIgnore)&&this.text.length>oldLen)&&this.lineBreak(),cur2=next}return this.findPointBefore(parent,end2),this}readTextNode(node){let text2=node.nodeValue;for(let point of this.points)point.node==node&&(point.pos=this.text.length+Math.min(point.offset,text2.length));for(let off=0,re=this.lineSeparator?null:/\r\n?|\n/g;;){let m,nextBreak=-1,breakSize=1;if(this.lineSeparator?(nextBreak=text2.indexOf(this.lineSeparator,off),breakSize=this.lineSeparator.length):(m=re.exec(text2))&&(nextBreak=m.index,breakSize=m[0].length),this.append(text2.slice(off,nextBreak<0?text2.length:nextBreak)),nextBreak<0)break;if(this.lineBreak(),breakSize>1)for(let point of this.points)point.node==node&&point.pos>this.text.length&&(point.pos-=breakSize-1);off=nextBreak+breakSize}}readNode(node){if(node.cmIgnore)return;let view=ContentView$1.get(node),fromView=view&&view.overrideDOMText;if(null!=fromView){this.findPointInside(node,fromView.length);for(let i2=fromView.iter();!i2.next().done;)i2.lineBreak?this.lineBreak():this.append(i2.value)}else 3==node.nodeType?this.readTextNode(node):"BR"==node.nodeName?node.nextSibling&&this.lineBreak():1==node.nodeType&&this.readRange(node.firstChild,null)}findPointBefore(node,next){for(let point of this.points)point.node==node&&node.childNodes[point.offset]==next&&(point.pos=this.text.length)}findPointInside(node,length){for(let point of this.points)(3==node.nodeType?point.node==node:node.contains(point.node))&&(point.pos=this.text.length+(isAtEnd$1(node,point.node,point.offset)?length:0))}};function isAtEnd$1(parent,node,offset2){for(;;){if(!node||offset2<maxOffset$1(node))return!1;if(node==parent)return!0;offset2=domIndex$1(node)+1,node=node.parentNode}}function isBlockElement$1(node){return 1==node.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(node.nodeName)}let DOMPoint$1=class{constructor(node,offset2){this.node=node,this.offset=offset2,this.pos=-1}},DOMChange$1=class{constructor(view,start2,end2,typeOver){this.typeOver=typeOver,this.bounds=null,this.text="";let{impreciseHead:iHead,impreciseAnchor:iAnchor}=view.docView;if(view.state.readOnly&&start2>-1)this.newSel=null;else if(start2>-1&&(this.bounds=view.docView.domBoundsAround(start2,end2,0))){let selPoints=iHead||iAnchor?[]:function(view){let result=[];if(view.root.activeElement!=view.contentDOM)return result;let{anchorNode:anchorNode,anchorOffset:anchorOffset,focusNode:focusNode,focusOffset:focusOffset}=view.observer.selectionRange;anchorNode&&(result.push(new DOMPoint$1(anchorNode,anchorOffset)),focusNode==anchorNode&&focusOffset==anchorOffset||result.push(new DOMPoint$1(focusNode,focusOffset)));return result}(view),reader=new DOMReader$1(selPoints,view.state);reader.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=reader.text,this.newSel=function(points,base2){if(0==points.length)return null;let anchor=points[0].pos,head=2==points.length?points[1].pos:anchor;return anchor>-1&&head>-1?EditorSelection.single(anchor+base2,head+base2):null}(selPoints,this.bounds.from)}else{let domSel=view.observer.selectionRange,head=iHead&&iHead.node==domSel.focusNode&&iHead.offset==domSel.focusOffset||!contains$1(view.contentDOM,domSel.focusNode)?view.state.selection.main.head:view.docView.posFromDOM(domSel.focusNode,domSel.focusOffset),anchor=iAnchor&&iAnchor.node==domSel.anchorNode&&iAnchor.offset==domSel.anchorOffset||!contains$1(view.contentDOM,domSel.anchorNode)?view.state.selection.main.anchor:view.docView.posFromDOM(domSel.anchorNode,domSel.anchorOffset);this.newSel=EditorSelection.single(anchor,head)}}};function applyDOMChange$1(view,domChange){let change,{newSel:newSel}=domChange,sel=view.state.selection.main,lastKey=view.inputState.lastKeyTime>Date.now()-100?view.inputState.lastKeyCode:-1;if(domChange.bounds){let{from:from,to:to}=domChange.bounds,preferredPos=sel.from,preferredSide=null;(8===lastKey||browser$2.android&&domChange.text.length<to-from)&&(preferredPos=sel.to,preferredSide="end");let diff=function(a,b,preferredPos,preferredSide){let minLen=Math.min(a.length,b.length),from=0;for(;from<minLen&&a.charCodeAt(from)==b.charCodeAt(from);)from++;if(from==minLen&&a.length==b.length)return null;let toA=a.length,toB=b.length;for(;toA>0&&toB>0&&a.charCodeAt(toA-1)==b.charCodeAt(toB-1);)toA--,toB--;if("end"==preferredSide){preferredPos-=toA+Math.max(0,from-Math.min(toA,toB))-from}if(toA<from&&a.length<b.length){from-=preferredPos<=from&&preferredPos>=toA?from-preferredPos:0,toB=from+(toB-toA),toA=from}else if(toB<from){from-=preferredPos<=from&&preferredPos>=toB?from-preferredPos:0,toA=from+(toA-toB),toB=from}return{from:from,toA:toA,toB:toB}}(view.state.doc.sliceString(from,to,"\uffff"),domChange.text,preferredPos-from,preferredSide);diff&&(browser$2.chrome&&13==lastKey&&diff.toB==diff.from+2&&"\uffff\uffff"==domChange.text.slice(diff.from,diff.toB)&&diff.toB--,change={from:from+diff.from,to:from+diff.toA,insert:Text.of(domChange.text.slice(diff.from,diff.toB).split("\uffff"))})}else newSel&&(!view.hasFocus&&view.state.facet(editable$1)||newSel.main.eq(sel))&&(newSel=null);if(!change&&!newSel)return!1;if(!change&&domChange.typeOver&&!sel.empty&&newSel&&newSel.main.empty?change={from:sel.from,to:sel.to,insert:view.state.doc.slice(sel.from,sel.to)}:change&&change.from>=sel.from&&change.to<=sel.to&&(change.from!=sel.from||change.to!=sel.to)&&sel.to-sel.from-(change.to-change.from)<=4?change={from:sel.from,to:sel.to,insert:view.state.doc.slice(sel.from,change.from).append(change.insert).append(view.state.doc.slice(change.to,sel.to))}:(browser$2.mac||browser$2.android)&&change&&change.from==change.to&&change.from==sel.head-1&&/^\. ?$/.test(change.insert.toString())&&"off"==view.contentDOM.getAttribute("autocorrect")?(newSel&&2==change.insert.length&&(newSel=EditorSelection.single(newSel.main.anchor-1,newSel.main.head-1)),change={from:sel.from,to:sel.to,insert:Text.of([" "])}):browser$2.chrome&&change&&change.from==change.to&&change.from==sel.head&&"\n "==change.insert.toString()&&view.lineWrapping&&(newSel&&(newSel=EditorSelection.single(newSel.main.anchor-1,newSel.main.head-1)),change={from:sel.from,to:sel.to,insert:Text.of([" "])}),change){if(browser$2.ios&&view.inputState.flushIOSKey())return!0;if(browser$2.android&&(change.from==sel.from&&change.to==sel.to&&1==change.insert.length&&2==change.insert.lines&&dispatchKey$1(view.contentDOM,"Enter",13)||(change.from==sel.from-1&&change.to==sel.to&&0==change.insert.length||8==lastKey&&change.insert.length<change.to-change.from&&change.to>sel.head)&&dispatchKey$1(view.contentDOM,"Backspace",8)||change.from==sel.from&&change.to==sel.to+1&&0==change.insert.length&&dispatchKey$1(view.contentDOM,"Delete",46)))return!0;let defaultTr,text2=change.insert.toString();view.inputState.composing>=0&&view.inputState.composing++;let defaultInsert=()=>defaultTr||(defaultTr=function(view,change,newSel){let tr,startState=view.state,sel=startState.selection.main;if(change.from>=sel.from&&change.to<=sel.to&&change.to-change.from>=(sel.to-sel.from)/3&&(!newSel||newSel.main.empty&&newSel.main.from==change.from+change.insert.length)&&view.inputState.composing<0){let before=sel.from<change.from?startState.sliceDoc(sel.from,change.from):"",after=sel.to>change.to?startState.sliceDoc(change.to,sel.to):"";tr=startState.replaceSelection(view.state.toText(before+change.insert.sliceString(0,void 0,view.state.lineBreak)+after))}else{let changes=startState.changes(change),mainSel=newSel&&newSel.main.to<=changes.newLength?newSel.main:void 0;if(startState.selection.ranges.length>1&&view.inputState.composing>=0&&change.to<=sel.to&&change.to>=sel.to-10){let compositionRange,replaced=view.state.sliceDoc(change.from,change.to),composition=newSel&&findCompositionNode$1(view,newSel.main.head);if(composition){let dLen=change.insert.length-(change.to-change.from);compositionRange={from:composition.from,to:composition.to-dLen}}else compositionRange=view.state.doc.lineAt(sel.head);let offset2=sel.to-change.to,size=sel.to-sel.from;tr=startState.changeByRange((range=>{if(range.from==sel.from&&range.to==sel.to)return{changes:changes,range:mainSel||range.map(changes)};let to=range.to-offset2,from=to-replaced.length;if(range.to-range.from!=size||view.state.sliceDoc(from,to)!=replaced||range.to>=compositionRange.from&&range.from<=compositionRange.to)return{range:range};let rangeChanges=startState.changes({from:from,to:to,insert:change.insert}),selOff=range.to-sel.to;return{changes:rangeChanges,range:mainSel?EditorSelection.range(Math.max(0,mainSel.anchor+selOff),Math.max(0,mainSel.head+selOff)):range.map(rangeChanges)}}))}else tr={changes:changes,selection:mainSel&&startState.selection.replaceRange(mainSel)}}let userEvent="input.type";(view.composing||view.inputState.compositionPendingChange&&view.inputState.compositionEndedAt>Date.now()-50)&&(view.inputState.compositionPendingChange=!1,userEvent+=".compose",view.inputState.compositionFirstChange&&(userEvent+=".start",view.inputState.compositionFirstChange=!1));return startState.update(tr,{userEvent:userEvent,scrollIntoView:!0})}(view,change,newSel));return view.state.facet(inputHandler$2).some((h=>h(view,change.from,change.to,text2,defaultInsert)))||view.dispatch(defaultInsert()),!0}if(newSel&&!newSel.main.eq(sel)){let scrollIntoView2=!1,userEvent="select";return view.inputState.lastSelectionTime>Date.now()-50&&("select"==view.inputState.lastSelectionOrigin&&(scrollIntoView2=!0),userEvent=view.inputState.lastSelectionOrigin),view.dispatch({selection:newSel,scrollIntoView:scrollIntoView2,userEvent:userEvent}),!0}return!1}const observeOptions$1={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},useCharData$1=browser$2.ie&&browser$2.ie_version<=11;let DOMObserver$1=class{constructor(view){this.view=view,this.active=!1,this.selectionRange=new DOMSelectionState$1,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=view.contentDOM,this.observer=new MutationObserver((mutations=>{for(let mut of mutations)this.queue.push(mut);(browser$2.ie&&browser$2.ie_version<=11||browser$2.ios&&view.composing)&&mutations.some((m=>"childList"==m.type&&m.removedNodes.length||"characterData"==m.type&&m.oldValue.length>m.target.nodeValue.length))?this.flushSoon():this.flush()})),useCharData$1&&(this.onCharData=event=>{this.queue.push({target:event.target,type:"characterData",oldValue:event.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var _a2;(null===(_a2=this.view.docView)||void 0===_a2?void 0:_a2.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(view.scrollDOM)),this.addWindowListeners(this.win=view.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((entries=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),entries.length>0&&entries[entries.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((entries=>{entries.length>0&&entries[entries.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500)}updateGaps(gaps){if(this.gapIntersection&&(gaps.length!=this.gaps.length||this.gaps.some(((g,i2)=>g!=gaps[i2])))){this.gapIntersection.disconnect();for(let gap of gaps)this.gapIntersection.observe(gap);this.gaps=gaps}}onSelectionChange(event){let wasChanged=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:view}=this,sel=this.selectionRange;if(view.state.facet(editable$1)?view.root.activeElement!=this.dom:!hasSelection$1(view.dom,sel))return;let context=sel.anchorNode&&view.docView.nearest(sel.anchorNode);context&&context.ignoreEvent(event)?wasChanged||(this.selectionChanged=!1):(browser$2.ie&&browser$2.ie_version<=11||browser$2.android&&browser$2.chrome)&&!view.state.selection.main.empty&&sel.focusNode&&isEquivalentPosition$1(sel.focusNode,sel.focusOffset,sel.anchorNode,sel.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:view}=this,range=browser$2.safari&&11==view.root.nodeType&&function(doc2){let elt=doc2.activeElement;for(;elt&&elt.shadowRoot;)elt=elt.shadowRoot.activeElement;return elt}(this.dom.ownerDocument)==this.dom&&function(view){let found=null;function read2(event){event.preventDefault(),event.stopImmediatePropagation(),found=event.getTargetRanges()[0]}if(view.contentDOM.addEventListener("beforeinput",read2,!0),view.dom.ownerDocument.execCommand("indent"),view.contentDOM.removeEventListener("beforeinput",read2,!0),!found)return null;let anchorNode=found.startContainer,anchorOffset=found.startOffset,focusNode=found.endContainer,focusOffset=found.endOffset,curAnchor=view.docView.domAtPos(view.state.selection.main.anchor);isEquivalentPosition$1(curAnchor.node,curAnchor.offset,focusNode,focusOffset)&&([anchorNode,anchorOffset,focusNode,focusOffset]=[focusNode,focusOffset,anchorNode,anchorOffset]);return{anchorNode:anchorNode,anchorOffset:anchorOffset,focusNode:focusNode,focusOffset:focusOffset}}(this.view)||getSelection$1(view.root);if(!range||this.selectionRange.eq(range))return!1;let local=hasSelection$1(this.dom,range);return local&&!this.selectionChanged&&view.inputState.lastFocusTime>Date.now()-200&&view.inputState.lastTouchTime<Date.now()-300&&function(doc2,selection2){let node=selection2.focusNode,offset2=selection2.focusOffset;if(!node||selection2.anchorNode!=node||selection2.anchorOffset!=offset2)return!1;for(offset2=Math.min(offset2,maxOffset$1(node));;)if(offset2){if(1!=node.nodeType)return!1;let prev=node.childNodes[offset2-1];"false"==prev.contentEditable?offset2--:(node=prev,offset2=maxOffset$1(node))}else{if(node==doc2)return!0;offset2=domIndex$1(node),node=node.parentNode}}(this.dom,range)?(this.view.inputState.lastFocusTime=0,view.docView.updateSelection(),!1):(this.selectionRange.setRange(range),local&&(this.selectionChanged=!0),!0)}setSelectionRange(anchor,head){this.selectionRange.set(anchor.node,anchor.offset,head.node,head.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let i2=0,changed=null;for(let dom=this.dom;dom;)if(1==dom.nodeType)!changed&&i2<this.scrollTargets.length&&this.scrollTargets[i2]==dom?i2++:changed||(changed=this.scrollTargets.slice(0,i2)),changed&&changed.push(dom),dom=dom.assignedSlot||dom.parentNode;else{if(11!=dom.nodeType)break;dom=dom.host}if(i2<this.scrollTargets.length&&!changed&&(changed=this.scrollTargets.slice(0,i2)),changed){for(let dom of this.scrollTargets)dom.removeEventListener("scroll",this.onScroll);for(let dom of this.scrollTargets=changed)dom.addEventListener("scroll",this.onScroll)}}ignore(f){if(!this.active)return f();try{return this.stop(),f()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,observeOptions$1),useCharData$1&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),useCharData$1&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(key,keyCode){var _a2;if(!this.delayedAndroidKey){let flush2=()=>{let key2=this.delayedAndroidKey;if(key2){this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=key2.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&key2.force&&dispatchKey$1(this.dom,key2.key,key2.keyCode)}};this.flushingAndroidKey=this.view.win.requestAnimationFrame(flush2)}this.delayedAndroidKey&&"Enter"!=key||(this.delayedAndroidKey={key:key,keyCode:keyCode,force:this.lastChange<Date.now()-50||!!(null===(_a2=this.delayedAndroidKey)||void 0===_a2?void 0:_a2.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let mut of this.observer.takeRecords())this.queue.push(mut);return this.queue}processRecords(){let records=this.pendingRecords();records.length&&(this.queue=[]);let from=-1,to=-1,typeOver=!1;for(let record of records){let range=this.readMutation(record);range&&(range.typeOver&&(typeOver=!0),-1==from?({from:from,to:to}=range):(from=Math.min(range.from,from),to=Math.max(range.to,to)))}return{from:from,to:to,typeOver:typeOver}}readChange(){let{from:from,to:to,typeOver:typeOver}=this.processRecords(),newSel=this.selectionChanged&&hasSelection$1(this.dom,this.selectionRange);if(from<0&&!newSel)return null;from>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let change=new DOMChange$1(this.view,from,to,typeOver);return this.view.docView.domChanged={newSel:change.newSel?change.newSel.main:null},change}flush(readSelection=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;readSelection&&this.readSelectionRange();let domChange=this.readChange();if(!domChange)return this.view.requestMeasure(),!1;let startState=this.view.state,handled=applyDOMChange$1(this.view,domChange);return this.view.state==startState&&this.view.update([]),handled}readMutation(rec){let cView=this.view.docView.nearest(rec.target);if(!cView||cView.ignoreMutation(rec))return null;if(cView.markDirty("attributes"==rec.type),"attributes"==rec.type&&(cView.flags|=4),"childList"==rec.type){let childBefore=findChild$1(cView,rec.previousSibling||rec.target.previousSibling,-1),childAfter=findChild$1(cView,rec.nextSibling||rec.target.nextSibling,1);return{from:childBefore?cView.posAfter(childBefore):cView.posAtStart,to:childAfter?cView.posBefore(childAfter):cView.posAtEnd,typeOver:!1}}return"characterData"==rec.type?{from:cView.posAtStart,to:cView.posAtEnd,typeOver:rec.target.nodeValue==rec.oldValue}:null}setWindow(win){win!=this.win&&(this.removeWindowListeners(this.win),this.win=win,this.addWindowListeners(this.win))}addWindowListeners(win){win.addEventListener("resize",this.onResize),win.addEventListener("beforeprint",this.onPrint),win.addEventListener("scroll",this.onScroll),win.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(win){win.removeEventListener("scroll",this.onScroll),win.removeEventListener("resize",this.onResize),win.removeEventListener("beforeprint",this.onPrint),win.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var _a2,_b,_c;this.stop(),null===(_a2=this.intersection)||void 0===_a2||_a2.disconnect(),null===(_b=this.gapIntersection)||void 0===_b||_b.disconnect(),null===(_c=this.resizeScroll)||void 0===_c||_c.disconnect();for(let dom of this.scrollTargets)dom.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}};function findChild$1(cView,dom,dir){for(;dom;){let curView=ContentView$1.get(dom);if(curView&&curView.parent==cView)return curView;let parent=dom.parentNode;dom=parent!=cView.dom?parent:dir>0?dom.nextSibling:dom.previousSibling}return null}let EditorView$1=class EditorView2{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(config2={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM);let{dispatch:dispatch2}=config2;this.dispatchTransactions=config2.dispatchTransactions||dispatch2&&(trs=>trs.forEach((tr=>dispatch2(tr,this))))||(trs=>this.update(trs)),this.dispatch=this.dispatch.bind(this),this._root=config2.root||function(node){for(;node;){if(node&&(9==node.nodeType||11==node.nodeType&&node.host))return node;node=node.assignedSlot||node.parentNode}return null}(config2.parent)||document,this.viewState=new ViewState$1(config2.state||EditorState.create(config2)),config2.scrollTo&&config2.scrollTo.is(scrollIntoView$2)&&(this.viewState.scrollTarget=config2.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(viewPlugin$1).map((spec=>new PluginInstance$1(spec)));for(let plugin of this.plugins)plugin.update(this);this.observer=new DOMObserver$1(this),this.inputState=new InputState$1(this),this.inputState.ensureHandlers(this.plugins),this.docView=new DocView$1(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),config2.parent&&config2.parent.appendChild(this.dom)}dispatch(...input){let trs=1==input.length&&input[0]instanceof Transaction?input:1==input.length&&Array.isArray(input[0])?input[0]:[this.state.update(...input)];this.dispatchTransactions(trs,this)}update(transactions){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let update2,redrawn=!1,attrsChanged=!1,state=this.state;for(let tr of transactions){if(tr.startState!=state)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");state=tr.state}if(this.destroyed)return void(this.viewState.state=state);let focus=this.hasFocus,focusFlag=0,dispatchFocus=null;transactions.some((tr=>tr.annotation(isFocusChange$1)))?(this.inputState.notifiedFocused=focus,focusFlag=1):focus!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=focus,dispatchFocus=focusChangeTransaction$1(state,focus),dispatchFocus||(focusFlag=1));let pendingKey=this.observer.delayedAndroidKey,domChange=null;if(pendingKey?(this.observer.clearDelayedAndroidKey(),domChange=this.observer.readChange(),(domChange&&!this.state.doc.eq(state.doc)||!this.state.selection.eq(state.selection))&&(domChange=null)):this.observer.clear(),state.facet(EditorState.phrases)!=this.state.facet(EditorState.phrases))return this.setState(state);update2=ViewUpdate$1.create(this,state,transactions),update2.flags|=focusFlag;let scrollTarget=this.viewState.scrollTarget;try{this.updateState=2;for(let tr of transactions){if(scrollTarget&&(scrollTarget=scrollTarget.map(tr.changes)),tr.scrollIntoView){let{main:main2}=tr.state.selection;scrollTarget=new ScrollTarget$1(main2.empty?main2:EditorSelection.cursor(main2.head,main2.head>main2.anchor?-1:1))}for(let e of tr.effects)e.is(scrollIntoView$2)&&(scrollTarget=e.value.clip(this.state))}this.viewState.update(update2,scrollTarget),this.bidiCache=CachedOrder$1.update(this.bidiCache,update2.changes),update2.empty||(this.updatePlugins(update2),this.inputState.update(update2)),redrawn=this.docView.update(update2),this.state.facet(styleModule$1)!=this.styleModules&&this.mountStyles(),attrsChanged=this.updateAttrs(),this.showAnnouncements(transactions),this.docView.updateSelection(redrawn,transactions.some((tr=>tr.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(update2.startState.facet(theme$1)!=update2.state.facet(theme$1)&&(this.viewState.mustMeasureContent=!0),(redrawn||attrsChanged||scrollTarget||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!update2.empty)for(let listener of this.state.facet(updateListener$1))try{listener(update2)}catch(e){logException$1(this.state,e,"update listener")}(dispatchFocus||domChange)&&Promise.resolve().then((()=>{dispatchFocus&&this.state==dispatchFocus.startState&&this.dispatch(dispatchFocus),domChange&&!applyDOMChange$1(this,domChange)&&pendingKey.force&&dispatchKey$1(this.contentDOM,pendingKey.key,pendingKey.keyCode)}))}setState(newState){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=newState);this.updateState=2;let hadFocus=this.hasFocus;try{for(let plugin of this.plugins)plugin.destroy(this);this.viewState=new ViewState$1(newState),this.plugins=newState.facet(viewPlugin$1).map((spec=>new PluginInstance$1(spec))),this.pluginMap.clear();for(let plugin of this.plugins)plugin.update(this);this.docView=new DocView$1(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}hadFocus&&this.focus(),this.requestMeasure()}updatePlugins(update2){let prevSpecs=update2.startState.facet(viewPlugin$1),specs=update2.state.facet(viewPlugin$1);if(prevSpecs!=specs){let newPlugins=[];for(let spec of specs){let found=prevSpecs.indexOf(spec);if(found<0)newPlugins.push(new PluginInstance$1(spec));else{let plugin=this.plugins[found];plugin.mustUpdate=update2,newPlugins.push(plugin)}}for(let plugin of this.plugins)plugin.mustUpdate!=update2&&plugin.destroy(this);this.plugins=newPlugins,this.pluginMap.clear()}else for(let p of this.plugins)p.mustUpdate=update2;for(let i2=0;i2<this.plugins.length;i2++)this.plugins[i2].update(this);prevSpecs!=specs&&this.inputState.ensureHandlers(this.plugins)}measure(flush2=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,flush2&&this.observer.forceFlush();let updated=null,sDOM=this.scrollDOM,scrollTop=sDOM.scrollTop*this.scaleY,{scrollAnchorPos:scrollAnchorPos,scrollAnchorHeight:scrollAnchorHeight}=this.viewState;Math.abs(scrollTop-this.viewState.scrollTop)>1&&(scrollAnchorHeight=-1),this.viewState.scrollAnchorHeight=-1;try{for(let i2=0;;i2++){if(scrollAnchorHeight<0)if(isScrolledToBottom$1(sDOM))scrollAnchorPos=-1,scrollAnchorHeight=this.viewState.heightMap.height;else{let block=this.viewState.scrollAnchorAt(scrollTop);scrollAnchorPos=block.from,scrollAnchorHeight=block.top}this.updateState=1;let changed=this.viewState.measure(this);if(!changed&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(i2>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let measuring=[];4&changed||([this.measureRequests,measuring]=[measuring,this.measureRequests]);let measured=measuring.map((m=>{try{return m.read(this)}catch(e){return logException$1(this.state,e),BadMeasure$1}})),update2=ViewUpdate$1.create(this,this.state,[]),redrawn=!1;update2.flags|=changed,updated?updated.flags|=changed:updated=update2,this.updateState=2,update2.empty||(this.updatePlugins(update2),this.inputState.update(update2),this.updateAttrs(),redrawn=this.docView.update(update2));for(let i3=0;i3<measuring.length;i3++)if(measured[i3]!=BadMeasure$1)try{let m=measuring[i3];m.write&&m.write(measured[i3],this)}catch(e){logException$1(this.state,e)}if(redrawn&&this.docView.updateSelection(!0),!update2.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null;continue}{let diff=(scrollAnchorPos<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(scrollAnchorPos).top)-scrollAnchorHeight;if(diff>1||diff<-1){scrollTop+=diff,sDOM.scrollTop=scrollTop/this.scaleY,scrollAnchorHeight=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(updated&&!updated.empty)for(let listener of this.state.facet(updateListener$1))listener(updated)}get themeClasses(){return baseThemeID$1+" "+(this.state.facet(darkTheme$1)?baseDarkID$1:baseLightID$1)+" "+this.state.facet(theme$1)}updateAttrs(){let editorAttrs=attrsFromFacet$1(this,editorAttributes$1,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),contentAttrs={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(editable$1)?"true":"false",class:"cm-content",style:`${browser$2.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(contentAttrs["aria-readonly"]="true"),attrsFromFacet$1(this,contentAttributes$1,contentAttrs);let changed=this.observer.ignore((()=>{let changedContent=updateAttrs$1(this.contentDOM,this.contentAttrs,contentAttrs),changedEditor=updateAttrs$1(this.dom,this.editorAttrs,editorAttrs);return changedContent||changedEditor}));return this.editorAttrs=editorAttrs,this.contentAttrs=contentAttrs,changed}showAnnouncements(trs){let first=!0;for(let tr of trs)for(let effect2 of tr.effects)if(effect2.is(EditorView2.announce)){first&&(this.announceDOM.textContent=""),first=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=effect2.value}}mountStyles(){this.styleModules=this.state.facet(styleModule$1);let nonce=this.state.facet(EditorView2.cspNonce);StyleModule.mount(this.root,this.styleModules.concat(baseTheme$1$4).reverse(),nonce?{nonce:nonce}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(request){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),request){if(this.measureRequests.indexOf(request)>-1)return;if(null!=request.key)for(let i2=0;i2<this.measureRequests.length;i2++)if(this.measureRequests[i2].key===request.key)return void(this.measureRequests[i2]=request);this.measureRequests.push(request)}}plugin(plugin){let known=this.pluginMap.get(plugin);return(void 0===known||known&&known.spec!=plugin)&&this.pluginMap.set(plugin,known=this.plugins.find((p=>p.spec==plugin))||null),known&&known.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(height){return this.readMeasured(),this.viewState.elementAtHeight(height)}lineBlockAtHeight(height){return this.readMeasured(),this.viewState.lineBlockAtHeight(height)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(pos){return this.viewState.lineBlockAt(pos)}get contentHeight(){return this.viewState.contentHeight}moveByChar(start2,forward,by){return skipAtoms$1(this,start2,moveByChar$1(this,start2,forward,by))}moveByGroup(start2,forward){return skipAtoms$1(this,start2,moveByChar$1(this,start2,forward,(initial=>function(view,pos,start2){let categorize=view.state.charCategorizer(pos),cat=categorize(start2);return next=>{let nextCat=categorize(next);return cat==CharCategory.Space&&(cat=nextCat),cat==nextCat}}(this,start2.head,initial))))}moveToLineBoundary(start2,forward,includeWrap=!0){return function(view,start2,forward,includeWrap){let line=blockAt$1(view,start2.head),coords=includeWrap&&line.type==BlockType$1.Text&&(view.lineWrapping||line.widgetLineBreaks)?view.coordsAtPos(start2.assoc<0&&start2.head>line.from?start2.head-1:start2.head):null;if(coords){let editorRect=view.dom.getBoundingClientRect(),direction=view.textDirectionAt(line.from),pos=view.posAtCoords({x:forward==(direction==Direction$1.LTR)?editorRect.right-1:editorRect.left+1,y:(coords.top+coords.bottom)/2});if(null!=pos)return EditorSelection.cursor(pos,forward?-1:1)}return EditorSelection.cursor(forward?line.to:line.from,forward?-1:1)}(this,start2,forward,includeWrap)}moveVertically(start2,forward,distance){return skipAtoms$1(this,start2,function(view,start2,forward,distance){let startPos=start2.head,dir=forward?1:-1;if(startPos==(forward?view.state.doc.length:0))return EditorSelection.cursor(startPos,start2.assoc);let startY,goal=start2.goalColumn,rect=view.contentDOM.getBoundingClientRect(),startCoords=view.coordsAtPos(startPos,start2.assoc||-1),docTop=view.documentTop;if(startCoords)null==goal&&(goal=startCoords.left-rect.left),startY=dir<0?startCoords.top:startCoords.bottom;else{let line=view.viewState.lineBlockAt(startPos);null==goal&&(goal=Math.min(rect.right-rect.left,view.defaultCharacterWidth*(startPos-line.from))),startY=(dir<0?line.top:line.bottom)+docTop}let resolvedGoal=rect.left+goal,dist2=null!=distance?distance:view.viewState.heightOracle.textHeight>>1;for(let extra2=0;;extra2+=10){let curY=startY+(dist2+extra2)*dir,pos=posAtCoords$1(view,{x:resolvedGoal,y:curY},!1,dir);if(curY<rect.top||curY>rect.bottom||(dir<0?pos<startPos:pos>startPos)){let charRect=view.docView.coordsForChar(pos),assoc=!charRect||curY<charRect.top?-1:1;return EditorSelection.cursor(pos,assoc,void 0,goal)}}}(this,start2,forward,distance))}domAtPos(pos){return this.docView.domAtPos(pos)}posAtDOM(node,offset2=0){return this.docView.posFromDOM(node,offset2)}posAtCoords(coords,precise=!0){return this.readMeasured(),posAtCoords$1(this,coords,precise)}coordsAtPos(pos,side=1){this.readMeasured();let rect=this.docView.coordsAt(pos,side);if(!rect||rect.left==rect.right)return rect;let line=this.state.doc.lineAt(pos),order2=this.bidiSpans(line);return flattenRect$1(rect,order2[BidiSpan$1.find(order2,pos-line.from,-1,side)].dir==Direction$1.LTR==side>0)}coordsForChar(pos){return this.readMeasured(),this.docView.coordsForChar(pos)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(pos){return!this.state.facet(perLineTextDirection$1)||pos<this.viewport.from||pos>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(pos))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(line){if(line.length>MaxBidiLine$1)return trivialOrder$1(line.length);let isolates,dir=this.textDirectionAt(line.from);for(let entry of this.bidiCache)if(entry.from==line.from&&entry.dir==dir&&(entry.fresh||isolatesEq$1(entry.isolates,isolates=getIsolatedRanges$1(this,line.from,line.to))))return entry.order;isolates||(isolates=getIsolatedRanges$1(this,line.from,line.to));let order2=function(line,direction,isolates){if(!line)return[new BidiSpan$1(0,0,direction==RTL$1?1:0)];if(direction==LTR$1&&!isolates.length&&!BidiRE$1.test(line))return trivialOrder$1(line.length);if(isolates.length)for(;line.length>types$1.length;)types$1[types$1.length]=256;let order2=[],level=direction==LTR$1?0:1;return computeSectionOrder$1(line,level,level,isolates,0,line.length,order2),order2}(line.text,dir,isolates);return this.bidiCache.push(new CachedOrder$1(line.from,line.to,dir,isolates,!0,order2)),order2}get hasFocus(){var _a2;return(this.dom.ownerDocument.hasFocus()||browser$2.safari&&(null===(_a2=this.inputState)||void 0===_a2?void 0:_a2.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{focusPreventScroll$1(this.contentDOM),this.docView.updateSelection()}))}setRoot(root){this._root!=root&&(this._root=root,this.observer.setWindow((9==root.nodeType?root:root.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let plugin of this.plugins)plugin.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(pos,options={}){return scrollIntoView$2.of(new ScrollTarget$1("number"==typeof pos?EditorSelection.cursor(pos):pos,options.y,options.x,options.yMargin,options.xMargin))}scrollSnapshot(){let{scrollTop:scrollTop,scrollLeft:scrollLeft}=this.scrollDOM,ref=this.viewState.scrollAnchorAt(scrollTop);return scrollIntoView$2.of(new ScrollTarget$1(EditorSelection.cursor(ref.from),"start","start",ref.top-scrollTop,scrollLeft,!0))}static domEventHandlers(handlers2){return ViewPlugin$1.define((()=>({})),{eventHandlers:handlers2})}static domEventObservers(observers2){return ViewPlugin$1.define((()=>({})),{eventObservers:observers2})}static theme(spec,options){let prefix=StyleModule.newName(),result=[theme$1.of(prefix),styleModule$1.of(buildTheme$1(`.${prefix}`,spec))];return options&&options.dark&&result.push(darkTheme$1.of(!0)),result}static baseTheme(spec){return Prec.lowest(styleModule$1.of(buildTheme$1("."+baseThemeID$1,spec,lightDarkIDs$1)))}static findFromDOM(dom){var _a2;let content2=dom.querySelector(".cm-content"),cView=content2&&ContentView$1.get(content2)||ContentView$1.get(dom);return(null===(_a2=null==cView?void 0:cView.rootView)||void 0===_a2?void 0:_a2.view)||null}};EditorView$1.styleModule=styleModule$1,EditorView$1.inputHandler=inputHandler$2,EditorView$1.focusChangeEffect=focusChangeEffect$1,EditorView$1.perLineTextDirection=perLineTextDirection$1,EditorView$1.exceptionSink=exceptionSink$1,EditorView$1.updateListener=updateListener$1,EditorView$1.editable=editable$1,EditorView$1.mouseSelectionStyle=mouseSelectionStyle$1,EditorView$1.dragMovesSelection=dragMovesSelection$1$1,EditorView$1.clickAddsSelectionRange=clickAddsSelectionRange$1,EditorView$1.decorations=decorations$1,EditorView$1.atomicRanges=atomicRanges$1,EditorView$1.bidiIsolatedRanges=bidiIsolatedRanges$1,EditorView$1.scrollMargins=scrollMargins$1,EditorView$1.darkTheme=darkTheme$1,EditorView$1.cspNonce=Facet.define({combine:values=>values.length?values[0]:""}),EditorView$1.contentAttributes=contentAttributes$1,EditorView$1.editorAttributes=editorAttributes$1,EditorView$1.lineWrapping=EditorView$1.contentAttributes.of({class:"cm-lineWrapping"}),EditorView$1.announce=StateEffect.define();const MaxBidiLine$1=4096,BadMeasure$1={};let CachedOrder$1=class CachedOrder2{constructor(from,to,dir,isolates,fresh,order2){this.from=from,this.to=to,this.dir=dir,this.isolates=isolates,this.fresh=fresh,this.order=order2}static update(cache,changes){if(changes.empty&&!cache.some((c=>c.fresh)))return cache;let result=[],lastDir=cache.length?cache[cache.length-1].dir:Direction$1.LTR;for(let i2=Math.max(0,cache.length-10);i2<cache.length;i2++){let entry=cache[i2];entry.dir!=lastDir||changes.touchesRange(entry.from,entry.to)||result.push(new CachedOrder2(changes.mapPos(entry.from,1),changes.mapPos(entry.to,-1),entry.dir,entry.isolates,!1,entry.order))}return result}};function attrsFromFacet$1(view,facet,base2){for(let sources=view.state.facet(facet),i2=sources.length-1;i2>=0;i2--){let source=sources[i2],value="function"==typeof source?source(view):source;value&&combineAttrs$1(value,base2)}return base2}const currentPlatform$1=browser$2.mac?"mac":browser$2.windows?"win":browser$2.linux?"linux":"key";function modifiers$1(name2,event,shift2){return event.altKey&&(name2="Alt-"+name2),event.ctrlKey&&(name2="Ctrl-"+name2),event.metaKey&&(name2="Meta-"+name2),!1!==shift2&&event.shiftKey&&(name2="Shift-"+name2),name2}const handleKeyEvents$1=Prec.default(EditorView$1.domEventHandlers({keydown:(event,view)=>runHandlers$1(getKeymap$1(view.state),event,view,"editor")})),keymap$1=Facet.define({enables:handleKeyEvents$1}),Keymaps$1=new WeakMap;function getKeymap$1(state){let bindings=state.facet(keymap$1),map=Keymaps$1.get(bindings);return map||Keymaps$1.set(bindings,map=function(bindings,platform=currentPlatform$1){let bound=Object.create(null),isPrefix=Object.create(null),checkPrefix=(name2,is2)=>{let current=isPrefix[name2];if(null==current)isPrefix[name2]=is2;else if(current!=is2)throw new Error("Key binding "+name2+" is used both as a regular binding and as a multi-stroke prefix")},add2=(scope,key,command2,preventDefault,stopPropagation)=>{var _a2,_b;let scopeObj=bound[scope]||(bound[scope]=Object.create(null)),parts=key.split(/ (?!$)/).map((k=>function(name2,platform){const parts=name2.split(/-(?!$)/);let alt,ctrl,shift2,meta2,result=parts[parts.length-1];"Space"==result&&(result=" ");for(let i2=0;i2<parts.length-1;++i2){const mod=parts[i2];if(/^(cmd|meta|m)$/i.test(mod))meta2=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else if(/^s(hift)?$/i.test(mod))shift2=!0;else{if(!/^mod$/i.test(mod))throw new Error("Unrecognized modifier name: "+mod);"mac"==platform?meta2=!0:ctrl=!0}}return alt&&(result="Alt-"+result),ctrl&&(result="Ctrl-"+result),meta2&&(result="Meta-"+result),shift2&&(result="Shift-"+result),result}(k,platform)));for(let i2=1;i2<parts.length;i2++){let prefix=parts.slice(0,i2).join(" ");checkPrefix(prefix,!0),scopeObj[prefix]||(scopeObj[prefix]={preventDefault:!0,stopPropagation:!1,run:[view=>{let ourObj=storedPrefix$1={view:view,prefix:prefix,scope:scope};return setTimeout((()=>{storedPrefix$1==ourObj&&(storedPrefix$1=null)}),PrefixTimeout$1),!0}]})}let full=parts.join(" ");checkPrefix(full,!1);let binding=scopeObj[full]||(scopeObj[full]={preventDefault:!1,stopPropagation:!1,run:(null===(_b=null===(_a2=scopeObj._any)||void 0===_a2?void 0:_a2.run)||void 0===_b?void 0:_b.slice())||[]});command2&&binding.run.push(command2),preventDefault&&(binding.preventDefault=!0),stopPropagation&&(binding.stopPropagation=!0)};for(let b of bindings){let scopes=b.scope?b.scope.split(" "):["editor"];if(b.any)for(let scope of scopes){let scopeObj=bound[scope]||(bound[scope]=Object.create(null));scopeObj._any||(scopeObj._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let key in scopeObj)scopeObj[key].run.push(b.any)}let name2=b[platform]||b.key;if(name2)for(let scope of scopes)add2(scope,name2,b.run,b.preventDefault,b.stopPropagation),b.shift&&add2(scope,"Shift-"+name2,b.shift,b.preventDefault,b.stopPropagation)}return bound}(bindings.reduce(((a,b)=>a.concat(b)),[]))),map}let storedPrefix$1=null;const PrefixTimeout$1=4e3;function runHandlers$1(map,event,view,scope){let name2=keyName(event),isChar=codePointSize(codePointAt(name2,0))==name2.length&&" "!=name2,prefix="",handled=!1,prevented=!1,stopPropagation=!1;storedPrefix$1&&storedPrefix$1.view==view&&storedPrefix$1.scope==scope&&(prefix=storedPrefix$1.prefix+" ",modifierCodes$1.indexOf(event.keyCode)<0&&(prevented=!0,storedPrefix$1=null));let baseName,shiftName,ran=new Set,runFor=binding=>{if(binding){for(let cmd2 of binding.run)if(!ran.has(cmd2)&&(ran.add(cmd2),cmd2(view,event)))return binding.stopPropagation&&(stopPropagation=!0),!0;binding.preventDefault&&(binding.stopPropagation&&(stopPropagation=!0),prevented=!0)}return!1},scopeObj=map[scope];return scopeObj&&(runFor(scopeObj[prefix+modifiers$1(name2,event,!isChar)])?handled=!0:isChar&&(event.altKey||event.metaKey||event.ctrlKey)&&!(browser$2.windows&&event.ctrlKey&&event.altKey)&&(baseName=base[event.keyCode])&&baseName!=name2?(runFor(scopeObj[prefix+modifiers$1(baseName,event,!0)])||event.shiftKey&&(shiftName=shift[event.keyCode])!=name2&&shiftName!=baseName&&runFor(scopeObj[prefix+modifiers$1(shiftName,event,!1)]))&&(handled=!0):isChar&&event.shiftKey&&runFor(scopeObj[prefix+modifiers$1(name2,event,!0)])&&(handled=!0),!handled&&runFor(scopeObj._any)&&(handled=!0)),prevented&&(handled=!0),handled&&stopPropagation&&event.stopPropagation(),handled}class RectangleMarker{constructor(className,left2,top2,width,height){this.className=className,this.left=left2,this.top=top2,this.width=width,this.height=height}draw(){let elt=document.createElement("div");return elt.className=this.className,this.adjust(elt),elt}update(elt,prev){return prev.className==this.className&&(this.adjust(elt),!0)}adjust(elt){elt.style.left=this.left+"px",elt.style.top=this.top+"px",null!=this.width&&(elt.style.width=this.width+"px"),elt.style.height=this.height+"px"}eq(p){return this.left==p.left&&this.top==p.top&&this.width==p.width&&this.height==p.height&&this.className==p.className}static forRange(view,className,range){if(range.empty){let pos=view.coordsAtPos(range.head,range.assoc||1);if(!pos)return[];let base2=getBase(view);return[new RectangleMarker(className,pos.left-base2.left,pos.top-base2.top,null,pos.bottom-pos.top)]}return function(view,className,range){if(range.to<=view.viewport.from||range.from>=view.viewport.to)return[];let from=Math.max(range.from,view.viewport.from),to=Math.min(range.to,view.viewport.to),ltr=view.textDirection==Direction$1.LTR,content2=view.contentDOM,contentRect=content2.getBoundingClientRect(),base2=getBase(view),lineElt=content2.querySelector(".cm-line"),lineStyle=lineElt&&window.getComputedStyle(lineElt),leftSide=contentRect.left+(lineStyle?parseInt(lineStyle.paddingLeft)+Math.min(0,parseInt(lineStyle.textIndent)):0),rightSide=contentRect.right-(lineStyle?parseInt(lineStyle.paddingRight):0),startBlock=blockAt$1(view,from),endBlock=blockAt$1(view,to),visualStart=startBlock.type==BlockType$1.Text?startBlock:null,visualEnd=endBlock.type==BlockType$1.Text?endBlock:null;visualStart&&(view.lineWrapping||startBlock.widgetLineBreaks)&&(visualStart=wrappedLine(view,from,visualStart));visualEnd&&(view.lineWrapping||endBlock.widgetLineBreaks)&&(visualEnd=wrappedLine(view,to,visualEnd));if(visualStart&&visualEnd&&visualStart.from==visualEnd.from)return pieces(drawForLine(range.from,range.to,visualStart));{let top2=visualStart?drawForLine(range.from,null,visualStart):drawForWidget(startBlock,!1),bottom2=visualEnd?drawForLine(null,range.to,visualEnd):drawForWidget(endBlock,!0),between=[];return(visualStart||startBlock).to<(visualEnd||endBlock).from-(visualStart&&visualEnd?1:0)||startBlock.widgetLineBreaks>1&&top2.bottom+view.defaultLineHeight/2<bottom2.top?between.push(piece(leftSide,top2.bottom,rightSide,bottom2.top)):top2.bottom<bottom2.top&&view.elementAtHeight((top2.bottom+bottom2.top)/2).type==BlockType$1.Text&&(top2.bottom=bottom2.top=(top2.bottom+bottom2.top)/2),pieces(top2).concat(between).concat(pieces(bottom2))}function piece(left2,top2,right2,bottom2){return new RectangleMarker(className,left2-base2.left,top2-base2.top-.01,right2-left2,bottom2-top2+.01)}function pieces({top:top2,bottom:bottom2,horizontal:horizontal}){let pieces2=[];for(let i2=0;i2<horizontal.length;i2+=2)pieces2.push(piece(horizontal[i2],top2,horizontal[i2+1],bottom2));return pieces2}function drawForLine(from2,to2,line){let top2=1e9,bottom2=-1e9,horizontal=[];function addSpan(from3,fromOpen,to3,toOpen,dir){let fromCoords=view.coordsAtPos(from3,from3==line.to?-2:2),toCoords=view.coordsAtPos(to3,to3==line.from?2:-2);fromCoords&&toCoords&&(top2=Math.min(fromCoords.top,toCoords.top,top2),bottom2=Math.max(fromCoords.bottom,toCoords.bottom,bottom2),dir==Direction$1.LTR?horizontal.push(ltr&&fromOpen?leftSide:fromCoords.left,ltr&&toOpen?rightSide:toCoords.right):horizontal.push(!ltr&&toOpen?leftSide:toCoords.left,!ltr&&fromOpen?rightSide:fromCoords.right))}let start2=null!=from2?from2:line.from,end2=null!=to2?to2:line.to;for(let r of view.visibleRanges)if(r.to>start2&&r.from<end2)for(let pos=Math.max(r.from,start2),endPos=Math.min(r.to,end2);;){let docLine=view.state.doc.lineAt(pos);for(let span of view.bidiSpans(docLine)){let spanFrom=span.from+docLine.from,spanTo=span.to+docLine.from;if(spanFrom>=endPos)break;spanTo>pos&&addSpan(Math.max(spanFrom,pos),null==from2&&spanFrom<=start2,Math.min(spanTo,endPos),null==to2&&spanTo>=end2,span.dir)}if(pos=docLine.to+1,pos>=endPos)break}return 0==horizontal.length&&addSpan(start2,null==from2,end2,null==to2,view.textDirection),{top:top2,bottom:bottom2,horizontal:horizontal}}function drawForWidget(block,top2){let y=contentRect.top+(top2?block.top:block.bottom);return{top:y,bottom:y,horizontal:[]}}}(view,className,range)}}function getBase(view){let rect=view.scrollDOM.getBoundingClientRect();return{left:(view.textDirection==Direction$1.LTR?rect.left:rect.right-view.scrollDOM.clientWidth*view.scaleX)-view.scrollDOM.scrollLeft*view.scaleX,top:rect.top-view.scrollDOM.scrollTop*view.scaleY}}function wrappedLine(view,pos,inside2){let range=EditorSelection.cursor(pos);return{from:Math.max(inside2.from,view.moveToLineBoundary(range,!1,!0).from),to:Math.min(inside2.to,view.moveToLineBoundary(range,!0,!0).from),type:BlockType$1.Text}}class LayerView{constructor(view,layer2){this.view=view,this.layer=layer2,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=view.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),layer2.above&&this.dom.classList.add("cm-layer-above"),layer2.class&&this.dom.classList.add(layer2.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(view.state),view.requestMeasure(this.measureReq),layer2.mount&&layer2.mount(this.dom,view)}update(update2){update2.startState.facet(layerOrder)!=update2.state.facet(layerOrder)&&this.setOrder(update2.state),(this.layer.update(update2,this.dom)||update2.geometryChanged)&&(this.scale(),update2.view.requestMeasure(this.measureReq))}setOrder(state){let pos=0,order2=state.facet(layerOrder);for(;pos<order2.length&&order2[pos]!=this.layer;)pos++;this.dom.style.zIndex=String((this.layer.above?150:-1)-pos)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:scaleX,scaleY:scaleY}=this.view;scaleX==this.scaleX&&scaleY==this.scaleY||(this.scaleX=scaleX,this.scaleY=scaleY,this.dom.style.transform=`scale(${1/scaleX}, ${1/scaleY})`)}draw(markers){if(markers.length!=this.drawn.length||markers.some(((p,i2)=>{return a=p,b=this.drawn[i2],!(a.constructor==b.constructor&&a.eq(b));var a,b}))){let old=this.dom.firstChild,oldI=0;for(let marker of markers)marker.update&&old&&marker.constructor&&this.drawn[oldI].constructor&&marker.update(old,this.drawn[oldI])?(old=old.nextSibling,oldI++):this.dom.insertBefore(marker.draw(),old);for(;old;){let next=old.nextSibling;old.remove(),old=next}this.drawn=markers}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const layerOrder=Facet.define();function layer(config2){return[ViewPlugin$1.define((v=>new LayerView(v,config2))),layerOrder.of(config2)]}const CanHidePrimary$1=!browser$2.ios,selectionConfig=Facet.define({combine:configs=>combineConfig(configs,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(a,b)=>Math.min(a,b),drawRangeCursor:(a,b)=>a||b})});function drawSelection(config2={}){return[selectionConfig.of(config2),cursorLayer,selectionLayer,hideNativeSelection,nativeSelectionHidden$1.of(!0)]}function configChanged(update2){return update2.startState.facet(selectionConfig)!=update2.state.facet(selectionConfig)}const cursorLayer=layer({above:!0,markers(view){let{state:state}=view,conf=state.facet(selectionConfig),cursors=[];for(let r of state.selection.ranges){let prim=r==state.selection.main;if(r.empty?!prim||CanHidePrimary$1:conf.drawRangeCursor){let className=prim?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",cursor2=r.empty?r:EditorSelection.cursor(r.head,r.head>r.anchor?-1:1);for(let piece of RectangleMarker.forRange(view,className,cursor2))cursors.push(piece)}}return cursors},update(update2,dom){update2.transactions.some((tr=>tr.selection))&&(dom.style.animationName="cm-blink"==dom.style.animationName?"cm-blink2":"cm-blink");let confChange=configChanged(update2);return confChange&&setBlinkRate(update2.state,dom),update2.docChanged||update2.selectionSet||confChange},mount(dom,view){setBlinkRate(view.state,dom)},class:"cm-cursorLayer"});function setBlinkRate(state,dom){dom.style.animationDuration=state.facet(selectionConfig).cursorBlinkRate+"ms"}const selectionLayer=layer({above:!1,markers:view=>view.state.selection.ranges.map((r=>r.empty?[]:RectangleMarker.forRange(view,"cm-selectionBackground",r))).reduce(((a,b)=>a.concat(b))),update:(update2,dom)=>update2.docChanged||update2.selectionSet||update2.viewportChanged||configChanged(update2),class:"cm-selectionLayer"}),themeSpec$1={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};CanHidePrimary$1&&(themeSpec$1[".cm-line"].caretColor="transparent !important");const hideNativeSelection=Prec.highest(EditorView$1.theme(themeSpec$1)),setDropCursorPos=StateEffect.define({map:(pos,mapping)=>null==pos?null:mapping.mapPos(pos)}),dropCursorPos=StateField.define({create:()=>null,update:(pos,tr)=>(null!=pos&&(pos=tr.changes.mapPos(pos)),tr.effects.reduce(((pos2,e)=>e.is(setDropCursorPos)?e.value:pos2),pos))}),drawDropCursor=ViewPlugin$1.fromClass(class{constructor(view){this.view=view,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(update2){var _a2;let cursorPos=update2.state.field(dropCursorPos);null==cursorPos?null!=this.cursor&&(null===(_a2=this.cursor)||void 0===_a2||_a2.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(update2.startState.field(dropCursorPos)!=cursorPos||update2.docChanged||update2.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:view}=this,pos=view.state.field(dropCursorPos),rect=null!=pos&&view.coordsAtPos(pos);if(!rect)return null;let outer=view.scrollDOM.getBoundingClientRect();return{left:rect.left-outer.left+view.scrollDOM.scrollLeft*view.scaleX,top:rect.top-outer.top+view.scrollDOM.scrollTop*view.scaleY,height:rect.bottom-rect.top}}drawCursor(pos){if(this.cursor){let{scaleX:scaleX,scaleY:scaleY}=this.view;pos?(this.cursor.style.left=pos.left/scaleX+"px",this.cursor.style.top=pos.top/scaleY+"px",this.cursor.style.height=pos.height/scaleY+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(pos){this.view.state.field(dropCursorPos)!=pos&&this.view.dispatch({effects:setDropCursorPos.of(pos)})}},{eventObservers:{dragover(event){this.setDropPos(this.view.posAtCoords({x:event.clientX,y:event.clientY}))},dragleave(event){event.target!=this.view.contentDOM&&this.view.contentDOM.contains(event.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function iterMatches(doc2,re,from,to,f){re.lastIndex=0;for(let m,cursor2=doc2.iterRange(from,to),pos=from;!cursor2.next().done;pos+=cursor2.value.length)if(!cursor2.lineBreak)for(;m=re.exec(cursor2.value);)f(pos+m.index,m)}class MatchDecorator{constructor(config2){const{regexp:regexp,decoration:decoration,decorate:decorate,boundary:boundary,maxLength:maxLength=1e3}=config2;if(!regexp.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=regexp,decorate)this.addMatch=(match,view,from,add2)=>decorate(add2,from,from+match[0].length,match,view);else if("function"==typeof decoration)this.addMatch=(match,view,from,add2)=>{let deco=decoration(match,view,from);deco&&add2(from,from+match[0].length,deco)};else{if(!decoration)throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.addMatch=(match,_view,from,add2)=>add2(from,from+match[0].length,decoration)}this.boundary=boundary,this.maxLength=maxLength}createDeco(view){let build=new RangeSetBuilder,add2=build.add.bind(build);for(let{from:from,to:to}of function(view,maxLength){let visible=view.visibleRanges;if(1==visible.length&&visible[0].from==view.viewport.from&&visible[0].to==view.viewport.to)return visible;let result=[];for(let{from:from,to:to}of visible)from=Math.max(view.state.doc.lineAt(from).from,from-maxLength),to=Math.min(view.state.doc.lineAt(to).to,to+maxLength),result.length&&result[result.length-1].to>=from?result[result.length-1].to=to:result.push({from:from,to:to});return result}(view,this.maxLength))iterMatches(view.state.doc,this.regexp,from,to,((from2,m)=>this.addMatch(m,view,from2,add2)));return build.finish()}updateDeco(update2,deco){let changeFrom=1e9,changeTo=-1;return update2.docChanged&&update2.changes.iterChanges(((_f,_t,from,to)=>{to>update2.view.viewport.from&&from<update2.view.viewport.to&&(changeFrom=Math.min(from,changeFrom),changeTo=Math.max(to,changeTo))})),update2.viewportChanged||changeTo-changeFrom>1e3?this.createDeco(update2.view):changeTo>-1?this.updateRange(update2.view,deco.map(update2.changes),changeFrom,changeTo):deco}updateRange(view,deco,updateFrom,updateTo){for(let r of view.visibleRanges){let from=Math.max(r.from,updateFrom),to=Math.min(r.to,updateTo);if(to>from){let fromLine=view.state.doc.lineAt(from),toLine=fromLine.to<to?view.state.doc.lineAt(to):fromLine,start2=Math.max(r.from,fromLine.from),end2=Math.min(r.to,toLine.to);if(this.boundary){for(;from>fromLine.from;from--)if(this.boundary.test(fromLine.text[from-1-fromLine.from])){start2=from;break}for(;to<toLine.to;to++)if(this.boundary.test(toLine.text[to-toLine.from])){end2=to;break}}let m,ranges=[],add2=(from2,to2,deco2)=>ranges.push(deco2.range(from2,to2));if(fromLine==toLine)for(this.regexp.lastIndex=start2-fromLine.from;(m=this.regexp.exec(fromLine.text))&&m.index<end2-fromLine.from;)this.addMatch(m,view,m.index+fromLine.from,add2);else iterMatches(view.state.doc,this.regexp,start2,end2,((from2,m2)=>this.addMatch(m2,view,from2,add2)));deco=deco.update({filterFrom:start2,filterTo:end2,filter:(from2,to2)=>from2<start2||to2>end2,add:ranges})}}return deco}}const UnicodeRegexpSupport=null!=/x/.unicode?"gu":"g",Specials=new RegExp("[\0-\b\n-\x1f\x7f-\x9f\xad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]",UnicodeRegexpSupport),Names={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let _supportsTabSize=null;const specialCharConfig=Facet.define({combine(configs){let config2=combineConfig(configs,{render:null,specialChars:Specials,addSpecialChars:null});return(config2.replaceTabs=!function(){var _a2;if(null==_supportsTabSize&&"undefined"!=typeof document&&document.body){let styles2=document.body.style;_supportsTabSize=null!=(null!==(_a2=styles2.tabSize)&&void 0!==_a2?_a2:styles2.MozTabSize)}return _supportsTabSize||!1}())&&(config2.specialChars=new RegExp("\t|"+config2.specialChars.source,UnicodeRegexpSupport)),config2.addSpecialChars&&(config2.specialChars=new RegExp(config2.specialChars.source+"|"+config2.addSpecialChars.source,UnicodeRegexpSupport)),config2}});function highlightSpecialChars(config2={}){return[specialCharConfig.of(config2),_plugin||(_plugin=ViewPlugin$1.fromClass(class{constructor(view){this.view=view,this.decorations=Decoration$1.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(view.state.facet(specialCharConfig)),this.decorations=this.decorator.createDeco(view)}makeDecorator(conf){return new MatchDecorator({regexp:conf.specialChars,decoration:(m,view,pos)=>{let{doc:doc2}=view.state,code2=codePointAt(m[0],0);if(9==code2){let line=doc2.lineAt(pos),size=view.state.tabSize,col=countColumn(line.text,size,pos-line.from);return Decoration$1.replace({widget:new TabWidget((size-col%size)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[code2]||(this.decorationCache[code2]=Decoration$1.replace({widget:new SpecialCharWidget(conf,code2)}))},boundary:conf.replaceTabs?void 0:/[^]/})}update(update2){let conf=update2.state.facet(specialCharConfig);update2.startState.facet(specialCharConfig)!=conf?(this.decorator=this.makeDecorator(conf),this.decorations=this.decorator.createDeco(update2.view)):this.decorations=this.decorator.updateDeco(update2,this.decorations)}},{decorations:v=>v.decorations}))]}let _plugin=null;class SpecialCharWidget extends WidgetType$1{constructor(options,code2){super(),this.options=options,this.code=code2}eq(other){return other.code==this.code}toDOM(view){let ph=(code2=this.code)>=32?"\u2022":10==code2?"\u2424":String.fromCharCode(9216+code2);var code2;let desc=view.state.phrase("Control character")+" "+(Names[this.code]||"0x"+this.code.toString(16)),custom2=this.options.render&&this.options.render(this.code,desc,ph);if(custom2)return custom2;let span=document.createElement("span");return span.textContent=ph,span.title=desc,span.setAttribute("aria-label",desc),span.className="cm-specialChar",span}ignoreEvent(){return!1}}class TabWidget extends WidgetType$1{constructor(width){super(),this.width=width}eq(other){return other.width==this.width}toDOM(){let span=document.createElement("span");return span.textContent="\t",span.className="cm-tab",span.style.width=this.width+"px",span}ignoreEvent(){return!1}}const lineDeco=Decoration$1.line({class:"cm-activeLine"}),activeLineHighlighter=ViewPlugin$1.fromClass(class{constructor(view){this.decorations=this.getDeco(view)}update(update2){(update2.docChanged||update2.selectionSet)&&(this.decorations=this.getDeco(update2.view))}getDeco(view){let lastLineStart=-1,deco=[];for(let r of view.state.selection.ranges){let line=view.lineBlockAt(r.head);line.from>lastLineStart&&(deco.push(lineDeco.range(line.from)),lastLineStart=line.from)}return Decoration$1.set(deco)}},{decorations:v=>v.decorations}),MaxOff=2e3;function getPos(view,event){let offset2=view.posAtCoords({x:event.clientX,y:event.clientY},!1),line=view.state.doc.lineAt(offset2),off=offset2-line.from,col=off>MaxOff?-1:off==line.length?function(view,x){let ref=view.coordsAtPos(view.viewport.from);return ref?Math.round(Math.abs((ref.left-x)/view.defaultCharacterWidth)):-1}(view,event.clientX):countColumn(line.text,view.state.tabSize,offset2-line.from);return{line:line.number,col:col,off:off}}function rectangleSelectionStyle(view,event){let start2=getPos(view,event),startSel=view.state.selection;return start2?{update(update2){if(update2.docChanged){let newStart=update2.changes.mapPos(update2.startState.doc.line(start2.line).from),newLine=update2.state.doc.lineAt(newStart);start2={line:newLine.number,col:start2.col,off:Math.min(start2.off,newLine.length)},startSel=startSel.map(update2.changes)}},get(event2,_extend,multiple){let cur2=getPos(view,event2);if(!cur2)return startSel;let ranges=function(state,a,b){let startLine=Math.min(a.line,b.line),endLine=Math.max(a.line,b.line),ranges=[];if(a.off>MaxOff||b.off>MaxOff||a.col<0||b.col<0){let startOff=Math.min(a.off,b.off),endOff=Math.max(a.off,b.off);for(let i2=startLine;i2<=endLine;i2++){let line=state.doc.line(i2);line.length<=endOff&&ranges.push(EditorSelection.range(line.from+startOff,line.to+endOff))}}else{let startCol=Math.min(a.col,b.col),endCol=Math.max(a.col,b.col);for(let i2=startLine;i2<=endLine;i2++){let line=state.doc.line(i2),start2=findColumn(line.text,startCol,state.tabSize,!0);if(start2<0)ranges.push(EditorSelection.cursor(line.to));else{let end2=findColumn(line.text,endCol,state.tabSize);ranges.push(EditorSelection.range(line.from+start2,line.from+end2))}}}return ranges}(view.state,start2,cur2);return ranges.length?multiple?EditorSelection.create(ranges.concat(startSel.ranges)):EditorSelection.create(ranges):startSel}}:null}function rectangularSelection(options){let filter=(null==options?void 0:options.eventFilter)||(e=>e.altKey&&0==e.button);return EditorView$1.mouseSelectionStyle.of(((view,event)=>filter(event)?rectangleSelectionStyle(view,event):null))}const keys={Alt:[18,e=>!!e.altKey],Control:[17,e=>!!e.ctrlKey],Shift:[16,e=>!!e.shiftKey],Meta:[91,e=>!!e.metaKey]},showCrosshair={style:"cursor: crosshair"};function crosshairCursor(options={}){let[code2,getter]=keys[options.key||"Alt"],plugin=ViewPlugin$1.fromClass(class{constructor(view){this.view=view,this.isDown=!1}set(isDown){this.isDown!=isDown&&(this.isDown=isDown,this.view.update([]))}},{eventObservers:{keydown(e){this.set(e.keyCode==code2||getter(e))},keyup(e){e.keyCode!=code2&&getter(e)||this.set(!1)},mousemove(e){this.set(getter(e))}}});return[plugin,EditorView$1.contentAttributes.of((view=>{var _a2;return(null===(_a2=view.plugin(plugin))||void 0===_a2?void 0:_a2.isDown)?showCrosshair:null}))]}class TooltipViewManager{constructor(view,facet,createTooltipView){this.facet=facet,this.createTooltipView=createTooltipView,this.input=view.state.facet(facet),this.tooltips=this.input.filter((t2=>t2)),this.tooltipViews=this.tooltips.map(createTooltipView)}update(update2,above){var _a2;let input=update2.state.facet(this.facet),tooltips=input.filter((x=>x));if(input===this.input){for(let t2 of this.tooltipViews)t2.update&&t2.update(update2);return!1}let tooltipViews=[],newAbove=above?[]:null;for(let i2=0;i2<tooltips.length;i2++){let tip=tooltips[i2],known=-1;if(tip){for(let i3=0;i3<this.tooltips.length;i3++){let other=this.tooltips[i3];other&&other.create==tip.create&&(known=i3)}if(known<0)tooltipViews[i2]=this.createTooltipView(tip),newAbove&&(newAbove[i2]=!!tip.above);else{let tooltipView=tooltipViews[i2]=this.tooltipViews[known];newAbove&&(newAbove[i2]=above[known]),tooltipView.update&&tooltipView.update(update2)}}}for(let t2 of this.tooltipViews)tooltipViews.indexOf(t2)<0&&(t2.dom.remove(),null===(_a2=t2.destroy)||void 0===_a2||_a2.call(t2));return above&&(newAbove.forEach(((val,i2)=>above[i2]=val)),above.length=newAbove.length),this.input=input,this.tooltips=tooltips,this.tooltipViews=tooltipViews,!0}}function windowSpace(view){let{win:win}=view;return{top:0,left:0,bottom:win.innerHeight,right:win.innerWidth}}const tooltipConfig=Facet.define({combine:values=>{var _a2,_b,_c;return{position:browser$2.ios?"absolute":(null===(_a2=values.find((conf=>conf.position)))||void 0===_a2?void 0:_a2.position)||"fixed",parent:(null===(_b=values.find((conf=>conf.parent)))||void 0===_b?void 0:_b.parent)||null,tooltipSpace:(null===(_c=values.find((conf=>conf.tooltipSpace)))||void 0===_c?void 0:_c.tooltipSpace)||windowSpace}}}),knownHeight=new WeakMap,tooltipPlugin=ViewPlugin$1.fromClass(class{constructor(view){this.view=view,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let config2=view.state.facet(tooltipConfig);this.position=config2.position,this.parent=config2.parent,this.classes=view.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new TooltipViewManager(view,showTooltip,(t2=>this.createTooltip(t2))),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((entries=>{Date.now()>this.lastTransaction-50&&entries.length>0&&entries[entries.length-1].intersectionRatio<1&&this.measureSoon()}),{threshold:[1]}):null,this.observeIntersection(),view.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let tooltip of this.manager.tooltipViews)this.intersectionObserver.observe(tooltip.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout((()=>{this.measureTimeout=-1,this.maybeMeasure()}),50))}update(update2){update2.transactions.length&&(this.lastTransaction=Date.now());let updated=this.manager.update(update2,this.above);updated&&this.observeIntersection();let shouldMeasure=updated||update2.geometryChanged,newConfig=update2.state.facet(tooltipConfig);if(newConfig.position!=this.position&&!this.madeAbsolute){this.position=newConfig.position;for(let t2 of this.manager.tooltipViews)t2.dom.style.position=this.position;shouldMeasure=!0}if(newConfig.parent!=this.parent){this.parent&&this.container.remove(),this.parent=newConfig.parent,this.createContainer();for(let t2 of this.manager.tooltipViews)this.container.appendChild(t2.dom);shouldMeasure=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);shouldMeasure&&this.maybeMeasure()}createTooltip(tooltip){let tooltipView=tooltip.create(this.view);if(tooltipView.dom.classList.add("cm-tooltip"),tooltip.arrow&&!tooltipView.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let arrow2=document.createElement("div");arrow2.className="cm-tooltip-arrow",tooltipView.dom.appendChild(arrow2)}return tooltipView.dom.style.position=this.position,tooltipView.dom.style.top="-10000px",tooltipView.dom.style.left="0px",this.container.appendChild(tooltipView.dom),tooltipView.mount&&tooltipView.mount(this.view),tooltipView}destroy(){var _a2,_b;this.view.win.removeEventListener("resize",this.measureSoon);for(let tooltipView of this.manager.tooltipViews)tooltipView.dom.remove(),null===(_a2=tooltipView.destroy)||void 0===_a2||_a2.call(tooltipView);this.parent&&this.container.remove(),null===(_b=this.intersectionObserver)||void 0===_b||_b.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let editor=this.view.dom.getBoundingClientRect(),scaleX=1,scaleY=1,makeAbsolute=!1;if("fixed"==this.position&&this.manager.tooltipViews.length){let{dom:dom}=this.manager.tooltipViews[0];if(browser$2.gecko)makeAbsolute=dom.offsetParent!=this.container.ownerDocument.body;else if(1!=this.view.scaleX||1!=this.view.scaleY)makeAbsolute=!0;else if("-10000px"==dom.style.top&&"0px"==dom.style.left){let rect=dom.getBoundingClientRect();makeAbsolute=Math.abs(rect.top+1e4)>1||Math.abs(rect.left)>1}}if(makeAbsolute||"absolute"==this.position)if(this.parent){let rect=this.parent.getBoundingClientRect();rect.width&&rect.height&&(scaleX=rect.width/this.parent.offsetWidth,scaleY=rect.height/this.parent.offsetHeight)}else({scaleX:scaleX,scaleY:scaleY}=this.view.viewState);return{editor:editor,parent:this.parent?this.container.getBoundingClientRect():editor,pos:this.manager.tooltips.map(((t2,i2)=>{let tv=this.manager.tooltipViews[i2];return tv.getCoords?tv.getCoords(t2.pos):this.view.coordsAtPos(t2.pos)})),size:this.manager.tooltipViews.map((({dom:dom})=>dom.getBoundingClientRect())),space:this.view.state.facet(tooltipConfig).tooltipSpace(this.view),scaleX:scaleX,scaleY:scaleY,makeAbsolute:makeAbsolute}}writeMeasure(measured){var _a2;if(measured.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let t2 of this.manager.tooltipViews)t2.dom.style.position="absolute"}let{editor:editor,space:space2,scaleX:scaleX,scaleY:scaleY}=measured,others=[];for(let i2=0;i2<this.manager.tooltips.length;i2++){let tooltip=this.manager.tooltips[i2],tView=this.manager.tooltipViews[i2],{dom:dom}=tView,pos=measured.pos[i2],size=measured.size[i2];if(!pos||pos.bottom<=Math.max(editor.top,space2.top)||pos.top>=Math.min(editor.bottom,space2.bottom)||pos.right<Math.max(editor.left,space2.left)-.1||pos.left>Math.min(editor.right,space2.right)+.1){dom.style.top="-10000px";continue}let arrow2=tooltip.arrow?tView.dom.querySelector(".cm-tooltip-arrow"):null,arrowHeight=arrow2?7:0,width=size.right-size.left,height=null!==(_a2=knownHeight.get(tView))&&void 0!==_a2?_a2:size.bottom-size.top,offset2=tView.offset||noOffset,ltr=this.view.textDirection==Direction$1.LTR,left2=size.width>space2.right-space2.left?ltr?space2.left:space2.right-size.width:ltr?Math.min(pos.left-(arrow2?14:0)+offset2.x,space2.right-width):Math.max(space2.left,pos.left-width+(arrow2?14:0)-offset2.x),above=this.above[i2];!tooltip.strictSide&&(above?pos.top-(size.bottom-size.top)-offset2.y<space2.top:pos.bottom+(size.bottom-size.top)+offset2.y>space2.bottom)&&above==space2.bottom-pos.bottom>pos.top-space2.top&&(above=this.above[i2]=!above);let spaceVert=(above?pos.top-space2.top:space2.bottom-pos.bottom)-arrowHeight;if(spaceVert<height&&!1!==tView.resize){if(spaceVert<this.view.defaultLineHeight){dom.style.top="-10000px";continue}knownHeight.set(tView,height),dom.style.height=(height=spaceVert)/scaleY+"px"}else dom.style.height&&(dom.style.height="");let top2=above?pos.top-height-arrowHeight-offset2.y:pos.bottom+arrowHeight+offset2.y,right2=left2+width;if(!0!==tView.overlap)for(let r of others)r.left<right2&&r.right>left2&&r.top<top2+height&&r.bottom>top2&&(top2=above?r.top-height-2-arrowHeight:r.bottom+arrowHeight+2);if("absolute"==this.position?(dom.style.top=(top2-measured.parent.top)/scaleY+"px",dom.style.left=(left2-measured.parent.left)/scaleX+"px"):(dom.style.top=top2/scaleY+"px",dom.style.left=left2/scaleX+"px"),arrow2){let arrowLeft=pos.left+(ltr?offset2.x:-offset2.x)-(left2+14-7);arrow2.style.left=arrowLeft/scaleX+"px"}!0!==tView.overlap&&others.push({left:left2,top:top2,right:right2,bottom:top2+height}),dom.classList.toggle("cm-tooltip-above",above),dom.classList.toggle("cm-tooltip-below",!above),tView.positioned&&tView.positioned(measured.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let tv of this.manager.tooltipViews)tv.dom.style.top="-10000px"}},{eventObservers:{scroll(){this.maybeMeasure()}}}),baseTheme$4=EditorView$1.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),noOffset={x:0,y:0},showTooltip=Facet.define({enables:[tooltipPlugin,baseTheme$4]}),showHoverTooltip=Facet.define();class HoverTooltipHost{static create(view){return new HoverTooltipHost(view)}constructor(view){this.view=view,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new TooltipViewManager(view,showHoverTooltip,(t2=>this.createHostedView(t2)))}createHostedView(tooltip){let hostedView=tooltip.create(this.view);return hostedView.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(hostedView.dom),this.mounted&&hostedView.mount&&hostedView.mount(this.view),hostedView}mount(view){for(let hostedView of this.manager.tooltipViews)hostedView.mount&&hostedView.mount(view);this.mounted=!0}positioned(space2){for(let hostedView of this.manager.tooltipViews)hostedView.positioned&&hostedView.positioned(space2)}update(update2){this.manager.update(update2)}destroy(){var _a2;for(let t2 of this.manager.tooltipViews)null===(_a2=t2.destroy)||void 0===_a2||_a2.call(t2)}passProp(name2){let value;for(let view of this.manager.tooltipViews){let given=view[name2];if(void 0!==given)if(void 0===value)value=given;else if(value!==given)return}return value}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const showHoverTooltipHost=showTooltip.compute([showHoverTooltip],(state=>{let tooltips=state.facet(showHoverTooltip).filter((t2=>t2));return 0===tooltips.length?null:{pos:Math.min(...tooltips.map((t2=>t2.pos))),end:Math.max(...tooltips.filter((t2=>null!=t2.end)).map((t2=>t2.end))),create:HoverTooltipHost.create,above:tooltips[0].above,arrow:tooltips.some((t2=>t2.arrow))}}));class HoverPlugin{constructor(view,source,field,setHover,hoverTime){this.view=view,this.source=source,this.field=field,this.setHover=setHover,this.hoverTime=hoverTime,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:view.dom,time:0},this.checkHover=this.checkHover.bind(this),view.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),view.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout((()=>this.startHover()),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let hovered=Date.now()-this.lastMove.time;hovered<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-hovered):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:view,lastMove:lastMove}=this,desc=view.docView.nearest(lastMove.target);if(!desc)return;let pos,side=1;if(desc instanceof WidgetView$1)pos=desc.posAtStart;else{if(pos=view.posAtCoords(lastMove),null==pos)return;let posCoords=view.coordsAtPos(pos);if(!posCoords||lastMove.y<posCoords.top||lastMove.y>posCoords.bottom||lastMove.x<posCoords.left-view.defaultCharacterWidth||lastMove.x>posCoords.right+view.defaultCharacterWidth)return;let bidi=view.bidiSpans(view.state.doc.lineAt(pos)).find((s=>s.from<=pos&&s.to>=pos)),rtl=bidi&&bidi.dir==Direction$1.RTL?-1:1;side=lastMove.x<posCoords.left?-rtl:rtl}let open=this.source(view,pos,side);if(null==open?void 0:open.then){let pending=this.pending={pos:pos};open.then((result=>{this.pending==pending&&(this.pending=null,result&&view.dispatch({effects:this.setHover.of(result)}))}),(e=>logException$1(view.state,e,"hover tooltip")))}else open&&view.dispatch({effects:this.setHover.of(open)})}mousemove(event){var _a2;this.lastMove={x:event.clientX,y:event.clientY,target:event.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let tooltip=this.active;if(tooltip&&!isInTooltip(this.lastMove.target)||this.pending){let{pos:pos}=tooltip||this.pending,end2=null!==(_a2=null==tooltip?void 0:tooltip.end)&&void 0!==_a2?_a2:pos;(pos==end2?this.view.posAtCoords(this.lastMove)==pos:function(view,from,to,x,y,margin){let rect=view.scrollDOM.getBoundingClientRect(),docBottom=view.documentTop+view.documentPadding.top+view.contentHeight;if(rect.left>x||rect.right<x||rect.top>y||Math.min(rect.bottom,docBottom)<y)return!1;let pos=view.posAtCoords({x:x,y:y},!1);return pos>=from&&pos<=to}(this.view,pos,end2,event.clientX,event.clientY))||(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!isInTooltip(e.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function isInTooltip(elt){for(let cur2=elt;cur2;cur2=cur2.parentNode)if(1==cur2.nodeType&&cur2.classList.contains("cm-tooltip"))return!0;return!1}function hoverTooltip(source,options={}){let setHover=StateEffect.define(),hoverState=StateField.define({create:()=>null,update(value,tr){if(value&&(options.hideOnChange&&(tr.docChanged||tr.selection)||options.hideOn&&options.hideOn(tr,value)))return null;if(value&&tr.docChanged){let newPos=tr.changes.mapPos(value.pos,-1,MapMode.TrackDel);if(null==newPos)return null;let copy=Object.assign(Object.create(null),value);copy.pos=newPos,null!=value.end&&(copy.end=tr.changes.mapPos(value.end)),value=copy}for(let effect2 of tr.effects)effect2.is(setHover)&&(value=effect2.value),effect2.is(closeHoverTooltipEffect)&&(value=null);return value},provide:f=>showHoverTooltip.from(f)});return[hoverState,ViewPlugin$1.define((view=>new HoverPlugin(view,source,hoverState,setHover,options.hoverTime||300))),showHoverTooltipHost]}function getTooltip(view,tooltip){let plugin=view.plugin(tooltipPlugin);if(!plugin)return null;let found=plugin.manager.tooltips.indexOf(tooltip);return found<0?null:plugin.manager.tooltipViews[found]}const closeHoverTooltipEffect=StateEffect.define(),panelConfig=Facet.define({combine(configs){let topContainer,bottomContainer;for(let c of configs)topContainer=topContainer||c.topContainer,bottomContainer=bottomContainer||c.bottomContainer;return{topContainer:topContainer,bottomContainer:bottomContainer}}});function getPanel(view,panel){let plugin=view.plugin(panelPlugin),index=plugin?plugin.specs.indexOf(panel):-1;return index>-1?plugin.panels[index]:null}const panelPlugin=ViewPlugin$1.fromClass(class{constructor(view){this.input=view.state.facet(showPanel),this.specs=this.input.filter((s=>s)),this.panels=this.specs.map((spec=>spec(view)));let conf=view.state.facet(panelConfig);this.top=new PanelGroup(view,!0,conf.topContainer),this.bottom=new PanelGroup(view,!1,conf.bottomContainer),this.top.sync(this.panels.filter((p=>p.top))),this.bottom.sync(this.panels.filter((p=>!p.top)));for(let p of this.panels)p.dom.classList.add("cm-panel"),p.mount&&p.mount()}update(update2){let conf=update2.state.facet(panelConfig);this.top.container!=conf.topContainer&&(this.top.sync([]),this.top=new PanelGroup(update2.view,!0,conf.topContainer)),this.bottom.container!=conf.bottomContainer&&(this.bottom.sync([]),this.bottom=new PanelGroup(update2.view,!1,conf.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let input=update2.state.facet(showPanel);if(input!=this.input){let specs=input.filter((x=>x)),panels=[],top2=[],bottom2=[],mount=[];for(let spec of specs){let panel,known=this.specs.indexOf(spec);known<0?(panel=spec(update2.view),mount.push(panel)):(panel=this.panels[known],panel.update&&panel.update(update2)),panels.push(panel),(panel.top?top2:bottom2).push(panel)}this.specs=specs,this.panels=panels,this.top.sync(top2),this.bottom.sync(bottom2);for(let p of mount)p.dom.classList.add("cm-panel"),p.mount&&p.mount()}else for(let p of this.panels)p.update&&p.update(update2)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:plugin=>EditorView$1.scrollMargins.of((view=>{let value=view.plugin(plugin);return value&&{top:value.top.scrollMargin(),bottom:value.bottom.scrollMargin()}}))});class PanelGroup{constructor(view,top2,container){this.view=view,this.top=top2,this.container=container,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(panels){for(let p of this.panels)p.destroy&&panels.indexOf(p)<0&&p.destroy();this.panels=panels,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let parent=this.container||this.view.dom;parent.insertBefore(this.dom,this.top?parent.firstChild:null)}let curDOM=this.dom.firstChild;for(let panel of this.panels)if(panel.dom.parentNode==this.dom){for(;curDOM!=panel.dom;)curDOM=rm(curDOM);curDOM=curDOM.nextSibling}else this.dom.insertBefore(panel.dom,curDOM);for(;curDOM;)curDOM=rm(curDOM)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let cls of this.classes.split(" "))cls&&this.container.classList.remove(cls);for(let cls of(this.classes=this.view.themeClasses).split(" "))cls&&this.container.classList.add(cls)}}}function rm(node){let next=node.nextSibling;return node.remove(),next}const showPanel=Facet.define({enables:panelPlugin});let GutterMarker$1=class extends RangeValue{compare(other){return this==other||this.constructor==other.constructor&&this.eq(other)}eq(other){return!1}destroy(dom){}};GutterMarker$1.prototype.elementClass="",GutterMarker$1.prototype.toDOM=void 0,GutterMarker$1.prototype.mapMode=MapMode.TrackBefore,GutterMarker$1.prototype.startSide=GutterMarker$1.prototype.endSide=-1,GutterMarker$1.prototype.point=!0;const gutterLineClass$1=Facet.define(),activeGutters$1=Facet.define(),unfixGutters$1=Facet.define({combine:values=>values.some((x=>x))});function gutters$1(config2){let result=[gutterView$1];return config2&&!1===config2.fixed&&result.push(unfixGutters$1.of(!0)),result}const gutterView$1=ViewPlugin$1.fromClass(class{constructor(view){this.view=view,this.prevViewport=view.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=view.state.facet(activeGutters$1).map((conf=>new SingleGutterView$1(view,conf)));for(let gutter2 of this.gutters)this.dom.appendChild(gutter2.dom);this.fixed=!view.state.facet(unfixGutters$1),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),view.scrollDOM.insertBefore(this.dom,view.contentDOM)}update(update2){if(this.updateGutters(update2)){let vpA=this.prevViewport,vpB=update2.view.viewport,vpOverlap=Math.min(vpA.to,vpB.to)-Math.max(vpA.from,vpB.from);this.syncGutters(vpOverlap<.8*(vpB.to-vpB.from))}update2.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(unfixGutters$1)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=update2.view.viewport}syncGutters(detach2){let after=this.dom.nextSibling;detach2&&this.dom.remove();let lineClasses=RangeSet.iter(this.view.state.facet(gutterLineClass$1),this.view.viewport.from),classSet=[],contexts=this.gutters.map((gutter2=>new UpdateContext$1(gutter2,this.view.viewport,-this.view.documentPadding.top)));for(let line of this.view.viewportLineBlocks)if(classSet.length&&(classSet=[]),Array.isArray(line.type)){let first=!0;for(let b of line.type)if(b.type==BlockType$1.Text&&first){advanceCursor$1(lineClasses,classSet,b.from);for(let cx of contexts)cx.line(this.view,b,classSet);first=!1}else if(b.widget)for(let cx of contexts)cx.widget(this.view,b)}else if(line.type==BlockType$1.Text){advanceCursor$1(lineClasses,classSet,line.from);for(let cx of contexts)cx.line(this.view,line,classSet)}else if(line.widget)for(let cx of contexts)cx.widget(this.view,line);for(let cx of contexts)cx.finish();detach2&&this.view.scrollDOM.insertBefore(this.dom,after)}updateGutters(update2){let prev=update2.startState.facet(activeGutters$1),cur2=update2.state.facet(activeGutters$1),change=update2.docChanged||update2.heightChanged||update2.viewportChanged||!RangeSet.eq(update2.startState.facet(gutterLineClass$1),update2.state.facet(gutterLineClass$1),update2.view.viewport.from,update2.view.viewport.to);if(prev==cur2)for(let gutter2 of this.gutters)gutter2.update(update2)&&(change=!0);else{change=!0;let gutters2=[];for(let conf of cur2){let known=prev.indexOf(conf);known<0?gutters2.push(new SingleGutterView$1(this.view,conf)):(this.gutters[known].update(update2),gutters2.push(this.gutters[known]))}for(let g of this.gutters)g.dom.remove(),gutters2.indexOf(g)<0&&g.destroy();for(let g of gutters2)this.dom.appendChild(g.dom);this.gutters=gutters2}return change}destroy(){for(let view of this.gutters)view.destroy();this.dom.remove()}},{provide:plugin=>EditorView$1.scrollMargins.of((view=>{let value=view.plugin(plugin);return value&&0!=value.gutters.length&&value.fixed?view.textDirection==Direction$1.LTR?{left:value.dom.offsetWidth*view.scaleX}:{right:value.dom.offsetWidth*view.scaleX}:null}))});function asArray$1(val){return Array.isArray(val)?val:[val]}function advanceCursor$1(cursor2,collect,pos){for(;cursor2.value&&cursor2.from<=pos;)cursor2.from==pos&&collect.push(cursor2.value),cursor2.next()}let UpdateContext$1=class{constructor(gutter2,viewport2,height){this.gutter=gutter2,this.height=height,this.i=0,this.cursor=RangeSet.iter(gutter2.markers,viewport2.from)}addElement(view,block,markers){let{gutter:gutter2}=this,above=(block.top-this.height)/view.scaleY,height=block.height/view.scaleY;if(this.i==gutter2.elements.length){let newElt=new GutterElement$1(view,height,above,markers);gutter2.elements.push(newElt),gutter2.dom.appendChild(newElt.dom)}else gutter2.elements[this.i].update(view,height,above,markers);this.height=block.bottom,this.i++}line(view,line,extraMarkers){let localMarkers=[];advanceCursor$1(this.cursor,localMarkers,line.from),extraMarkers.length&&(localMarkers=localMarkers.concat(extraMarkers));let forLine=this.gutter.config.lineMarker(view,line,localMarkers);forLine&&localMarkers.unshift(forLine);let gutter2=this.gutter;(0!=localMarkers.length||gutter2.config.renderEmptyElements)&&this.addElement(view,line,localMarkers)}widget(view,block){let marker=this.gutter.config.widgetMarker(view,block.widget,block);marker&&this.addElement(view,block,[marker])}finish(){let gutter2=this.gutter;for(;gutter2.elements.length>this.i;){let last=gutter2.elements.pop();gutter2.dom.removeChild(last.dom),last.destroy()}}},SingleGutterView$1=class{constructor(view,config2){this.view=view,this.config=config2,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let prop in config2.domEventHandlers)this.dom.addEventListener(prop,(event=>{let y,target=event.target;if(target!=this.dom&&this.dom.contains(target)){for(;target.parentNode!=this.dom;)target=target.parentNode;let rect=target.getBoundingClientRect();y=(rect.top+rect.bottom)/2}else y=event.clientY;let line=view.lineBlockAtHeight(y-view.documentTop);config2.domEventHandlers[prop](view,line,event)&&event.preventDefault()}));this.markers=asArray$1(config2.markers(view)),config2.initialSpacer&&(this.spacer=new GutterElement$1(view,0,0,[config2.initialSpacer(view)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(update2){let prevMarkers=this.markers;if(this.markers=asArray$1(this.config.markers(update2.view)),this.spacer&&this.config.updateSpacer){let updated=this.config.updateSpacer(this.spacer.markers[0],update2);updated!=this.spacer.markers[0]&&this.spacer.update(update2.view,0,0,[updated])}let vp=update2.view.viewport;return!RangeSet.eq(this.markers,prevMarkers,vp.from,vp.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(update2)}destroy(){for(let elt of this.elements)elt.destroy()}},GutterElement$1=class{constructor(view,height,above,markers){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(view,height,above,markers)}update(view,height,above,markers){this.height!=height&&(this.height=height,this.dom.style.height=height+"px"),this.above!=above&&(this.dom.style.marginTop=(this.above=above)?above+"px":""),function(a,b){if(a.length!=b.length)return!1;for(let i2=0;i2<a.length;i2++)if(!a[i2].compare(b[i2]))return!1;return!0}(this.markers,markers)||this.setMarkers(view,markers)}setMarkers(view,markers){let cls="cm-gutterElement",domPos=this.dom.firstChild;for(let iNew=0,iOld=0;;){let skipTo=iOld,marker=iNew<markers.length?markers[iNew++]:null,matched=!1;if(marker){let c=marker.elementClass;c&&(cls+=" "+c);for(let i2=iOld;i2<this.markers.length;i2++)if(this.markers[i2].compare(marker)){skipTo=i2,matched=!0;break}}else skipTo=this.markers.length;for(;iOld<skipTo;){let next=this.markers[iOld++];if(next.toDOM){next.destroy(domPos);let after=domPos.nextSibling;domPos.remove(),domPos=after}}if(!marker)break;marker.toDOM&&(matched?domPos=domPos.nextSibling:this.dom.insertBefore(marker.toDOM(view),domPos)),matched&&iOld++}this.dom.className=cls,this.markers=markers}destroy(){this.setMarkers(null,[])}};const lineNumberMarkers=Facet.define(),lineNumberConfig=Facet.define({combine:values=>combineConfig(values,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(a,b){let result=Object.assign({},a);for(let event in b){let exists=result[event],add2=b[event];result[event]=exists?(view,line,event2)=>exists(view,line,event2)||add2(view,line,event2):add2}return result}})});class NumberMarker extends GutterMarker$1{constructor(number2){super(),this.number=number2}eq(other){return this.number==other.number}toDOM(){return document.createTextNode(this.number)}}function formatNumber(view,number2){return view.state.facet(lineNumberConfig).formatNumber(number2,view.state)}const lineNumberGutter=activeGutters$1.compute([lineNumberConfig],(state=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:view=>view.state.facet(lineNumberMarkers),lineMarker:(view,line,others)=>others.some((m=>m.toDOM))?null:new NumberMarker(formatNumber(view,view.state.doc.lineAt(line.from).number)),widgetMarker:()=>null,lineMarkerChange:update2=>update2.startState.facet(lineNumberConfig)!=update2.state.facet(lineNumberConfig),initialSpacer:view=>new NumberMarker(formatNumber(view,maxLineNumber(view.state.doc.lines))),updateSpacer(spacer,update2){let max2=formatNumber(update2.view,maxLineNumber(update2.view.state.doc.lines));return max2==spacer.number?spacer:new NumberMarker(max2)},domEventHandlers:state.facet(lineNumberConfig).domEventHandlers})));function lineNumbers(config2={}){return[lineNumberConfig.of(config2),gutters$1(),lineNumberGutter]}function maxLineNumber(lines){let last=9;for(;last<lines;)last=10*last+9;return last}const activeLineGutterMarker=new class extends GutterMarker$1{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},activeLineGutterHighlighter=gutterLineClass$1.compute(["selection"],(state=>{let marks=[],last=-1;for(let range of state.selection.ranges){let linePos=state.doc.lineAt(range.head).from;linePos>last&&(last=linePos,marks.push(activeLineGutterMarker.range(linePos)))}return RangeSet.of(marks)}));const DefaultBufferLength$1=1024;let nextPropID$1=0;class Range{constructor(from,to){this.from=from,this.to=to}}let NodeProp$1=class{constructor(config2={}){this.id=nextPropID$1++,this.perNode=!!config2.perNode,this.deserialize=config2.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(match){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof match&&(match=NodeType$1.match(match)),type2=>{let result=match(type2);return void 0===result?null:[this,result]}}};NodeProp$1.closedBy=new NodeProp$1({deserialize:str=>str.split(" ")}),NodeProp$1.openedBy=new NodeProp$1({deserialize:str=>str.split(" ")}),NodeProp$1.group=new NodeProp$1({deserialize:str=>str.split(" ")}),NodeProp$1.contextHash=new NodeProp$1({perNode:!0}),NodeProp$1.lookAhead=new NodeProp$1({perNode:!0}),NodeProp$1.mounted=new NodeProp$1({perNode:!0});let MountedTree$1=class{constructor(tree,overlay,parser2){this.tree=tree,this.overlay=overlay,this.parser=parser2}static get(tree){return tree&&tree.props&&tree.props[NodeProp$1.mounted.id]}};const noProps$1=Object.create(null);let NodeType$1=class NodeType2{constructor(name2,props,id2,flags=0){this.name=name2,this.props=props,this.id=id2,this.flags=flags}static define(spec){let props=spec.props&&spec.props.length?Object.create(null):noProps$1,flags=(spec.top?1:0)|(spec.skipped?2:0)|(spec.error?4:0)|(null==spec.name?8:0),type2=new NodeType2(spec.name||"",props,spec.id,flags);if(spec.props)for(let src of spec.props)if(Array.isArray(src)||(src=src(type2)),src){if(src[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");props[src[0].id]=src[1]}return type2}prop(prop){return this.props[prop.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(name2){if("string"==typeof name2){if(this.name==name2)return!0;let group=this.prop(NodeProp$1.group);return!!group&&group.indexOf(name2)>-1}return this.id==name2}static match(map){let direct=Object.create(null);for(let prop in map)for(let name2 of prop.split(" "))direct[name2]=map[prop];return node=>{for(let groups=node.prop(NodeProp$1.group),i2=-1;i2<(groups?groups.length:0);i2++){let found=direct[i2<0?node.name:groups[i2]];if(found)return found}}}};NodeType$1.none=new NodeType$1("",Object.create(null),0,8);class NodeSet{constructor(types2){this.types=types2;for(let i2=0;i2<types2.length;i2++)if(types2[i2].id!=i2)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...props){let newTypes=[];for(let type2 of this.types){let newProps=null;for(let source of props){let add2=source(type2);add2&&(newProps||(newProps=Object.assign({},type2.props)),newProps[add2[0].id]=add2[1])}newTypes.push(newProps?new NodeType$1(type2.name,newProps,type2.id,type2.flags):type2)}return new NodeSet(newTypes)}}const CachedNode$1=new WeakMap,CachedInnerNode$1=new WeakMap;var IterMode$1,IterMode2;(IterMode2=IterMode$1||(IterMode$1={}))[IterMode2.ExcludeBuffers=1]="ExcludeBuffers",IterMode2[IterMode2.IncludeAnonymous=2]="IncludeAnonymous",IterMode2[IterMode2.IgnoreMounts=4]="IgnoreMounts",IterMode2[IterMode2.IgnoreOverlays=8]="IgnoreOverlays";let Tree$1=class Tree2{constructor(type2,children2,positions,length,props){if(this.type=type2,this.children=children2,this.positions=positions,this.length=length,this.props=null,props&&props.length){this.props=Object.create(null);for(let[prop,value]of props)this.props["number"==typeof prop?prop:prop.id]=value}}toString(){let mounted=MountedTree$1.get(this);if(mounted&&!mounted.overlay)return mounted.tree.toString();let children2="";for(let ch of this.children){let str=ch.toString();str&&(children2&&(children2+=","),children2+=str)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(children2.length?"("+children2+")":""):children2}cursor(mode=0){return new TreeCursor$1(this.topNode,mode)}cursorAt(pos,side=0,mode=0){let scope=CachedNode$1.get(this)||this.topNode,cursor2=new TreeCursor$1(scope);return cursor2.moveTo(pos,side),CachedNode$1.set(this,cursor2._tree),cursor2}get topNode(){return new TreeNode$1(this,0,0,null)}resolve(pos,side=0){let node=resolveNode$1(CachedNode$1.get(this)||this.topNode,pos,side,!1);return CachedNode$1.set(this,node),node}resolveInner(pos,side=0){let node=resolveNode$1(CachedInnerNode$1.get(this)||this.topNode,pos,side,!0);return CachedInnerNode$1.set(this,node),node}resolveStack(pos,side=0){return function(tree,pos,side){let inner=tree.resolveInner(pos,side),layers=null;for(let scan=inner instanceof TreeNode$1?inner:inner.context.parent;scan;scan=scan.parent)if(scan.index<0){let parent=scan.parent;(layers||(layers=[inner])).push(parent.resolve(pos,side)),scan=parent}else{let mount=MountedTree$1.get(scan.tree);if(mount&&mount.overlay&&mount.overlay[0].from<=pos&&mount.overlay[mount.overlay.length-1].to>=pos){let root=new TreeNode$1(mount.tree,mount.overlay[0].from+scan.from,0,null);(layers||(layers=[inner])).push(resolveNode$1(root,pos,side,!1))}}return layers?iterStack$1(layers):inner}(this,pos,side)}iterate(spec){let{enter:enter,leave:leave,from:from=0,to:to=this.length}=spec,mode=spec.mode||0,anon=(mode&IterMode$1.IncludeAnonymous)>0;for(let c=this.cursor(mode|IterMode$1.IncludeAnonymous);;){let entered=!1;if(c.from<=to&&c.to>=from&&(!anon&&c.type.isAnonymous||!1!==enter(c))){if(c.firstChild())continue;entered=!0}for(;entered&&leave&&(anon||!c.type.isAnonymous)&&leave(c),!c.nextSibling();){if(!c.parent())return;entered=!0}}}prop(prop){return prop.perNode?this.props?this.props[prop.id]:void 0:this.type.prop(prop)}get propValues(){let result=[];if(this.props)for(let id2 in this.props)result.push([+id2,this.props[id2]]);return result}balance(config2={}){return this.children.length<=8?this:balanceRange$1(NodeType$1.none,this.children,this.positions,0,this.children.length,0,this.length,((children2,positions,length)=>new Tree2(this.type,children2,positions,length,this.propValues)),config2.makeTree||((children2,positions,length)=>new Tree2(NodeType$1.none,children2,positions,length)))}static build(data2){return function(data2){var _a2;let{buffer:buffer,nodeSet:nodeSet,maxBufferLength:maxBufferLength=DefaultBufferLength$1,reused:reused=[],minRepeatType:minRepeatType=nodeSet.types.length}=data2,cursor2=Array.isArray(buffer)?new FlatBufferCursor$1(buffer,buffer.length):buffer,types2=nodeSet.types,contextHash=0,lookAhead=0;function takeNode(parentStart,minPos,children3,positions2,inRepeat){let{id:id2,start:start2,end:end2,size:size}=cursor2,lookAheadAtStart=lookAhead;for(;size<0;){if(cursor2.next(),-1==size){let node2=reused[id2];return children3.push(node2),void positions2.push(start2-parentStart)}if(-3==size)return void(contextHash=id2);if(-4==size)return void(lookAhead=id2);throw new RangeError(`Unrecognized record size: ${size}`)}let node,buffer2,type2=types2[id2],startPos=start2-parentStart;if(end2-start2<=maxBufferLength&&(buffer2=findBufferSize(cursor2.pos-minPos,inRepeat))){let data3=new Uint16Array(buffer2.size-buffer2.skip),endPos=cursor2.pos-buffer2.size,index=data3.length;for(;cursor2.pos>endPos;)index=copyToBuffer(buffer2.start,data3,index);node=new TreeBuffer$1(data3,end2-buffer2.start,nodeSet),startPos=buffer2.start-parentStart}else{let endPos=cursor2.pos-size;cursor2.next();let localChildren=[],localPositions=[],localInRepeat=id2>=minRepeatType?id2:-1,lastGroup=0,lastEnd=end2;for(;cursor2.pos>endPos;)localInRepeat>=0&&cursor2.id==localInRepeat&&cursor2.size>=0?(cursor2.end<=lastEnd-maxBufferLength&&(makeRepeatLeaf(localChildren,localPositions,start2,lastGroup,cursor2.end,lastEnd,localInRepeat,lookAheadAtStart),lastGroup=localChildren.length,lastEnd=cursor2.end),cursor2.next()):takeNode(start2,endPos,localChildren,localPositions,localInRepeat);if(localInRepeat>=0&&lastGroup>0&&lastGroup<localChildren.length&&makeRepeatLeaf(localChildren,localPositions,start2,lastGroup,start2,lastEnd,localInRepeat,lookAheadAtStart),localChildren.reverse(),localPositions.reverse(),localInRepeat>-1&&lastGroup>0){let make=makeBalanced(type2);node=balanceRange$1(type2,localChildren,localPositions,0,localChildren.length,0,end2-start2,make,make)}else node=makeTree(type2,localChildren,localPositions,end2-start2,lookAheadAtStart-end2)}children3.push(node),positions2.push(startPos)}function makeBalanced(type2){return(children3,positions2,length2)=>{let last,lookAheadProp,lookAhead2=0,lastI=children3.length-1;if(lastI>=0&&(last=children3[lastI])instanceof Tree$1){if(!lastI&&last.type==type2&&last.length==length2)return last;(lookAheadProp=last.prop(NodeProp$1.lookAhead))&&(lookAhead2=positions2[lastI]+last.length+lookAheadProp)}return makeTree(type2,children3,positions2,length2,lookAhead2)}}function makeRepeatLeaf(children3,positions2,base2,i2,from,to,type2,lookAhead2){let localChildren=[],localPositions=[];for(;children3.length>i2;)localChildren.push(children3.pop()),localPositions.push(positions2.pop()+base2-from);children3.push(makeTree(nodeSet.types[type2],localChildren,localPositions,to-from,lookAhead2-to)),positions2.push(from-base2)}function makeTree(type2,children3,positions2,length2,lookAhead2=0,props){if(contextHash){let pair2=[NodeProp$1.contextHash,contextHash];props=props?[pair2].concat(props):[pair2]}if(lookAhead2>25){let pair2=[NodeProp$1.lookAhead,lookAhead2];props=props?[pair2].concat(props):[pair2]}return new Tree$1(type2,children3,positions2,length2,props)}function findBufferSize(maxSize,inRepeat){let fork=cursor2.fork(),size=0,start2=0,skip=0,minStart=fork.end-maxBufferLength,result={size:0,start:0,skip:0};scan:for(let minPos=fork.pos-maxSize;fork.pos>minPos;){let nodeSize2=fork.size;if(fork.id==inRepeat&&nodeSize2>=0){result.size=size,result.start=start2,result.skip=skip,skip+=4,size+=4,fork.next();continue}let startPos=fork.pos-nodeSize2;if(nodeSize2<0||startPos<minPos||fork.start<minStart)break;let localSkipped=fork.id>=minRepeatType?4:0,nodeStart2=fork.start;for(fork.next();fork.pos>startPos;){if(fork.size<0){if(-3!=fork.size)break scan;localSkipped+=4}else fork.id>=minRepeatType&&(localSkipped+=4);fork.next()}start2=nodeStart2,size+=nodeSize2,skip+=localSkipped}return(inRepeat<0||size==maxSize)&&(result.size=size,result.start=start2,result.skip=skip),result.size>4?result:void 0}function copyToBuffer(bufferStart,buffer2,index){let{id:id2,start:start2,end:end2,size:size}=cursor2;if(cursor2.next(),size>=0&&id2<minRepeatType){let startIndex=index;if(size>4){let endPos=cursor2.pos-(size-4);for(;cursor2.pos>endPos;)index=copyToBuffer(bufferStart,buffer2,index)}buffer2[--index]=startIndex,buffer2[--index]=end2-bufferStart,buffer2[--index]=start2-bufferStart,buffer2[--index]=id2}else-3==size?contextHash=id2:-4==size&&(lookAhead=id2);return index}let children2=[],positions=[];for(;cursor2.pos>0;)takeNode(data2.start||0,data2.bufferStart||0,children2,positions,-1);let length=null!==(_a2=data2.length)&&void 0!==_a2?_a2:children2.length?positions[0]+children2[0].length:0;return new Tree$1(types2[data2.topID],children2.reverse(),positions.reverse(),length)}(data2)}};Tree$1.empty=new Tree$1(NodeType$1.none,[],[],0);let FlatBufferCursor$1=class FlatBufferCursor2{constructor(buffer,index){this.buffer=buffer,this.index=index}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new FlatBufferCursor2(this.buffer,this.index)}},TreeBuffer$1=class TreeBuffer2{constructor(buffer,length,set2){this.buffer=buffer,this.length=length,this.set=set2}get type(){return NodeType$1.none}toString(){let result=[];for(let index=0;index<this.buffer.length;)result.push(this.childString(index)),index=this.buffer[index+3];return result.join(",")}childString(index){let id2=this.buffer[index],endIndex=this.buffer[index+3],type2=this.set.types[id2],result=type2.name;if(/\W/.test(result)&&!type2.isError&&(result=JSON.stringify(result)),endIndex==(index+=4))return result;let children2=[];for(;index<endIndex;)children2.push(this.childString(index)),index=this.buffer[index+3];return result+"("+children2.join(",")+")"}findChild(startIndex,endIndex,dir,pos,side){let{buffer:buffer}=this,pick=-1;for(let i2=startIndex;i2!=endIndex&&!(checkSide$1(side,pos,buffer[i2+1],buffer[i2+2])&&(pick=i2,dir>0));i2=buffer[i2+3]);return pick}slice(startI,endI,from){let b=this.buffer,copy=new Uint16Array(endI-startI),len=0;for(let i2=startI,j=0;i2<endI;){copy[j++]=b[i2++],copy[j++]=b[i2++]-from;let to=copy[j++]=b[i2++]-from;copy[j++]=b[i2++]-startI,len=Math.max(len,to)}return new TreeBuffer2(copy,len,this.set)}};function checkSide$1(side,pos,from,to){switch(side){case-2:return from<pos;case-1:return to>=pos&&from<pos;case 0:return from<pos&&to>pos;case 1:return from<=pos&&to>pos;case 2:return to>pos;case 4:return!0}}function resolveNode$1(node,pos,side,overlays){for(var _a2;node.from==node.to||(side<1?node.from>=pos:node.from>pos)||(side>-1?node.to<=pos:node.to<pos);){let parent=!overlays&&node instanceof TreeNode$1&&node.index<0?null:node.parent;if(!parent)return node;node=parent}let mode=overlays?0:IterMode$1.IgnoreOverlays;if(overlays)for(let scan=node,parent=scan.parent;parent;scan=parent,parent=scan.parent)scan instanceof TreeNode$1&&scan.index<0&&(null===(_a2=parent.enter(pos,side,mode))||void 0===_a2?void 0:_a2.from)!=scan.from&&(node=parent);for(;;){let inner=node.enter(pos,side,mode);if(!inner)return node;node=inner}}let BaseNode$1=class{cursor(mode=0){return new TreeCursor$1(this,mode)}getChild(type2,before=null,after=null){let r=getChildren$1(this,type2,before,after);return r.length?r[0]:null}getChildren(type2,before=null,after=null){return getChildren$1(this,type2,before,after)}resolve(pos,side=0){return resolveNode$1(this,pos,side,!1)}resolveInner(pos,side=0){return resolveNode$1(this,pos,side,!0)}matchContext(context){return matchNodeContext$1(this,context)}enterUnfinishedNodesBefore(pos){let scan=this.childBefore(pos),node=this;for(;scan;){let last=scan.lastChild;if(!last||last.to!=scan.to)break;last.type.isError&&last.from==last.to?(node=scan,scan=last.prevSibling):scan=last}return node}get node(){return this}get next(){return this.parent}},TreeNode$1=class TreeNode2 extends BaseNode$1{constructor(_tree,from,index,_parent){super(),this._tree=_tree,this.from=from,this.index=index,this._parent=_parent}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(i2,dir,pos,side,mode=0){for(let parent=this;;){for(let{children:children2,positions:positions}=parent._tree,e=dir>0?children2.length:-1;i2!=e;i2+=dir){let next=children2[i2],start2=positions[i2]+parent.from;if(checkSide$1(side,pos,start2,start2+next.length))if(next instanceof TreeBuffer$1){if(mode&IterMode$1.ExcludeBuffers)continue;let index=next.findChild(0,next.buffer.length,dir,pos-start2,side);if(index>-1)return new BufferNode$1(new BufferContext$1(parent,next,i2,start2),null,index)}else if(mode&IterMode$1.IncludeAnonymous||!next.type.isAnonymous||hasChild$1(next)){let mounted;if(!(mode&IterMode$1.IgnoreMounts)&&(mounted=MountedTree$1.get(next))&&!mounted.overlay)return new TreeNode2(mounted.tree,start2,i2,parent);let inner=new TreeNode2(next,start2,i2,parent);return mode&IterMode$1.IncludeAnonymous||!inner.type.isAnonymous?inner:inner.nextChild(dir<0?next.children.length-1:0,dir,pos,side)}}if(mode&IterMode$1.IncludeAnonymous||!parent.type.isAnonymous)return null;if(i2=parent.index>=0?parent.index+dir:dir<0?-1:parent._parent._tree.children.length,parent=parent._parent,!parent)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(pos){return this.nextChild(0,1,pos,2)}childBefore(pos){return this.nextChild(this._tree.children.length-1,-1,pos,-2)}enter(pos,side,mode=0){let mounted;if(!(mode&IterMode$1.IgnoreOverlays)&&(mounted=MountedTree$1.get(this._tree))&&mounted.overlay){let rPos=pos-this.from;for(let{from:from,to:to}of mounted.overlay)if((side>0?from<=rPos:from<rPos)&&(side<0?to>=rPos:to>rPos))return new TreeNode2(mounted.tree,mounted.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,pos,side,mode)}nextSignificantParent(){let val=this;for(;val.type.isAnonymous&&val._parent;)val=val._parent;return val}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function getChildren$1(node,type2,before,after){let cur2=node.cursor(),result=[];if(!cur2.firstChild())return result;if(null!=before)for(;!cur2.type.is(before);)if(!cur2.nextSibling())return result;for(;;){if(null!=after&&cur2.type.is(after))return result;if(cur2.type.is(type2)&&result.push(cur2.node),!cur2.nextSibling())return null==after?result:[]}}function matchNodeContext$1(node,context,i2=context.length-1){for(let p=node.parent;i2>=0;p=p.parent){if(!p)return!1;if(!p.type.isAnonymous){if(context[i2]&&context[i2]!=p.name)return!1;i2--}}return!0}let BufferContext$1=class{constructor(parent,buffer,index,start2){this.parent=parent,this.buffer=buffer,this.index=index,this.start=start2}},BufferNode$1=class BufferNode2 extends BaseNode$1{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(context,_parent,index){super(),this.context=context,this._parent=_parent,this.index=index,this.type=context.buffer.set.types[context.buffer.buffer[index]]}child(dir,pos,side){let{buffer:buffer}=this.context,index=buffer.findChild(this.index+4,buffer.buffer[this.index+3],dir,pos-this.context.start,side);return index<0?null:new BufferNode2(this.context,this,index)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(pos){return this.child(1,pos,2)}childBefore(pos){return this.child(-1,pos,-2)}enter(pos,side,mode=0){if(mode&IterMode$1.ExcludeBuffers)return null;let{buffer:buffer}=this.context,index=buffer.findChild(this.index+4,buffer.buffer[this.index+3],side>0?1:-1,pos-this.context.start,side);return index<0?null:new BufferNode2(this.context,this,index)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(dir){return this._parent?null:this.context.parent.nextChild(this.context.index+dir,dir,0,4)}get nextSibling(){let{buffer:buffer}=this.context,after=buffer.buffer[this.index+3];return after<(this._parent?buffer.buffer[this._parent.index+3]:buffer.buffer.length)?new BufferNode2(this.context,this._parent,after):this.externalSibling(1)}get prevSibling(){let{buffer:buffer}=this.context,parentStart=this._parent?this._parent.index+4:0;return this.index==parentStart?this.externalSibling(-1):new BufferNode2(this.context,this._parent,buffer.findChild(parentStart,this.index,-1,0,4))}get tree(){return null}toTree(){let children2=[],positions=[],{buffer:buffer}=this.context,startI=this.index+4,endI=buffer.buffer[this.index+3];if(endI>startI){let from=buffer.buffer[this.index+1];children2.push(buffer.slice(startI,endI,from)),positions.push(0)}return new Tree$1(this.type,children2,positions,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function iterStack$1(heads){if(!heads.length)return null;if(1==heads.length)return heads[0];let pick=0,picked=heads[0];for(let i2=1;i2<heads.length;i2++){let node=heads[i2];(node.from>picked.from||node.to<picked.to)&&(picked=node,pick=i2)}let next=picked instanceof TreeNode$1&&picked.index<0?null:picked.parent,newHeads=heads.slice();return next?newHeads[pick]=next:newHeads.splice(pick,1),new StackIterator$1(newHeads,picked)}let StackIterator$1=class{constructor(heads,node){this.heads=heads,this.node=node}get next(){return iterStack$1(this.heads)}};let TreeCursor$1=class{get name(){return this.type.name}constructor(node,mode=0){if(this.mode=mode,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,node instanceof TreeNode$1)this.yieldNode(node);else{this._tree=node.context.parent,this.buffer=node.context;for(let n=node._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=node,this.yieldBuf(node.index)}}yieldNode(node){return!!node&&(this._tree=node,this.type=node.type,this.from=node.from,this.to=node.to,!0)}yieldBuf(index,type2){this.index=index;let{start:start2,buffer:buffer}=this.buffer;return this.type=type2||buffer.set.types[buffer.buffer[index]],this.from=start2+buffer.buffer[index+1],this.to=start2+buffer.buffer[index+2],!0}yield(node){return!!node&&(node instanceof TreeNode$1?(this.buffer=null,this.yieldNode(node)):(this.buffer=node.context,this.yieldBuf(node.index,node.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(dir,pos,side){if(!this.buffer)return this.yield(this._tree.nextChild(dir<0?this._tree._tree.children.length-1:0,dir,pos,side,this.mode));let{buffer:buffer}=this.buffer,index=buffer.findChild(this.index+4,buffer.buffer[this.index+3],dir,pos-this.buffer.start,side);return!(index<0)&&(this.stack.push(this.index),this.yieldBuf(index))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(pos){return this.enterChild(1,pos,2)}childBefore(pos){return this.enterChild(-1,pos,-2)}enter(pos,side,mode=this.mode){return this.buffer?!(mode&IterMode$1.ExcludeBuffers)&&this.enterChild(1,pos,side):this.yield(this._tree.enter(pos,side,mode))}parent(){if(!this.buffer)return this.yieldNode(this.mode&IterMode$1.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let parent=this.mode&IterMode$1.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(parent)}sibling(dir){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+dir,dir,0,4,this.mode));let{buffer:buffer}=this.buffer,d=this.stack.length-1;if(dir<0){let parentStart=d<0?0:this.stack[d]+4;if(this.index!=parentStart)return this.yieldBuf(buffer.findChild(parentStart,this.index,-1,0,4))}else{let after=buffer.buffer[this.index+3];if(after<(d<0?buffer.buffer.length:buffer.buffer[this.stack[d]+3]))return this.yieldBuf(after)}return d<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+dir,dir,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(dir){let index,parent,{buffer:buffer}=this;if(buffer){if(dir>0){if(this.index<buffer.buffer.buffer.length)return!1}else for(let i2=0;i2<this.index;i2++)if(buffer.buffer.buffer[i2+3]<this.index)return!1;({index:index,parent:parent}=buffer)}else({index:index,_parent:parent}=this._tree);for(;parent;({index:index,_parent:parent}=parent))if(index>-1)for(let i2=index+dir,e=dir<0?-1:parent._tree.children.length;i2!=e;i2+=dir){let child=parent._tree.children[i2];if(this.mode&IterMode$1.IncludeAnonymous||child instanceof TreeBuffer$1||!child.type.isAnonymous||hasChild$1(child))return!1}return!0}move(dir,enter){if(enter&&this.enterChild(dir,0,4))return!0;for(;;){if(this.sibling(dir))return!0;if(this.atLastNode(dir)||!this.parent())return!1}}next(enter=!0){return this.move(1,enter)}prev(enter=!0){return this.move(-1,enter)}moveTo(pos,side=0){for(;(this.from==this.to||(side<1?this.from>=pos:this.from>pos)||(side>-1?this.to<=pos:this.to<pos))&&this.parent(););for(;this.enterChild(1,pos,side););return this}get node(){if(!this.buffer)return this._tree;let cache=this.bufferNode,result=null,depth=0;if(cache&&cache.context==this.buffer)scan:for(let index=this.index,d=this.stack.length;d>=0;){for(let c=cache;c;c=c._parent)if(c.index==index){if(index==this.index)return c;result=c,depth=d+1;break scan}index=this.stack[--d]}for(let i2=depth;i2<this.stack.length;i2++)result=new BufferNode$1(this.buffer,result,this.stack[i2]);return this.bufferNode=new BufferNode$1(this.buffer,result,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(enter,leave){for(let depth=0;;){let mustLeave=!1;if(this.type.isAnonymous||!1!==enter(this)){if(this.firstChild()){depth++;continue}this.type.isAnonymous||(mustLeave=!0)}for(;mustLeave&&leave&&leave(this),mustLeave=this.type.isAnonymous,!this.nextSibling();){if(!depth)return;this.parent(),depth--,mustLeave=!0}}}matchContext(context){if(!this.buffer)return matchNodeContext$1(this.node,context);let{buffer:buffer}=this.buffer,{types:types2}=buffer.set;for(let i2=context.length-1,d=this.stack.length-1;i2>=0;d--){if(d<0)return matchNodeContext$1(this.node,context,i2);let type2=types2[buffer.buffer[this.stack[d]]];if(!type2.isAnonymous){if(context[i2]&&context[i2]!=type2.name)return!1;i2--}}return!0}};function hasChild$1(tree){return tree.children.some((ch=>ch instanceof TreeBuffer$1||!ch.type.isAnonymous||hasChild$1(ch)))}const nodeSizeCache$1=new WeakMap;function nodeSize$1(balanceType,node){if(!balanceType.isAnonymous||node instanceof TreeBuffer$1||node.type!=balanceType)return 1;let size=nodeSizeCache$1.get(node);if(null==size){size=1;for(let child of node.children){if(child.type!=balanceType||!(child instanceof Tree$1)){size=1;break}size+=nodeSize$1(balanceType,child)}nodeSizeCache$1.set(node,size)}return size}function balanceRange$1(balanceType,children2,positions,from,to,start2,length,mkTop,mkTree){let total=0;for(let i2=from;i2<to;i2++)total+=nodeSize$1(balanceType,children2[i2]);let maxChild=Math.ceil(1.5*total/8),localChildren=[],localPositions=[];return function divide(children3,positions2,from2,to2,offset2){for(let i2=from2;i2<to2;){let groupFrom=i2,groupStart=positions2[i2],groupSize=nodeSize$1(balanceType,children3[i2]);for(i2++;i2<to2;i2++){let nextSize=nodeSize$1(balanceType,children3[i2]);if(groupSize+nextSize>=maxChild)break;groupSize+=nextSize}if(i2==groupFrom+1){if(groupSize>maxChild){let only=children3[groupFrom];divide(only.children,only.positions,0,only.children.length,positions2[groupFrom]+offset2);continue}localChildren.push(children3[groupFrom])}else{let length2=positions2[i2-1]+children3[i2-1].length-groupStart;localChildren.push(balanceRange$1(balanceType,children3,positions2,groupFrom,i2,groupStart,length2,null,mkTree))}localPositions.push(groupStart+offset2-start2)}}(children2,positions,from,to,0),(mkTop||mkTree)(localChildren,localPositions,length)}class TreeFragment{constructor(from,to,tree,offset2,openStart=!1,openEnd=!1){this.from=from,this.to=to,this.tree=tree,this.offset=offset2,this.open=(openStart?1:0)|(openEnd?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(tree,fragments=[],partial=!1){let result=[new TreeFragment(0,tree.length,tree,0,!1,partial)];for(let f of fragments)f.to>tree.length&&result.push(f);return result}static applyChanges(fragments,changes,minGap=128){if(!changes.length)return fragments;let result=[],fI=1,nextF=fragments.length?fragments[0]:null;for(let cI=0,pos=0,off=0;;cI++){let nextC=cI<changes.length?changes[cI]:null,nextPos=nextC?nextC.fromA:1e9;if(nextPos-pos>=minGap)for(;nextF&&nextF.from<nextPos;){let cut=nextF;if(pos>=cut.from||nextPos<=cut.to||off){let fFrom=Math.max(cut.from,pos)-off,fTo=Math.min(cut.to,nextPos)-off;cut=fFrom>=fTo?null:new TreeFragment(fFrom,fTo,cut.tree,cut.offset+off,cI>0,!!nextC)}if(cut&&result.push(cut),nextF.to>nextPos)break;nextF=fI<fragments.length?fragments[fI++]:null}if(!nextC)break;pos=nextC.toA,off=nextC.toA-nextC.toB}return result}}class Parser{startParse(input,fragments,ranges){return"string"==typeof input&&(input=new StringInput(input)),ranges=ranges?ranges.length?ranges.map((r=>new Range(r.from,r.to))):[new Range(0,0)]:[new Range(0,input.length)],this.createParse(input,fragments||[],ranges)}parse(input,fragments,ranges){let parse=this.startParse(input,fragments,ranges);for(;;){let done=parse.advance();if(done)return done}}}class StringInput{constructor(string2){this.string=string2}get length(){return this.string.length}chunk(from){return this.string.slice(from)}get lineChunks(){return!1}read(from,to){return this.string.slice(from,to)}}function getSelection(root){let target;return target=11==root.nodeType?root.getSelection?root:root.ownerDocument:root,target.getSelection()}function contains(dom,node){return!!node&&(dom==node||dom.contains(1!=node.nodeType?node.parentNode:node))}function hasSelection(dom,selection2){if(!selection2.anchorNode)return!1;try{return contains(dom,selection2.anchorNode)}catch(_){return!1}}function clientRectsFor(dom){return 3==dom.nodeType?textRange(dom,0,dom.nodeValue.length).getClientRects():1==dom.nodeType?dom.getClientRects():[]}function isEquivalentPosition(node,off,targetNode,targetOff){return!!targetNode&&(scanFor(node,off,targetNode,targetOff,-1)||scanFor(node,off,targetNode,targetOff,1))}function domIndex(node){for(var index=0;;index++)if(!(node=node.previousSibling))return index}function scanFor(node,off,targetNode,targetOff,dir){for(;;){if(node==targetNode&&off==targetOff)return!0;if(off==(dir<0?0:maxOffset(node))){if("DIV"==node.nodeName)return!1;let parent=node.parentNode;if(!parent||1!=parent.nodeType)return!1;off=domIndex(node)+(dir<0?0:1),node=parent}else{if(1!=node.nodeType)return!1;if(1==(node=node.childNodes[off+(dir<0?-1:0)]).nodeType&&"false"==node.contentEditable)return!1;off=dir<0?maxOffset(node):0}}}function maxOffset(node){return 3==node.nodeType?node.nodeValue.length:node.childNodes.length}function flattenRect(rect,left2){let x=left2?rect.left:rect.right;return{left:x,right:x,top:rect.top,bottom:rect.bottom}}function windowRect(win){return{left:0,right:win.innerWidth,top:0,bottom:win.innerHeight}}new NodeProp$1({perNode:!0});class DOMSelectionState{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(domSel){return this.anchorNode==domSel.anchorNode&&this.anchorOffset==domSel.anchorOffset&&this.focusNode==domSel.focusNode&&this.focusOffset==domSel.focusOffset}setRange(range){let{anchorNode:anchorNode,focusNode:focusNode}=range;this.set(anchorNode,Math.min(range.anchorOffset,anchorNode?maxOffset(anchorNode):0),focusNode,Math.min(range.focusOffset,focusNode?maxOffset(focusNode):0))}set(anchorNode,anchorOffset,focusNode,focusOffset){this.anchorNode=anchorNode,this.anchorOffset=anchorOffset,this.focusNode=focusNode,this.focusOffset=focusOffset}}let scratchRange,preventScrollSupported=null;function focusPreventScroll(dom){if(dom.setActive)return dom.setActive();if(preventScrollSupported)return dom.focus(preventScrollSupported);let stack=[];for(let cur2=dom;cur2&&(stack.push(cur2,cur2.scrollTop,cur2.scrollLeft),cur2!=cur2.ownerDocument);cur2=cur2.parentNode);if(dom.focus(null==preventScrollSupported?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),!preventScrollSupported){preventScrollSupported=!1;for(let i2=0;i2<stack.length;){let elt=stack[i2++],top2=stack[i2++],left2=stack[i2++];elt.scrollTop!=top2&&(elt.scrollTop=top2),elt.scrollLeft!=left2&&(elt.scrollLeft=left2)}}}function textRange(node,from,to=from){let range=scratchRange||(scratchRange=document.createRange());return range.setEnd(node,to),range.setStart(node,from),range}function dispatchKey(elt,name2,code2){let options={key:name2,code:name2,keyCode:code2,which:code2,cancelable:!0},down=new KeyboardEvent("keydown",options);down.synthetic=!0,elt.dispatchEvent(down);let up=new KeyboardEvent("keyup",options);return up.synthetic=!0,elt.dispatchEvent(up),down.defaultPrevented||up.defaultPrevented}function clearAttributes(node){for(;node.attributes.length;)node.removeAttributeNode(node.attributes[0])}function isScrolledToBottom(elt){return elt.scrollTop>Math.max(1,elt.scrollHeight-elt.clientHeight-4)}class DOMPos{constructor(node,offset2,precise=!0){this.node=node,this.offset=offset2,this.precise=precise}static before(dom,precise){return new DOMPos(dom.parentNode,domIndex(dom),precise)}static after(dom,precise){return new DOMPos(dom.parentNode,domIndex(dom)+1,precise)}}const noChildren=[];class ContentView{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(view){let pos=this.posAtStart;for(let child of this.children){if(child==view)return pos;pos+=child.length+child.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(view){return this.posBefore(view)+view.length}sync(view,track){if(2&this.flags){let next,parent=this.dom,prev=null;for(let child of this.children){if(7&child.flags){if(!child.dom&&(next=prev?prev.nextSibling:parent.firstChild)){let contentView=ContentView.get(next);(!contentView||!contentView.parent&&contentView.canReuseDOM(child))&&child.reuseDOM(next)}child.sync(view,track),child.flags&=-8}if(next=prev?prev.nextSibling:parent.firstChild,track&&!track.written&&track.node==parent&&next!=child.dom&&(track.written=!0),child.dom.parentNode==parent)for(;next&&next!=child.dom;)next=rm$1(next);else parent.insertBefore(child.dom,next);prev=child.dom}for(next=prev?prev.nextSibling:parent.firstChild,next&&track&&track.node==parent&&(track.written=!0);next;)next=rm$1(next)}else if(1&this.flags)for(let child of this.children)7&child.flags&&(child.sync(view,track),child.flags&=-8)}reuseDOM(_dom){}localPosFromDOM(node,offset2){let after;if(node==this.dom)after=this.dom.childNodes[offset2];else{let bias=0==maxOffset(node)?0:0==offset2?-1:1;for(;;){let parent=node.parentNode;if(parent==this.dom)break;0==bias&&parent.firstChild!=parent.lastChild&&(bias=node==parent.firstChild?-1:1),node=parent}after=bias<0?node:node.nextSibling}if(after==this.dom.firstChild)return 0;for(;after&&!ContentView.get(after);)after=after.nextSibling;if(!after)return this.length;for(let i2=0,pos=0;;i2++){let child=this.children[i2];if(child.dom==after)return pos;pos+=child.length+child.breakAfter}}domBoundsAround(from,to,offset2=0){let fromI=-1,fromStart=-1,toI=-1,toEnd=-1;for(let i2=0,pos=offset2,prevEnd=offset2;i2<this.children.length;i2++){let child=this.children[i2],end2=pos+child.length;if(pos<from&&end2>to)return child.domBoundsAround(from,to,pos);if(end2>=from&&-1==fromI&&(fromI=i2,fromStart=pos),pos>to&&child.dom.parentNode==this.dom){toI=i2,toEnd=prevEnd;break}prevEnd=end2,pos=end2+child.breakAfter}return{from:fromStart,to:toEnd<0?offset2+this.length:toEnd,startDOM:(fromI?this.children[fromI-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:toI<this.children.length&&toI>=0?this.children[toI].dom:null}}markDirty(andParent=!1){this.flags|=2,this.markParentsDirty(andParent)}markParentsDirty(childList){for(let parent=this.parent;parent;parent=parent.parent){if(childList&&(parent.flags|=2),1&parent.flags)return;parent.flags|=1,childList=!1}}setParent(parent){this.parent!=parent&&(this.parent=parent,7&this.flags&&this.markParentsDirty(!0))}setDOM(dom){this.dom!=dom&&(this.dom&&(this.dom.cmView=null),this.dom=dom,dom.cmView=this)}get rootView(){for(let v=this;;){let parent=v.parent;if(!parent)return v;v=parent}}replaceChildren(from,to,children2=noChildren){this.markDirty();for(let i2=from;i2<to;i2++){let child=this.children[i2];child.parent==this&&child.destroy()}this.children.splice(from,to-from,...children2);for(let i2=0;i2<children2.length;i2++)children2[i2].setParent(this)}ignoreMutation(_rec){return!1}ignoreEvent(_event){return!1}childCursor(pos=this.length){return new ChildCursor(this.children,pos,this.children.length)}childPos(pos,bias=1){return this.childCursor().findPos(pos,bias)}toString(){let name2=this.constructor.name.replace("View","");return name2+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==name2?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(node){return node.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(from,to,source,hasStart,openStart,openEnd){return!1}become(other){return!1}canReuseDOM(other){return other.constructor==this.constructor&&!(8&(this.flags|other.flags))}getSide(){return 0}destroy(){this.parent=null}}function rm$1(dom){let next=dom.nextSibling;return dom.parentNode.removeChild(dom),next}ContentView.prototype.breakAfter=0;class ChildCursor{constructor(children2,pos,i2){this.children=children2,this.pos=pos,this.i=i2,this.off=0}findPos(pos,bias=1){for(;;){if(pos>this.pos||pos==this.pos&&(bias>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=pos-this.pos,this;let next=this.children[--this.i];this.pos-=next.length+next.breakAfter}}}function replaceRange(parent,fromI,fromOff,toI,toOff,insert2,breakAtStart,openStart,openEnd){let{children:children2}=parent,before=children2.length?children2[fromI]:null,last=insert2.length?insert2[insert2.length-1]:null,breakAtEnd=last?last.breakAfter:breakAtStart;if(!(fromI==toI&&before&&!breakAtStart&&!breakAtEnd&&insert2.length<2&&before.merge(fromOff,toOff,insert2.length?last:null,0==fromOff,openStart,openEnd))){if(toI<children2.length){let after=children2[toI];after&&(toOff<after.length||after.breakAfter&&(null==last?void 0:last.breakAfter))?(fromI==toI&&(after=after.split(toOff),toOff=0),!breakAtEnd&&last&&after.merge(0,toOff,last,!0,0,openEnd)?insert2[insert2.length-1]=after:((toOff||after.children.length&&!after.children[0].length)&&after.merge(0,toOff,null,!1,0,openEnd),insert2.push(after))):(null==after?void 0:after.breakAfter)&&(last?last.breakAfter=1:breakAtStart=1),toI++}for(before&&(before.breakAfter=breakAtStart,fromOff>0&&(!breakAtStart&&insert2.length&&before.merge(fromOff,before.length,insert2[0],!1,openStart,0)?before.breakAfter=insert2.shift().breakAfter:(fromOff<before.length||before.children.length&&0==before.children[before.children.length-1].length)&&before.merge(fromOff,before.length,null,!1,openStart,0),fromI++));fromI<toI&&insert2.length;)if(children2[toI-1].become(insert2[insert2.length-1]))toI--,insert2.pop(),openEnd=insert2.length?0:openStart;else{if(!children2[fromI].become(insert2[0]))break;fromI++,insert2.shift(),openStart=insert2.length?0:openEnd}!insert2.length&&fromI&&toI<children2.length&&!children2[fromI-1].breakAfter&&children2[toI].merge(0,0,children2[fromI-1],!1,openStart,openEnd)&&fromI--,(fromI<toI||insert2.length)&&parent.replaceChildren(fromI,toI,insert2)}}function mergeChildrenInto(parent,from,to,insert2,openStart,openEnd){let cur2=parent.childCursor(),{i:toI,off:toOff}=cur2.findPos(to,1),{i:fromI,off:fromOff}=cur2.findPos(from,-1),dLen=from-to;for(let view of insert2)dLen+=view.length;parent.length+=dLen,replaceRange(parent,fromI,fromOff,toI,toOff,insert2,0,openStart,openEnd)}let nav="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},doc="undefined"!=typeof document?document:{documentElement:{style:{}}};const ie_edge=/Edge\/(\d+)/.exec(nav.userAgent),ie_upto10=/MSIE \d/.test(nav.userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav.userAgent),ie=!!(ie_upto10||ie_11up||ie_edge),gecko=!ie&&/gecko\/(\d+)/i.test(nav.userAgent),chrome$1=!ie&&/Chrome\/(\d+)/.exec(nav.userAgent),webkit="webkitFontSmoothing"in doc.documentElement.style,safari=!ie&&/Apple Computer/.test(nav.vendor),ios=safari&&(/Mobile\/\w+/.test(nav.userAgent)||nav.maxTouchPoints>2);var browser$1={mac:ios||/Mac/.test(nav.platform),windows:/Win/.test(nav.platform),linux:/Linux|X11/.test(nav.platform),ie:ie,ie_version:ie_upto10?doc.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko:gecko,gecko_version:gecko?+(/Firefox\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,chrome:!!chrome$1,chrome_version:chrome$1?+chrome$1[1]:0,ios:ios,android:/Android\b/.test(nav.userAgent),webkit:webkit,safari:safari,webkit_version:webkit?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=doc.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class TextView extends ContentView{constructor(text2){super(),this.text=text2}get length(){return this.text.length}createDOM(textDOM){this.setDOM(textDOM||document.createTextNode(this.text))}sync(view,track){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(track&&track.node==this.dom&&(track.written=!0),this.dom.nodeValue=this.text)}reuseDOM(dom){3==dom.nodeType&&this.createDOM(dom)}merge(from,to,source){return!(8&this.flags||source&&(!(source instanceof TextView)||this.length-(to-from)+source.length>256||8&source.flags))&&(this.text=this.text.slice(0,from)+(source?source.text:"")+this.text.slice(to),this.markDirty(),!0)}split(from){let result=new TextView(this.text.slice(from));return this.text=this.text.slice(0,from),this.markDirty(),result.flags|=8&this.flags,result}localPosFromDOM(node,offset2){return node==this.dom?offset2:offset2?this.text.length:0}domAtPos(pos){return new DOMPos(this.dom,pos)}domBoundsAround(_from,_to,offset2){return{from:offset2,to:offset2+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(pos,side){return function(text2,pos,side){let length=text2.nodeValue.length;pos>length&&(pos=length);let from=pos,to=pos,flatten2=0;0==pos&&side<0||pos==length&&side>=0?browser$1.chrome||browser$1.gecko||(pos?(from--,flatten2=1):to<length&&(to++,flatten2=-1)):side<0?from--:to<length&&to++;let rects=textRange(text2,from,to).getClientRects();if(!rects.length)return null;let rect=rects[(flatten2?flatten2<0:side>=0)?0:rects.length-1];browser$1.safari&&!flatten2&&0==rect.width&&(rect=Array.prototype.find.call(rects,(r=>r.width))||rect);return flatten2?flattenRect(rect,flatten2<0):rect||null}(this.dom,pos,side)}}class MarkView extends ContentView{constructor(mark,children2=[],length=0){super(),this.mark=mark,this.children=children2,this.length=length;for(let ch of children2)ch.setParent(this)}setAttrs(dom){if(clearAttributes(dom),this.mark.class&&(dom.className=this.mark.class),this.mark.attrs)for(let name2 in this.mark.attrs)dom.setAttribute(name2,this.mark.attrs[name2]);return dom}canReuseDOM(other){return super.canReuseDOM(other)&&!(8&(this.flags|other.flags))}reuseDOM(node){node.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(node),this.flags|=6)}sync(view,track){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(view,track)}merge(from,to,source,_hasStart,openStart,openEnd){return(!source||!(!(source instanceof MarkView&&source.mark.eq(this.mark))||from&&openStart<=0||to<this.length&&openEnd<=0))&&(mergeChildrenInto(this,from,to,source?source.children:[],openStart-1,openEnd-1),this.markDirty(),!0)}split(from){let result=[],off=0,detachFrom=-1,i2=0;for(let elt of this.children){let end2=off+elt.length;end2>from&&result.push(off<from?elt.split(from-off):elt),detachFrom<0&&off>=from&&(detachFrom=i2),off=end2,i2++}let length=this.length-from;return this.length=from,detachFrom>-1&&(this.children.length=detachFrom,this.markDirty()),new MarkView(this.mark,result,length)}domAtPos(pos){return inlineDOMAtPos(this,pos)}coordsAt(pos,side){return coordsInChildren(this,pos,side)}}class WidgetView extends ContentView{static create(widget,length,side){return new WidgetView(widget,length,side)}constructor(widget,length,side){super(),this.widget=widget,this.length=length,this.side=side,this.prevWidget=null}split(from){let result=WidgetView.create(this.widget,this.length-from,this.side);return this.length-=from,result}sync(view){this.dom&&this.widget.updateDOM(this.dom,view)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(view)),this.dom.contentEditable="false")}getSide(){return this.side}merge(from,to,source,hasStart,openStart,openEnd){return!(source&&(!(source instanceof WidgetView&&this.widget.compare(source.widget))||from>0&&openStart<=0||to<this.length&&openEnd<=0))&&(this.length=from+(source?source.length:0)+(this.length-to),!0)}become(other){return other instanceof WidgetView&&other.side==this.side&&this.widget.constructor==other.widget.constructor&&(this.widget.compare(other.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=other.widget,this.length=other.length,!0)}ignoreMutation(){return!0}ignoreEvent(event){return this.widget.ignoreEvent(event)}get overrideDOMText(){if(0==this.length)return Text.empty;let top2=this;for(;top2.parent;)top2=top2.parent;let{view:view}=top2,text2=view&&view.state.doc,start2=this.posAtStart;return text2?text2.slice(start2,start2+this.length):Text.empty}domAtPos(pos){return(this.length?0==pos:this.side>0)?DOMPos.before(this.dom):DOMPos.after(this.dom,pos==this.length)}domBoundsAround(){return null}coordsAt(pos,side){let custom2=this.widget.coordsAt(this.dom,pos,side);if(custom2)return custom2;let rects=this.dom.getClientRects(),rect=null;if(!rects.length)return null;let fromBack=this.side?this.side<0:pos>0;for(let i2=fromBack?rects.length-1:0;rect=rects[i2],!(pos>0?0==i2:i2==rects.length-1||rect.top<rect.bottom);i2+=fromBack?-1:1);return flattenRect(rect,!fromBack)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class WidgetBufferView extends ContentView{constructor(side){super(),this.side=side}get length(){return 0}merge(){return!1}become(other){return other instanceof WidgetBufferView&&other.side==this.side}split(){return new WidgetBufferView(this.side)}sync(){if(!this.dom){let dom=document.createElement("img");dom.className="cm-widgetBuffer",dom.setAttribute("aria-hidden","true"),this.setDOM(dom)}}getSide(){return this.side}domAtPos(pos){return this.side>0?DOMPos.before(this.dom):DOMPos.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(pos){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Text.empty}get isHidden(){return!0}}function inlineDOMAtPos(parent,pos){let dom=parent.dom,{children:children2}=parent,i2=0;for(let off=0;i2<children2.length;i2++){let child=children2[i2],end2=off+child.length;if(!(end2==off&&child.getSide()<=0)){if(pos>off&&pos<end2&&child.dom.parentNode==dom)return child.domAtPos(pos-off);if(pos<=off)break;off=end2}}for(let j=i2;j>0;j--){let prev=children2[j-1];if(prev.dom.parentNode==dom)return prev.domAtPos(prev.length)}for(let j=i2;j<children2.length;j++){let next=children2[j];if(next.dom.parentNode==dom)return next.domAtPos(0)}return new DOMPos(dom,0)}function joinInlineInto(parent,view,open){let last,{children:children2}=parent;open>0&&view instanceof MarkView&&children2.length&&(last=children2[children2.length-1])instanceof MarkView&&last.mark.eq(view.mark)?joinInlineInto(last,view.children[0],open-1):(children2.push(view),view.setParent(parent)),parent.length+=view.length}function coordsInChildren(view,pos,side){let before=null,beforePos=-1,after=null,afterPos=-1;!function scan(view2,pos2){for(let i2=0,off=0;i2<view2.children.length&&off<=pos2;i2++){let child=view2.children[i2],end2=off+child.length;end2>=pos2&&(child.children.length?scan(child,pos2-off):(!after||after.isHidden&&side>0)&&(end2>pos2||off==end2&&child.getSide()>0)?(after=child,afterPos=pos2-off):(off<pos2||off==end2&&child.getSide()<0&&!child.isHidden)&&(before=child,beforePos=pos2-off)),off=end2}}(view,pos);let target=(side<0?before:after)||before||after;return target?target.coordsAt(Math.max(0,target==before?beforePos:afterPos),side):function(view){let last=view.dom.lastChild;if(!last)return view.dom.getBoundingClientRect();let rects=clientRectsFor(last);return rects[rects.length-1]||null}(view)}function combineAttrs(source,target){for(let name2 in source)"class"==name2&&target.class?target.class+=" "+source.class:"style"==name2&&target.style?target.style+=";"+source.style:target[name2]=source[name2];return target}TextView.prototype.children=WidgetView.prototype.children=WidgetBufferView.prototype.children=noChildren;const noAttrs=Object.create(null);function attrsEq(a,b,ignore){if(a==b)return!0;a||(a=noAttrs),b||(b=noAttrs);let keysA=Object.keys(a),keysB=Object.keys(b);if(keysA.length-(ignore&&keysA.indexOf(ignore)>-1?1:0)!=keysB.length-(ignore&&keysB.indexOf(ignore)>-1?1:0))return!1;for(let key of keysA)if(key!=ignore&&(-1==keysB.indexOf(key)||a[key]!==b[key]))return!1;return!0}function updateAttrs(dom,prev,attrs){let changed=!1;if(prev)for(let name2 in prev)attrs&&name2 in attrs||(changed=!0,"style"==name2?dom.style.cssText="":dom.removeAttribute(name2));if(attrs)for(let name2 in attrs)prev&&prev[name2]==attrs[name2]||(changed=!0,"style"==name2?dom.style.cssText=attrs[name2]:dom.setAttribute(name2,attrs[name2]));return changed}function getAttrs(dom){let attrs=Object.create(null);for(let i2=0;i2<dom.attributes.length;i2++){let attr2=dom.attributes[i2];attrs[attr2.name]=attr2.value}return attrs}class LineView extends ContentView{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(from,to,source,hasStart,openStart,openEnd){if(source){if(!(source instanceof LineView))return!1;this.dom||source.transferDOM(this)}return hasStart&&this.setDeco(source?source.attrs:null),mergeChildrenInto(this,from,to,source?source.children:[],openStart,openEnd),!0}split(at){let end2=new LineView;if(end2.breakAfter=this.breakAfter,0==this.length)return end2;let{i:i2,off:off}=this.childPos(at);off&&(end2.append(this.children[i2].split(off),0),this.children[i2].merge(off,this.children[i2].length,null,!1,0,0),i2++);for(let j=i2;j<this.children.length;j++)end2.append(this.children[j],0);for(;i2>0&&0==this.children[i2-1].length;)this.children[--i2].destroy();return this.children.length=i2,this.markDirty(),this.length=at,end2}transferDOM(other){this.dom&&(this.markDirty(),other.setDOM(this.dom),other.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(attrs){attrsEq(this.attrs,attrs)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=attrs)}append(child,openStart){joinInlineInto(this,child,openStart)}addLineDeco(deco){let attrs=deco.spec.attributes,cls=deco.spec.class;attrs&&(this.attrs=combineAttrs(attrs,this.attrs||{})),cls&&(this.attrs=combineAttrs({class:cls},this.attrs||{}))}domAtPos(pos){return inlineDOMAtPos(this,pos)}reuseDOM(node){"DIV"==node.nodeName&&(this.setDOM(node),this.flags|=6)}sync(view,track){var _a2;this.dom?4&this.flags&&(clearAttributes(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(updateAttrs(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(view,track);let last=this.dom.lastChild;for(;last&&ContentView.get(last)instanceof MarkView;)last=last.lastChild;if(!(last&&this.length&&("BR"==last.nodeName||0!=(null===(_a2=ContentView.get(last))||void 0===_a2?void 0:_a2.isEditable)||browser$1.ios&&this.children.some((ch=>ch instanceof TextView))))){let hack=document.createElement("BR");hack.cmIgnore=!0,this.dom.appendChild(hack)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let textHeight,totalWidth=0;for(let child of this.children){if(!(child instanceof TextView)||/[^ -~]/.test(child.text))return null;let rects=clientRectsFor(child.dom);if(1!=rects.length)return null;totalWidth+=rects[0].width,textHeight=rects[0].height}return totalWidth?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:totalWidth/this.length,textHeight:textHeight}:null}coordsAt(pos,side){let rect=coordsInChildren(this,pos,side);if(!this.children.length&&rect&&this.parent){let{heightOracle:heightOracle}=this.parent.view.viewState,height=rect.bottom-rect.top;if(Math.abs(height-heightOracle.lineHeight)<2&&heightOracle.textHeight<height){let dist2=(height-heightOracle.textHeight)/2;return{top:rect.top+dist2,bottom:rect.bottom-dist2,left:rect.left,right:rect.left}}}return rect}become(_other){return!1}covers(){return!0}static find(docView,pos){for(let i2=0,off=0;i2<docView.children.length;i2++){let block=docView.children[i2],end2=off+block.length;if(end2>=pos){if(block instanceof LineView)return block;if(end2>pos)break}off=end2+block.breakAfter}return null}}class BlockWidgetView extends ContentView{constructor(widget,length,deco){super(),this.widget=widget,this.length=length,this.deco=deco,this.breakAfter=0,this.prevWidget=null}merge(from,to,source,_takeDeco,openStart,openEnd){return!(source&&(!(source instanceof BlockWidgetView&&this.widget.compare(source.widget))||from>0&&openStart<=0||to<this.length&&openEnd<=0))&&(this.length=from+(source?source.length:0)+(this.length-to),!0)}domAtPos(pos){return 0==pos?DOMPos.before(this.dom):DOMPos.after(this.dom,pos==this.length)}split(at){let len=this.length-at;this.length=at;let end2=new BlockWidgetView(this.widget,len,this.deco);return end2.breakAfter=this.breakAfter,end2}get children(){return noChildren}sync(view){this.dom&&this.widget.updateDOM(this.dom,view)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(view)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Text.empty}domBoundsAround(){return null}become(other){return other instanceof BlockWidgetView&&other.widget.constructor==this.widget.constructor&&(other.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=other.widget,this.length=other.length,this.deco=other.deco,this.breakAfter=other.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(event){return this.widget.ignoreEvent(event)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(pos,side){return this.widget.coordsAt(this.dom,pos,side)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(side){let{startSide:startSide,endSide:endSide}=this.deco;return startSide!=endSide&&(side<0?startSide<0:endSide>0)}}class WidgetType{eq(widget){return!1}updateDOM(dom,view){return!1}compare(other){return this==other||this.constructor==other.constructor&&this.eq(other)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(event){return!0}coordsAt(dom,pos,side){return null}get isHidden(){return!1}destroy(dom){}}var BlockType=function(BlockType2){return BlockType2[BlockType2.Text=0]="Text",BlockType2[BlockType2.WidgetBefore=1]="WidgetBefore",BlockType2[BlockType2.WidgetAfter=2]="WidgetAfter",BlockType2[BlockType2.WidgetRange=3]="WidgetRange",BlockType2}(BlockType||(BlockType={}));class Decoration extends RangeValue{constructor(startSide,endSide,widget,spec){super(),this.startSide=startSide,this.endSide=endSide,this.widget=widget,this.spec=spec}get heightRelevant(){return!1}static mark(spec){return new MarkDecoration(spec)}static widget(spec){let side=Math.max(-1e4,Math.min(1e4,spec.side||0)),block=!!spec.block;return side+=block&&!spec.inlineOrder?side>0?3e8:-4e8:side>0?1e8:-1e8,new PointDecoration(spec,side,side,block,spec.widget||null,!1)}static replace(spec){let startSide,endSide,block=!!spec.block;if(spec.isBlockGap)startSide=-5e8,endSide=4e8;else{let{start:start2,end:end2}=getInclusive(spec,block);startSide=(start2?block?-3e8:-1:5e8)-1,endSide=1+(end2?block?2e8:1:-6e8)}return new PointDecoration(spec,startSide,endSide,block,spec.widget||null,!0)}static line(spec){return new LineDecoration(spec)}static set(of,sort=!1){return RangeSet.of(of,sort)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}Decoration.none=RangeSet.empty;class MarkDecoration extends Decoration{constructor(spec){let{start:start2,end:end2}=getInclusive(spec);super(start2?-1:5e8,end2?1:-6e8,null,spec),this.tagName=spec.tagName||"span",this.class=spec.class||"",this.attrs=spec.attributes||null}eq(other){var _a2,_b;return this==other||other instanceof MarkDecoration&&this.tagName==other.tagName&&(this.class||(null===(_a2=this.attrs)||void 0===_a2?void 0:_a2.class))==(other.class||(null===(_b=other.attrs)||void 0===_b?void 0:_b.class))&&attrsEq(this.attrs,other.attrs,"class")}range(from,to=from){if(from>=to)throw new RangeError("Mark decorations may not be empty");return super.range(from,to)}}MarkDecoration.prototype.point=!1;class LineDecoration extends Decoration{constructor(spec){super(-2e8,-2e8,null,spec)}eq(other){return other instanceof LineDecoration&&this.spec.class==other.spec.class&&attrsEq(this.spec.attributes,other.spec.attributes)}range(from,to=from){if(to!=from)throw new RangeError("Line decoration ranges must be zero-length");return super.range(from,to)}}LineDecoration.prototype.mapMode=MapMode.TrackBefore,LineDecoration.prototype.point=!0;class PointDecoration extends Decoration{constructor(spec,startSide,endSide,block,widget,isReplace){super(startSide,endSide,widget,spec),this.block=block,this.isReplace=isReplace,this.mapMode=block?startSide<=0?MapMode.TrackBefore:MapMode.TrackAfter:MapMode.TrackDel}get type(){return this.startSide!=this.endSide?BlockType.WidgetRange:this.startSide<=0?BlockType.WidgetBefore:BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(other){return other instanceof PointDecoration&&(a=this.widget,b=other.widget,a==b||!!(a&&b&&a.compare(b)))&&this.block==other.block&&this.startSide==other.startSide&&this.endSide==other.endSide;var a,b}range(from,to=from){if(this.isReplace&&(from>to||from==to&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&to!=from)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(from,to)}}function getInclusive(spec,block=!1){let{inclusiveStart:start2,inclusiveEnd:end2}=spec;return null==start2&&(start2=spec.inclusive),null==end2&&(end2=spec.inclusive),{start:null!=start2?start2:block,end:null!=end2?end2:block}}function addRange(from,to,ranges,margin=0){let last=ranges.length-1;last>=0&&ranges[last]+margin>=from?ranges[last]=Math.max(ranges[last],to):ranges.push(from,to)}PointDecoration.prototype.point=!0;class ContentBuilder{constructor(doc2,pos,end2,disallowBlockEffectsFor){this.doc=doc2,this.pos=pos,this.end=end2,this.disallowBlockEffectsFor=disallowBlockEffectsFor,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=doc2.iter(),this.skip=pos}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let last=this.content[this.content.length-1];return!(last.breakAfter||last instanceof BlockWidgetView&&last.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new LineView),this.atCursorPos=!0),this.curLine}flushBuffer(active2=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(wrapMarks(new WidgetBufferView(-1),active2),active2.length),this.pendingBuffer=0)}addBlockWidget(view){this.flushBuffer(),this.curLine=null,this.content.push(view)}finish(openEnd){this.pendingBuffer&&openEnd<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||openEnd&&this.content.length&&this.content[this.content.length-1]instanceof BlockWidgetView||this.getLine()}buildText(length,active2,openStart){for(;length>0;){if(this.textOff==this.text.length){let{value:value,lineBreak:lineBreak,done:done}=this.cursor.next(this.skip);if(this.skip=0,done)throw new Error("Ran out of text content when drawing inline views");if(lineBreak){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,length--;continue}this.text=value,this.textOff=0}let take=Math.min(this.text.length-this.textOff,length,512);this.flushBuffer(active2.slice(active2.length-openStart)),this.getLine().append(wrapMarks(new TextView(this.text.slice(this.textOff,this.textOff+take)),active2),openStart),this.atCursorPos=!0,this.textOff+=take,length-=take,openStart=0}}span(from,to,active2,openStart){this.buildText(to-from,active2,openStart),this.pos=to,this.openStart<0&&(this.openStart=openStart)}point(from,to,deco,active2,openStart,index){if(this.disallowBlockEffectsFor[index]&&deco instanceof PointDecoration){if(deco.block)throw new RangeError("Block decorations may not be specified via plugins");if(to>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let len=to-from;if(deco instanceof PointDecoration)if(deco.block)deco.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new BlockWidgetView(deco.widget||new NullWidget("div"),len,deco));else{let view=WidgetView.create(deco.widget||new NullWidget("span"),len,len?0:deco.startSide),cursorBefore=this.atCursorPos&&!view.isEditable&&openStart<=active2.length&&(from<to||deco.startSide>0),cursorAfter=!view.isEditable&&(from<to||openStart>active2.length||deco.startSide<=0),line=this.getLine();2!=this.pendingBuffer||cursorBefore||view.isEditable||(this.pendingBuffer=0),this.flushBuffer(active2),cursorBefore&&(line.append(wrapMarks(new WidgetBufferView(1),active2),openStart),openStart=active2.length+Math.max(0,openStart-active2.length)),line.append(wrapMarks(view,active2),openStart),this.atCursorPos=cursorAfter,this.pendingBuffer=cursorAfter?from<to||openStart>active2.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=active2.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(deco);len&&(this.textOff+len<=this.text.length?this.textOff+=len:(this.skip+=len-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=to),this.openStart<0&&(this.openStart=openStart)}static build(text2,from,to,decorations2,dynamicDecorationMap){let builder=new ContentBuilder(text2,from,to,dynamicDecorationMap);return builder.openEnd=RangeSet.spans(decorations2,from,to,builder),builder.openStart<0&&(builder.openStart=builder.openEnd),builder.finish(builder.openEnd),builder}}function wrapMarks(view,active2){for(let mark of active2)view=new MarkView(mark,[view],view.length);return view}class NullWidget extends WidgetType{constructor(tag){super(),this.tag=tag}eq(other){return other.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(elt){return elt.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const clickAddsSelectionRange=Facet.define(),dragMovesSelection$1=Facet.define(),mouseSelectionStyle=Facet.define(),exceptionSink=Facet.define(),updateListener=Facet.define(),inputHandler$1=Facet.define(),focusChangeEffect=Facet.define(),perLineTextDirection=Facet.define({combine:values=>values.some((x=>x))}),nativeSelectionHidden=Facet.define({combine:values=>values.some((x=>x))});class ScrollTarget{constructor(range,y="nearest",x="nearest",yMargin=5,xMargin=5){this.range=range,this.y=y,this.x=x,this.yMargin=yMargin,this.xMargin=xMargin}map(changes){return changes.empty?this:new ScrollTarget(this.range.map(changes),this.y,this.x,this.yMargin,this.xMargin)}}const scrollIntoView$1=StateEffect.define({map:(t2,ch)=>t2.map(ch)});function logException(state,exception,context){let handler=state.facet(exceptionSink);handler.length?handler[0](exception):window.onerror?window.onerror(String(exception),context,void 0,void 0,exception):context?console.error(context+":",exception):console.error(exception)}const editable=Facet.define({combine:values=>!values.length||values[0]});let nextPluginID=0;const viewPlugin=Facet.define();class ViewPlugin{constructor(id2,create,domEventHandlers,domEventObservers,buildExtensions){this.id=id2,this.create=create,this.domEventHandlers=domEventHandlers,this.domEventObservers=domEventObservers,this.extension=buildExtensions(this)}static define(create,spec){const{eventHandlers:eventHandlers,eventObservers:eventObservers,provide:provide,decorations:deco}=spec||{};return new ViewPlugin(nextPluginID++,create,eventHandlers,eventObservers,(plugin=>{let ext=[viewPlugin.of(plugin)];return deco&&ext.push(decorations.of((view=>{let pluginInst=view.plugin(plugin);return pluginInst?deco(pluginInst):Decoration.none}))),provide&&ext.push(provide(plugin)),ext}))}static fromClass(cls,spec){return ViewPlugin.define((view=>new cls(view)),spec)}}class PluginInstance{constructor(spec){this.spec=spec,this.mustUpdate=null,this.value=null}update(view){if(this.value){if(this.mustUpdate){let update2=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(update2)}catch(e){if(logException(update2.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(_){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(view)}catch(e){logException(view.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(view){var _a2;if(null===(_a2=this.value)||void 0===_a2?void 0:_a2.destroy)try{this.value.destroy()}catch(e){logException(view.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const editorAttributes=Facet.define(),contentAttributes=Facet.define(),decorations=Facet.define(),atomicRanges=Facet.define(),bidiIsolatedRanges=Facet.define();function getIsolatedRanges(view,from,to){let isolates=view.state.facet(bidiIsolatedRanges);if(!isolates.length)return isolates;let sets=isolates.map((i2=>i2 instanceof Function?i2(view):i2)),result=[];return RangeSet.spans(sets,from,to,{point(){},span(from2,to2,active2,open){let level=result;for(let i2=active2.length-1;i2>=0;i2--,open--){let update2,iso=active2[i2].spec.bidiIsolate;if(null!=iso)if(open>0&&level.length&&(update2=level[level.length-1]).to==from2&&update2.direction==iso)update2.to=to2,level=update2.inner;else{let add2={from:from2,to:to2,direction:iso,inner:[]};level.push(add2),level=add2.inner}}}}),result}const scrollMargins=Facet.define();function getScrollMargins(view){let left2=0,right2=0,top2=0,bottom2=0;for(let source of view.state.facet(scrollMargins)){let m=source(view);m&&(null!=m.left&&(left2=Math.max(left2,m.left)),null!=m.right&&(right2=Math.max(right2,m.right)),null!=m.top&&(top2=Math.max(top2,m.top)),null!=m.bottom&&(bottom2=Math.max(bottom2,m.bottom)))}return{left:left2,right:right2,top:top2,bottom:bottom2}}const styleModule=Facet.define();class ChangedRange{constructor(fromA,toA,fromB,toB){this.fromA=fromA,this.toA=toA,this.fromB=fromB,this.toB=toB}join(other){return new ChangedRange(Math.min(this.fromA,other.fromA),Math.max(this.toA,other.toA),Math.min(this.fromB,other.fromB),Math.max(this.toB,other.toB))}addToSet(set2){let i2=set2.length,me=this;for(;i2>0;i2--){let range=set2[i2-1];if(!(range.fromA>me.toA)){if(range.toA<me.fromA)break;me=me.join(range),set2.splice(i2-1,1)}}return set2.splice(i2,0,me),set2}static extendWithRanges(diff,ranges){if(0==ranges.length)return diff;let result=[];for(let dI=0,rI=0,posA=0,posB=0;;dI++){let next=dI==diff.length?null:diff[dI],off=posA-posB,end2=next?next.fromB:1e9;for(;rI<ranges.length&&ranges[rI]<end2;){let from=ranges[rI],to=ranges[rI+1],fromB=Math.max(posB,from),toB=Math.min(end2,to);if(fromB<=toB&&new ChangedRange(fromB+off,toB+off,fromB,toB).addToSet(result),to>end2)break;rI+=2}if(!next)return result;new ChangedRange(next.fromA,next.toA,next.fromB,next.toB).addToSet(result),posA=next.toA,posB=next.toB}}}class ViewUpdate{constructor(view,state,transactions){this.view=view,this.state=state,this.transactions=transactions,this.flags=0,this.startState=view.state,this.changes=ChangeSet.empty(this.startState.doc.length);for(let tr of transactions)this.changes=this.changes.compose(tr.changes);let changedRanges=[];this.changes.iterChangedRanges(((fromA,toA,fromB,toB)=>changedRanges.push(new ChangedRange(fromA,toA,fromB,toB)))),this.changedRanges=changedRanges}static create(view,state,transactions){return new ViewUpdate(view,state,transactions)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((tr=>tr.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}var Direction=function(Direction2){return Direction2[Direction2.LTR=0]="LTR",Direction2[Direction2.RTL=1]="RTL",Direction2}(Direction||(Direction={}));const LTR=Direction.LTR,RTL=Direction.RTL;function dec(str){let result=[];for(let i2=0;i2<str.length;i2++)result.push(1<<+str[i2]);return result}const LowTypes=dec("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ArabicTypes=dec("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Brackets=Object.create(null),BracketStack=[];for(let p of["()","[]","{}"]){let l=p.charCodeAt(0),r=p.charCodeAt(1);Brackets[l]=r,Brackets[r]=-l}const BidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class BidiSpan{get dir(){return this.level%2?RTL:LTR}constructor(from,to,level){this.from=from,this.to=to,this.level=level}side(end2,dir){return this.dir==dir==end2?this.to:this.from}static find(order2,index,level,assoc){let maybe=-1;for(let i2=0;i2<order2.length;i2++){let span=order2[i2];if(span.from<=index&&span.to>=index){if(span.level==level)return i2;(maybe<0||(0!=assoc?assoc<0?span.from<index:span.to>index:order2[maybe].level>span.level))&&(maybe=i2)}}if(maybe<0)throw new RangeError("Index out of range");return maybe}}function isolatesEq(a,b){if(a.length!=b.length)return!1;for(let i2=0;i2<a.length;i2++){let iA=a[i2],iB=b[i2];if(iA.from!=iB.from||iA.to!=iB.to||iA.direction!=iB.direction||!isolatesEq(iA.inner,iB.inner))return!1}return!0}const types=[];function emitSpans(line,from,to,level,baseLevel,isolates,order2){let ourType=level%2?2:1;if(level%2==baseLevel%2)for(let iCh=from,iI=0;iCh<to;){let sameDir=!0,isNum=!1;if(iI==isolates.length||iCh<isolates[iI].from){let next=types[iCh];next!=ourType&&(sameDir=!1,isNum=16==next)}let recurse=sameDir||1!=ourType?null:[],localLevel=sameDir?level:level+1,iScan=iCh;run:for(;;)if(iI<isolates.length&&iScan==isolates[iI].from){if(isNum)break run;let iso=isolates[iI];if(!sameDir)for(let upto=iso.to,jI=iI+1;;){if(upto==to)break run;if(!(jI<isolates.length&&isolates[jI].from==upto)){if(types[upto]==ourType)break run;break}upto=isolates[jI++].to}if(iI++,recurse)recurse.push(iso);else{iso.from>iCh&&order2.push(new BidiSpan(iCh,iso.from,localLevel)),computeSectionOrder(line,iso.direction==LTR!=!(localLevel%2)?level+1:level,baseLevel,iso.inner,iso.from,iso.to,order2),iCh=iso.to}iScan=iso.to}else{if(iScan==to||(sameDir?types[iScan]!=ourType:types[iScan]==ourType))break;iScan++}recurse?emitSpans(line,iCh,iScan,level+1,baseLevel,recurse,order2):iCh<iScan&&order2.push(new BidiSpan(iCh,iScan,localLevel)),iCh=iScan}else for(let iCh=to,iI=isolates.length;iCh>from;){let sameDir=!0,isNum=!1;if(!iI||iCh>isolates[iI-1].to){let next=types[iCh-1];next!=ourType&&(sameDir=!1,isNum=16==next)}let recurse=sameDir||1!=ourType?null:[],localLevel=sameDir?level:level+1,iScan=iCh;run:for(;;)if(iI&&iScan==isolates[iI-1].to){if(isNum)break run;let iso=isolates[--iI];if(!sameDir)for(let upto=iso.from,jI=iI;;){if(upto==from)break run;if(!jI||isolates[jI-1].to!=upto){if(types[upto-1]==ourType)break run;break}upto=isolates[--jI].from}if(recurse)recurse.push(iso);else{iso.to<iCh&&order2.push(new BidiSpan(iso.to,iCh,localLevel)),computeSectionOrder(line,iso.direction==LTR!=!(localLevel%2)?level+1:level,baseLevel,iso.inner,iso.from,iso.to,order2),iCh=iso.from}iScan=iso.from}else{if(iScan==from||(sameDir?types[iScan-1]!=ourType:types[iScan-1]==ourType))break;iScan--}recurse?emitSpans(line,iScan,iCh,level+1,baseLevel,recurse,order2):iScan<iCh&&order2.push(new BidiSpan(iScan,iCh,localLevel)),iCh=iScan}}function computeSectionOrder(line,level,baseLevel,isolates,from,to,order2){let outerType=level%2?2:1;!function(line,rFrom,rTo,isolates,outerType){for(let iI=0;iI<=isolates.length;iI++){let from=iI?isolates[iI-1].to:rFrom,to=iI<isolates.length?isolates[iI].from:rTo,prevType=iI?256:outerType;for(let i2=from,prev=prevType,prevStrong=prevType;i2<to;i2++){let type2=(ch=line.charCodeAt(i2))<=247?LowTypes[ch]:1424<=ch&&ch<=1524?2:1536<=ch&&ch<=1785?ArabicTypes[ch-1536]:1774<=ch&&ch<=2220?4:8192<=ch&&ch<=8203?256:64336<=ch&&ch<=65023?4:8204==ch?256:1;512==type2?type2=prev:8==type2&&4==prevStrong&&(type2=16),types[i2]=4==type2?2:type2,7&type2&&(prevStrong=type2),prev=type2}for(let i2=from,prev=prevType,prevStrong=prevType;i2<to;i2++){let type2=types[i2];if(128==type2)i2<to-1&&prev==types[i2+1]&&24&prev?type2=types[i2]=prev:types[i2]=256;else if(64==type2){let end2=i2+1;for(;end2<to&&64==types[end2];)end2++;let replace=i2&&8==prev||end2<rTo&&8==types[end2]?1==prevStrong?1:8:256;for(let j=i2;j<end2;j++)types[j]=replace;i2=end2-1}else 8==type2&&1==prevStrong&&(types[i2]=1);prev=type2,7&type2&&(prevStrong=type2)}}var ch}(line,from,to,isolates,outerType),function(line,rFrom,rTo,isolates,outerType){let oppositeType=1==outerType?2:1;for(let iI=0,sI=0,context=0;iI<=isolates.length;iI++){let from=iI?isolates[iI-1].to:rFrom,to=iI<isolates.length?isolates[iI].from:rTo;for(let ch,br,type2,i2=from;i2<to;i2++)if(br=Brackets[ch=line.charCodeAt(i2)])if(br<0){for(let sJ=sI-3;sJ>=0;sJ-=3)if(BracketStack[sJ+1]==-br){let flags=BracketStack[sJ+2],type3=2&flags?outerType:4&flags?1&flags?oppositeType:outerType:0;type3&&(types[i2]=types[BracketStack[sJ]]=type3),sI=sJ;break}}else{if(189==BracketStack.length)break;BracketStack[sI++]=i2,BracketStack[sI++]=ch,BracketStack[sI++]=context}else if(2==(type2=types[i2])||1==type2){let embed=type2==outerType;context=embed?0:1;for(let sJ=sI-3;sJ>=0;sJ-=3){let cur2=BracketStack[sJ+2];if(2&cur2)break;if(embed)BracketStack[sJ+2]|=2;else{if(4&cur2)break;BracketStack[sJ+2]|=4}}}}}(line,from,to,isolates,outerType),function(rFrom,rTo,isolates,outerType){for(let iI=0,prev=outerType;iI<=isolates.length;iI++){let from=iI?isolates[iI-1].to:rFrom,to=iI<isolates.length?isolates[iI].from:rTo;for(let i2=from;i2<to;){let type2=types[i2];if(256==type2){let end2=i2+1;for(;;)if(end2==to){if(iI==isolates.length)break;end2=isolates[iI++].to,to=iI<isolates.length?isolates[iI].from:rTo}else{if(256!=types[end2])break;end2++}let beforeL=1==prev,replace=beforeL==(1==(end2<rTo?types[end2]:outerType))?beforeL?1:2:outerType;for(let j=end2,jI=iI,fromJ=jI?isolates[jI-1].to:rFrom;j>i2;)j==fromJ&&(j=isolates[--jI].from,fromJ=jI?isolates[jI-1].to:rFrom),types[--j]=replace;i2=end2}else prev=type2,i2++}}}(from,to,isolates,outerType),emitSpans(line,from,to,level,baseLevel,isolates,order2)}function trivialOrder(length){return[new BidiSpan(0,length,0)]}let movedOver="";function moveVisually(line,order2,dir,start2,forward){var _a2;let startIndex=start2.head-line.from,spanI=-1;if(0==startIndex){if(!forward||!line.length)return null;order2[0].level!=dir&&(startIndex=order2[0].side(!1,dir),spanI=0)}else if(startIndex==line.length){if(forward)return null;let last=order2[order2.length-1];last.level!=dir&&(startIndex=last.side(!0,dir),spanI=order2.length-1)}spanI<0&&(spanI=BidiSpan.find(order2,startIndex,null!==(_a2=start2.bidiLevel)&&void 0!==_a2?_a2:-1,start2.assoc));let span=order2[spanI];startIndex==span.side(forward,dir)&&(span=order2[spanI+=forward?1:-1],startIndex=span.side(!forward,dir));let indexForward=forward==(span.dir==dir),nextIndex=findClusterBreak(line.text,startIndex,indexForward);if(movedOver=line.text.slice(Math.min(startIndex,nextIndex),Math.max(startIndex,nextIndex)),nextIndex!=span.side(forward,dir))return EditorSelection.cursor(nextIndex+line.from,indexForward?-1:1,span.level);let nextSpan=spanI==(forward?order2.length-1:0)?null:order2[spanI+(forward?1:-1)];return nextSpan||span.level==dir?nextSpan&&nextSpan.level<span.level?EditorSelection.cursor(nextSpan.side(!forward,dir)+line.from,forward?1:-1,nextSpan.level):EditorSelection.cursor(nextIndex+line.from,forward?-1:1,span.level):EditorSelection.cursor(forward?line.to:line.from,forward?-1:1,dir)}class DocView extends ContentView{get length(){return this.view.state.doc.length}constructor(view){super(),this.view=view,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(view.contentDOM),this.children=[new LineView],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ChangedRange(0,0,0,view.state.doc.length)],0,null)}update(update2){var _a2;let changedRanges=update2.changedRanges;this.minWidth>0&&changedRanges.length&&(changedRanges.every((({fromA:fromA,toA:toA})=>toA<this.minWidthFrom||fromA>this.minWidthTo))?(this.minWidthFrom=update2.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=update2.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let readCompositionAt=-1;this.view.inputState.composing>=0&&((null===(_a2=this.domChanged)||void 0===_a2?void 0:_a2.newSel)?readCompositionAt=this.domChanged.newSel.head:function(changes,composition){let touched=!1;composition&&changes.iterChangedRanges(((from,to)=>{from<composition.to&&to>composition.from&&(touched=!0)}));return touched}(update2.changes,this.hasComposition)||update2.selectionSet||(readCompositionAt=update2.state.selection.main.head));let composition=readCompositionAt>-1?function(view,changes,headPos){let found=findCompositionNode(view,headPos);if(!found)return null;let{node:textNode,from:from,to:to}=found,text2=textNode.nodeValue;if(/[\n\r]/.test(text2))return null;if(view.state.doc.sliceString(found.from,found.to)!=text2)return null;let inv=changes.invertedDesc,range=new ChangedRange(inv.mapPos(from),inv.mapPos(to),from,to),marks=[];for(let parent=textNode.parentNode;;parent=parent.parentNode){let parentView=ContentView.get(parent);if(parentView instanceof MarkView)marks.push({node:parent,deco:parentView.mark});else{if(parentView instanceof LineView||"DIV"==parent.nodeName&&parent.parentNode==view.contentDOM)return{range:range,text:textNode,marks:marks,line:parent};if(parent==view.contentDOM)return null;marks.push({node:parent,deco:new MarkDecoration({inclusive:!0,attributes:getAttrs(parent),tagName:parent.tagName.toLowerCase()})})}}}(this.view,update2.changes,readCompositionAt):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:from,to:to}=this.hasComposition;changedRanges=new ChangedRange(from,to,update2.changes.mapPos(from,-1),update2.changes.mapPos(to,1)).addToSet(changedRanges.slice())}this.hasComposition=composition?{from:composition.range.fromB,to:composition.range.toB}:null,(browser$1.ie||browser$1.chrome)&&!composition&&update2&&update2.state.doc.lines!=update2.startState.doc.lines&&(this.forceSelection=!0);let decoDiff=function(a,b,diff){let comp=new DecorationComparator$1;return RangeSet.compare(a,b,diff,comp),comp.changes}(this.decorations,this.updateDeco(),update2.changes);return changedRanges=ChangedRange.extendWithRanges(changedRanges,decoDiff),!!(7&this.flags||0!=changedRanges.length)&&(this.updateInner(changedRanges,update2.startState.doc.length,composition),update2.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(changes,oldLength,composition){this.view.viewState.mustMeasureContent=!0,this.updateChildren(changes,oldLength,composition);let{observer:observer}=this.view;observer.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let track=browser$1.chrome||browser$1.ios?{node:observer.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,track),this.flags&=-8,track&&(track.written||observer.selectionRange.focusNode!=track.node)&&(this.forceSelection=!0),this.dom.style.height=""})),this.markedForComposition.forEach((cView=>cView.flags&=-9));let gaps=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let child of this.children)child instanceof BlockWidgetView&&child.widget instanceof BlockGapWidget&&gaps.push(child.dom);observer.updateGaps(gaps)}updateChildren(changes,oldLength,composition){let ranges=composition?composition.range.addToSet(changes.slice()):changes,cursor2=this.childCursor(oldLength);for(let i2=ranges.length-1;;i2--){let next=i2>=0?ranges[i2]:null;if(!next)break;let content2,breakAtStart,openStart,openEnd,{fromA:fromA,toA:toA,fromB:fromB,toB:toB}=next;if(composition&&composition.range.fromB<toB&&composition.range.toB>fromB){let before=ContentBuilder.build(this.view.state.doc,fromB,composition.range.fromB,this.decorations,this.dynamicDecorationMap),after=ContentBuilder.build(this.view.state.doc,composition.range.toB,toB,this.decorations,this.dynamicDecorationMap);breakAtStart=before.breakAtStart,openStart=before.openStart,openEnd=after.openEnd;let compLine=this.compositionView(composition);after.breakAtStart?compLine.breakAfter=1:after.content.length&&compLine.merge(compLine.length,compLine.length,after.content[0],!1,after.openStart,0)&&(compLine.breakAfter=after.content[0].breakAfter,after.content.shift()),before.content.length&&compLine.merge(0,0,before.content[before.content.length-1],!0,0,before.openEnd)&&before.content.pop(),content2=before.content.concat(compLine).concat(after.content)}else({content:content2,breakAtStart:breakAtStart,openStart:openStart,openEnd:openEnd}=ContentBuilder.build(this.view.state.doc,fromB,toB,this.decorations,this.dynamicDecorationMap));let{i:toI,off:toOff}=cursor2.findPos(toA,1),{i:fromI,off:fromOff}=cursor2.findPos(fromA,-1);replaceRange(this,fromI,fromOff,toI,toOff,content2,breakAtStart,openStart,openEnd)}composition&&this.fixCompositionDOM(composition)}compositionView(composition){let cur2=new TextView(composition.text.nodeValue);cur2.flags|=8;for(let{deco:deco}of composition.marks)cur2=new MarkView(deco,[cur2],cur2.length);let line=new LineView;return line.append(cur2,0),line}fixCompositionDOM(composition){let fix=(dom,cView2)=>{cView2.flags|=8|(cView2.children.some((c=>7&c.flags))?1:0),this.markedForComposition.add(cView2);let prev=ContentView.get(dom);prev&&prev!=cView2&&(prev.dom=null),cView2.setDOM(dom)},pos=this.childPos(composition.range.fromB,1),cView=this.children[pos.i];fix(composition.line,cView);for(let i2=composition.marks.length-1;i2>=-1;i2--)pos=cView.childPos(pos.off,1),cView=cView.children[pos.i],fix(i2>=0?composition.marks[i2].node:composition.text,cView)}updateSelection(mustRead=!1,fromPointer=!1){!mustRead&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let activeElt=this.view.root.activeElement,focused=activeElt==this.dom,selectionNotFocus=!focused&&hasSelection(this.dom,this.view.observer.selectionRange)&&!(activeElt&&this.dom.contains(activeElt));if(!(focused||fromPointer||selectionNotFocus))return;let force=this.forceSelection;this.forceSelection=!1;let main2=this.view.state.selection.main,anchor=this.moveToLine(this.domAtPos(main2.anchor)),head=main2.empty?anchor:this.moveToLine(this.domAtPos(main2.head));if(browser$1.gecko&&main2.empty&&!this.hasComposition&&(1==(pos=anchor).node.nodeType&&pos.node.firstChild&&(0==pos.offset||"false"==pos.node.childNodes[pos.offset-1].contentEditable)&&(pos.offset==pos.node.childNodes.length||"false"==pos.node.childNodes[pos.offset].contentEditable))){let dummy=document.createTextNode("");this.view.observer.ignore((()=>anchor.node.insertBefore(dummy,anchor.node.childNodes[anchor.offset]||null))),anchor=head=new DOMPos(dummy,0),force=!0}var pos;let domSel=this.view.observer.selectionRange;!force&&domSel.focusNode&&isEquivalentPosition(anchor.node,anchor.offset,domSel.anchorNode,domSel.anchorOffset)&&isEquivalentPosition(head.node,head.offset,domSel.focusNode,domSel.focusOffset)||(this.view.observer.ignore((()=>{browser$1.android&&browser$1.chrome&&this.dom.contains(domSel.focusNode)&&function(node,inside2){for(let cur2=node;cur2&&cur2!=inside2;cur2=cur2.assignedSlot||cur2.parentNode)if(1==cur2.nodeType&&"false"==cur2.contentEditable)return!0;return!1}(domSel.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let rawSel=getSelection(this.view.root);if(rawSel)if(main2.empty){if(browser$1.gecko){let nextTo=(node=anchor.node,offset2=anchor.offset,1!=node.nodeType?0:(offset2&&"false"==node.childNodes[offset2-1].contentEditable?1:0)|(offset2<node.childNodes.length&&"false"==node.childNodes[offset2].contentEditable?2:0));if(nextTo&&3!=nextTo){let text2=nearbyTextNode(anchor.node,anchor.offset,1==nextTo?1:-1);text2&&(anchor=new DOMPos(text2.node,text2.offset))}}rawSel.collapse(anchor.node,anchor.offset),null!=main2.bidiLevel&&void 0!==rawSel.caretBidiLevel&&(rawSel.caretBidiLevel=main2.bidiLevel)}else if(rawSel.extend){rawSel.collapse(anchor.node,anchor.offset);try{rawSel.extend(head.node,head.offset)}catch(_){}}else{let range=document.createRange();main2.anchor>main2.head&&([anchor,head]=[head,anchor]),range.setEnd(head.node,head.offset),range.setStart(anchor.node,anchor.offset),rawSel.removeAllRanges(),rawSel.addRange(range)}else;var node,offset2;selectionNotFocus&&this.view.root.activeElement==this.dom&&(this.dom.blur(),activeElt&&activeElt.focus())})),this.view.observer.setSelectionRange(anchor,head)),this.impreciseAnchor=anchor.precise?null:new DOMPos(domSel.anchorNode,domSel.anchorOffset),this.impreciseHead=head.precise?null:new DOMPos(domSel.focusNode,domSel.focusOffset)}enforceCursorAssoc(){if(this.hasComposition)return;let{view:view}=this,cursor2=view.state.selection.main,sel=getSelection(view.root),{anchorNode:anchorNode,anchorOffset:anchorOffset}=view.observer.selectionRange;if(!(sel&&cursor2.empty&&cursor2.assoc&&sel.modify))return;let line=LineView.find(this,cursor2.head);if(!line)return;let lineStart=line.posAtStart;if(cursor2.head==lineStart||cursor2.head==lineStart+line.length)return;let before=this.coordsAt(cursor2.head,-1),after=this.coordsAt(cursor2.head,1);if(!before||!after||before.bottom>after.top)return;let dom=this.domAtPos(cursor2.head+cursor2.assoc);sel.collapse(dom.node,dom.offset),sel.modify("move",cursor2.assoc<0?"forward":"backward","lineboundary"),view.observer.readSelectionRange();let newRange=view.observer.selectionRange;view.docView.posFromDOM(newRange.anchorNode,newRange.anchorOffset)!=cursor2.from&&sel.collapse(anchorNode,anchorOffset)}moveToLine(pos){let newPos,dom=this.dom;if(pos.node!=dom)return pos;for(let i2=pos.offset;!newPos&&i2<dom.childNodes.length;i2++){let view=ContentView.get(dom.childNodes[i2]);view instanceof LineView&&(newPos=view.domAtPos(0))}for(let i2=pos.offset-1;!newPos&&i2>=0;i2--){let view=ContentView.get(dom.childNodes[i2]);view instanceof LineView&&(newPos=view.domAtPos(view.length))}return newPos?new DOMPos(newPos.node,newPos.offset,!0):pos}nearest(dom){for(let cur2=dom;cur2;){let domView=ContentView.get(cur2);if(domView&&domView.rootView==this)return domView;cur2=cur2.parentNode}return null}posFromDOM(node,offset2){let view=this.nearest(node);if(!view)throw new RangeError("Trying to find position for a DOM position outside of the document");return view.localPosFromDOM(node,offset2)+view.posAtStart}domAtPos(pos){let{i:i2,off:off}=this.childCursor().findPos(pos,-1);for(;i2<this.children.length-1;){let child=this.children[i2];if(off<child.length||child instanceof LineView)break;i2++,off=0}return this.children[i2].domAtPos(off)}coordsAt(pos,side){let best=null,bestPos=0;for(let off=this.length,i2=this.children.length-1;i2>=0;i2--){let child=this.children[i2],end2=off-child.breakAfter,start2=end2-child.length;if(end2<pos)break;start2<=pos&&(start2<pos||child.covers(-1))&&(end2>pos||child.covers(1))&&(!best||child instanceof LineView&&!(best instanceof LineView&&side>=0))&&(best=child,bestPos=start2),off=start2}return best?best.coordsAt(pos-bestPos,side):null}coordsForChar(pos){let{i:i2,off:off}=this.childPos(pos,1),child=this.children[i2];if(!(child instanceof LineView))return null;for(;child.children.length;){let{i:i3,off:childOff}=child.childPos(off,1);for(;;i3++){if(i3==child.children.length)return null;if((child=child.children[i3]).length)break}off=childOff}if(!(child instanceof TextView))return null;let end2=findClusterBreak(child.text,off);if(end2==off)return null;let rects=textRange(child.dom,off,end2).getClientRects();for(let i3=0;i3<rects.length;i3++){let rect=rects[i3];if(i3==rects.length-1||rect.top<rect.bottom&&rect.left<rect.right)return rect}return null}measureVisibleLineHeights(viewport2){let result=[],{from:from,to:to}=viewport2,contentWidth=this.view.contentDOM.clientWidth,isWider=contentWidth>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,widest=-1,ltr=this.view.textDirection==Direction.LTR;for(let pos=0,i2=0;i2<this.children.length;i2++){let child=this.children[i2],end2=pos+child.length;if(end2>to)break;if(pos>=from){let childRect=child.dom.getBoundingClientRect();if(result.push(childRect.height),isWider){let last=child.dom.lastChild,rects=last?clientRectsFor(last):[];if(rects.length){let rect=rects[rects.length-1],width=ltr?rect.right-childRect.left:childRect.right-rect.left;width>widest&&(widest=width,this.minWidth=contentWidth,this.minWidthFrom=pos,this.minWidthTo=end2)}}}pos=end2+child.breakAfter}return result}textDirectionAt(pos){let{i:i2}=this.childPos(pos,1);return"rtl"==getComputedStyle(this.children[i2].dom).direction?Direction.RTL:Direction.LTR}measureTextSize(){for(let child of this.children)if(child instanceof LineView){let measure=child.measureTextSize();if(measure)return measure}let lineHeight,charWidth,textHeight,dummy=document.createElement("div");return dummy.className="cm-line",dummy.style.width="99999px",dummy.style.position="absolute",dummy.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(dummy);let rect=clientRectsFor(dummy.firstChild)[0];lineHeight=dummy.getBoundingClientRect().height,charWidth=rect?rect.width/27:7,textHeight=rect?rect.height:lineHeight,dummy.remove()})),{lineHeight:lineHeight,charWidth:charWidth,textHeight:textHeight}}childCursor(pos=this.length){let i2=this.children.length;return i2&&(pos-=this.children[--i2].length),new ChildCursor(this.children,pos,i2)}computeBlockGapDeco(){let deco=[],vs=this.view.viewState;for(let pos=0,i2=0;;i2++){let next=i2==vs.viewports.length?null:vs.viewports[i2],end2=next?next.from-1:this.length;if(end2>pos){let height=(vs.lineBlockAt(end2).bottom-vs.lineBlockAt(pos).top)/this.view.scaleY;deco.push(Decoration.replace({widget:new BlockGapWidget(height),block:!0,inclusive:!0,isBlockGap:!0}).range(pos,end2))}if(!next)break;pos=next.to+1}return Decoration.set(deco)}updateDeco(){let allDeco=this.view.state.facet(decorations).map(((d,i2)=>(this.dynamicDecorationMap[i2]="function"==typeof d)?d(this.view):d));for(let i2=allDeco.length;i2<allDeco.length+3;i2++)this.dynamicDecorationMap[i2]=!1;return this.decorations=[...allDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(target){let other,{range:range}=target,rect=this.coordsAt(range.head,range.empty?range.assoc:range.head>range.anchor?-1:1);if(!rect)return;!range.empty&&(other=this.coordsAt(range.anchor,range.anchor>range.head?-1:1))&&(rect={left:Math.min(rect.left,other.left),top:Math.min(rect.top,other.top),right:Math.max(rect.right,other.right),bottom:Math.max(rect.bottom,other.bottom)});let margins=getScrollMargins(this.view),targetRect={left:rect.left-margins.left,top:rect.top-margins.top,right:rect.right+margins.right,bottom:rect.bottom+margins.bottom};!function(dom,rect,side,x,y,xMargin,yMargin,ltr){let doc2=dom.ownerDocument,win=doc2.defaultView||window;for(let cur2=dom,stop=!1;cur2&&!stop;)if(1==cur2.nodeType){let bounding,top2=cur2==doc2.body,scaleX=1,scaleY=1;if(top2)bounding=windowRect(win);else{if(/^(fixed|sticky)$/.test(getComputedStyle(cur2).position)&&(stop=!0),cur2.scrollHeight<=cur2.clientHeight&&cur2.scrollWidth<=cur2.clientWidth){cur2=cur2.assignedSlot||cur2.parentNode;continue}let rect2=cur2.getBoundingClientRect();scaleX=rect2.width/cur2.offsetWidth,scaleY=rect2.height/cur2.offsetHeight,bounding={left:rect2.left,right:rect2.left+cur2.clientWidth*scaleX,top:rect2.top,bottom:rect2.top+cur2.clientHeight*scaleY}}let moveX=0,moveY=0;if("nearest"==y)rect.top<bounding.top?(moveY=-(bounding.top-rect.top+yMargin),side>0&&rect.bottom>bounding.bottom+moveY&&(moveY=rect.bottom-bounding.bottom+moveY+yMargin)):rect.bottom>bounding.bottom&&(moveY=rect.bottom-bounding.bottom+yMargin,side<0&&rect.top-moveY<bounding.top&&(moveY=-(bounding.top+moveY-rect.top+yMargin)));else{let rectHeight=rect.bottom-rect.top,boundingHeight=bounding.bottom-bounding.top;moveY=("center"==y&&rectHeight<=boundingHeight?rect.top+rectHeight/2-boundingHeight/2:"start"==y||"center"==y&&side<0?rect.top-yMargin:rect.bottom-boundingHeight+yMargin)-bounding.top}if("nearest"==x?rect.left<bounding.left?(moveX=-(bounding.left-rect.left+xMargin),side>0&&rect.right>bounding.right+moveX&&(moveX=rect.right-bounding.right+moveX+xMargin)):rect.right>bounding.right&&(moveX=rect.right-bounding.right+xMargin,side<0&&rect.left<bounding.left+moveX&&(moveX=-(bounding.left+moveX-rect.left+xMargin))):moveX=("center"==x?rect.left+(rect.right-rect.left)/2-(bounding.right-bounding.left)/2:"start"==x==ltr?rect.left-xMargin:rect.right-(bounding.right-bounding.left)+xMargin)-bounding.left,moveX||moveY)if(top2)win.scrollBy(moveX,moveY);else{let movedX=0,movedY=0;if(moveY){let start2=cur2.scrollTop;cur2.scrollTop+=moveY/scaleY,movedY=(cur2.scrollTop-start2)*scaleY}if(moveX){let start2=cur2.scrollLeft;cur2.scrollLeft+=moveX/scaleX,movedX=(cur2.scrollLeft-start2)*scaleX}rect={left:rect.left-movedX,top:rect.top-movedY,right:rect.right-movedX,bottom:rect.bottom-movedY},movedX&&Math.abs(movedX-moveX)<1&&(x="nearest"),movedY&&Math.abs(movedY-moveY)<1&&(y="nearest")}if(top2)break;cur2=cur2.assignedSlot||cur2.parentNode}else{if(11!=cur2.nodeType)break;cur2=cur2.host}}(this.view.scrollDOM,targetRect,range.head<range.anchor?-1:1,target.x,target.y,target.xMargin,target.yMargin,this.view.textDirection==Direction.LTR)}}class BlockGapWidget extends WidgetType{constructor(height){super(),this.height=height}toDOM(){let elt=document.createElement("div");return this.updateDOM(elt),elt}eq(other){return other.height==this.height}updateDOM(elt){return elt.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function findCompositionNode(view,headPos){let sel=view.observer.selectionRange,textNode=sel.focusNode&&nearbyTextNode(sel.focusNode,sel.focusOffset,0);if(!textNode)return null;let from=headPos-textNode.offset;return{from:from,to:from+textNode.node.nodeValue.length,node:textNode.node}}function nearbyTextNode(startNode,startOffset,side){if(side<=0)for(let node=startNode,offset2=startOffset;;){if(3==node.nodeType)return{node:node,offset:offset2};if(!(1==node.nodeType&&offset2>0))break;node=node.childNodes[offset2-1],offset2=maxOffset(node)}if(side>=0)for(let node=startNode,offset2=startOffset;;){if(3==node.nodeType)return{node:node,offset:offset2};if(!(1==node.nodeType&&offset2<node.childNodes.length&&side>=0))break;node=node.childNodes[offset2],offset2=0}return null}let DecorationComparator$1=class{constructor(){this.changes=[]}compareRange(from,to){addRange(from,to,this.changes)}comparePoint(from,to){addRange(from,to,this.changes)}};function getdx(x,rect){return rect.left>x?rect.left-x:Math.max(0,x-rect.right)}function getdy(y,rect){return rect.top>y?rect.top-y:Math.max(0,y-rect.bottom)}function yOverlap(a,b){return a.top<b.bottom-1&&a.bottom>b.top+1}function upTop(rect,top2){return top2<rect.top?{top:top2,left:rect.left,right:rect.right,bottom:rect.bottom}:rect}function upBot(rect,bottom2){return bottom2>rect.bottom?{top:rect.top,left:rect.left,right:rect.right,bottom:bottom2}:rect}function domPosAtCoords(parent,x,y){let closest,closestRect,closestX,closestY,above,below,aboveRect,belowRect,closestOverlap=!1;for(let child=parent.firstChild;child;child=child.nextSibling){let rects=clientRectsFor(child);for(let i2=0;i2<rects.length;i2++){let rect=rects[i2];closestRect&&yOverlap(closestRect,rect)&&(rect=upTop(upBot(rect,closestRect.bottom),closestRect.top));let dx=getdx(x,rect),dy=getdy(y,rect);if(0==dx&&0==dy)return 3==child.nodeType?domPosInText(child,x,y):domPosAtCoords(child,x,y);if(!closest||closestY>dy||closestY==dy&&closestX>dx){closest=child,closestRect=rect,closestX=dx,closestY=dy;let side=dy?y<rect.top?-1:1:dx?x<rect.left?-1:1:0;closestOverlap=!side||(side>0?i2<rects.length-1:i2>0)}0==dx?y>rect.bottom&&(!aboveRect||aboveRect.bottom<rect.bottom)?(above=child,aboveRect=rect):y<rect.top&&(!belowRect||belowRect.top>rect.top)&&(below=child,belowRect=rect):aboveRect&&yOverlap(aboveRect,rect)?aboveRect=upBot(aboveRect,rect.bottom):belowRect&&yOverlap(belowRect,rect)&&(belowRect=upTop(belowRect,rect.top))}}if(aboveRect&&aboveRect.bottom>=y?(closest=above,closestRect=aboveRect):belowRect&&belowRect.top<=y&&(closest=below,closestRect=belowRect),!closest)return{node:parent,offset:0};let clipX=Math.max(closestRect.left,Math.min(closestRect.right,x));return 3==closest.nodeType?domPosInText(closest,clipX,y):closestOverlap&&"false"!=closest.contentEditable?domPosAtCoords(closest,clipX,y):{node:parent,offset:Array.prototype.indexOf.call(parent.childNodes,closest)+(x>=(closestRect.left+closestRect.right)/2?1:0)}}function domPosInText(node,x,y){let len=node.nodeValue.length,closestOffset=-1,closestDY=1e9,generalSide=0;for(let i2=0;i2<len;i2++){let rects=textRange(node,i2,i2+1).getClientRects();for(let j=0;j<rects.length;j++){let rect=rects[j];if(rect.top==rect.bottom)continue;generalSide||(generalSide=x-rect.left);let dy=(rect.top>y?rect.top-y:y-rect.bottom)-1;if(rect.left-1<=x&&rect.right+1>=x&&dy<closestDY){let right2=x>=(rect.left+rect.right)/2,after=right2;if(browser$1.chrome||browser$1.gecko){textRange(node,i2).getBoundingClientRect().left==rect.right&&(after=!right2)}if(dy<=0)return{node:node,offset:i2+(after?1:0)};closestOffset=i2+(after?1:0),closestDY=dy}}}return{node:node,offset:closestOffset>-1?closestOffset:generalSide>0?node.nodeValue.length:0}}function posAtCoords(view,coords,precise,bias=-1){var _a2,_b;let block,content2=view.contentDOM.getBoundingClientRect(),docTop=content2.top+view.viewState.paddingTop,{docHeight:docHeight}=view.viewState,{x:x,y:y}=coords,yOffset=y-docTop;if(yOffset<0)return 0;if(yOffset>docHeight)return view.state.doc.length;for(let halfLine=view.viewState.heightOracle.textHeight/2,bounced=!1;block=view.elementAtHeight(yOffset),block.type!=BlockType.Text;)for(;yOffset=bias>0?block.bottom+halfLine:block.top-halfLine,!(yOffset>=0&&yOffset<=docHeight);){if(bounced)return precise?null:0;bounced=!0,bias=-bias}y=docTop+yOffset;let lineStart=block.from;if(lineStart<view.viewport.from)return 0==view.viewport.from?0:precise?null:posAtCoordsImprecise(view,content2,block,x,y);if(lineStart>view.viewport.to)return view.viewport.to==view.state.doc.length?view.state.doc.length:precise?null:posAtCoordsImprecise(view,content2,block,x,y);let doc2=view.dom.ownerDocument,root=view.root.elementFromPoint?view.root:doc2,element2=root.elementFromPoint(x,y);element2&&!view.contentDOM.contains(element2)&&(element2=null),element2||(x=Math.max(content2.left+1,Math.min(content2.right-1,x)),element2=root.elementFromPoint(x,y),element2&&!view.contentDOM.contains(element2)&&(element2=null));let node,offset2=-1;if(element2&&0!=(null===(_a2=view.docView.nearest(element2))||void 0===_a2?void 0:_a2.isEditable))if(doc2.caretPositionFromPoint){let pos=doc2.caretPositionFromPoint(x,y);pos&&({offsetNode:node,offset:offset2}=pos)}else if(doc2.caretRangeFromPoint){let range=doc2.caretRangeFromPoint(x,y);range&&(({startContainer:node,startOffset:offset2}=range),(!view.contentDOM.contains(node)||browser$1.safari&&function(node,offset2,x){let len;if(3!=node.nodeType||offset2!=(len=node.nodeValue.length))return!1;for(let next=node.nextSibling;next;next=next.nextSibling)if(1!=next.nodeType||"BR"!=next.nodeName)return!1;return textRange(node,len-1,len).getBoundingClientRect().left>x}(node,offset2,x)||browser$1.chrome&&function(node,offset2,x){if(0!=offset2)return!1;for(let cur2=node;;){let parent=cur2.parentNode;if(!parent||1!=parent.nodeType||parent.firstChild!=cur2)return!1;if(parent.classList.contains("cm-line"))break;cur2=parent}let rect=1==node.nodeType?node.getBoundingClientRect():textRange(node,0,Math.max(node.nodeValue.length,1)).getBoundingClientRect();return x-rect.left>5}(node,offset2,x))&&(node=void 0))}if(!node||!view.docView.dom.contains(node)){let line=LineView.find(view.docView,lineStart);if(!line)return yOffset>block.top+block.height/2?block.to:block.from;({node:node,offset:offset2}=domPosAtCoords(line.dom,x,y))}let nearest=view.docView.nearest(node);if(!nearest)return null;if(nearest.isWidget&&1==(null===(_b=nearest.dom)||void 0===_b?void 0:_b.nodeType)){let rect=nearest.dom.getBoundingClientRect();return coords.y<rect.top||coords.y<=rect.bottom&&coords.x<=(rect.left+rect.right)/2?nearest.posAtStart:nearest.posAtEnd}return nearest.localPosFromDOM(node,offset2)+nearest.posAtStart}function posAtCoordsImprecise(view,contentRect,block,x,y){let into=Math.round((x-contentRect.left)*view.defaultCharacterWidth);if(view.lineWrapping&&block.height>1.5*view.defaultLineHeight){let textHeight=view.viewState.heightOracle.textHeight;into+=Math.floor((y-block.top-.5*(view.defaultLineHeight-textHeight))/textHeight)*view.viewState.heightOracle.lineLength}let content2=view.state.sliceDoc(block.from,block.to);return block.from+findColumn(content2,into,view.state.tabSize)}function moveToLineBoundary(view,start2,forward,includeWrap){let line=function(view,pos){let line=view.lineBlockAt(pos);if(Array.isArray(line.type))for(let l of line.type)if(l.to>pos||l.to==pos&&(l.to==line.to||l.type==BlockType.Text))return l;return line}(view,start2.head),coords=includeWrap&&line.type==BlockType.Text&&(view.lineWrapping||line.widgetLineBreaks)?view.coordsAtPos(start2.assoc<0&&start2.head>line.from?start2.head-1:start2.head):null;if(coords){let editorRect=view.dom.getBoundingClientRect(),direction=view.textDirectionAt(line.from),pos=view.posAtCoords({x:forward==(direction==Direction.LTR)?editorRect.right-1:editorRect.left+1,y:(coords.top+coords.bottom)/2});if(null!=pos)return EditorSelection.cursor(pos,forward?-1:1)}return EditorSelection.cursor(forward?line.to:line.from,forward?-1:1)}function moveByChar(view,start2,forward,by){let line=view.state.doc.lineAt(start2.head),spans=view.bidiSpans(line),direction=view.textDirectionAt(line.from);for(let cur2=start2,check=null;;){let next=moveVisually(line,spans,direction,cur2,forward),char=movedOver;if(!next){if(line.number==(forward?view.state.doc.lines:1))return cur2;char="\n",line=view.state.doc.line(line.number+(forward?1:-1)),spans=view.bidiSpans(line),next=EditorSelection.cursor(forward?line.from:line.to)}if(check){if(!check(char))return cur2}else{if(!by)return next;check=by(char)}cur2=next}}function skipAtomicRanges(atoms,pos,bias){for(;;){let moved=0;for(let set2 of atoms)set2.between(pos-1,pos+1,((from,to,value)=>{if(pos>from&&pos<to){let side=moved||bias||(pos-from<to-pos?-1:1);pos=side<0?from:to,moved=side}}));if(!moved)return pos}}function skipAtoms(view,oldPos,pos){let newPos=skipAtomicRanges(view.state.facet(atomicRanges).map((f=>f(view))),pos.from,oldPos.head>pos.from?-1:1);return newPos==pos.from?pos:EditorSelection.cursor(newPos,newPos<pos.from?1:-1)}class InputState{setSelectionOrigin(origin){this.lastSelectionOrigin=origin,this.lastSelectionTime=Date.now()}constructor(view){var doc2;this.view=view,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=view.hasFocus,browser$1.safari&&view.contentDOM.addEventListener("input",(()=>null)),browser$1.gecko&&(doc2=view.contentDOM.ownerDocument,appliedFirefoxHack.has(doc2)||(appliedFirefoxHack.add(doc2),doc2.addEventListener("copy",(()=>{})),doc2.addEventListener("cut",(()=>{}))))}handleEvent(event){(function(view,event){if(!event.bubbles)return!0;if(event.defaultPrevented)return!1;for(let cView,node=event.target;node!=view.contentDOM;node=node.parentNode)if(!node||11==node.nodeType||(cView=ContentView.get(node))&&cView.ignoreEvent(event))return!1;return!0})(this.view,event)&&!this.ignoreDuringComposition(event)&&("keydown"==event.type&&this.keydown(event)||this.runHandlers(event.type,event))}runHandlers(type2,event){let handlers2=this.handlers[type2];if(handlers2){for(let observer of handlers2.observers)observer(this.view,event);for(let handler of handlers2.handlers){if(event.defaultPrevented)break;if(handler(this.view,event)){event.preventDefault();break}}}}ensureHandlers(plugins){let handlers2=function(plugins){let result=Object.create(null);function record(type2){return result[type2]||(result[type2]={observers:[],handlers:[]})}for(let plugin of plugins){let spec=plugin.spec;if(spec&&spec.domEventHandlers)for(let type2 in spec.domEventHandlers){let f=spec.domEventHandlers[type2];f&&record(type2).handlers.push(bindHandler(plugin.value,f))}if(spec&&spec.domEventObservers)for(let type2 in spec.domEventObservers){let f=spec.domEventObservers[type2];f&&record(type2).observers.push(bindHandler(plugin.value,f))}}for(let type2 in handlers)record(type2).handlers.push(handlers[type2]);for(let type2 in observers)record(type2).observers.push(observers[type2]);return result}(plugins),prev=this.handlers,dom=this.view.contentDOM;for(let type2 in handlers2)if("scroll"!=type2){let passive2=!handlers2[type2].handlers.length,exists=prev[type2];exists&&passive2!=!exists.handlers.length&&(dom.removeEventListener(type2,this.handleEvent),exists=null),exists||dom.addEventListener(type2,this.handleEvent,{passive:passive2})}for(let type2 in prev)"scroll"==type2||handlers2[type2]||dom.removeEventListener(type2,this.handleEvent);this.handlers=handlers2}keydown(event){if(this.lastKeyCode=event.keyCode,this.lastKeyTime=Date.now(),9==event.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(27!=event.keyCode&&modifierCodes.indexOf(event.keyCode)<0&&(this.view.inputState.lastEscPress=0),browser$1.android&&browser$1.chrome&&!event.synthetic&&(13==event.keyCode||8==event.keyCode))return this.view.observer.delayAndroidKey(event.key,event.keyCode),!0;let pending;return!browser$1.ios||event.synthetic||event.altKey||event.metaKey||!((pending=PendingKeys.find((key=>key.keyCode==event.keyCode)))&&!event.ctrlKey||EmacsyPendingKeys.indexOf(event.key)>-1&&event.ctrlKey&&!event.shiftKey)?(229!=event.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=pending||event,setTimeout((()=>this.flushIOSKey()),250),!0)}flushIOSKey(){let key=this.pendingIOSKey;return!!key&&(this.pendingIOSKey=void 0,dispatchKey(this.view.contentDOM,key.key,key.keyCode))}ignoreDuringComposition(event){return!!/^key/.test(event.type)&&(this.composing>0||!!(browser$1.safari&&!browser$1.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(mouseSelection){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=mouseSelection}update(update2){this.mouseSelection&&this.mouseSelection.update(update2),update2.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function bindHandler(plugin,handler){return(view,event)=>{try{return handler.call(plugin,event,view)}catch(e){logException(view.state,e)}}}const PendingKeys=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],EmacsyPendingKeys="dthko",modifierCodes=[16,17,18,20,91,92,224,225];function dragScrollSpeed(dist2){return.7*Math.max(0,dist2)+8}class MouseSelection{constructor(view,startEvent,style,mustSelect){this.view=view,this.startEvent=startEvent,this.style=style,this.mustSelect=mustSelect,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=startEvent,this.scrollParent=function(dom){let doc2=dom.ownerDocument;for(let cur2=dom.parentNode;cur2&&cur2!=doc2.body;)if(1==cur2.nodeType){if(cur2.scrollHeight>cur2.clientHeight||cur2.scrollWidth>cur2.clientWidth)return cur2;cur2=cur2.assignedSlot||cur2.parentNode}else{if(11!=cur2.nodeType)break;cur2=cur2.host}return null}(view.contentDOM),this.atoms=view.state.facet(atomicRanges).map((f=>f(view)));let doc2=view.contentDOM.ownerDocument;doc2.addEventListener("mousemove",this.move=this.move.bind(this)),doc2.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=startEvent.shiftKey,this.multiple=view.state.facet(EditorState.allowMultipleSelections)&&function(view,event){let facet=view.state.facet(clickAddsSelectionRange);return facet.length?facet[0](event):browser$1.mac?event.metaKey:event.ctrlKey}(view,startEvent),this.dragging=!(!function(view,event){let{main:main2}=view.state.selection;if(main2.empty)return!1;let sel=getSelection(view.root);if(!sel||0==sel.rangeCount)return!0;let rects=sel.getRangeAt(0).getClientRects();for(let i2=0;i2<rects.length;i2++){let rect=rects[i2];if(rect.left<=event.clientX&&rect.right>=event.clientX&&rect.top<=event.clientY&&rect.bottom>=event.clientY)return!0}return!1}(view,startEvent)||1!=getClickType(startEvent))&&null}start(event){!1===this.dragging&&this.select(event)}move(event){var _a2,a,b;if(0==event.buttons)return this.destroy();if(this.dragging||null==this.dragging&&(a=this.startEvent,b=event,Math.max(Math.abs(a.clientX-b.clientX),Math.abs(a.clientY-b.clientY))<10))return;this.select(this.lastEvent=event);let sx=0,sy=0,rect=(null===(_a2=this.scrollParent)||void 0===_a2?void 0:_a2.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},margins=getScrollMargins(this.view);event.clientX-margins.left<=rect.left+6?sx=-dragScrollSpeed(rect.left-event.clientX):event.clientX+margins.right>=rect.right-6&&(sx=dragScrollSpeed(event.clientX-rect.right)),event.clientY-margins.top<=rect.top+6?sy=-dragScrollSpeed(rect.top-event.clientY):event.clientY+margins.bottom>=rect.bottom-6&&(sy=dragScrollSpeed(event.clientY-rect.bottom)),this.setScrollSpeed(sx,sy)}up(event){null==this.dragging&&this.select(this.lastEvent),this.dragging||event.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let doc2=this.view.contentDOM.ownerDocument;doc2.removeEventListener("mousemove",this.move),doc2.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(sx,sy){this.scrollSpeed={x:sx,y:sy},sx||sy?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(sel){let ranges=null;for(let i2=0;i2<sel.ranges.length;i2++){let range=sel.ranges[i2],updated=null;if(range.empty){let pos=skipAtomicRanges(this.atoms,range.from,0);pos!=range.from&&(updated=EditorSelection.cursor(pos,-1))}else{let from=skipAtomicRanges(this.atoms,range.from,-1),to=skipAtomicRanges(this.atoms,range.to,1);from==range.from&&to==range.to||(updated=EditorSelection.range(range.from==range.anchor?from:to,range.from==range.head?from:to))}updated&&(ranges||(ranges=sel.ranges.slice()),ranges[i2]=updated)}return ranges?EditorSelection.create(ranges,sel.mainIndex):sel}select(event){let{view:view}=this,selection2=this.skipAtoms(this.style.get(event,this.extend,this.multiple));(this.mustSelect||!selection2.eq(view.state.selection)||selection2.main.assoc!=view.state.selection.main.assoc&&!1===this.dragging)&&this.view.dispatch({selection:selection2,userEvent:"select.pointer"}),this.mustSelect=!1}update(update2){update2.docChanged&&this.dragging&&(this.dragging=this.dragging.map(update2.changes)),this.style.update(update2)&&setTimeout((()=>this.select(this.lastEvent)),20)}}const handlers=Object.create(null),observers=Object.create(null),brokenClipboardAPI=browser$1.ie&&browser$1.ie_version<15||browser$1.ios&&browser$1.webkit_version<604;function doPaste(view,input){let changes,{state:state}=view,i2=1,text2=state.toText(input),byLine=text2.lines==state.selection.ranges.length;if(null!=lastLinewiseCopy&&state.selection.ranges.every((r=>r.empty))&&lastLinewiseCopy==text2.toString()){let lastLine=-1;changes=state.changeByRange((range=>{let line=state.doc.lineAt(range.from);if(line.from==lastLine)return{range:range};lastLine=line.from;let insert2=state.toText((byLine?text2.line(i2++).text:input)+state.lineBreak);return{changes:{from:line.from,insert:insert2},range:EditorSelection.cursor(range.from+insert2.length)}}))}else changes=byLine?state.changeByRange((range=>{let line=text2.line(i2++);return{changes:{from:range.from,to:range.to,insert:line.text},range:EditorSelection.cursor(range.from+line.length)}})):state.replaceSelection(text2);view.dispatch(changes,{userEvent:"input.paste",scrollIntoView:!0})}function rangeForClick(view,pos,bias,type2){if(1==type2)return EditorSelection.cursor(pos,bias);if(2==type2)return function(state,pos,bias=1){let categorize=state.charCategorizer(pos),line=state.doc.lineAt(pos),linePos=pos-line.from;if(0==line.length)return EditorSelection.cursor(pos);0==linePos?bias=1:linePos==line.length&&(bias=-1);let from=linePos,to=linePos;bias<0?from=findClusterBreak(line.text,linePos,!1):to=findClusterBreak(line.text,linePos);let cat=categorize(line.text.slice(from,to));for(;from>0;){let prev=findClusterBreak(line.text,from,!1);if(categorize(line.text.slice(prev,from))!=cat)break;from=prev}for(;to<line.length;){let next=findClusterBreak(line.text,to);if(categorize(line.text.slice(to,next))!=cat)break;to=next}return EditorSelection.range(from+line.from,to+line.from)}(view.state,pos,bias);{let visual=LineView.find(view.docView,pos),line=view.state.doc.lineAt(visual?visual.posAtEnd:pos),from=visual?visual.posAtStart:line.from,to=visual?visual.posAtEnd:line.to;return to<view.state.doc.length&&to==line.to&&to++,EditorSelection.range(from,to)}}observers.scroll=view=>{view.inputState.lastScrollTop=view.scrollDOM.scrollTop,view.inputState.lastScrollLeft=view.scrollDOM.scrollLeft},handlers.keydown=(view,event)=>(view.inputState.setSelectionOrigin("select"),27==event.keyCode&&(view.inputState.lastEscPress=Date.now()),!1),observers.touchstart=(view,e)=>{view.inputState.lastTouchTime=Date.now(),view.inputState.setSelectionOrigin("select.pointer")},observers.touchmove=view=>{view.inputState.setSelectionOrigin("select.pointer")},handlers.mousedown=(view,event)=>{if(view.observer.flush(),view.inputState.lastTouchTime>Date.now()-2e3)return!1;let style=null;for(let makeStyle of view.state.facet(mouseSelectionStyle))if(style=makeStyle(view,event),style)break;if(style||0!=event.button||(style=function(view,event){let start2=queryPos(view,event),type2=getClickType(event),startSel=view.state.selection;return{update(update2){update2.docChanged&&(start2.pos=update2.changes.mapPos(start2.pos),startSel=startSel.map(update2.changes))},get(event2,extend2,multiple){let removed,cur2=queryPos(view,event2),range=rangeForClick(view,cur2.pos,cur2.bias,type2);if(start2.pos!=cur2.pos&&!extend2){let startRange=rangeForClick(view,start2.pos,start2.bias,type2),from=Math.min(startRange.from,range.from),to=Math.max(startRange.to,range.to);range=from<range.from?EditorSelection.range(from,to):EditorSelection.range(to,from)}return extend2?startSel.replaceRange(startSel.main.extend(range.from,range.to)):multiple&&1==type2&&startSel.ranges.length>1&&(removed=function(sel,pos){for(let i2=0;i2<sel.ranges.length;i2++){let{from:from,to:to}=sel.ranges[i2];if(from<=pos&&to>=pos)return EditorSelection.create(sel.ranges.slice(0,i2).concat(sel.ranges.slice(i2+1)),sel.mainIndex==i2?0:sel.mainIndex-(sel.mainIndex>i2?1:0))}return null}(startSel,cur2.pos))?removed:multiple?startSel.addRange(range):EditorSelection.create([range])}}}(view,event)),style){let mustFocus=!view.hasFocus;view.inputState.startMouseSelection(new MouseSelection(view,event,style,mustFocus)),mustFocus&&view.observer.ignore((()=>focusPreventScroll(view.contentDOM)));let mouseSel=view.inputState.mouseSelection;if(mouseSel)return mouseSel.start(event),!1===mouseSel.dragging}return!1};let insideY=(y,rect)=>y>=rect.top&&y<=rect.bottom,inside=(x,y,rect)=>insideY(y,rect)&&x>=rect.left&&x<=rect.right;function findPositionSide(view,pos,x,y){let line=LineView.find(view.docView,pos);if(!line)return 1;let off=pos-line.posAtStart;if(0==off)return 1;if(off==line.length)return-1;let before=line.coordsAt(off,-1);if(before&&inside(x,y,before))return-1;let after=line.coordsAt(off,1);return after&&inside(x,y,after)?1:before&&insideY(y,before)?-1:1}function queryPos(view,event){let pos=view.posAtCoords({x:event.clientX,y:event.clientY},!1);return{pos:pos,bias:findPositionSide(view,pos,event.clientX,event.clientY)}}const BadMouseDetail=browser$1.ie&&browser$1.ie_version<=11;let lastMouseDown=null,lastMouseDownCount=0,lastMouseDownTime=0;function getClickType(event){if(!BadMouseDetail)return event.detail;let last=lastMouseDown,lastTime=lastMouseDownTime;return lastMouseDown=event,lastMouseDownTime=Date.now(),lastMouseDownCount=!last||lastTime>Date.now()-400&&Math.abs(last.clientX-event.clientX)<2&&Math.abs(last.clientY-event.clientY)<2?(lastMouseDownCount+1)%3:1}function dropText(view,event,text2,direct){if(!text2)return;let dropPos=view.posAtCoords({x:event.clientX,y:event.clientY},!1),{mouseSelection:mouseSelection}=view.inputState,del=direct&&mouseSelection&&mouseSelection.dragging&&function(view,event){let facet=view.state.facet(dragMovesSelection$1);return facet.length?facet[0](event):browser$1.mac?!event.altKey:!event.ctrlKey}(view,event)?{from:mouseSelection.dragging.from,to:mouseSelection.dragging.to}:null,ins={from:dropPos,insert:text2},changes=view.state.changes(del?[del,ins]:ins);view.focus(),view.dispatch({changes:changes,selection:{anchor:changes.mapPos(dropPos,-1),head:changes.mapPos(dropPos,1)},userEvent:del?"move.drop":"input.drop"})}handlers.dragstart=(view,event)=>{let{selection:{main:main2}}=view.state,{mouseSelection:mouseSelection}=view.inputState;return mouseSelection&&(mouseSelection.dragging=main2),event.dataTransfer&&(event.dataTransfer.setData("Text",view.state.sliceDoc(main2.from,main2.to)),event.dataTransfer.effectAllowed="copyMove"),!1},handlers.drop=(view,event)=>{if(!event.dataTransfer)return!1;if(view.state.readOnly)return!0;let files=event.dataTransfer.files;if(files&&files.length){let text2=Array(files.length),read2=0,finishFile=()=>{++read2==files.length&&dropText(view,event,text2.filter((s=>null!=s)).join(view.state.lineBreak),!1)};for(let i2=0;i2<files.length;i2++){let reader=new FileReader;reader.onerror=finishFile,reader.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(reader.result)||(text2[i2]=reader.result),finishFile()},reader.readAsText(files[i2])}return!0}{let text2=event.dataTransfer.getData("Text");if(text2)return dropText(view,event,text2,!0),!0}return!1},handlers.paste=(view,event)=>{if(view.state.readOnly)return!0;view.observer.flush();let data2=brokenClipboardAPI?null:event.clipboardData;return data2?(doPaste(view,data2.getData("text/plain")||data2.getData("text/uri-text")),!0):(function(view){let parent=view.dom.parentNode;if(!parent)return;let target=parent.appendChild(document.createElement("textarea"));target.style.cssText="position: fixed; left: -10000px; top: 10px",target.focus(),setTimeout((()=>{view.focus(),target.remove(),doPaste(view,target.value)}),50)}(view),!1)};let lastLinewiseCopy=null;handlers.copy=handlers.cut=(view,event)=>{let{text:text2,ranges:ranges,linewise:linewise}=function(state){let content2=[],ranges=[],linewise=!1;for(let range of state.selection.ranges)range.empty||(content2.push(state.sliceDoc(range.from,range.to)),ranges.push(range));if(!content2.length){let upto=-1;for(let{from:from}of state.selection.ranges){let line=state.doc.lineAt(from);line.number>upto&&(content2.push(line.text),ranges.push({from:line.from,to:Math.min(state.doc.length,line.to+1)})),upto=line.number}linewise=!0}return{text:content2.join(state.lineBreak),ranges:ranges,linewise:linewise}}(view.state);if(!text2&&!linewise)return!1;lastLinewiseCopy=linewise?text2:null,"cut"!=event.type||view.state.readOnly||view.dispatch({changes:ranges,scrollIntoView:!0,userEvent:"delete.cut"});let data2=brokenClipboardAPI?null:event.clipboardData;return data2?(data2.clearData(),data2.setData("text/plain",text2),!0):(function(view,text2){let parent=view.dom.parentNode;if(!parent)return;let target=parent.appendChild(document.createElement("textarea"));target.style.cssText="position: fixed; left: -10000px; top: 10px",target.value=text2,target.focus(),target.selectionEnd=text2.length,target.selectionStart=0,setTimeout((()=>{target.remove(),view.focus()}),50)}(view,text2),!1)};const isFocusChange=Annotation.define();function focusChangeTransaction(state,focus){let effects=[];for(let getEffect of state.facet(focusChangeEffect)){let effect2=getEffect(state,focus);effect2&&effects.push(effect2)}return effects?state.update({effects:effects,annotations:isFocusChange.of(!0)}):null}function updateForFocusChange(view){setTimeout((()=>{let focus=view.hasFocus;if(focus!=view.inputState.notifiedFocused){let tr=focusChangeTransaction(view.state,focus);tr?view.dispatch(tr):view.update([])}}),10)}observers.focus=view=>{view.inputState.lastFocusTime=Date.now(),view.scrollDOM.scrollTop||!view.inputState.lastScrollTop&&!view.inputState.lastScrollLeft||(view.scrollDOM.scrollTop=view.inputState.lastScrollTop,view.scrollDOM.scrollLeft=view.inputState.lastScrollLeft),updateForFocusChange(view)},observers.blur=view=>{view.observer.clearSelectionRange(),updateForFocusChange(view)},observers.compositionstart=observers.compositionupdate=view=>{null==view.inputState.compositionFirstChange&&(view.inputState.compositionFirstChange=!0),view.inputState.composing<0&&(view.inputState.composing=0)},observers.compositionend=view=>{view.inputState.composing=-1,view.inputState.compositionEndedAt=Date.now(),view.inputState.compositionPendingKey=!0,view.inputState.compositionPendingChange=view.observer.pendingRecords().length>0,view.inputState.compositionFirstChange=null,browser$1.chrome&&browser$1.android?view.observer.flushSoon():view.inputState.compositionPendingChange?Promise.resolve().then((()=>view.observer.flush())):setTimeout((()=>{view.inputState.composing<0&&view.docView.hasComposition&&view.update([])}),50)},observers.contextmenu=view=>{view.inputState.lastContextMenu=Date.now()},handlers.beforeinput=(view,event)=>{var _a2;let pending;if(browser$1.chrome&&browser$1.android&&(pending=PendingKeys.find((key=>key.inputType==event.inputType)))&&(view.observer.delayAndroidKey(pending.key,pending.keyCode),"Backspace"==pending.key||"Delete"==pending.key)){let startViewHeight=(null===(_a2=window.visualViewport)||void 0===_a2?void 0:_a2.height)||0;setTimeout((()=>{var _a3;((null===(_a3=window.visualViewport)||void 0===_a3?void 0:_a3.height)||0)>startViewHeight+10&&view.hasFocus&&(view.contentDOM.blur(),view.focus())}),100)}return!1};const appliedFirefoxHack=new Set;const wrappingWhiteSpace=["pre-wrap","normal","pre-line","break-spaces"];class HeightOracle{constructor(lineWrapping){this.lineWrapping=lineWrapping,this.doc=Text.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(from,to){let lines=this.doc.lineAt(to).number-this.doc.lineAt(from).number+1;return this.lineWrapping&&(lines+=Math.max(0,Math.ceil((to-from-lines*this.lineLength*.5)/this.lineLength))),this.lineHeight*lines}heightForLine(length){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((length-this.lineLength)/(this.lineLength-5))))*this.lineHeight}setDoc(doc2){return this.doc=doc2,this}mustRefreshForWrapping(whiteSpace){return wrappingWhiteSpace.indexOf(whiteSpace)>-1!=this.lineWrapping}mustRefreshForHeights(lineHeights){let newHeight=!1;for(let i2=0;i2<lineHeights.length;i2++){let h=lineHeights[i2];h<0?i2++:this.heightSamples[Math.floor(10*h)]||(newHeight=!0,this.heightSamples[Math.floor(10*h)]=!0)}return newHeight}refresh(whiteSpace,lineHeight,charWidth,textHeight,lineLength,knownHeights){let lineWrapping=wrappingWhiteSpace.indexOf(whiteSpace)>-1,changed=Math.round(lineHeight)!=Math.round(this.lineHeight)||this.lineWrapping!=lineWrapping;if(this.lineWrapping=lineWrapping,this.lineHeight=lineHeight,this.charWidth=charWidth,this.textHeight=textHeight,this.lineLength=lineLength,changed){this.heightSamples={};for(let i2=0;i2<knownHeights.length;i2++){let h=knownHeights[i2];h<0?i2++:this.heightSamples[Math.floor(10*h)]=!0}}return changed}}class MeasuredHeights{constructor(from,heights){this.from=from,this.heights=heights,this.index=0}get more(){return this.index<this.heights.length}}class BlockInfo{constructor(from,length,top2,height,_content){this.from=from,this.length=length,this.top=top2,this.height=height,this._content=_content}get type(){return"number"==typeof this._content?BlockType.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof PointDecoration?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(other){let content2=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(other._content)?other._content:[other]);return new BlockInfo(this.from,this.length+other.length,this.top,this.height+other.height,content2)}}var QueryType$1=function(QueryType2){return QueryType2[QueryType2.ByPos=0]="ByPos",QueryType2[QueryType2.ByHeight=1]="ByHeight",QueryType2[QueryType2.ByPosNoHeight=2]="ByPosNoHeight",QueryType2}(QueryType$1||(QueryType$1={}));class HeightMap{constructor(length,height,flags=2){this.length=length,this.height=height,this.flags=flags}get outdated(){return(2&this.flags)>0}set outdated(value){this.flags=(value?2:0)|-3&this.flags}setHeight(oracle,height){this.height!=height&&(Math.abs(this.height-height)>.001&&(oracle.heightChanged=!0),this.height=height)}replace(_from,_to,nodes){return HeightMap.of(nodes)}decomposeLeft(_to,result){result.push(this)}decomposeRight(_from,result){result.push(this)}applyChanges(decorations2,oldDoc,oracle,changes){let me=this,doc2=oracle.doc;for(let i2=changes.length-1;i2>=0;i2--){let{fromA:fromA,toA:toA,fromB:fromB,toB:toB}=changes[i2],start2=me.lineAt(fromA,QueryType$1.ByPosNoHeight,oracle.setDoc(oldDoc),0,0),end2=start2.to>=toA?start2:me.lineAt(toA,QueryType$1.ByPosNoHeight,oracle,0,0);for(toB+=end2.to-toA,toA=end2.to;i2>0&&start2.from<=changes[i2-1].toA;)fromA=changes[i2-1].fromA,fromB=changes[i2-1].fromB,i2--,fromA<start2.from&&(start2=me.lineAt(fromA,QueryType$1.ByPosNoHeight,oracle,0,0));fromB+=start2.from-fromA,fromA=start2.from;let nodes=NodeBuilder.build(oracle.setDoc(doc2),decorations2,fromB,toB);me=me.replace(fromA,toA,nodes)}return me.updateHeight(oracle,0)}static empty(){return new HeightMapText(0,0)}static of(nodes){if(1==nodes.length)return nodes[0];let i2=0,j=nodes.length,before=0,after=0;for(;;)if(i2==j)if(before>2*after){let split=nodes[i2-1];split.break?nodes.splice(--i2,1,split.left,null,split.right):nodes.splice(--i2,1,split.left,split.right),j+=1+split.break,before-=split.size}else{if(!(after>2*before))break;{let split=nodes[j];split.break?nodes.splice(j,1,split.left,null,split.right):nodes.splice(j,1,split.left,split.right),j+=2+split.break,after-=split.size}}else if(before<after){let next=nodes[i2++];next&&(before+=next.size)}else{let next=nodes[--j];next&&(after+=next.size)}let brk=0;return null==nodes[i2-1]?(brk=1,i2--):null==nodes[i2]&&(brk=1,j++),new HeightMapBranch(HeightMap.of(nodes.slice(0,i2)),brk,HeightMap.of(nodes.slice(j)))}}HeightMap.prototype.size=1;class HeightMapBlock extends HeightMap{constructor(length,height,deco){super(length,height),this.deco=deco}blockAt(_height,_oracle,top2,offset2){return new BlockInfo(offset2,this.length,top2,this.height,this.deco||0)}lineAt(_value,_type,oracle,top2,offset2){return this.blockAt(0,oracle,top2,offset2)}forEachLine(from,to,oracle,top2,offset2,f){from<=offset2+this.length&&to>=offset2&&f(this.blockAt(0,oracle,top2,offset2))}updateHeight(oracle,offset2=0,_force=!1,measured){return measured&&measured.from<=offset2&&measured.more&&this.setHeight(oracle,measured.heights[measured.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class HeightMapText extends HeightMapBlock{constructor(length,height){super(length,height,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(_height,_oracle,top2,offset2){return new BlockInfo(offset2,this.length,top2,this.height,this.breaks)}replace(_from,_to,nodes){let node=nodes[0];return 1==nodes.length&&(node instanceof HeightMapText||node instanceof HeightMapGap&&4&node.flags)&&Math.abs(this.length-node.length)<10?(node instanceof HeightMapGap?node=new HeightMapText(node.length,this.height):node.height=this.height,this.outdated||(node.outdated=!1),node):HeightMap.of(nodes)}updateHeight(oracle,offset2=0,force=!1,measured){return measured&&measured.from<=offset2&&measured.more?this.setHeight(oracle,measured.heights[measured.index++]):(force||this.outdated)&&this.setHeight(oracle,Math.max(this.widgetHeight,oracle.heightForLine(this.length-this.collapsed))+this.breaks*oracle.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class HeightMapGap extends HeightMap{constructor(length){super(length,0)}heightMetrics(oracle,offset2){let perLine,firstLine=oracle.doc.lineAt(offset2).number,lastLine=oracle.doc.lineAt(offset2+this.length).number,lines=lastLine-firstLine+1,perChar=0;if(oracle.lineWrapping){let totalPerLine=Math.min(this.height,oracle.lineHeight*lines);perLine=totalPerLine/lines,this.length>lines+1&&(perChar=(this.height-totalPerLine)/(this.length-lines-1))}else perLine=this.height/lines;return{firstLine:firstLine,lastLine:lastLine,perLine:perLine,perChar:perChar}}blockAt(height,oracle,top2,offset2){let{firstLine:firstLine,lastLine:lastLine,perLine:perLine,perChar:perChar}=this.heightMetrics(oracle,offset2);if(oracle.lineWrapping){let guess=offset2+Math.round(Math.max(0,Math.min(1,(height-top2)/this.height))*this.length),line=oracle.doc.lineAt(guess),lineHeight=perLine+line.length*perChar,lineTop=Math.max(top2,height-lineHeight/2);return new BlockInfo(line.from,line.length,lineTop,lineHeight,0)}{let line=Math.max(0,Math.min(lastLine-firstLine,Math.floor((height-top2)/perLine))),{from:from,length:length}=oracle.doc.line(firstLine+line);return new BlockInfo(from,length,top2+perLine*line,perLine,0)}}lineAt(value,type2,oracle,top2,offset2){if(type2==QueryType$1.ByHeight)return this.blockAt(value,oracle,top2,offset2);if(type2==QueryType$1.ByPosNoHeight){let{from:from,to:to}=oracle.doc.lineAt(value);return new BlockInfo(from,to-from,0,0,0)}let{firstLine:firstLine,perLine:perLine,perChar:perChar}=this.heightMetrics(oracle,offset2),line=oracle.doc.lineAt(value),lineHeight=perLine+line.length*perChar,linesAbove=line.number-firstLine,lineTop=top2+perLine*linesAbove+perChar*(line.from-offset2-linesAbove);return new BlockInfo(line.from,line.length,Math.max(top2,Math.min(lineTop,top2+this.height-lineHeight)),lineHeight,0)}forEachLine(from,to,oracle,top2,offset2,f){from=Math.max(from,offset2),to=Math.min(to,offset2+this.length);let{firstLine:firstLine,perLine:perLine,perChar:perChar}=this.heightMetrics(oracle,offset2);for(let pos=from,lineTop=top2;pos<=to;){let line=oracle.doc.lineAt(pos);if(pos==from){let linesAbove=line.number-firstLine;lineTop+=perLine*linesAbove+perChar*(from-offset2-linesAbove)}let lineHeight=perLine+perChar*line.length;f(new BlockInfo(line.from,line.length,lineTop,lineHeight,0)),lineTop+=lineHeight,pos=line.to+1}}replace(from,to,nodes){let after=this.length-to;if(after>0){let last=nodes[nodes.length-1];last instanceof HeightMapGap?nodes[nodes.length-1]=new HeightMapGap(last.length+after):nodes.push(null,new HeightMapGap(after-1))}if(from>0){let first=nodes[0];first instanceof HeightMapGap?nodes[0]=new HeightMapGap(from+first.length):nodes.unshift(new HeightMapGap(from-1),null)}return HeightMap.of(nodes)}decomposeLeft(to,result){result.push(new HeightMapGap(to-1),null)}decomposeRight(from,result){result.push(null,new HeightMapGap(this.length-from-1))}updateHeight(oracle,offset2=0,force=!1,measured){let end2=offset2+this.length;if(measured&&measured.from<=offset2+this.length&&measured.more){let nodes=[],pos=Math.max(offset2,measured.from),singleHeight=-1;for(measured.from>offset2&&nodes.push(new HeightMapGap(measured.from-offset2-1).updateHeight(oracle,offset2));pos<=end2&&measured.more;){let len=oracle.doc.lineAt(pos).length;nodes.length&&nodes.push(null);let height=measured.heights[measured.index++];-1==singleHeight?singleHeight=height:Math.abs(height-singleHeight)>=.001&&(singleHeight=-2);let line=new HeightMapText(len,height);line.outdated=!1,nodes.push(line),pos+=len+1}pos<=end2&&nodes.push(null,new HeightMapGap(end2-pos).updateHeight(oracle,pos));let result=HeightMap.of(nodes);return(singleHeight<0||Math.abs(result.height-this.height)>=.001||Math.abs(singleHeight-this.heightMetrics(oracle,offset2).perLine)>=.001)&&(oracle.heightChanged=!0),result}return(force||this.outdated)&&(this.setHeight(oracle,oracle.heightForGap(offset2,offset2+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class HeightMapBranch extends HeightMap{constructor(left2,brk,right2){super(left2.length+brk+right2.length,left2.height+right2.height,brk|(left2.outdated||right2.outdated?2:0)),this.left=left2,this.right=right2,this.size=left2.size+right2.size}get break(){return 1&this.flags}blockAt(height,oracle,top2,offset2){let mid=top2+this.left.height;return height<mid?this.left.blockAt(height,oracle,top2,offset2):this.right.blockAt(height,oracle,mid,offset2+this.left.length+this.break)}lineAt(value,type2,oracle,top2,offset2){let rightTop=top2+this.left.height,rightOffset=offset2+this.left.length+this.break,left2=type2==QueryType$1.ByHeight?value<rightTop:value<rightOffset,base2=left2?this.left.lineAt(value,type2,oracle,top2,offset2):this.right.lineAt(value,type2,oracle,rightTop,rightOffset);if(this.break||(left2?base2.to<rightOffset:base2.from>rightOffset))return base2;let subQuery=type2==QueryType$1.ByPosNoHeight?QueryType$1.ByPosNoHeight:QueryType$1.ByPos;return left2?base2.join(this.right.lineAt(rightOffset,subQuery,oracle,rightTop,rightOffset)):this.left.lineAt(rightOffset,subQuery,oracle,top2,offset2).join(base2)}forEachLine(from,to,oracle,top2,offset2,f){let rightTop=top2+this.left.height,rightOffset=offset2+this.left.length+this.break;if(this.break)from<rightOffset&&this.left.forEachLine(from,to,oracle,top2,offset2,f),to>=rightOffset&&this.right.forEachLine(from,to,oracle,rightTop,rightOffset,f);else{let mid=this.lineAt(rightOffset,QueryType$1.ByPos,oracle,top2,offset2);from<mid.from&&this.left.forEachLine(from,mid.from-1,oracle,top2,offset2,f),mid.to>=from&&mid.from<=to&&f(mid),to>mid.to&&this.right.forEachLine(mid.to+1,to,oracle,rightTop,rightOffset,f)}}replace(from,to,nodes){let rightStart=this.left.length+this.break;if(to<rightStart)return this.balanced(this.left.replace(from,to,nodes),this.right);if(from>this.left.length)return this.balanced(this.left,this.right.replace(from-rightStart,to-rightStart,nodes));let result=[];from>0&&this.decomposeLeft(from,result);let left2=result.length;for(let node of nodes)result.push(node);if(from>0&&mergeGaps(result,left2-1),to<this.length){let right2=result.length;this.decomposeRight(to,result),mergeGaps(result,right2)}return HeightMap.of(result)}decomposeLeft(to,result){let left2=this.left.length;if(to<=left2)return this.left.decomposeLeft(to,result);result.push(this.left),this.break&&(left2++,to>=left2&&result.push(null)),to>left2&&this.right.decomposeLeft(to-left2,result)}decomposeRight(from,result){let left2=this.left.length,right2=left2+this.break;if(from>=right2)return this.right.decomposeRight(from-right2,result);from<left2&&this.left.decomposeRight(from,result),this.break&&from<right2&&result.push(null),result.push(this.right)}balanced(left2,right2){return left2.size>2*right2.size||right2.size>2*left2.size?HeightMap.of(this.break?[left2,null,right2]:[left2,right2]):(this.left=left2,this.right=right2,this.height=left2.height+right2.height,this.outdated=left2.outdated||right2.outdated,this.size=left2.size+right2.size,this.length=left2.length+this.break+right2.length,this)}updateHeight(oracle,offset2=0,force=!1,measured){let{left:left2,right:right2}=this,rightStart=offset2+left2.length+this.break,rebalance=null;return measured&&measured.from<=offset2+left2.length&&measured.more?rebalance=left2=left2.updateHeight(oracle,offset2,force,measured):left2.updateHeight(oracle,offset2,force),measured&&measured.from<=rightStart+right2.length&&measured.more?rebalance=right2=right2.updateHeight(oracle,rightStart,force,measured):right2.updateHeight(oracle,rightStart,force),rebalance?this.balanced(left2,right2):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function mergeGaps(nodes,around){let before,after;null==nodes[around]&&(before=nodes[around-1])instanceof HeightMapGap&&(after=nodes[around+1])instanceof HeightMapGap&&nodes.splice(around-1,3,new HeightMapGap(before.length+1+after.length))}class NodeBuilder{constructor(pos,oracle){this.pos=pos,this.oracle=oracle,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=pos}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(_from,to){if(this.lineStart>-1){let end2=Math.min(to,this.lineEnd),last=this.nodes[this.nodes.length-1];last instanceof HeightMapText?last.length+=end2-this.pos:(end2>this.pos||!this.isCovered)&&this.nodes.push(new HeightMapText(end2-this.pos,-1)),this.writtenTo=end2,to>end2&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=to}point(from,to,deco){if(from<to||deco.heightRelevant){let height=deco.widget?deco.widget.estimatedHeight:0,breaks=deco.widget?deco.widget.lineBreaks:0;height<0&&(height=this.oracle.lineHeight);let len=to-from;deco.block?this.addBlock(new HeightMapBlock(len,height,deco)):(len||breaks||height>=5)&&this.addLineDeco(height,breaks,len)}else to>from&&this.span(from,to);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:from,to:to}=this.oracle.doc.lineAt(this.pos);this.lineStart=from,this.lineEnd=to,this.writtenTo<from&&((this.writtenTo<from-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,from-1)),this.nodes.push(null)),this.pos>from&&this.nodes.push(new HeightMapText(this.pos-from,-1)),this.writtenTo=this.pos}blankContent(from,to){let gap=new HeightMapGap(to-from);return this.oracle.doc.lineAt(from).to==to&&(gap.flags|=4),gap}ensureLine(){this.enterLine();let last=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(last instanceof HeightMapText)return last;let line=new HeightMapText(0,-1);return this.nodes.push(line),line}addBlock(block){this.enterLine();let deco=block.deco;deco&&deco.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(block),this.writtenTo=this.pos=this.pos+block.length,deco&&deco.endSide>0&&(this.covering=block)}addLineDeco(height,breaks,length){let line=this.ensureLine();line.length+=length,line.collapsed+=length,line.widgetHeight=Math.max(line.widgetHeight,height),line.breaks+=breaks,this.writtenTo=this.pos=this.pos+length}finish(from){let last=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||last instanceof HeightMapText||this.isCovered?(this.writtenTo<this.pos||null==last)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new HeightMapText(0,-1));let pos=from;for(let node of this.nodes)node instanceof HeightMapText&&node.updateHeight(this.oracle,pos),pos+=node?node.length:1;return this.nodes}static build(oracle,decorations2,from,to){let builder=new NodeBuilder(from,oracle);return RangeSet.spans(decorations2,from,to,builder,0),builder.finish(from)}}class DecorationComparator{constructor(){this.changes=[]}compareRange(){}comparePoint(from,to,a,b){(from<to||a&&a.heightRelevant||b&&b.heightRelevant)&&addRange(from,to,this.changes,5)}}function visiblePixelRange(dom,paddingTop){let rect=dom.getBoundingClientRect(),doc2=dom.ownerDocument,win=doc2.defaultView||window,left2=Math.max(0,rect.left),right2=Math.min(win.innerWidth,rect.right),top2=Math.max(0,rect.top),bottom2=Math.min(win.innerHeight,rect.bottom);for(let parent=dom.parentNode;parent&&parent!=doc2.body;)if(1==parent.nodeType){let elt=parent,style=window.getComputedStyle(elt);if((elt.scrollHeight>elt.clientHeight||elt.scrollWidth>elt.clientWidth)&&"visible"!=style.overflow){let parentRect=elt.getBoundingClientRect();left2=Math.max(left2,parentRect.left),right2=Math.min(right2,parentRect.right),top2=Math.max(top2,parentRect.top),bottom2=parent==dom.parentNode?parentRect.bottom:Math.min(bottom2,parentRect.bottom)}parent="absolute"==style.position||"fixed"==style.position?elt.offsetParent:elt.parentNode}else{if(11!=parent.nodeType)break;parent=parent.host}return{left:left2-rect.left,right:Math.max(left2,right2)-rect.left,top:top2-(rect.top+paddingTop),bottom:Math.max(top2,bottom2)-(rect.top+paddingTop)}}function fullPixelRange(dom,paddingTop){let rect=dom.getBoundingClientRect();return{left:0,right:rect.right-rect.left,top:paddingTop,bottom:rect.bottom-(rect.top+paddingTop)}}class LineGap{constructor(from,to,size){this.from=from,this.to=to,this.size=size}static same(a,b){if(a.length!=b.length)return!1;for(let i2=0;i2<a.length;i2++){let gA=a[i2],gB=b[i2];if(gA.from!=gB.from||gA.to!=gB.to||gA.size!=gB.size)return!1}return!0}draw(viewState,wrapping){return Decoration.replace({widget:new LineGapWidget(this.size*(wrapping?viewState.scaleY:viewState.scaleX),wrapping)}).range(this.from,this.to)}}class LineGapWidget extends WidgetType{constructor(size,vertical){super(),this.size=size,this.vertical=vertical}eq(other){return other.size==this.size&&other.vertical==this.vertical}toDOM(){let elt=document.createElement("div");return this.vertical?elt.style.height=this.size+"px":(elt.style.width=this.size+"px",elt.style.height="2px",elt.style.display="inline-block"),elt}get estimatedHeight(){return this.vertical?this.size:-1}}class ViewState{constructor(state){this.state=state,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=IdScaler,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Direction.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let guessWrapping=state.facet(contentAttributes).some((v=>"function"!=typeof v&&"cm-lineWrapping"==v.class));this.heightOracle=new HeightOracle(guessWrapping),this.stateDeco=state.facet(decorations).filter((d=>"function"!=typeof d)),this.heightMap=HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle.setDoc(state.doc),[new ChangedRange(0,0,0,state.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Decoration.set(this.lineGaps.map((gap=>gap.draw(this,!1)))),this.computeVisibleRanges()}updateForViewport(){let viewports=[this.viewport],{main:main2}=this.state.selection;for(let i2=0;i2<=1;i2++){let pos=i2?main2.head:main2.anchor;if(!viewports.some((({from:from,to:to})=>pos>=from&&pos<=to))){let{from:from,to:to}=this.lineBlockAt(pos);viewports.push(new Viewport(from,to))}}this.viewports=viewports.sort(((a,b)=>a.from-b.from)),this.scaler=this.heightMap.height<=7e6?IdScaler:new BigScaler(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(block=>{this.viewportLines.push(1==this.scaler.scale?block:scaleBlock(block,this.scaler))}))}update(update2,scrollTarget=null){this.state=update2.state;let prevDeco=this.stateDeco;this.stateDeco=this.state.facet(decorations).filter((d=>"function"!=typeof d));let contentChanges=update2.changedRanges,heightChanges=ChangedRange.extendWithRanges(contentChanges,function(a,b,diff){let comp=new DecorationComparator;return RangeSet.compare(a,b,diff,comp,0),comp.changes}(prevDeco,this.stateDeco,update2?update2.changes:ChangeSet.empty(this.state.doc.length))),prevHeight=this.heightMap.height,scrollAnchor=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,update2.startState.doc,this.heightOracle.setDoc(this.state.doc),heightChanges),this.heightMap.height!=prevHeight&&(update2.flags|=2),scrollAnchor?(this.scrollAnchorPos=update2.changes.mapPos(scrollAnchor.from,-1),this.scrollAnchorHeight=scrollAnchor.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let viewport2=heightChanges.length?this.mapViewport(this.viewport,update2.changes):this.viewport;(scrollTarget&&(scrollTarget.range.head<viewport2.from||scrollTarget.range.head>viewport2.to)||!this.viewportIsAppropriate(viewport2))&&(viewport2=this.getViewport(0,scrollTarget));let updateLines=!update2.changes.empty||2&update2.flags||viewport2.from!=this.viewport.from||viewport2.to!=this.viewport.to;this.viewport=viewport2,this.updateForViewport(),updateLines&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,update2.changes))),update2.flags|=this.computeVisibleRanges(),scrollTarget&&(this.scrollTarget=scrollTarget),!this.mustEnforceCursorAssoc&&update2.selectionSet&&update2.view.lineWrapping&&update2.state.selection.main.empty&&update2.state.selection.main.assoc&&!update2.state.facet(nativeSelectionHidden)&&(this.mustEnforceCursorAssoc=!0)}measure(view){let dom=view.contentDOM,style=window.getComputedStyle(dom),oracle=this.heightOracle,whiteSpace=style.whiteSpace;this.defaultTextDirection="rtl"==style.direction?Direction.RTL:Direction.LTR;let refresh=this.heightOracle.mustRefreshForWrapping(whiteSpace),domRect=dom.getBoundingClientRect(),measureContent=refresh||this.mustMeasureContent||this.contentDOMHeight!=domRect.height;this.contentDOMHeight=domRect.height,this.mustMeasureContent=!1;let result=0,bias=0;if(domRect.width&&domRect.height){let scaleX=domRect.width/dom.offsetWidth,scaleY=domRect.height/dom.offsetHeight;(scaleX>.995&&scaleX<1.005||!isFinite(scaleX)||Math.abs(domRect.width-dom.offsetWidth)<1)&&(scaleX=1),(scaleY>.995&&scaleY<1.005||!isFinite(scaleY)||Math.abs(domRect.height-dom.offsetHeight)<1)&&(scaleY=1),this.scaleX==scaleX&&this.scaleY==scaleY||(this.scaleX=scaleX,this.scaleY=scaleY,result|=8,refresh=measureContent=!0)}let paddingTop=(parseInt(style.paddingTop)||0)*this.scaleY,paddingBottom=(parseInt(style.paddingBottom)||0)*this.scaleY;this.paddingTop==paddingTop&&this.paddingBottom==paddingBottom||(this.paddingTop=paddingTop,this.paddingBottom=paddingBottom,result|=10),this.editorWidth!=view.scrollDOM.clientWidth&&(oracle.lineWrapping&&(measureContent=!0),this.editorWidth=view.scrollDOM.clientWidth,result|=8);let scrollTop=view.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=scrollTop&&(this.scrollAnchorHeight=-1,this.scrollTop=scrollTop),this.scrolledToBottom=isScrolledToBottom(view.scrollDOM);let pixelViewport=(this.printing?fullPixelRange:visiblePixelRange)(dom,this.paddingTop),dTop=pixelViewport.top-this.pixelViewport.top,dBottom=pixelViewport.bottom-this.pixelViewport.bottom;this.pixelViewport=pixelViewport;let inView=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(inView!=this.inView&&(this.inView=inView,inView&&(measureContent=!0)),!this.inView&&!this.scrollTarget)return 0;let contentWidth=domRect.width;if(this.contentDOMWidth==contentWidth&&this.editorHeight==view.scrollDOM.clientHeight||(this.contentDOMWidth=domRect.width,this.editorHeight=view.scrollDOM.clientHeight,result|=8),measureContent){let lineHeights=view.docView.measureVisibleLineHeights(this.viewport);if(oracle.mustRefreshForHeights(lineHeights)&&(refresh=!0),refresh||oracle.lineWrapping&&Math.abs(contentWidth-this.contentDOMWidth)>oracle.charWidth){let{lineHeight:lineHeight,charWidth:charWidth,textHeight:textHeight}=view.docView.measureTextSize();refresh=lineHeight>0&&oracle.refresh(whiteSpace,lineHeight,charWidth,textHeight,contentWidth/charWidth,lineHeights),refresh&&(view.docView.minWidth=0,result|=8)}dTop>0&&dBottom>0?bias=Math.max(dTop,dBottom):dTop<0&&dBottom<0&&(bias=Math.min(dTop,dBottom)),oracle.heightChanged=!1;for(let vp of this.viewports){let heights=vp.from==this.viewport.from?lineHeights:view.docView.measureVisibleLineHeights(vp);this.heightMap=(refresh?HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle,[new ChangedRange(0,0,0,view.state.doc.length)]):this.heightMap).updateHeight(oracle,0,refresh,new MeasuredHeights(vp.from,heights))}oracle.heightChanged&&(result|=2)}let viewportChange=!this.viewportIsAppropriate(this.viewport,bias)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return viewportChange&&(this.viewport=this.getViewport(bias,this.scrollTarget)),this.updateForViewport(),(2&result||viewportChange)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(refresh?[]:this.lineGaps,view)),result|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,view.docView.enforceCursorAssoc()),result}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(bias,scrollTarget){let marginTop=.5-Math.max(-.5,Math.min(.5,bias/1e3/2)),map=this.heightMap,oracle=this.heightOracle,{visibleTop:visibleTop,visibleBottom:visibleBottom}=this,viewport2=new Viewport(map.lineAt(visibleTop-1e3*marginTop,QueryType$1.ByHeight,oracle,0,0).from,map.lineAt(visibleBottom+1e3*(1-marginTop),QueryType$1.ByHeight,oracle,0,0).to);if(scrollTarget){let{head:head}=scrollTarget.range;if(head<viewport2.from||head>viewport2.to){let topPos,viewHeight=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),block=map.lineAt(head,QueryType$1.ByPos,oracle,0,0);topPos="center"==scrollTarget.y?(block.top+block.bottom)/2-viewHeight/2:"start"==scrollTarget.y||"nearest"==scrollTarget.y&&head<viewport2.from?block.top:block.bottom-viewHeight,viewport2=new Viewport(map.lineAt(topPos-500,QueryType$1.ByHeight,oracle,0,0).from,map.lineAt(topPos+viewHeight+500,QueryType$1.ByHeight,oracle,0,0).to)}}return viewport2}mapViewport(viewport2,changes){let from=changes.mapPos(viewport2.from,-1),to=changes.mapPos(viewport2.to,1);return new Viewport(this.heightMap.lineAt(from,QueryType$1.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(to,QueryType$1.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:from,to:to},bias=0){if(!this.inView)return!0;let{top:top2}=this.heightMap.lineAt(from,QueryType$1.ByPos,this.heightOracle,0,0),{bottom:bottom2}=this.heightMap.lineAt(to,QueryType$1.ByPos,this.heightOracle,0,0),{visibleTop:visibleTop,visibleBottom:visibleBottom}=this;return(0==from||top2<=visibleTop-Math.max(10,Math.min(-bias,250)))&&(to==this.state.doc.length||bottom2>=visibleBottom+Math.max(10,Math.min(bias,250)))&&top2>visibleTop-2e3&&bottom2<visibleBottom+2e3}mapLineGaps(gaps,changes){if(!gaps.length||changes.empty)return gaps;let mapped=[];for(let gap of gaps)changes.touchesRange(gap.from,gap.to)||mapped.push(new LineGap(changes.mapPos(gap.from),changes.mapPos(gap.to),gap.size));return mapped}ensureLineGaps(current,mayMeasure){let wrapping=this.heightOracle.lineWrapping,margin=wrapping?1e4:2e3,halfMargin=margin>>1,doubleMargin=margin<<1;if(this.defaultTextDirection!=Direction.LTR&&!wrapping)return[];let gaps=[],addGap=(from,to,line,structure)=>{if(to-from<halfMargin)return;let sel=this.state.selection.main,avoid=[sel.from];sel.empty||avoid.push(sel.to);for(let pos of avoid)if(pos>from&&pos<to)return addGap(from,pos-10,line,structure),void addGap(pos+10,to,line,structure);let gap=function(array,f){for(let val of array)if(f(val))return val;return}(current,(gap2=>gap2.from>=line.from&&gap2.to<=line.to&&Math.abs(gap2.from-from)<halfMargin&&Math.abs(gap2.to-to)<halfMargin&&!avoid.some((pos=>gap2.from<pos&&gap2.to>pos))));if(!gap){if(to<line.to&&mayMeasure&&wrapping&&mayMeasure.visibleRanges.some((r=>r.from<=to&&r.to>=to))){let lineStart=mayMeasure.moveToLineBoundary(EditorSelection.cursor(to),!1,!0).head;lineStart>from&&(to=lineStart)}gap=new LineGap(from,to,this.gapSize(line,from,to,structure))}gaps.push(gap)};for(let line of this.viewportLines){if(line.length<doubleMargin)continue;let structure=lineStructure(line.from,line.to,this.stateDeco);if(structure.total<doubleMargin)continue;let viewFrom,viewTo,target=this.scrollTarget?this.scrollTarget.range.head:null;if(wrapping){let top2,bot,marginHeight=margin/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=target){let targetFrac=findFraction(structure,target),spaceFrac=((this.visibleBottom-this.visibleTop)/2+marginHeight)/line.height;top2=targetFrac-spaceFrac,bot=targetFrac+spaceFrac}else top2=(this.visibleTop-line.top-marginHeight)/line.height,bot=(this.visibleBottom-line.top+marginHeight)/line.height;viewFrom=findPosition(structure,top2),viewTo=findPosition(structure,bot)}else{let left2,right2,totalWidth=structure.total*this.heightOracle.charWidth,marginWidth=margin*this.heightOracle.charWidth;if(null!=target){let targetFrac=findFraction(structure,target),spaceFrac=((this.pixelViewport.right-this.pixelViewport.left)/2+marginWidth)/totalWidth;left2=targetFrac-spaceFrac,right2=targetFrac+spaceFrac}else left2=(this.pixelViewport.left-marginWidth)/totalWidth,right2=(this.pixelViewport.right+marginWidth)/totalWidth;viewFrom=findPosition(structure,left2),viewTo=findPosition(structure,right2)}viewFrom>line.from&&addGap(line.from,viewFrom,line,structure),viewTo<line.to&&addGap(viewTo,line.to,line,structure)}return gaps}gapSize(line,from,to,structure){let fraction=findFraction(structure,to)-findFraction(structure,from);return this.heightOracle.lineWrapping?line.height*fraction:structure.total*this.heightOracle.charWidth*fraction}updateLineGaps(gaps){LineGap.same(gaps,this.lineGaps)||(this.lineGaps=gaps,this.lineGapDeco=Decoration.set(gaps.map((gap=>gap.draw(this,this.heightOracle.lineWrapping)))))}computeVisibleRanges(){let deco=this.stateDeco;this.lineGaps.length&&(deco=deco.concat(this.lineGapDeco));let ranges=[];RangeSet.spans(deco,this.viewport.from,this.viewport.to,{span(from,to){ranges.push({from:from,to:to})},point(){}},20);let changed=ranges.length!=this.visibleRanges.length||this.visibleRanges.some(((r,i2)=>r.from!=ranges[i2].from||r.to!=ranges[i2].to));return this.visibleRanges=ranges,changed?4:0}lineBlockAt(pos){return pos>=this.viewport.from&&pos<=this.viewport.to&&this.viewportLines.find((b=>b.from<=pos&&b.to>=pos))||scaleBlock(this.heightMap.lineAt(pos,QueryType$1.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(height){return scaleBlock(this.heightMap.lineAt(this.scaler.fromDOM(height),QueryType$1.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(scrollTop){let block=this.lineBlockAtHeight(scrollTop+8);return block.from>=this.viewport.from||this.viewportLines[0].top-scrollTop>200?block:this.viewportLines[0]}elementAtHeight(height){return scaleBlock(this.heightMap.blockAt(this.scaler.fromDOM(height),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Viewport{constructor(from,to){this.from=from,this.to=to}}function lineStructure(from,to,stateDeco){let ranges=[],pos=from,total=0;return RangeSet.spans(stateDeco,from,to,{span(){},point(from2,to2){from2>pos&&(ranges.push({from:pos,to:from2}),total+=from2-pos),pos=to2}},20),pos<to&&(ranges.push({from:pos,to:to}),total+=to-pos),{total:total,ranges:ranges}}function findPosition({total:total,ranges:ranges},ratio){if(ratio<=0)return ranges[0].from;if(ratio>=1)return ranges[ranges.length-1].to;let dist2=Math.floor(total*ratio);for(let i2=0;;i2++){let{from:from,to:to}=ranges[i2],size=to-from;if(dist2<=size)return from+dist2;dist2-=size}}function findFraction(structure,pos){let counted=0;for(let{from:from,to:to}of structure.ranges){if(pos<=to){counted+=pos-from;break}counted+=to-from}return counted/structure.total}const IdScaler={toDOM:n=>n,fromDOM:n=>n,scale:1};class BigScaler{constructor(oracle,heightMap,viewports){let vpHeight=0,base2=0,domBase=0;this.viewports=viewports.map((({from:from,to:to})=>{let top2=heightMap.lineAt(from,QueryType$1.ByPos,oracle,0,0).top,bottom2=heightMap.lineAt(to,QueryType$1.ByPos,oracle,0,0).bottom;return vpHeight+=bottom2-top2,{from:from,to:to,top:top2,bottom:bottom2,domTop:0,domBottom:0}})),this.scale=(7e6-vpHeight)/(heightMap.height-vpHeight);for(let obj of this.viewports)obj.domTop=domBase+(obj.top-base2)*this.scale,domBase=obj.domBottom=obj.domTop+(obj.bottom-obj.top),base2=obj.bottom}toDOM(n){for(let i2=0,base2=0,domBase=0;;i2++){let vp=i2<this.viewports.length?this.viewports[i2]:null;if(!vp||n<vp.top)return domBase+(n-base2)*this.scale;if(n<=vp.bottom)return vp.domTop+(n-vp.top);base2=vp.bottom,domBase=vp.domBottom}}fromDOM(n){for(let i2=0,base2=0,domBase=0;;i2++){let vp=i2<this.viewports.length?this.viewports[i2]:null;if(!vp||n<vp.domTop)return base2+(n-domBase)/this.scale;if(n<=vp.domBottom)return vp.top+(n-vp.domTop);base2=vp.bottom,domBase=vp.domBottom}}}function scaleBlock(block,scaler){if(1==scaler.scale)return block;let bTop=scaler.toDOM(block.top),bBottom=scaler.toDOM(block.bottom);return new BlockInfo(block.from,block.length,bTop,bBottom-bTop,Array.isArray(block._content)?block._content.map((b=>scaleBlock(b,scaler))):block._content)}const theme=Facet.define({combine:strs=>strs.join(" ")}),darkTheme=Facet.define({combine:values=>values.indexOf(!0)>-1}),baseThemeID=StyleModule.newName(),baseLightID=StyleModule.newName(),baseDarkID=StyleModule.newName(),lightDarkIDs={"&light":"."+baseLightID,"&dark":"."+baseDarkID};function buildTheme(main2,spec,scopes){return new StyleModule(spec,{finish:sel=>/&/.test(sel)?sel.replace(/&\w*/,(m=>{if("&"==m)return main2;if(!scopes||!scopes[m])throw new RangeError(`Unsupported selector: ${m}`);return scopes[m]})):main2+" "+sel})}const baseTheme$1$3=buildTheme("."+baseThemeID,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},lightDarkIDs);class DOMReader{constructor(points,state){this.points=points,this.text="",this.lineSeparator=state.facet(EditorState.lineSeparator)}append(text2){this.text+=text2}lineBreak(){this.text+="\uffff"}readRange(start2,end2){if(!start2)return this;let parent=start2.parentNode;for(let cur2=start2;;){this.findPointBefore(parent,cur2);let oldLen=this.text.length;this.readNode(cur2);let next=cur2.nextSibling;if(next==end2)break;let view=ContentView.get(cur2),nextView=ContentView.get(next);(view&&nextView?view.breakAfter:(view?view.breakAfter:isBlockElement(cur2))||isBlockElement(next)&&("BR"!=cur2.nodeName||cur2.cmIgnore)&&this.text.length>oldLen)&&this.lineBreak(),cur2=next}return this.findPointBefore(parent,end2),this}readTextNode(node){let text2=node.nodeValue;for(let point of this.points)point.node==node&&(point.pos=this.text.length+Math.min(point.offset,text2.length));for(let off=0,re=this.lineSeparator?null:/\r\n?|\n/g;;){let m,nextBreak=-1,breakSize=1;if(this.lineSeparator?(nextBreak=text2.indexOf(this.lineSeparator,off),breakSize=this.lineSeparator.length):(m=re.exec(text2))&&(nextBreak=m.index,breakSize=m[0].length),this.append(text2.slice(off,nextBreak<0?text2.length:nextBreak)),nextBreak<0)break;if(this.lineBreak(),breakSize>1)for(let point of this.points)point.node==node&&point.pos>this.text.length&&(point.pos-=breakSize-1);off=nextBreak+breakSize}}readNode(node){if(node.cmIgnore)return;let view=ContentView.get(node),fromView=view&&view.overrideDOMText;if(null!=fromView){this.findPointInside(node,fromView.length);for(let i2=fromView.iter();!i2.next().done;)i2.lineBreak?this.lineBreak():this.append(i2.value)}else 3==node.nodeType?this.readTextNode(node):"BR"==node.nodeName?node.nextSibling&&this.lineBreak():1==node.nodeType&&this.readRange(node.firstChild,null)}findPointBefore(node,next){for(let point of this.points)point.node==node&&node.childNodes[point.offset]==next&&(point.pos=this.text.length)}findPointInside(node,length){for(let point of this.points)(3==node.nodeType?point.node==node:node.contains(point.node))&&(point.pos=this.text.length+(isAtEnd(node,point.node,point.offset)?length:0))}}function isAtEnd(parent,node,offset2){for(;;){if(!node||offset2<maxOffset(node))return!1;if(node==parent)return!0;offset2=domIndex(node)+1,node=node.parentNode}}function isBlockElement(node){return 1==node.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(node.nodeName)}class DOMPoint{constructor(node,offset2){this.node=node,this.offset=offset2,this.pos=-1}}class DOMChange{constructor(view,start2,end2,typeOver){this.typeOver=typeOver,this.bounds=null,this.text="";let{impreciseHead:iHead,impreciseAnchor:iAnchor}=view.docView;if(view.state.readOnly&&start2>-1)this.newSel=null;else if(start2>-1&&(this.bounds=view.docView.domBoundsAround(start2,end2,0))){let selPoints=iHead||iAnchor?[]:function(view){let result=[];if(view.root.activeElement!=view.contentDOM)return result;let{anchorNode:anchorNode,anchorOffset:anchorOffset,focusNode:focusNode,focusOffset:focusOffset}=view.observer.selectionRange;anchorNode&&(result.push(new DOMPoint(anchorNode,anchorOffset)),focusNode==anchorNode&&focusOffset==anchorOffset||result.push(new DOMPoint(focusNode,focusOffset)));return result}(view),reader=new DOMReader(selPoints,view.state);reader.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=reader.text,this.newSel=function(points,base2){if(0==points.length)return null;let anchor=points[0].pos,head=2==points.length?points[1].pos:anchor;return anchor>-1&&head>-1?EditorSelection.single(anchor+base2,head+base2):null}(selPoints,this.bounds.from)}else{let domSel=view.observer.selectionRange,head=iHead&&iHead.node==domSel.focusNode&&iHead.offset==domSel.focusOffset||!contains(view.contentDOM,domSel.focusNode)?view.state.selection.main.head:view.docView.posFromDOM(domSel.focusNode,domSel.focusOffset),anchor=iAnchor&&iAnchor.node==domSel.anchorNode&&iAnchor.offset==domSel.anchorOffset||!contains(view.contentDOM,domSel.anchorNode)?view.state.selection.main.anchor:view.docView.posFromDOM(domSel.anchorNode,domSel.anchorOffset);this.newSel=EditorSelection.single(anchor,head)}}}function applyDOMChange(view,domChange){let change,{newSel:newSel}=domChange,sel=view.state.selection.main,lastKey=view.inputState.lastKeyTime>Date.now()-100?view.inputState.lastKeyCode:-1;if(domChange.bounds){let{from:from,to:to}=domChange.bounds,preferredPos=sel.from,preferredSide=null;(8===lastKey||browser$1.android&&domChange.text.length<to-from)&&(preferredPos=sel.to,preferredSide="end");let diff=function(a,b,preferredPos,preferredSide){let minLen=Math.min(a.length,b.length),from=0;for(;from<minLen&&a.charCodeAt(from)==b.charCodeAt(from);)from++;if(from==minLen&&a.length==b.length)return null;let toA=a.length,toB=b.length;for(;toA>0&&toB>0&&a.charCodeAt(toA-1)==b.charCodeAt(toB-1);)toA--,toB--;if("end"==preferredSide){preferredPos-=toA+Math.max(0,from-Math.min(toA,toB))-from}if(toA<from&&a.length<b.length){from-=preferredPos<=from&&preferredPos>=toA?from-preferredPos:0,toB=from+(toB-toA),toA=from}else if(toB<from){from-=preferredPos<=from&&preferredPos>=toB?from-preferredPos:0,toA=from+(toA-toB),toB=from}return{from:from,toA:toA,toB:toB}}(view.state.doc.sliceString(from,to,"\uffff"),domChange.text,preferredPos-from,preferredSide);diff&&(browser$1.chrome&&13==lastKey&&diff.toB==diff.from+2&&"\uffff\uffff"==domChange.text.slice(diff.from,diff.toB)&&diff.toB--,change={from:from+diff.from,to:from+diff.toA,insert:Text.of(domChange.text.slice(diff.from,diff.toB).split("\uffff"))})}else newSel&&(!view.hasFocus&&view.state.facet(editable)||newSel.main.eq(sel))&&(newSel=null);if(!change&&!newSel)return!1;if(!change&&domChange.typeOver&&!sel.empty&&newSel&&newSel.main.empty?change={from:sel.from,to:sel.to,insert:view.state.doc.slice(sel.from,sel.to)}:change&&change.from>=sel.from&&change.to<=sel.to&&(change.from!=sel.from||change.to!=sel.to)&&sel.to-sel.from-(change.to-change.from)<=4?change={from:sel.from,to:sel.to,insert:view.state.doc.slice(sel.from,change.from).append(change.insert).append(view.state.doc.slice(change.to,sel.to))}:(browser$1.mac||browser$1.android)&&change&&change.from==change.to&&change.from==sel.head-1&&/^\. ?$/.test(change.insert.toString())&&"off"==view.contentDOM.getAttribute("autocorrect")?(newSel&&2==change.insert.length&&(newSel=EditorSelection.single(newSel.main.anchor-1,newSel.main.head-1)),change={from:sel.from,to:sel.to,insert:Text.of([" "])}):browser$1.chrome&&change&&change.from==change.to&&change.from==sel.head&&"\n "==change.insert.toString()&&view.lineWrapping&&(newSel&&(newSel=EditorSelection.single(newSel.main.anchor-1,newSel.main.head-1)),change={from:sel.from,to:sel.to,insert:Text.of([" "])}),change){if(browser$1.ios&&view.inputState.flushIOSKey())return!0;if(browser$1.android&&(change.from==sel.from&&change.to==sel.to&&1==change.insert.length&&2==change.insert.lines&&dispatchKey(view.contentDOM,"Enter",13)||(change.from==sel.from-1&&change.to==sel.to&&0==change.insert.length||8==lastKey&&change.insert.length<change.to-change.from&&change.to>sel.head)&&dispatchKey(view.contentDOM,"Backspace",8)||change.from==sel.from&&change.to==sel.to+1&&0==change.insert.length&&dispatchKey(view.contentDOM,"Delete",46)))return!0;let defaultTr,text2=change.insert.toString();view.inputState.composing>=0&&view.inputState.composing++;let defaultInsert=()=>defaultTr||(defaultTr=function(view,change,newSel){let tr,startState=view.state,sel=startState.selection.main;if(change.from>=sel.from&&change.to<=sel.to&&change.to-change.from>=(sel.to-sel.from)/3&&(!newSel||newSel.main.empty&&newSel.main.from==change.from+change.insert.length)&&view.inputState.composing<0){let before=sel.from<change.from?startState.sliceDoc(sel.from,change.from):"",after=sel.to>change.to?startState.sliceDoc(change.to,sel.to):"";tr=startState.replaceSelection(view.state.toText(before+change.insert.sliceString(0,void 0,view.state.lineBreak)+after))}else{let changes=startState.changes(change),mainSel=newSel&&newSel.main.to<=changes.newLength?newSel.main:void 0;if(startState.selection.ranges.length>1&&view.inputState.composing>=0&&change.to<=sel.to&&change.to>=sel.to-10){let compositionRange,replaced=view.state.sliceDoc(change.from,change.to),composition=newSel&&findCompositionNode(view,newSel.main.head);if(composition){let dLen=change.insert.length-(change.to-change.from);compositionRange={from:composition.from,to:composition.to-dLen}}else compositionRange=view.state.doc.lineAt(sel.head);let offset2=sel.to-change.to,size=sel.to-sel.from;tr=startState.changeByRange((range=>{if(range.from==sel.from&&range.to==sel.to)return{changes:changes,range:mainSel||range.map(changes)};let to=range.to-offset2,from=to-replaced.length;if(range.to-range.from!=size||view.state.sliceDoc(from,to)!=replaced||range.to>=compositionRange.from&&range.from<=compositionRange.to)return{range:range};let rangeChanges=startState.changes({from:from,to:to,insert:change.insert}),selOff=range.to-sel.to;return{changes:rangeChanges,range:mainSel?EditorSelection.range(Math.max(0,mainSel.anchor+selOff),Math.max(0,mainSel.head+selOff)):range.map(rangeChanges)}}))}else tr={changes:changes,selection:mainSel&&startState.selection.replaceRange(mainSel)}}let userEvent="input.type";(view.composing||view.inputState.compositionPendingChange&&view.inputState.compositionEndedAt>Date.now()-50)&&(view.inputState.compositionPendingChange=!1,userEvent+=".compose",view.inputState.compositionFirstChange&&(userEvent+=".start",view.inputState.compositionFirstChange=!1));return startState.update(tr,{userEvent:userEvent,scrollIntoView:!0})}(view,change,newSel));return view.state.facet(inputHandler$1).some((h=>h(view,change.from,change.to,text2,defaultInsert)))||view.dispatch(defaultInsert()),!0}if(newSel&&!newSel.main.eq(sel)){let scrollIntoView2=!1,userEvent="select";return view.inputState.lastSelectionTime>Date.now()-50&&("select"==view.inputState.lastSelectionOrigin&&(scrollIntoView2=!0),userEvent=view.inputState.lastSelectionOrigin),view.dispatch({selection:newSel,scrollIntoView:scrollIntoView2,userEvent:userEvent}),!0}return!1}const observeOptions={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},useCharData=browser$1.ie&&browser$1.ie_version<=11;class DOMObserver{constructor(view){this.view=view,this.active=!1,this.selectionRange=new DOMSelectionState,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=view.contentDOM,this.observer=new MutationObserver((mutations=>{for(let mut of mutations)this.queue.push(mut);(browser$1.ie&&browser$1.ie_version<=11||browser$1.ios&&view.composing)&&mutations.some((m=>"childList"==m.type&&m.removedNodes.length||"characterData"==m.type&&m.oldValue.length>m.target.nodeValue.length))?this.flushSoon():this.flush()})),useCharData&&(this.onCharData=event=>{this.queue.push({target:event.target,type:"characterData",oldValue:event.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var _a2;(null===(_a2=this.view.docView)||void 0===_a2?void 0:_a2.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(view.scrollDOM)),this.addWindowListeners(this.win=view.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((entries=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),entries.length>0&&entries[entries.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((entries=>{entries.length>0&&entries[entries.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500)}updateGaps(gaps){if(this.gapIntersection&&(gaps.length!=this.gaps.length||this.gaps.some(((g,i2)=>g!=gaps[i2])))){this.gapIntersection.disconnect();for(let gap of gaps)this.gapIntersection.observe(gap);this.gaps=gaps}}onSelectionChange(event){let wasChanged=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:view}=this,sel=this.selectionRange;if(view.state.facet(editable)?view.root.activeElement!=this.dom:!hasSelection(view.dom,sel))return;let context=sel.anchorNode&&view.docView.nearest(sel.anchorNode);context&&context.ignoreEvent(event)?wasChanged||(this.selectionChanged=!1):(browser$1.ie&&browser$1.ie_version<=11||browser$1.android&&browser$1.chrome)&&!view.state.selection.main.empty&&sel.focusNode&&isEquivalentPosition(sel.focusNode,sel.focusOffset,sel.anchorNode,sel.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:view}=this,range=browser$1.safari&&11==view.root.nodeType&&function(doc2){let elt=doc2.activeElement;for(;elt&&elt.shadowRoot;)elt=elt.shadowRoot.activeElement;return elt}(this.dom.ownerDocument)==this.dom&&function(view){let found=null;function read2(event){event.preventDefault(),event.stopImmediatePropagation(),found=event.getTargetRanges()[0]}if(view.contentDOM.addEventListener("beforeinput",read2,!0),view.dom.ownerDocument.execCommand("indent"),view.contentDOM.removeEventListener("beforeinput",read2,!0),!found)return null;let anchorNode=found.startContainer,anchorOffset=found.startOffset,focusNode=found.endContainer,focusOffset=found.endOffset,curAnchor=view.docView.domAtPos(view.state.selection.main.anchor);isEquivalentPosition(curAnchor.node,curAnchor.offset,focusNode,focusOffset)&&([anchorNode,anchorOffset,focusNode,focusOffset]=[focusNode,focusOffset,anchorNode,anchorOffset]);return{anchorNode:anchorNode,anchorOffset:anchorOffset,focusNode:focusNode,focusOffset:focusOffset}}(this.view)||getSelection(view.root);if(!range||this.selectionRange.eq(range))return!1;let local=hasSelection(this.dom,range);return local&&!this.selectionChanged&&view.inputState.lastFocusTime>Date.now()-200&&view.inputState.lastTouchTime<Date.now()-300&&function(doc2,selection2){let node=selection2.focusNode,offset2=selection2.focusOffset;if(!node||selection2.anchorNode!=node||selection2.anchorOffset!=offset2)return!1;for(offset2=Math.min(offset2,maxOffset(node));;)if(offset2){if(1!=node.nodeType)return!1;let prev=node.childNodes[offset2-1];"false"==prev.contentEditable?offset2--:(node=prev,offset2=maxOffset(node))}else{if(node==doc2)return!0;offset2=domIndex(node),node=node.parentNode}}(this.dom,range)?(this.view.inputState.lastFocusTime=0,view.docView.updateSelection(),!1):(this.selectionRange.setRange(range),local&&(this.selectionChanged=!0),!0)}setSelectionRange(anchor,head){this.selectionRange.set(anchor.node,anchor.offset,head.node,head.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let i2=0,changed=null;for(let dom=this.dom;dom;)if(1==dom.nodeType)!changed&&i2<this.scrollTargets.length&&this.scrollTargets[i2]==dom?i2++:changed||(changed=this.scrollTargets.slice(0,i2)),changed&&changed.push(dom),dom=dom.assignedSlot||dom.parentNode;else{if(11!=dom.nodeType)break;dom=dom.host}if(i2<this.scrollTargets.length&&!changed&&(changed=this.scrollTargets.slice(0,i2)),changed){for(let dom of this.scrollTargets)dom.removeEventListener("scroll",this.onScroll);for(let dom of this.scrollTargets=changed)dom.addEventListener("scroll",this.onScroll)}}ignore(f){if(!this.active)return f();try{return this.stop(),f()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,observeOptions),useCharData&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),useCharData&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(key,keyCode){var _a2;if(!this.delayedAndroidKey){let flush2=()=>{let key2=this.delayedAndroidKey;if(key2){this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=key2.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&key2.force&&dispatchKey(this.dom,key2.key,key2.keyCode)}};this.flushingAndroidKey=this.view.win.requestAnimationFrame(flush2)}this.delayedAndroidKey&&"Enter"!=key||(this.delayedAndroidKey={key:key,keyCode:keyCode,force:this.lastChange<Date.now()-50||!!(null===(_a2=this.delayedAndroidKey)||void 0===_a2?void 0:_a2.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let mut of this.observer.takeRecords())this.queue.push(mut);return this.queue}processRecords(){let records=this.pendingRecords();records.length&&(this.queue=[]);let from=-1,to=-1,typeOver=!1;for(let record of records){let range=this.readMutation(record);range&&(range.typeOver&&(typeOver=!0),-1==from?({from:from,to:to}=range):(from=Math.min(range.from,from),to=Math.max(range.to,to)))}return{from:from,to:to,typeOver:typeOver}}readChange(){let{from:from,to:to,typeOver:typeOver}=this.processRecords(),newSel=this.selectionChanged&&hasSelection(this.dom,this.selectionRange);if(from<0&&!newSel)return null;from>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let change=new DOMChange(this.view,from,to,typeOver);return this.view.docView.domChanged={newSel:change.newSel?change.newSel.main:null},change}flush(readSelection=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;readSelection&&this.readSelectionRange();let domChange=this.readChange();if(!domChange)return this.view.requestMeasure(),!1;let startState=this.view.state,handled=applyDOMChange(this.view,domChange);return this.view.state==startState&&this.view.update([]),handled}readMutation(rec){let cView=this.view.docView.nearest(rec.target);if(!cView||cView.ignoreMutation(rec))return null;if(cView.markDirty("attributes"==rec.type),"attributes"==rec.type&&(cView.flags|=4),"childList"==rec.type){let childBefore=findChild(cView,rec.previousSibling||rec.target.previousSibling,-1),childAfter=findChild(cView,rec.nextSibling||rec.target.nextSibling,1);return{from:childBefore?cView.posAfter(childBefore):cView.posAtStart,to:childAfter?cView.posBefore(childAfter):cView.posAtEnd,typeOver:!1}}return"characterData"==rec.type?{from:cView.posAtStart,to:cView.posAtEnd,typeOver:rec.target.nodeValue==rec.oldValue}:null}setWindow(win){win!=this.win&&(this.removeWindowListeners(this.win),this.win=win,this.addWindowListeners(this.win))}addWindowListeners(win){win.addEventListener("resize",this.onResize),win.addEventListener("beforeprint",this.onPrint),win.addEventListener("scroll",this.onScroll),win.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(win){win.removeEventListener("scroll",this.onScroll),win.removeEventListener("resize",this.onResize),win.removeEventListener("beforeprint",this.onPrint),win.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var _a2,_b,_c;this.stop(),null===(_a2=this.intersection)||void 0===_a2||_a2.disconnect(),null===(_b=this.gapIntersection)||void 0===_b||_b.disconnect(),null===(_c=this.resizeScroll)||void 0===_c||_c.disconnect();for(let dom of this.scrollTargets)dom.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function findChild(cView,dom,dir){for(;dom;){let curView=ContentView.get(dom);if(curView&&curView.parent==cView)return curView;let parent=dom.parentNode;dom=parent!=cView.dom?parent:dir>0?dom.nextSibling:dom.previousSibling}return null}class EditorView{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(config2={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM);let{dispatch:dispatch2}=config2;this.dispatchTransactions=config2.dispatchTransactions||dispatch2&&(trs=>trs.forEach((tr=>dispatch2(tr,this))))||(trs=>this.update(trs)),this.dispatch=this.dispatch.bind(this),this._root=config2.root||function(node){for(;node;){if(node&&(9==node.nodeType||11==node.nodeType&&node.host))return node;node=node.assignedSlot||node.parentNode}return null}(config2.parent)||document,this.viewState=new ViewState(config2.state||EditorState.create(config2)),this.plugins=this.state.facet(viewPlugin).map((spec=>new PluginInstance(spec)));for(let plugin of this.plugins)plugin.update(this);this.observer=new DOMObserver(this),this.inputState=new InputState(this),this.inputState.ensureHandlers(this.plugins),this.docView=new DocView(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),config2.parent&&config2.parent.appendChild(this.dom)}dispatch(...input){let trs=1==input.length&&input[0]instanceof Transaction?input:1==input.length&&Array.isArray(input[0])?input[0]:[this.state.update(...input)];this.dispatchTransactions(trs,this)}update(transactions){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let update2,redrawn=!1,attrsChanged=!1,state=this.state;for(let tr of transactions){if(tr.startState!=state)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");state=tr.state}if(this.destroyed)return void(this.viewState.state=state);let focus=this.hasFocus,focusFlag=0,dispatchFocus=null;transactions.some((tr=>tr.annotation(isFocusChange)))?(this.inputState.notifiedFocused=focus,focusFlag=1):focus!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=focus,dispatchFocus=focusChangeTransaction(state,focus),dispatchFocus||(focusFlag=1));let pendingKey=this.observer.delayedAndroidKey,domChange=null;if(pendingKey?(this.observer.clearDelayedAndroidKey(),domChange=this.observer.readChange(),(domChange&&!this.state.doc.eq(state.doc)||!this.state.selection.eq(state.selection))&&(domChange=null)):this.observer.clear(),state.facet(EditorState.phrases)!=this.state.facet(EditorState.phrases))return this.setState(state);update2=ViewUpdate.create(this,state,transactions),update2.flags|=focusFlag;let scrollTarget=this.viewState.scrollTarget;try{this.updateState=2;for(let tr of transactions){if(scrollTarget&&(scrollTarget=scrollTarget.map(tr.changes)),tr.scrollIntoView){let{main:main2}=tr.state.selection;scrollTarget=new ScrollTarget(main2.empty?main2:EditorSelection.cursor(main2.head,main2.head>main2.anchor?-1:1))}for(let e of tr.effects)e.is(scrollIntoView$1)&&(scrollTarget=e.value)}this.viewState.update(update2,scrollTarget),this.bidiCache=CachedOrder.update(this.bidiCache,update2.changes),update2.empty||(this.updatePlugins(update2),this.inputState.update(update2)),redrawn=this.docView.update(update2),this.state.facet(styleModule)!=this.styleModules&&this.mountStyles(),attrsChanged=this.updateAttrs(),this.showAnnouncements(transactions),this.docView.updateSelection(redrawn,transactions.some((tr=>tr.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(update2.startState.facet(theme)!=update2.state.facet(theme)&&(this.viewState.mustMeasureContent=!0),(redrawn||attrsChanged||scrollTarget||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!update2.empty)for(let listener of this.state.facet(updateListener))listener(update2);(dispatchFocus||domChange)&&Promise.resolve().then((()=>{dispatchFocus&&this.state==dispatchFocus.startState&&this.dispatch(dispatchFocus),domChange&&!applyDOMChange(this,domChange)&&pendingKey.force&&dispatchKey(this.contentDOM,pendingKey.key,pendingKey.keyCode)}))}setState(newState){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=newState);this.updateState=2;let hadFocus=this.hasFocus;try{for(let plugin of this.plugins)plugin.destroy(this);this.viewState=new ViewState(newState),this.plugins=newState.facet(viewPlugin).map((spec=>new PluginInstance(spec))),this.pluginMap.clear();for(let plugin of this.plugins)plugin.update(this);this.docView=new DocView(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}hadFocus&&this.focus(),this.requestMeasure()}updatePlugins(update2){let prevSpecs=update2.startState.facet(viewPlugin),specs=update2.state.facet(viewPlugin);if(prevSpecs!=specs){let newPlugins=[];for(let spec of specs){let found=prevSpecs.indexOf(spec);if(found<0)newPlugins.push(new PluginInstance(spec));else{let plugin=this.plugins[found];plugin.mustUpdate=update2,newPlugins.push(plugin)}}for(let plugin of this.plugins)plugin.mustUpdate!=update2&&plugin.destroy(this);this.plugins=newPlugins,this.pluginMap.clear()}else for(let p of this.plugins)p.mustUpdate=update2;for(let i2=0;i2<this.plugins.length;i2++)this.plugins[i2].update(this);prevSpecs!=specs&&this.inputState.ensureHandlers(this.plugins)}measure(flush2=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,flush2&&this.observer.forceFlush();let updated=null,sDOM=this.scrollDOM,scrollTop=sDOM.scrollTop*this.scaleY,{scrollAnchorPos:scrollAnchorPos,scrollAnchorHeight:scrollAnchorHeight}=this.viewState;Math.abs(scrollTop-this.viewState.scrollTop)>1&&(scrollAnchorHeight=-1),this.viewState.scrollAnchorHeight=-1;try{for(let i2=0;;i2++){if(scrollAnchorHeight<0)if(isScrolledToBottom(sDOM))scrollAnchorPos=-1,scrollAnchorHeight=this.viewState.heightMap.height;else{let block=this.viewState.scrollAnchorAt(scrollTop);scrollAnchorPos=block.from,scrollAnchorHeight=block.top}this.updateState=1;let changed=this.viewState.measure(this);if(!changed&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(i2>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let measuring=[];4&changed||([this.measureRequests,measuring]=[measuring,this.measureRequests]);let measured=measuring.map((m=>{try{return m.read(this)}catch(e){return logException(this.state,e),BadMeasure}})),update2=ViewUpdate.create(this,this.state,[]),redrawn=!1;update2.flags|=changed,updated?updated.flags|=changed:updated=update2,this.updateState=2,update2.empty||(this.updatePlugins(update2),this.inputState.update(update2),this.updateAttrs(),redrawn=this.docView.update(update2));for(let i3=0;i3<measuring.length;i3++)if(measured[i3]!=BadMeasure)try{let m=measuring[i3];m.write&&m.write(measured[i3],this)}catch(e){logException(this.state,e)}if(redrawn&&this.docView.updateSelection(!0),!update2.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null;continue}{let diff=(scrollAnchorPos<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(scrollAnchorPos).top)-scrollAnchorHeight;if(diff>1||diff<-1){scrollTop+=diff,sDOM.scrollTop=scrollTop/this.scaleY,scrollAnchorHeight=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(updated&&!updated.empty)for(let listener of this.state.facet(updateListener))listener(updated)}get themeClasses(){return baseThemeID+" "+(this.state.facet(darkTheme)?baseDarkID:baseLightID)+" "+this.state.facet(theme)}updateAttrs(){let editorAttrs=attrsFromFacet(this,editorAttributes,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),contentAttrs={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(editable)?"true":"false",class:"cm-content",style:`${browser$1.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(contentAttrs["aria-readonly"]="true"),attrsFromFacet(this,contentAttributes,contentAttrs);let changed=this.observer.ignore((()=>{let changedContent=updateAttrs(this.contentDOM,this.contentAttrs,contentAttrs),changedEditor=updateAttrs(this.dom,this.editorAttrs,editorAttrs);return changedContent||changedEditor}));return this.editorAttrs=editorAttrs,this.contentAttrs=contentAttrs,changed}showAnnouncements(trs){let first=!0;for(let tr of trs)for(let effect2 of tr.effects)if(effect2.is(EditorView.announce)){first&&(this.announceDOM.textContent=""),first=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=effect2.value}}mountStyles(){this.styleModules=this.state.facet(styleModule);let nonce=this.state.facet(EditorView.cspNonce);StyleModule.mount(this.root,this.styleModules.concat(baseTheme$1$3).reverse(),nonce?{nonce:nonce}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(request){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),request){if(this.measureRequests.indexOf(request)>-1)return;if(null!=request.key)for(let i2=0;i2<this.measureRequests.length;i2++)if(this.measureRequests[i2].key===request.key)return void(this.measureRequests[i2]=request);this.measureRequests.push(request)}}plugin(plugin){let known=this.pluginMap.get(plugin);return(void 0===known||known&&known.spec!=plugin)&&this.pluginMap.set(plugin,known=this.plugins.find((p=>p.spec==plugin))||null),known&&known.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(height){return this.readMeasured(),this.viewState.elementAtHeight(height)}lineBlockAtHeight(height){return this.readMeasured(),this.viewState.lineBlockAtHeight(height)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(pos){return this.viewState.lineBlockAt(pos)}get contentHeight(){return this.viewState.contentHeight}moveByChar(start2,forward,by){return skipAtoms(this,start2,moveByChar(this,start2,forward,by))}moveByGroup(start2,forward){return skipAtoms(this,start2,moveByChar(this,start2,forward,(initial=>function(view,pos,start2){let categorize=view.state.charCategorizer(pos),cat=categorize(start2);return next=>{let nextCat=categorize(next);return cat==CharCategory.Space&&(cat=nextCat),cat==nextCat}}(this,start2.head,initial))))}moveToLineBoundary(start2,forward,includeWrap=!0){return moveToLineBoundary(this,start2,forward,includeWrap)}moveVertically(start2,forward,distance){return skipAtoms(this,start2,function(view,start2,forward,distance){let startPos=start2.head,dir=forward?1:-1;if(startPos==(forward?view.state.doc.length:0))return EditorSelection.cursor(startPos,start2.assoc);let startY,goal=start2.goalColumn,rect=view.contentDOM.getBoundingClientRect(),startCoords=view.coordsAtPos(startPos,start2.assoc||-1),docTop=view.documentTop;if(startCoords)null==goal&&(goal=startCoords.left-rect.left),startY=dir<0?startCoords.top:startCoords.bottom;else{let line=view.viewState.lineBlockAt(startPos);null==goal&&(goal=Math.min(rect.right-rect.left,view.defaultCharacterWidth*(startPos-line.from))),startY=(dir<0?line.top:line.bottom)+docTop}let resolvedGoal=rect.left+goal,dist2=null!=distance?distance:view.viewState.heightOracle.textHeight>>1;for(let extra2=0;;extra2+=10){let curY=startY+(dist2+extra2)*dir,pos=posAtCoords(view,{x:resolvedGoal,y:curY},!1,dir);if(curY<rect.top||curY>rect.bottom||(dir<0?pos<startPos:pos>startPos)){let charRect=view.docView.coordsForChar(pos),assoc=!charRect||curY<charRect.top?-1:1;return EditorSelection.cursor(pos,assoc,void 0,goal)}}}(this,start2,forward,distance))}domAtPos(pos){return this.docView.domAtPos(pos)}posAtDOM(node,offset2=0){return this.docView.posFromDOM(node,offset2)}posAtCoords(coords,precise=!0){return this.readMeasured(),posAtCoords(this,coords,precise)}coordsAtPos(pos,side=1){this.readMeasured();let rect=this.docView.coordsAt(pos,side);if(!rect||rect.left==rect.right)return rect;let line=this.state.doc.lineAt(pos),order2=this.bidiSpans(line);return flattenRect(rect,order2[BidiSpan.find(order2,pos-line.from,-1,side)].dir==Direction.LTR==side>0)}coordsForChar(pos){return this.readMeasured(),this.docView.coordsForChar(pos)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(pos){return!this.state.facet(perLineTextDirection)||pos<this.viewport.from||pos>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(pos))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(line){if(line.length>MaxBidiLine)return trivialOrder(line.length);let isolates,dir=this.textDirectionAt(line.from);for(let entry of this.bidiCache)if(entry.from==line.from&&entry.dir==dir&&(entry.fresh||isolatesEq(entry.isolates,isolates=getIsolatedRanges(this,line.from,line.to))))return entry.order;isolates||(isolates=getIsolatedRanges(this,line.from,line.to));let order2=function(line,direction,isolates){if(!line)return[new BidiSpan(0,0,direction==RTL?1:0)];if(direction==LTR&&!isolates.length&&!BidiRE.test(line))return trivialOrder(line.length);if(isolates.length)for(;line.length>types.length;)types[types.length]=256;let order2=[],level=direction==LTR?0:1;return computeSectionOrder(line,level,level,isolates,0,line.length,order2),order2}(line.text,dir,isolates);return this.bidiCache.push(new CachedOrder(line.from,line.to,dir,isolates,!0,order2)),order2}get hasFocus(){var _a2;return(this.dom.ownerDocument.hasFocus()||browser$1.safari&&(null===(_a2=this.inputState)||void 0===_a2?void 0:_a2.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{focusPreventScroll(this.contentDOM),this.docView.updateSelection()}))}setRoot(root){this._root!=root&&(this._root=root,this.observer.setWindow((9==root.nodeType?root:root.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let plugin of this.plugins)plugin.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(pos,options={}){return scrollIntoView$1.of(new ScrollTarget("number"==typeof pos?EditorSelection.cursor(pos):pos,options.y,options.x,options.yMargin,options.xMargin))}static domEventHandlers(handlers2){return ViewPlugin.define((()=>({})),{eventHandlers:handlers2})}static domEventObservers(observers2){return ViewPlugin.define((()=>({})),{eventObservers:observers2})}static theme(spec,options){let prefix=StyleModule.newName(),result=[theme.of(prefix),styleModule.of(buildTheme(`.${prefix}`,spec))];return options&&options.dark&&result.push(darkTheme.of(!0)),result}static baseTheme(spec){return Prec.lowest(styleModule.of(buildTheme("."+baseThemeID,spec,lightDarkIDs)))}static findFromDOM(dom){var _a2;let content2=dom.querySelector(".cm-content"),cView=content2&&ContentView.get(content2)||ContentView.get(dom);return(null===(_a2=null==cView?void 0:cView.rootView)||void 0===_a2?void 0:_a2.view)||null}}EditorView.styleModule=styleModule,EditorView.inputHandler=inputHandler$1,EditorView.focusChangeEffect=focusChangeEffect,EditorView.perLineTextDirection=perLineTextDirection,EditorView.exceptionSink=exceptionSink,EditorView.updateListener=updateListener,EditorView.editable=editable,EditorView.mouseSelectionStyle=mouseSelectionStyle,EditorView.dragMovesSelection=dragMovesSelection$1,EditorView.clickAddsSelectionRange=clickAddsSelectionRange,EditorView.decorations=decorations,EditorView.atomicRanges=atomicRanges,EditorView.bidiIsolatedRanges=bidiIsolatedRanges,EditorView.scrollMargins=scrollMargins,EditorView.darkTheme=darkTheme,EditorView.cspNonce=Facet.define({combine:values=>values.length?values[0]:""}),EditorView.contentAttributes=contentAttributes,EditorView.editorAttributes=editorAttributes,EditorView.lineWrapping=EditorView.contentAttributes.of({class:"cm-lineWrapping"}),EditorView.announce=StateEffect.define();const MaxBidiLine=4096,BadMeasure={};class CachedOrder{constructor(from,to,dir,isolates,fresh,order2){this.from=from,this.to=to,this.dir=dir,this.isolates=isolates,this.fresh=fresh,this.order=order2}static update(cache,changes){if(changes.empty&&!cache.some((c=>c.fresh)))return cache;let result=[],lastDir=cache.length?cache[cache.length-1].dir:Direction.LTR;for(let i2=Math.max(0,cache.length-10);i2<cache.length;i2++){let entry=cache[i2];entry.dir!=lastDir||changes.touchesRange(entry.from,entry.to)||result.push(new CachedOrder(changes.mapPos(entry.from,1),changes.mapPos(entry.to,-1),entry.dir,entry.isolates,!1,entry.order))}return result}}function attrsFromFacet(view,facet,base2){for(let sources=view.state.facet(facet),i2=sources.length-1;i2>=0;i2--){let source=sources[i2],value="function"==typeof source?source(view):source;value&&combineAttrs(value,base2)}return base2}const currentPlatform=browser$1.mac?"mac":browser$1.windows?"win":browser$1.linux?"linux":"key";function modifiers(name2,event,shift2){return event.altKey&&(name2="Alt-"+name2),event.ctrlKey&&(name2="Ctrl-"+name2),event.metaKey&&(name2="Meta-"+name2),!1!==shift2&&event.shiftKey&&(name2="Shift-"+name2),name2}const handleKeyEvents=Prec.default(EditorView.domEventHandlers({keydown:(event,view)=>function(map,event,view,scope){let name2=keyName(event),isChar=codePointSize(codePointAt(name2,0))==name2.length&&" "!=name2,prefix="",handled=!1,prevented=!1,stopPropagation=!1;storedPrefix&&storedPrefix.view==view&&storedPrefix.scope==scope&&(prefix=storedPrefix.prefix+" ",modifierCodes.indexOf(event.keyCode)<0&&(prevented=!0,storedPrefix=null));let baseName,shiftName,ran=new Set,runFor=binding=>{if(binding){for(let cmd2 of binding.run)if(!ran.has(cmd2)&&(ran.add(cmd2),cmd2(view,event)))return binding.stopPropagation&&(stopPropagation=!0),!0;binding.preventDefault&&(binding.stopPropagation&&(stopPropagation=!0),prevented=!0)}return!1},scopeObj=map[scope];scopeObj&&(runFor(scopeObj[prefix+modifiers(name2,event,!isChar)])?handled=!0:isChar&&(event.altKey||event.metaKey||event.ctrlKey)&&!(browser$1.windows&&event.ctrlKey&&event.altKey)&&(baseName=base[event.keyCode])&&baseName!=name2?(runFor(scopeObj[prefix+modifiers(baseName,event,!0)])||event.shiftKey&&(shiftName=shift[event.keyCode])!=name2&&shiftName!=baseName&&runFor(scopeObj[prefix+modifiers(shiftName,event,!1)]))&&(handled=!0):isChar&&event.shiftKey&&runFor(scopeObj[prefix+modifiers(name2,event,!0)])&&(handled=!0),!handled&&runFor(scopeObj._any)&&(handled=!0));prevented&&(handled=!0);handled&&stopPropagation&&event.stopPropagation();return handled}(function(state){let bindings=state.facet(keymap),map=Keymaps.get(bindings);map||Keymaps.set(bindings,map=function(bindings,platform=currentPlatform){let bound=Object.create(null),isPrefix=Object.create(null),checkPrefix=(name2,is2)=>{let current=isPrefix[name2];if(null==current)isPrefix[name2]=is2;else if(current!=is2)throw new Error("Key binding "+name2+" is used both as a regular binding and as a multi-stroke prefix")},add2=(scope,key,command2,preventDefault,stopPropagation)=>{var _a2,_b;let scopeObj=bound[scope]||(bound[scope]=Object.create(null)),parts=key.split(/ (?!$)/).map((k=>function(name2,platform){const parts=name2.split(/-(?!$)/);let alt,ctrl,shift2,meta2,result=parts[parts.length-1];"Space"==result&&(result=" ");for(let i2=0;i2<parts.length-1;++i2){const mod=parts[i2];if(/^(cmd|meta|m)$/i.test(mod))meta2=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else if(/^s(hift)?$/i.test(mod))shift2=!0;else{if(!/^mod$/i.test(mod))throw new Error("Unrecognized modifier name: "+mod);"mac"==platform?meta2=!0:ctrl=!0}}return alt&&(result="Alt-"+result),ctrl&&(result="Ctrl-"+result),meta2&&(result="Meta-"+result),shift2&&(result="Shift-"+result),result}(k,platform)));for(let i2=1;i2<parts.length;i2++){let prefix=parts.slice(0,i2).join(" ");checkPrefix(prefix,!0),scopeObj[prefix]||(scopeObj[prefix]={preventDefault:!0,stopPropagation:!1,run:[view=>{let ourObj=storedPrefix={view:view,prefix:prefix,scope:scope};return setTimeout((()=>{storedPrefix==ourObj&&(storedPrefix=null)}),PrefixTimeout),!0}]})}let full=parts.join(" ");checkPrefix(full,!1);let binding=scopeObj[full]||(scopeObj[full]={preventDefault:!1,stopPropagation:!1,run:(null===(_b=null===(_a2=scopeObj._any)||void 0===_a2?void 0:_a2.run)||void 0===_b?void 0:_b.slice())||[]});command2&&binding.run.push(command2),preventDefault&&(binding.preventDefault=!0),stopPropagation&&(binding.stopPropagation=!0)};for(let b of bindings){let scopes=b.scope?b.scope.split(" "):["editor"];if(b.any)for(let scope of scopes){let scopeObj=bound[scope]||(bound[scope]=Object.create(null));scopeObj._any||(scopeObj._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let key in scopeObj)scopeObj[key].run.push(b.any)}let name2=b[platform]||b.key;if(name2)for(let scope of scopes)add2(scope,name2,b.run,b.preventDefault,b.stopPropagation),b.shift&&add2(scope,"Shift-"+name2,b.shift,b.preventDefault,b.stopPropagation)}return bound}(bindings.reduce(((a,b)=>a.concat(b)),[])));return map}(view.state),event,view,"editor")})),keymap=Facet.define({enables:handleKeyEvents}),Keymaps=new WeakMap;let storedPrefix=null;const PrefixTimeout=4e3;browser$1.ios;class Placeholder extends WidgetType{constructor(content2){super(),this.content=content2}toDOM(){let wrap=document.createElement("span");return wrap.className="cm-placeholder",wrap.style.pointerEvents="none",wrap.appendChild("string"==typeof this.content?document.createTextNode(this.content):this.content),"string"==typeof this.content?wrap.setAttribute("aria-label","placeholder "+this.content):wrap.setAttribute("aria-hidden","true"),wrap}coordsAt(dom){let rects=dom.firstChild?clientRectsFor(dom.firstChild):[];if(!rects.length)return null;let style=window.getComputedStyle(dom.parentNode),rect=flattenRect(rects[0],"rtl"!=style.direction),lineHeight=parseInt(style.lineHeight);return rect.bottom-rect.top>1.5*lineHeight?{left:rect.left,right:rect.right,top:rect.top,bottom:rect.top+lineHeight}:rect}ignoreEvent(){return!1}}class GutterMarker extends RangeValue{compare(other){return this==other||this.constructor==other.constructor&&this.eq(other)}eq(other){return!1}destroy(dom){}}GutterMarker.prototype.elementClass="",GutterMarker.prototype.toDOM=void 0,GutterMarker.prototype.mapMode=MapMode.TrackBefore,GutterMarker.prototype.startSide=GutterMarker.prototype.endSide=-1,GutterMarker.prototype.point=!0;const gutterLineClass=Facet.define(),defaults$1={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>RangeSet.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},activeGutters=Facet.define();function gutter(config2){return[gutters(),activeGutters.of(Object.assign(Object.assign({},defaults$1),config2))]}const unfixGutters=Facet.define({combine:values=>values.some((x=>x))});function gutters(config2){let result=[gutterView];return config2&&!1===config2.fixed&&result.push(unfixGutters.of(!0)),result}const gutterView=ViewPlugin.fromClass(class{constructor(view){this.view=view,this.prevViewport=view.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=view.state.facet(activeGutters).map((conf=>new SingleGutterView(view,conf)));for(let gutter2 of this.gutters)this.dom.appendChild(gutter2.dom);this.fixed=!view.state.facet(unfixGutters),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),view.scrollDOM.insertBefore(this.dom,view.contentDOM)}update(update2){if(this.updateGutters(update2)){let vpA=this.prevViewport,vpB=update2.view.viewport,vpOverlap=Math.min(vpA.to,vpB.to)-Math.max(vpA.from,vpB.from);this.syncGutters(vpOverlap<.8*(vpB.to-vpB.from))}update2.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(unfixGutters)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=update2.view.viewport}syncGutters(detach2){let after=this.dom.nextSibling;detach2&&this.dom.remove();let lineClasses=RangeSet.iter(this.view.state.facet(gutterLineClass),this.view.viewport.from),classSet=[],contexts=this.gutters.map((gutter2=>new UpdateContext(gutter2,this.view.viewport,-this.view.documentPadding.top)));for(let line of this.view.viewportLineBlocks)if(classSet.length&&(classSet=[]),Array.isArray(line.type)){let first=!0;for(let b of line.type)if(b.type==BlockType.Text&&first){advanceCursor(lineClasses,classSet,b.from);for(let cx of contexts)cx.line(this.view,b,classSet);first=!1}else if(b.widget)for(let cx of contexts)cx.widget(this.view,b)}else if(line.type==BlockType.Text){advanceCursor(lineClasses,classSet,line.from);for(let cx of contexts)cx.line(this.view,line,classSet)}else if(line.widget)for(let cx of contexts)cx.widget(this.view,line);for(let cx of contexts)cx.finish();detach2&&this.view.scrollDOM.insertBefore(this.dom,after)}updateGutters(update2){let prev=update2.startState.facet(activeGutters),cur2=update2.state.facet(activeGutters),change=update2.docChanged||update2.heightChanged||update2.viewportChanged||!RangeSet.eq(update2.startState.facet(gutterLineClass),update2.state.facet(gutterLineClass),update2.view.viewport.from,update2.view.viewport.to);if(prev==cur2)for(let gutter2 of this.gutters)gutter2.update(update2)&&(change=!0);else{change=!0;let gutters2=[];for(let conf of cur2){let known=prev.indexOf(conf);known<0?gutters2.push(new SingleGutterView(this.view,conf)):(this.gutters[known].update(update2),gutters2.push(this.gutters[known]))}for(let g of this.gutters)g.dom.remove(),gutters2.indexOf(g)<0&&g.destroy();for(let g of gutters2)this.dom.appendChild(g.dom);this.gutters=gutters2}return change}destroy(){for(let view of this.gutters)view.destroy();this.dom.remove()}},{provide:plugin=>EditorView.scrollMargins.of((view=>{let value=view.plugin(plugin);return value&&0!=value.gutters.length&&value.fixed?view.textDirection==Direction.LTR?{left:value.dom.offsetWidth*view.scaleX}:{right:value.dom.offsetWidth*view.scaleX}:null}))});function asArray(val){return Array.isArray(val)?val:[val]}function advanceCursor(cursor2,collect,pos){for(;cursor2.value&&cursor2.from<=pos;)cursor2.from==pos&&collect.push(cursor2.value),cursor2.next()}class UpdateContext{constructor(gutter2,viewport2,height){this.gutter=gutter2,this.height=height,this.i=0,this.cursor=RangeSet.iter(gutter2.markers,viewport2.from)}addElement(view,block,markers){let{gutter:gutter2}=this,above=(block.top-this.height)/view.scaleY,height=block.height/view.scaleY;if(this.i==gutter2.elements.length){let newElt=new GutterElement(view,height,above,markers);gutter2.elements.push(newElt),gutter2.dom.appendChild(newElt.dom)}else gutter2.elements[this.i].update(view,height,above,markers);this.height=block.bottom,this.i++}line(view,line,extraMarkers){let localMarkers=[];advanceCursor(this.cursor,localMarkers,line.from),extraMarkers.length&&(localMarkers=localMarkers.concat(extraMarkers));let forLine=this.gutter.config.lineMarker(view,line,localMarkers);forLine&&localMarkers.unshift(forLine);let gutter2=this.gutter;(0!=localMarkers.length||gutter2.config.renderEmptyElements)&&this.addElement(view,line,localMarkers)}widget(view,block){let marker=this.gutter.config.widgetMarker(view,block.widget,block);marker&&this.addElement(view,block,[marker])}finish(){let gutter2=this.gutter;for(;gutter2.elements.length>this.i;){let last=gutter2.elements.pop();gutter2.dom.removeChild(last.dom),last.destroy()}}}class SingleGutterView{constructor(view,config2){this.view=view,this.config=config2,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let prop in config2.domEventHandlers)this.dom.addEventListener(prop,(event=>{let y,target=event.target;if(target!=this.dom&&this.dom.contains(target)){for(;target.parentNode!=this.dom;)target=target.parentNode;let rect=target.getBoundingClientRect();y=(rect.top+rect.bottom)/2}else y=event.clientY;let line=view.lineBlockAtHeight(y-view.documentTop);config2.domEventHandlers[prop](view,line,event)&&event.preventDefault()}));this.markers=asArray(config2.markers(view)),config2.initialSpacer&&(this.spacer=new GutterElement(view,0,0,[config2.initialSpacer(view)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(update2){let prevMarkers=this.markers;if(this.markers=asArray(this.config.markers(update2.view)),this.spacer&&this.config.updateSpacer){let updated=this.config.updateSpacer(this.spacer.markers[0],update2);updated!=this.spacer.markers[0]&&this.spacer.update(update2.view,0,0,[updated])}let vp=update2.view.viewport;return!RangeSet.eq(this.markers,prevMarkers,vp.from,vp.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(update2)}destroy(){for(let elt of this.elements)elt.destroy()}}class GutterElement{constructor(view,height,above,markers){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(view,height,above,markers)}update(view,height,above,markers){this.height!=height&&(this.height=height,this.dom.style.height=height+"px"),this.above!=above&&(this.dom.style.marginTop=(this.above=above)?above+"px":""),function(a,b){if(a.length!=b.length)return!1;for(let i2=0;i2<a.length;i2++)if(!a[i2].compare(b[i2]))return!1;return!0}(this.markers,markers)||this.setMarkers(view,markers)}setMarkers(view,markers){let cls="cm-gutterElement",domPos=this.dom.firstChild;for(let iNew=0,iOld=0;;){let skipTo=iOld,marker=iNew<markers.length?markers[iNew++]:null,matched=!1;if(marker){let c=marker.elementClass;c&&(cls+=" "+c);for(let i2=iOld;i2<this.markers.length;i2++)if(this.markers[i2].compare(marker)){skipTo=i2,matched=!0;break}}else skipTo=this.markers.length;for(;iOld<skipTo;){let next=this.markers[iOld++];if(next.toDOM){next.destroy(domPos);let after=domPos.nextSibling;domPos.remove(),domPos=after}}if(!marker)break;marker.toDOM&&(matched?domPos=domPos.nextSibling:this.dom.insertBefore(marker.toDOM(view),domPos)),matched&&iOld++}this.dom.className=cls,this.markers=markers}destroy(){this.setMarkers(null,[])}}let nextTagID=0;class Tag{constructor(set2,base2,modified){this.set=set2,this.base=base2,this.modified=modified,this.id=nextTagID++}static define(parent){if(null==parent?void 0:parent.base)throw new Error("Can not derive from a modified tag");let tag=new Tag([],null,[]);if(tag.set.push(tag),parent)for(let t2 of parent.set)tag.set.push(t2);return tag}static defineModifier(){let mod=new Modifier;return tag=>tag.modified.indexOf(mod)>-1?tag:Modifier.get(tag.base||tag,tag.modified.concat(mod).sort(((a,b)=>a.id-b.id)))}}let nextModifierID=0;class Modifier{constructor(){this.instances=[],this.id=nextModifierID++}static get(base2,mods){if(!mods.length)return base2;let exists=mods[0].instances.find((t2=>{return t2.base==base2&&(a=mods,b=t2.modified,a.length==b.length&&a.every(((x,i2)=>x==b[i2])));var a,b}));if(exists)return exists;let set2=[],tag=new Tag(set2,base2,mods);for(let m of mods)m.instances.push(tag);let configs=function(array){let sets=[[]];for(let i2=0;i2<array.length;i2++)for(let j=0,e=sets.length;j<e;j++)sets.push(sets[j].concat(array[i2]));return sets.sort(((a,b)=>b.length-a.length))}(mods);for(let parent of base2.set)if(!parent.modified.length)for(let config2 of configs)set2.push(Modifier.get(parent,config2));return tag}}function styleTags(spec){let byName=Object.create(null);for(let prop in spec){let tags2=spec[prop];Array.isArray(tags2)||(tags2=[tags2]);for(let part of prop.split(" "))if(part){let pieces=[],mode=2,rest=part;for(let pos=0;;){if("..."==rest&&pos>0&&pos+3==part.length){mode=1;break}let m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(rest);if(!m)throw new RangeError("Invalid path: "+part);if(pieces.push("*"==m[0]?"":'"'==m[0][0]?JSON.parse(m[0]):m[0]),pos+=m[0].length,pos==part.length)break;let next=part[pos++];if(pos==part.length&&"!"==next){mode=0;break}if("/"!=next)throw new RangeError("Invalid path: "+part);rest=part.slice(pos)}let last=pieces.length-1,inner=pieces[last];if(!inner)throw new RangeError("Invalid path: "+part);let rule=new Rule(tags2,mode,last>0?pieces.slice(0,last):null);byName[inner]=rule.sort(byName[inner])}}return ruleNodeProp.add(byName)}const ruleNodeProp=new NodeProp$1;class Rule{constructor(tags2,mode,context,next){this.tags=tags2,this.mode=mode,this.context=context,this.next=next}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(other){return!other||other.depth<this.depth?(this.next=other,this):(other.next=this.sort(other.next),other)}get depth(){return this.context?this.context.length:0}}function tagHighlighter(tags2,options){let map=Object.create(null);for(let style of tags2)if(Array.isArray(style.tag))for(let tag of style.tag)map[tag.id]=style.class;else map[style.tag.id]=style.class;let{scope:scope,all:all=null}=options||{};return{style:tags3=>{let cls=all;for(let tag of tags3)for(let sub of tag.set){let tagClass=map[sub.id];if(tagClass){cls=cls?cls+" "+tagClass:tagClass;break}}return cls},scope:scope}}function highlightTree(tree,highlighter,putStyle,from=0,to=tree.length){let builder=new HighlightBuilder(from,Array.isArray(highlighter)?highlighter:[highlighter],putStyle);builder.highlightRange(tree.cursor(),from,to,"",builder.highlighters),builder.flush(to)}Rule.empty=new Rule([],2,null);class HighlightBuilder{constructor(at,highlighters,span){this.at=at,this.highlighters=highlighters,this.span=span,this.class=""}startSpan(at,cls){cls!=this.class&&(this.flush(at),at>this.at&&(this.at=at),this.class=cls)}flush(to){to>this.at&&this.class&&this.span(this.at,to,this.class)}highlightRange(cursor2,from,to,inheritedClass,highlighters){let{type:type2,from:start2,to:end2}=cursor2;if(start2>=to||end2<=from)return;type2.isTop&&(highlighters=this.highlighters.filter((h=>!h.scope||h.scope(type2))));let cls=inheritedClass,rule=function(node){let rule=node.type.prop(ruleNodeProp);for(;rule&&rule.context&&!node.matchContext(rule.context);)rule=rule.next;return rule||null}(cursor2)||Rule.empty,tagCls=function(highlighters,tags2){let result=null;for(let highlighter of highlighters){let value=highlighter.style(tags2);value&&(result=result?result+" "+value:value)}return result}(highlighters,rule.tags);if(tagCls&&(cls&&(cls+=" "),cls+=tagCls,1==rule.mode&&(inheritedClass+=(inheritedClass?" ":"")+tagCls)),this.startSpan(Math.max(from,start2),cls),rule.opaque)return;let mounted=cursor2.tree&&cursor2.tree.prop(NodeProp$1.mounted);if(mounted&&mounted.overlay){let inner=cursor2.node.enter(mounted.overlay[0].from+start2,1),innerHighlighters=this.highlighters.filter((h=>!h.scope||h.scope(mounted.tree.type))),hasChild2=cursor2.firstChild();for(let i2=0,pos=start2;;i2++){let next=i2<mounted.overlay.length?mounted.overlay[i2]:null,nextPos=next?next.from+start2:end2,rangeFrom=Math.max(from,pos),rangeTo=Math.min(to,nextPos);if(rangeFrom<rangeTo&&hasChild2)for(;cursor2.from<rangeTo&&(this.highlightRange(cursor2,rangeFrom,rangeTo,inheritedClass,highlighters),this.startSpan(Math.min(rangeTo,cursor2.to),cls),!(cursor2.to>=nextPos)&&cursor2.nextSibling()););if(!next||nextPos>to)break;pos=next.to+start2,pos>from&&(this.highlightRange(inner.cursor(),Math.max(from,next.from+start2),Math.min(to,pos),"",innerHighlighters),this.startSpan(Math.min(to,pos),cls))}hasChild2&&cursor2.parent()}else if(cursor2.firstChild()){mounted&&(inheritedClass="");do{if(!(cursor2.to<=from)){if(cursor2.from>=to)break;this.highlightRange(cursor2,from,to,inheritedClass,highlighters),this.startSpan(Math.min(to,cursor2.to),cls)}}while(cursor2.nextSibling());cursor2.parent()}}}const t=Tag.define,comment=t(),name=t(),typeName=t(name),propertyName=t(name),literal=t(),string=t(literal),number=t(literal),content=t(),heading=t(content),keyword=t(),operator=t(),punctuation=t(),bracket=t(punctuation),meta=t(),tags={comment:comment,lineComment:t(comment),blockComment:t(comment),docComment:t(comment),name:name,variableName:t(name),typeName:typeName,tagName:t(typeName),propertyName:propertyName,attributeName:t(propertyName),className:t(name),labelName:t(name),namespace:t(name),macroName:t(name),literal:literal,string:string,docString:t(string),character:t(string),attributeValue:t(string),number:number,integer:t(number),float:t(number),bool:t(literal),regexp:t(literal),escape:t(literal),color:t(literal),url:t(literal),keyword:keyword,self:t(keyword),null:t(keyword),atom:t(keyword),unit:t(keyword),modifier:t(keyword),operatorKeyword:t(keyword),controlKeyword:t(keyword),definitionKeyword:t(keyword),moduleKeyword:t(keyword),operator:operator,derefOperator:t(operator),arithmeticOperator:t(operator),logicOperator:t(operator),bitwiseOperator:t(operator),compareOperator:t(operator),updateOperator:t(operator),definitionOperator:t(operator),typeOperator:t(operator),controlOperator:t(operator),punctuation:punctuation,separator:t(punctuation),bracket:bracket,angleBracket:t(bracket),squareBracket:t(bracket),paren:t(bracket),brace:t(bracket),content:content,heading:heading,heading1:t(heading),heading2:t(heading),heading3:t(heading),heading4:t(heading),heading5:t(heading),heading6:t(heading),contentSeparator:t(content),list:t(content),quote:t(content),emphasis:t(content),strong:t(content),link:t(content),monospace:t(content),strikethrough:t(content),inserted:t(),deleted:t(),changed:t(),invalid:t(),meta:meta,documentMeta:t(meta),annotation:t(meta),processingInstruction:t(meta),definition:Tag.defineModifier(),constant:Tag.defineModifier(),function:Tag.defineModifier(),standard:Tag.defineModifier(),local:Tag.defineModifier(),special:Tag.defineModifier()};var _a;tagHighlighter([{tag:tags.link,class:"tok-link"},{tag:tags.heading,class:"tok-heading"},{tag:tags.emphasis,class:"tok-emphasis"},{tag:tags.strong,class:"tok-strong"},{tag:tags.keyword,class:"tok-keyword"},{tag:tags.atom,class:"tok-atom"},{tag:tags.bool,class:"tok-bool"},{tag:tags.url,class:"tok-url"},{tag:tags.labelName,class:"tok-labelName"},{tag:tags.inserted,class:"tok-inserted"},{tag:tags.deleted,class:"tok-deleted"},{tag:tags.literal,class:"tok-literal"},{tag:tags.string,class:"tok-string"},{tag:tags.number,class:"tok-number"},{tag:[tags.regexp,tags.escape,tags.special(tags.string)],class:"tok-string2"},{tag:tags.variableName,class:"tok-variableName"},{tag:tags.local(tags.variableName),class:"tok-variableName tok-local"},{tag:tags.definition(tags.variableName),class:"tok-variableName tok-definition"},{tag:tags.special(tags.variableName),class:"tok-variableName2"},{tag:tags.definition(tags.propertyName),class:"tok-propertyName tok-definition"},{tag:tags.typeName,class:"tok-typeName"},{tag:tags.namespace,class:"tok-namespace"},{tag:tags.className,class:"tok-className"},{tag:tags.macroName,class:"tok-macroName"},{tag:tags.propertyName,class:"tok-propertyName"},{tag:tags.operator,class:"tok-operator"},{tag:tags.comment,class:"tok-comment"},{tag:tags.meta,class:"tok-meta"},{tag:tags.invalid,class:"tok-invalid"},{tag:tags.punctuation,class:"tok-punctuation"}]);const languageDataProp=new NodeProp$1;const sublanguageProp=new NodeProp$1;class Language{constructor(data2,parser2,extraExtensions=[],name2=""){this.data=data2,this.name=name2,EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(EditorState.prototype,"tree",{get(){return syntaxTree(this)}}),this.parser=parser2,this.extension=[language.of(this),EditorState.languageData.of(((state,pos,side)=>{let top2=topNodeAt(state,pos,side),data3=top2.type.prop(languageDataProp);if(!data3)return[];let base2=state.facet(data3),sub=top2.type.prop(sublanguageProp);if(sub){let innerNode=top2.resolve(pos-top2.from,side);for(let sublang of sub)if(sublang.test(innerNode,state)){let data4=state.facet(sublang.facet);return"replace"==sublang.type?data4:data4.concat(base2)}}return base2}))].concat(extraExtensions)}isActiveAt(state,pos,side=-1){return topNodeAt(state,pos,side).type.prop(languageDataProp)==this.data}findRegions(state){let lang=state.facet(language);if((null==lang?void 0:lang.data)==this.data)return[{from:0,to:state.doc.length}];if(!lang||!lang.allowsNesting)return[];let result=[],explore=(tree,from)=>{if(tree.prop(languageDataProp)==this.data)return void result.push({from:from,to:from+tree.length});let mount=tree.prop(NodeProp$1.mounted);if(mount){if(mount.tree.prop(languageDataProp)==this.data){if(mount.overlay)for(let r of mount.overlay)result.push({from:r.from+from,to:r.to+from});else result.push({from:from,to:from+tree.length});return}if(mount.overlay){let size=result.length;if(explore(mount.tree,mount.overlay[0].from+from),result.length>size)return}}for(let i2=0;i2<tree.children.length;i2++){let ch=tree.children[i2];ch instanceof Tree$1&&explore(ch,tree.positions[i2]+from)}};return explore(syntaxTree(state),0),result}get allowsNesting(){return!0}}function topNodeAt(state,pos,side){let topLang=state.facet(language),tree=syntaxTree(state).topNode;if(!topLang||topLang.allowsNesting)for(let node=tree;node;node=node.enter(pos,side,IterMode$1.ExcludeBuffers))node.type.isTop&&(tree=node);return tree}Language.setState=StateEffect.define();class LRLanguage extends Language{constructor(data2,parser2,name2){super(data2,parser2,[],name2),this.parser=parser2}static define(spec){let data2=(baseData=spec.languageData,Facet.define({combine:baseData?values=>values.concat(baseData):void 0}));var baseData;return new LRLanguage(data2,spec.parser.configure({props:[languageDataProp.add((type2=>type2.isTop?data2:void 0))]}),spec.name)}configure(options,name2){return new LRLanguage(this.data,this.parser.configure(options),name2||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function syntaxTree(state){let field=state.field(Language.state,!1);return field?field.tree:Tree$1.empty}class DocInput{constructor(doc2){this.doc=doc2,this.cursorPos=0,this.string="",this.cursor=doc2.iter()}get length(){return this.doc.length}syncTo(pos){return this.string=this.cursor.next(pos-this.cursorPos).value,this.cursorPos=pos+this.string.length,this.cursorPos-this.string.length}chunk(pos){return this.syncTo(pos),this.string}get lineChunks(){return!0}read(from,to){let stringStart=this.cursorPos-this.string.length;return from<stringStart||to>=this.cursorPos?this.doc.sliceString(from,to):this.string.slice(from-stringStart,to-stringStart)}}let currentContext=null;class ParseContext{constructor(parser2,state,fragments=[],tree,treeLen,viewport2,skipped,scheduleOn){this.parser=parser2,this.state=state,this.fragments=fragments,this.tree=tree,this.treeLen=treeLen,this.viewport=viewport2,this.skipped=skipped,this.scheduleOn=scheduleOn,this.parse=null,this.tempSkipped=[]}static create(parser2,state,viewport2){return new ParseContext(parser2,state,[],Tree$1.empty,0,viewport2,[],null)}startParse(){return this.parser.startParse(new DocInput(this.state.doc),this.fragments)}work(until,upto){return null!=upto&&upto>=this.state.doc.length&&(upto=void 0),this.tree!=Tree$1.empty&&this.isDone(null!=upto?upto:this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var _a2;if("number"==typeof until){let endTime=Date.now()+until;until=()=>Date.now()>endTime}for(this.parse||(this.parse=this.startParse()),null!=upto&&(null==this.parse.stoppedAt||this.parse.stoppedAt>upto)&&upto<this.state.doc.length&&this.parse.stopAt(upto);;){let done=this.parse.advance();if(done){if(this.fragments=this.withoutTempSkipped(TreeFragment.addTree(done,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(_a2=this.parse.stoppedAt)&&void 0!==_a2?_a2:this.state.doc.length,this.tree=done,this.parse=null,!(this.treeLen<(null!=upto?upto:this.state.doc.length)))return!0;this.parse=this.startParse()}if(until())return!1}}))}takeTree(){let pos,tree;this.parse&&(pos=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>pos)&&this.parse.stopAt(pos),this.withContext((()=>{for(;!(tree=this.parse.advance()););})),this.treeLen=pos,this.tree=tree,this.fragments=this.withoutTempSkipped(TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(f){let prev=currentContext;currentContext=this;try{return f()}finally{currentContext=prev}}withoutTempSkipped(fragments){for(let r;r=this.tempSkipped.pop();)fragments=cutFragments(fragments,r.from,r.to);return fragments}changes(changes,newState){let{fragments:fragments,tree:tree,treeLen:treeLen,viewport:viewport2,skipped:skipped}=this;if(this.takeTree(),!changes.empty){let ranges=[];if(changes.iterChangedRanges(((fromA,toA,fromB,toB)=>ranges.push({fromA:fromA,toA:toA,fromB:fromB,toB:toB}))),fragments=TreeFragment.applyChanges(fragments,ranges),tree=Tree$1.empty,treeLen=0,viewport2={from:changes.mapPos(viewport2.from,-1),to:changes.mapPos(viewport2.to,1)},this.skipped.length){skipped=[];for(let r of this.skipped){let from=changes.mapPos(r.from,1),to=changes.mapPos(r.to,-1);from<to&&skipped.push({from:from,to:to})}}}return new ParseContext(this.parser,newState,fragments,tree,treeLen,viewport2,skipped,this.scheduleOn)}updateViewport(viewport2){if(this.viewport.from==viewport2.from&&this.viewport.to==viewport2.to)return!1;this.viewport=viewport2;let startLen=this.skipped.length;for(let i2=0;i2<this.skipped.length;i2++){let{from:from,to:to}=this.skipped[i2];from<viewport2.to&&to>viewport2.from&&(this.fragments=cutFragments(this.fragments,from,to),this.skipped.splice(i2--,1))}return!(this.skipped.length>=startLen)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(from,to){this.skipped.push({from:from,to:to})}static getSkippingParser(until){return new class extends Parser{createParse(input,fragments,ranges){let from=ranges[0].from,to=ranges[ranges.length-1].to;return{parsedPos:from,advance(){let cx=currentContext;if(cx){for(let r of ranges)cx.tempSkipped.push(r);until&&(cx.scheduleOn=cx.scheduleOn?Promise.all([cx.scheduleOn,until]):until)}return this.parsedPos=to,new Tree$1(NodeType$1.none,[],[],to-from)},stoppedAt:null,stopAt(){}}}}}isDone(upto){upto=Math.min(upto,this.state.doc.length);let frags=this.fragments;return this.treeLen>=upto&&frags.length&&0==frags[0].from&&frags[0].to>=upto}static get(){return currentContext}}function cutFragments(fragments,from,to){return TreeFragment.applyChanges(fragments,[{fromA:from,toA:to,fromB:from,toB:to}])}class LanguageState{constructor(context){this.context=context,this.tree=context.tree}apply(tr){if(!tr.docChanged&&this.tree==this.context.tree)return this;let newCx=this.context.changes(tr.changes,tr.state),upto=this.context.treeLen==tr.startState.doc.length?void 0:Math.max(tr.changes.mapPos(this.context.treeLen),newCx.viewport.to);return newCx.work(20,upto)||newCx.takeTree(),new LanguageState(newCx)}static init(state){let vpTo=Math.min(3e3,state.doc.length),parseState=ParseContext.create(state.facet(language).parser,state,{from:0,to:vpTo});return parseState.work(20,vpTo)||parseState.takeTree(),new LanguageState(parseState)}}Language.state=StateField.define({create:LanguageState.init,update(value,tr){for(let e of tr.effects)if(e.is(Language.setState))return e.value;return tr.startState.facet(language)!=tr.state.facet(language)?LanguageState.init(tr.state):value.apply(tr)}});let requestIdle=callback=>{let timeout=setTimeout((()=>callback()),500);return()=>clearTimeout(timeout)};"undefined"!=typeof requestIdleCallback&&(requestIdle=callback=>{let idle=-1,timeout=setTimeout((()=>{idle=requestIdleCallback(callback,{timeout:400})}),100);return()=>idle<0?clearTimeout(timeout):cancelIdleCallback(idle)});const isInputPending="undefined"!=typeof navigator&&(null===(_a=navigator.scheduling)||void 0===_a?void 0:_a.isInputPending)?()=>navigator.scheduling.isInputPending():null,parseWorker=ViewPlugin.fromClass(class{constructor(view){this.view=view,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(update2){let cx=this.view.state.field(Language.state).context;(cx.updateViewport(update2.view.viewport)||this.view.viewport.to>cx.treeLen)&&this.scheduleWork(),(update2.docChanged||update2.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(cx)}scheduleWork(){if(this.working)return;let{state:state}=this.view,field=state.field(Language.state);field.tree==field.context.tree&&field.context.isDone(state.doc.length)||(this.working=requestIdle(this.work))}work(deadline){this.working=null;let now2=Date.now();if(this.chunkEnd<now2&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=now2+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:state,viewport:{to:vpTo}}=this.view,field=state.field(Language.state);if(field.tree==field.context.tree&&field.context.isDone(vpTo+1e5))return;let endTime=Date.now()+Math.min(this.chunkBudget,100,deadline&&!isInputPending?Math.max(25,deadline.timeRemaining()-5):1e9),viewportFirst=field.context.treeLen<vpTo&&state.doc.length>vpTo+1e3,done=field.context.work((()=>isInputPending&&isInputPending()||Date.now()>endTime),vpTo+(viewportFirst?0:1e5));this.chunkBudget-=Date.now()-now2,(done||this.chunkBudget<=0)&&(field.context.takeTree(),this.view.dispatch({effects:Language.setState.of(new LanguageState(field.context))})),this.chunkBudget>0&&(!done||viewportFirst)&&this.scheduleWork(),this.checkAsyncSchedule(field.context)}checkAsyncSchedule(cx){cx.scheduleOn&&(this.workScheduled++,cx.scheduleOn.then((()=>this.scheduleWork())).catch((err=>logException(this.view.state,err))).then((()=>this.workScheduled--)),cx.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),language=Facet.define({combine:languages=>languages.length?languages[0]:null,enables:language2=>[Language.state,parseWorker,EditorView.contentAttributes.compute([language2],(state=>{let lang=state.facet(language2);return lang&&lang.name?{"data-language":lang.name}:{}}))]});class LanguageSupport{constructor(language2,support=[]){this.language=language2,this.support=support,this.extension=[language2,support]}}const indentService=Facet.define(),indentUnit=Facet.define({combine:values=>{if(!values.length)return"  ";let unit=values[0];if(!unit||/\S/.test(unit)||Array.from(unit).some((e=>e!=unit[0])))throw new Error("Invalid indent unit: "+JSON.stringify(values[0]));return unit}});function getIndentUnit(state){let unit=state.facet(indentUnit);return 9==unit.charCodeAt(0)?state.tabSize*unit.length:unit.length}function indentString(state,cols){let result="",ts=state.tabSize,ch=state.facet(indentUnit)[0];if("\t"==ch){for(;cols>=ts;)result+="\t",cols-=ts;ch=" "}for(let i2=0;i2<cols;i2++)result+=ch;return result}function getIndentation(context,pos){context instanceof EditorState&&(context=new IndentContext(context));for(let service of context.state.facet(indentService)){let result=service(context,pos);if(void 0!==result)return result}let tree=syntaxTree(context.state);return tree.length>=pos?function(cx,ast,pos){let stack=ast.resolveStack(pos),inner=stack.node.enterUnfinishedNodesBefore(pos);if(inner!=stack.node){let add2=[];for(let cur2=inner;cur2!=stack.node;cur2=cur2.parent)add2.push(cur2);for(let i2=add2.length-1;i2>=0;i2--)stack={node:add2[i2],next:stack}}return indentFor(stack,cx,pos)}(context,tree,pos):null}class IndentContext{constructor(state,options={}){this.state=state,this.options=options,this.unit=getIndentUnit(state)}lineAt(pos,bias=1){let line=this.state.doc.lineAt(pos),{simulateBreak:simulateBreak,simulateDoubleBreak:simulateDoubleBreak}=this.options;return null!=simulateBreak&&simulateBreak>=line.from&&simulateBreak<=line.to?simulateDoubleBreak&&simulateBreak==pos?{text:"",from:pos}:(bias<0?simulateBreak<pos:simulateBreak<=pos)?{text:line.text.slice(simulateBreak-line.from),from:simulateBreak}:{text:line.text.slice(0,simulateBreak-line.from),from:line.from}:line}textAfterPos(pos,bias=1){if(this.options.simulateDoubleBreak&&pos==this.options.simulateBreak)return"";let{text:text2,from:from}=this.lineAt(pos,bias);return text2.slice(pos-from,Math.min(text2.length,pos+100-from))}column(pos,bias=1){let{text:text2,from:from}=this.lineAt(pos,bias),result=this.countColumn(text2,pos-from),override=this.options.overrideIndentation?this.options.overrideIndentation(from):-1;return override>-1&&(result+=override-this.countColumn(text2,text2.search(/\S|$/))),result}countColumn(line,pos=line.length){return countColumn(line,this.state.tabSize,pos)}lineIndent(pos,bias=1){let{text:text2,from:from}=this.lineAt(pos,bias),override=this.options.overrideIndentation;if(override){let overriden=override(from);if(overriden>-1)return overriden}return this.countColumn(text2,text2.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const indentNodeProp=new NodeProp$1;function indentFor(stack,cx,pos){for(let cur2=stack;cur2;cur2=cur2.next){let strategy=indentStrategy(cur2.node);if(strategy)return strategy(TreeIndentContext.create(cx,pos,cur2))}return 0}function indentStrategy(tree){let strategy=tree.type.prop(indentNodeProp);if(strategy)return strategy;let close,first=tree.firstChild;if(first&&(close=first.type.prop(NodeProp$1.closedBy))){let last=tree.lastChild,closed=last&&close.indexOf(last.name)>-1;return cx=>function(context,align,units,closing2,closedAt){let after=context.textAfter,space2=after.match(/^\s*/)[0].length,closed=closing2&&after.slice(space2,space2+closing2.length)==closing2||closedAt==context.pos+space2,aligned=align?function(context){let tree=context.node,openToken=tree.childAfter(tree.from),last=tree.lastChild;if(!openToken)return null;let sim=context.options.simulateBreak,openLine=context.state.doc.lineAt(openToken.from),lineEnd=null==sim||sim<=openLine.from?openLine.to:Math.min(openLine.to,sim);for(let pos=openToken.to;;){let next=tree.childAfter(pos);if(!next||next==last)return null;if(!next.type.isSkipped)return next.from<lineEnd?openToken:null;pos=next.to}}(context):null;return aligned?closed?context.column(aligned.from):context.column(aligned.to):context.baseIndent+(closed?0:context.unit*units)}(cx,!0,1,void 0,closed&&!function(cx){return cx.pos==cx.options.simulateBreak&&cx.options.simulateDoubleBreak}(cx)?last.from:void 0)}return null==tree.parent?topIndent:null}function topIndent(){return 0}class TreeIndentContext extends IndentContext{constructor(base2,pos,context){super(base2.state,base2.options),this.base=base2,this.pos=pos,this.context=context}get node(){return this.context.node}static create(base2,pos,context){return new TreeIndentContext(base2,pos,context)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(node){let line=this.state.doc.lineAt(node.from);for(;;){let atBreak=node.resolve(line.from);for(;atBreak.parent&&atBreak.parent.from==atBreak.from;)atBreak=atBreak.parent;if(isParent(atBreak,node))break;line=this.state.doc.lineAt(atBreak.from)}return this.lineIndent(line.from)}continue(){return indentFor(this.context.next,this.base,this.pos)}}function isParent(parent,of){for(let cur2=of;cur2;cur2=cur2.parent)if(parent==cur2)return!0;return!1}function continuedIndent({except:except,units:units=1}={}){return context=>{let matchExcept=except&&except.test(context.textAfter);return context.baseIndent+(matchExcept?0:units*context.unit)}}const foldService=Facet.define(),foldNodeProp=new NodeProp$1;function isUnfinished(node){let ch=node.lastChild;return ch&&ch.to==node.to&&ch.type.isError}function foldable(state,lineStart,lineEnd){for(let service of state.facet(foldService)){let result=service(state,lineStart,lineEnd);if(result)return result}return function(state,start2,end2){let tree=syntaxTree(state);if(tree.length<end2)return null;let found=null;for(let iter=tree.resolveStack(end2,1);iter;iter=iter.next){let cur2=iter.node;if(cur2.to<=end2||cur2.from>end2)continue;if(found&&cur2.from<start2)break;let prop=cur2.type.prop(foldNodeProp);if(prop&&(cur2.to<tree.length-50||tree.length==state.doc.length||!isUnfinished(cur2))){let value=prop(cur2,state);value&&value.from<=end2&&value.from>=start2&&value.to>end2&&(found=value)}}return found}(state,lineStart,lineEnd)}function mapRange(range,mapping){let from=mapping.mapPos(range.from,1),to=mapping.mapPos(range.to,-1);return from>=to?void 0:{from:from,to:to}}const foldEffect=StateEffect.define({map:mapRange}),unfoldEffect=StateEffect.define({map:mapRange});function selectedLines(view){let lines=[];for(let{head:head}of view.state.selection.ranges)lines.some((l=>l.from<=head&&l.to>=head))||lines.push(view.lineBlockAt(head));return lines}const foldState=StateField.define({create:()=>Decoration.none,update(folded,tr){folded=folded.map(tr.changes);for(let e of tr.effects)if(e.is(foldEffect)&&!foldExists(folded,e.value.from,e.value.to)){let{preparePlaceholder:preparePlaceholder}=tr.state.facet(foldConfig),widget=preparePlaceholder?Decoration.replace({widget:new PreparedFoldWidget(preparePlaceholder(tr.state,e.value))}):foldWidget;folded=folded.update({add:[widget.range(e.value.from,e.value.to)]})}else e.is(unfoldEffect)&&(folded=folded.update({filter:(from,to)=>e.value.from!=from||e.value.to!=to,filterFrom:e.value.from,filterTo:e.value.to}));if(tr.selection){let onSelection=!1,{head:head}=tr.selection.main;folded.between(head,head,((a,b)=>{a<head&&b>head&&(onSelection=!0)})),onSelection&&(folded=folded.update({filterFrom:head,filterTo:head,filter:(a,b)=>b<=head||a>=head}))}return folded},provide:f=>EditorView.decorations.from(f),toJSON(folded,state){let ranges=[];return folded.between(0,state.doc.length,((from,to)=>{ranges.push(from,to)})),ranges},fromJSON(value){if(!Array.isArray(value)||value.length%2)throw new RangeError("Invalid JSON for fold state");let ranges=[];for(let i2=0;i2<value.length;){let from=value[i2++],to=value[i2++];if("number"!=typeof from||"number"!=typeof to)throw new RangeError("Invalid JSON for fold state");ranges.push(foldWidget.range(from,to))}return Decoration.set(ranges,!0)}});function findFold(state,from,to){var _a2;let found=null;return null===(_a2=state.field(foldState,!1))||void 0===_a2||_a2.between(from,to,((from2,to2)=>{(!found||found.from>from2)&&(found={from:from2,to:to2})})),found}function foldExists(folded,from,to){let found=!1;return folded.between(from,from,((a,b)=>{a==from&&b==to&&(found=!0)})),found}function maybeEnable(state,other){return state.field(foldState,!1)?other:other.concat(StateEffect.appendConfig.of(codeFolding()))}function announceFold(view,range,fold=!0){let lineFrom=view.state.doc.lineAt(range.from).number,lineTo=view.state.doc.lineAt(range.to).number;return EditorView.announce.of(`${view.state.phrase(fold?"Folded lines":"Unfolded lines")} ${lineFrom} ${view.state.phrase("to")} ${lineTo}.`)}const foldKeymap=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:view=>{for(let line of selectedLines(view)){let range=foldable(view.state,line.from,line.to);if(range)return view.dispatch({effects:maybeEnable(view.state,[foldEffect.of(range),announceFold(view,range)])}),!0}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:view=>{if(!view.state.field(foldState,!1))return!1;let effects=[];for(let line of selectedLines(view)){let folded=findFold(view.state,line.from,line.to);folded&&effects.push(unfoldEffect.of(folded),announceFold(view,folded,!1))}return effects.length&&view.dispatch({effects:effects}),effects.length>0}},{key:"Ctrl-Alt-[",run:view=>{let{state:state}=view,effects=[];for(let pos=0;pos<state.doc.length;){let line=view.lineBlockAt(pos),range=foldable(state,line.from,line.to);range&&effects.push(foldEffect.of(range)),pos=(range?view.lineBlockAt(range.to):line).to+1}return effects.length&&view.dispatch({effects:maybeEnable(view.state,effects)}),!!effects.length}},{key:"Ctrl-Alt-]",run:view=>{let field=view.state.field(foldState,!1);if(!field||!field.size)return!1;let effects=[];return field.between(0,view.state.doc.length,((from,to)=>{effects.push(unfoldEffect.of({from:from,to:to}))})),view.dispatch({effects:effects}),!0}}],defaultConfig={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},foldConfig=Facet.define({combine:values=>combineConfig(values,defaultConfig)});function codeFolding(config2){let result=[foldState,baseTheme$1$2];return config2&&result.push(foldConfig.of(config2)),result}function widgetToDOM(view,prepared){let{state:state}=view,conf=state.facet(foldConfig),onclick=event=>{let line=view.lineBlockAt(view.posAtDOM(event.target)),folded=findFold(view.state,line.from,line.to);folded&&view.dispatch({effects:unfoldEffect.of(folded)}),event.preventDefault()};if(conf.placeholderDOM)return conf.placeholderDOM(view,onclick,prepared);let element2=document.createElement("span");return element2.textContent=conf.placeholderText,element2.setAttribute("aria-label",state.phrase("folded code")),element2.title=state.phrase("unfold"),element2.className="cm-foldPlaceholder",element2.onclick=onclick,element2}const foldWidget=Decoration.replace({widget:new class extends WidgetType{toDOM(view){return widgetToDOM(view,null)}}});class PreparedFoldWidget extends WidgetType{constructor(value){super(),this.value=value}eq(other){return this.value==other.value}toDOM(view){return widgetToDOM(view,this.value)}}const foldGutterDefaults={openText:"\u2304",closedText:"\u203a",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class FoldMarker extends GutterMarker{constructor(config2,open){super(),this.config=config2,this.open=open}eq(other){return this.config==other.config&&this.open==other.open}toDOM(view){if(this.config.markerDOM)return this.config.markerDOM(this.open);let span=document.createElement("span");return span.textContent=this.open?this.config.openText:this.config.closedText,span.title=view.state.phrase(this.open?"Fold line":"Unfold line"),span}}function foldGutter(config2={}){let fullConfig=Object.assign(Object.assign({},foldGutterDefaults),config2),canFold=new FoldMarker(fullConfig,!0),canUnfold=new FoldMarker(fullConfig,!1),markers=ViewPlugin.fromClass(class{constructor(view){this.from=view.viewport.from,this.markers=this.buildMarkers(view)}update(update2){(update2.docChanged||update2.viewportChanged||update2.startState.facet(language)!=update2.state.facet(language)||update2.startState.field(foldState,!1)!=update2.state.field(foldState,!1)||syntaxTree(update2.startState)!=syntaxTree(update2.state)||fullConfig.foldingChanged(update2))&&(this.markers=this.buildMarkers(update2.view))}buildMarkers(view){let builder=new RangeSetBuilder;for(let line of view.viewportLineBlocks){let mark=findFold(view.state,line.from,line.to)?canUnfold:foldable(view.state,line.from,line.to)?canFold:null;mark&&builder.add(line.from,line.from,mark)}return builder.finish()}}),{domEventHandlers:domEventHandlers}=fullConfig;return[markers,gutter({class:"cm-foldGutter",markers(view){var _a2;return(null===(_a2=view.plugin(markers))||void 0===_a2?void 0:_a2.markers)||RangeSet.empty},initialSpacer:()=>new FoldMarker(fullConfig,!1),domEventHandlers:Object.assign(Object.assign({},domEventHandlers),{click:(view,line,event)=>{if(domEventHandlers.click&&domEventHandlers.click(view,line,event))return!0;let folded=findFold(view.state,line.from,line.to);if(folded)return view.dispatch({effects:unfoldEffect.of(folded)}),!0;let range=foldable(view.state,line.from,line.to);return!!range&&(view.dispatch({effects:foldEffect.of(range)}),!0)}})}),codeFolding()]}const baseTheme$1$2=EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class HighlightStyle{constructor(specs,options){let modSpec;function def(spec){let cls=StyleModule.newName();return(modSpec||(modSpec=Object.create(null)))["."+cls]=spec,cls}this.specs=specs;const all="string"==typeof options.all?options.all:options.all?def(options.all):void 0,scopeOpt=options.scope;this.scope=scopeOpt instanceof Language?type2=>type2.prop(languageDataProp)==scopeOpt.data:scopeOpt?type2=>type2==scopeOpt:void 0,this.style=tagHighlighter(specs.map((style=>({tag:style.tag,class:style.class||def(Object.assign({},style,{tag:null}))}))),{all:all}).style,this.module=modSpec?new StyleModule(modSpec):null,this.themeType=options.themeType}static define(specs,options){return new HighlightStyle(specs,options||{})}}const highlighterFacet=Facet.define(),fallbackHighlighter=Facet.define({combine:values=>values.length?[values[0]]:null});function getHighlighters(state){let main2=state.facet(highlighterFacet);return main2.length?main2:state.facet(fallbackHighlighter)}function syntaxHighlighting(highlighter,options){let themeType,ext=[treeHighlighter];return highlighter instanceof HighlightStyle&&(highlighter.module&&ext.push(EditorView.styleModule.of(highlighter.module)),themeType=highlighter.themeType),(null==options?void 0:options.fallback)?ext.push(fallbackHighlighter.of(highlighter)):themeType?ext.push(highlighterFacet.computeN([EditorView.darkTheme],(state=>state.facet(EditorView.darkTheme)==("dark"==themeType)?[highlighter]:[]))):ext.push(highlighterFacet.of(highlighter)),ext}class TreeHighlighter{constructor(view){this.markCache=Object.create(null),this.tree=syntaxTree(view.state),this.decorations=this.buildDeco(view,getHighlighters(view.state))}update(update2){let tree=syntaxTree(update2.state),highlighters=getHighlighters(update2.state),styleChange=highlighters!=getHighlighters(update2.startState);tree.length<update2.view.viewport.to&&!styleChange&&tree.type==this.tree.type?this.decorations=this.decorations.map(update2.changes):(tree!=this.tree||update2.viewportChanged||styleChange)&&(this.tree=tree,this.decorations=this.buildDeco(update2.view,highlighters))}buildDeco(view,highlighters){if(!highlighters||!this.tree.length)return Decoration.none;let builder=new RangeSetBuilder;for(let{from:from,to:to}of view.visibleRanges)highlightTree(this.tree,highlighters,((from2,to2,style)=>{builder.add(from2,to2,this.markCache[style]||(this.markCache[style]=Decoration.mark({class:style})))}),from,to);return builder.finish()}}const treeHighlighter=Prec.high(ViewPlugin.fromClass(TreeHighlighter,{decorations:v=>v.decorations})),defaultHighlightStyle=HighlightStyle.define([{tag:tags.meta,color:"#404740"},{tag:tags.link,textDecoration:"underline"},{tag:tags.heading,textDecoration:"underline",fontWeight:"bold"},{tag:tags.emphasis,fontStyle:"italic"},{tag:tags.strong,fontWeight:"bold"},{tag:tags.strikethrough,textDecoration:"line-through"},{tag:tags.keyword,color:"#708"},{tag:[tags.atom,tags.bool,tags.url,tags.contentSeparator,tags.labelName],color:"#219"},{tag:[tags.literal,tags.inserted],color:"#164"},{tag:[tags.string,tags.deleted],color:"#a11"},{tag:[tags.regexp,tags.escape,tags.special(tags.string)],color:"#e40"},{tag:tags.definition(tags.variableName),color:"#00f"},{tag:tags.local(tags.variableName),color:"#30a"},{tag:[tags.typeName,tags.namespace],color:"#085"},{tag:tags.className,color:"#167"},{tag:[tags.special(tags.variableName),tags.macroName],color:"#256"},{tag:tags.definition(tags.propertyName),color:"#00c"},{tag:tags.comment,color:"#940"},{tag:tags.invalid,color:"#f00"}]),baseTheme$3=EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),DefaultScanDist=1e4,DefaultBrackets="()[]{}",bracketMatchingConfig=Facet.define({combine:configs=>combineConfig(configs,{afterCursor:!0,brackets:DefaultBrackets,maxScanDistance:DefaultScanDist,renderMatch:defaultRenderMatch})}),matchingMark=Decoration.mark({class:"cm-matchingBracket"}),nonmatchingMark=Decoration.mark({class:"cm-nonmatchingBracket"});function defaultRenderMatch(match){let decorations2=[],mark=match.matched?matchingMark:nonmatchingMark;return decorations2.push(mark.range(match.start.from,match.start.to)),match.end&&decorations2.push(mark.range(match.end.from,match.end.to)),decorations2}const bracketMatchingUnique=[StateField.define({create:()=>Decoration.none,update(deco,tr){if(!tr.docChanged&&!tr.selection)return deco;let decorations2=[],config2=tr.state.facet(bracketMatchingConfig);for(let range of tr.state.selection.ranges){if(!range.empty)continue;let match=matchBrackets(tr.state,range.head,-1,config2)||range.head>0&&matchBrackets(tr.state,range.head-1,1,config2)||config2.afterCursor&&(matchBrackets(tr.state,range.head,1,config2)||range.head<tr.state.doc.length&&matchBrackets(tr.state,range.head+1,-1,config2));match&&(decorations2=decorations2.concat(config2.renderMatch(match,tr.state)))}return Decoration.set(decorations2,!0)},provide:f=>EditorView.decorations.from(f)}),baseTheme$3];function bracketMatching(config2={}){return[bracketMatchingConfig.of(config2),bracketMatchingUnique]}const bracketMatchingHandle=new NodeProp$1;function matchingNodes(node,dir,brackets){let byProp=node.prop(dir<0?NodeProp$1.openedBy:NodeProp$1.closedBy);if(byProp)return byProp;if(1==node.name.length){let index=brackets.indexOf(node.name);if(index>-1&&index%2==(dir<0?1:0))return[brackets[index+dir]]}return null}function findHandle(node){let hasHandle=node.type.prop(bracketMatchingHandle);return hasHandle?hasHandle(node.node):node}function matchBrackets(state,pos,dir,config2={}){let maxScanDistance=config2.maxScanDistance||DefaultScanDist,brackets=config2.brackets||DefaultBrackets,tree=syntaxTree(state),node=tree.resolveInner(pos,dir);for(let cur2=node;cur2;cur2=cur2.parent){let matches=matchingNodes(cur2.type,dir,brackets);if(matches&&cur2.from<cur2.to){let handle=findHandle(cur2);if(handle&&(dir>0?pos>=handle.from&&pos<handle.to:pos>handle.from&&pos<=handle.to))return matchMarkedBrackets(state,pos,dir,cur2,handle,matches,brackets)}}return function(state,pos,dir,tree,tokenType,maxScanDistance,brackets){let startCh=dir<0?state.sliceDoc(pos-1,pos):state.sliceDoc(pos,pos+1),bracket2=brackets.indexOf(startCh);if(bracket2<0||bracket2%2==0!=dir>0)return null;let startToken={from:dir<0?pos-1:pos,to:dir>0?pos+1:pos},iter=state.doc.iterRange(pos,dir>0?state.doc.length:0),depth=0;for(let distance=0;!iter.next().done&&distance<=maxScanDistance;){let text2=iter.value;dir<0&&(distance+=text2.length);let basePos=pos+distance*dir;for(let pos2=dir>0?0:text2.length-1,end2=dir>0?text2.length:-1;pos2!=end2;pos2+=dir){let found=brackets.indexOf(text2[pos2]);if(!(found<0||tree.resolveInner(basePos+pos2,1).type!=tokenType))if(found%2==0==dir>0)depth++;else{if(1==depth)return{start:startToken,end:{from:basePos+pos2,to:basePos+pos2+1},matched:found>>1==bracket2>>1};depth--}}dir>0&&(distance+=text2.length)}return iter.done?{start:startToken,matched:!1}:null}(state,pos,dir,tree,node.type,maxScanDistance,brackets)}function matchMarkedBrackets(_state,_pos,dir,token,handle,matching,brackets){let parent=token.parent,firstToken={from:handle.from,to:handle.to},depth=0,cursor2=null==parent?void 0:parent.cursor();if(cursor2&&(dir<0?cursor2.childBefore(token.from):cursor2.childAfter(token.to)))do{if(dir<0?cursor2.to<=token.from:cursor2.from>=token.to){if(0==depth&&matching.indexOf(cursor2.type.name)>-1&&cursor2.from<cursor2.to){let endHandle=findHandle(cursor2);return{start:firstToken,end:endHandle?{from:endHandle.from,to:endHandle.to}:void 0,matched:!0}}if(matchingNodes(cursor2.type,dir,brackets))depth++;else if(matchingNodes(cursor2.type,-dir,brackets)){if(0==depth){let endHandle=findHandle(cursor2);return{start:firstToken,end:endHandle&&endHandle.from<endHandle.to?{from:endHandle.from,to:endHandle.to}:void 0,matched:!1}}depth--}}}while(dir<0?cursor2.prevSibling():cursor2.nextSibling());return{start:firstToken,matched:!1}}const noTokens=Object.create(null),typeArray=[NodeType$1.none],warned=[],defaultTable=Object.create(null);for(let[legacyName,name2]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])defaultTable[legacyName]=createTokenType(noTokens,name2);function warnForPart(part,msg){warned.indexOf(part)>-1||(warned.push(part),console.warn(msg))}function createTokenType(extra2,tagStr){let tags$1=[];for(let name3 of tagStr.split(" ")){let found=[];for(let part of name3.split(".")){let value=extra2[part]||tags[part];value?"function"==typeof value?found.length?found=found.map(value):warnForPart(part,`Modifier ${part} used at start of tag`):found.length?warnForPart(part,`Tag ${part} used as modifier`):found=Array.isArray(value)?value:[value]:warnForPart(part,`Unknown highlighting tag ${part}`)}for(let tag of found)tags$1.push(tag)}if(!tags$1.length)return 0;let name2=tagStr.replace(/ /g,"_"),type2=NodeType$1.define({id:typeArray.length,name:name2,props:[styleTags({[name2]:tags$1})]});return typeArray.push(type2),type2.id}const DefaultBufferLength=1024;let nextPropID=0;class NodeProp{constructor(config2={}){this.id=nextPropID++,this.perNode=!!config2.perNode,this.deserialize=config2.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(match){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof match&&(match=NodeType.match(match)),type2=>{let result=match(type2);return void 0===result?null:[this,result]}}}NodeProp.closedBy=new NodeProp({deserialize:str=>str.split(" ")}),NodeProp.openedBy=new NodeProp({deserialize:str=>str.split(" ")}),NodeProp.group=new NodeProp({deserialize:str=>str.split(" ")}),NodeProp.contextHash=new NodeProp({perNode:!0}),NodeProp.lookAhead=new NodeProp({perNode:!0}),NodeProp.mounted=new NodeProp({perNode:!0});class MountedTree{constructor(tree,overlay,parser2){this.tree=tree,this.overlay=overlay,this.parser=parser2}static get(tree){return tree&&tree.props&&tree.props[NodeProp.mounted.id]}}const noProps=Object.create(null);class NodeType{constructor(name2,props,id2,flags=0){this.name=name2,this.props=props,this.id=id2,this.flags=flags}static define(spec){let props=spec.props&&spec.props.length?Object.create(null):noProps,flags=(spec.top?1:0)|(spec.skipped?2:0)|(spec.error?4:0)|(null==spec.name?8:0),type2=new NodeType(spec.name||"",props,spec.id,flags);if(spec.props)for(let src of spec.props)if(Array.isArray(src)||(src=src(type2)),src){if(src[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");props[src[0].id]=src[1]}return type2}prop(prop){return this.props[prop.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(name2){if("string"==typeof name2){if(this.name==name2)return!0;let group=this.prop(NodeProp.group);return!!group&&group.indexOf(name2)>-1}return this.id==name2}static match(map){let direct=Object.create(null);for(let prop in map)for(let name2 of prop.split(" "))direct[name2]=map[prop];return node=>{for(let groups=node.prop(NodeProp.group),i2=-1;i2<(groups?groups.length:0);i2++){let found=direct[i2<0?node.name:groups[i2]];if(found)return found}}}}NodeType.none=new NodeType("",Object.create(null),0,8);const CachedNode=new WeakMap,CachedInnerNode=new WeakMap;var IterMode;!function(IterMode2){IterMode2[IterMode2.ExcludeBuffers=1]="ExcludeBuffers",IterMode2[IterMode2.IncludeAnonymous=2]="IncludeAnonymous",IterMode2[IterMode2.IgnoreMounts=4]="IgnoreMounts",IterMode2[IterMode2.IgnoreOverlays=8]="IgnoreOverlays"}(IterMode||(IterMode={}));class Tree{constructor(type2,children2,positions,length,props){if(this.type=type2,this.children=children2,this.positions=positions,this.length=length,this.props=null,props&&props.length){this.props=Object.create(null);for(let[prop,value]of props)this.props["number"==typeof prop?prop:prop.id]=value}}toString(){let mounted=MountedTree.get(this);if(mounted&&!mounted.overlay)return mounted.tree.toString();let children2="";for(let ch of this.children){let str=ch.toString();str&&(children2&&(children2+=","),children2+=str)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(children2.length?"("+children2+")":""):children2}cursor(mode=0){return new TreeCursor(this.topNode,mode)}cursorAt(pos,side=0,mode=0){let scope=CachedNode.get(this)||this.topNode,cursor2=new TreeCursor(scope);return cursor2.moveTo(pos,side),CachedNode.set(this,cursor2._tree),cursor2}get topNode(){return new TreeNode(this,0,0,null)}resolve(pos,side=0){let node=resolveNode(CachedNode.get(this)||this.topNode,pos,side,!1);return CachedNode.set(this,node),node}resolveInner(pos,side=0){let node=resolveNode(CachedInnerNode.get(this)||this.topNode,pos,side,!0);return CachedInnerNode.set(this,node),node}resolveStack(pos,side=0){return function(tree,pos,side){let inner=tree.resolveInner(pos,side),layers=null;for(let scan=inner instanceof TreeNode?inner:inner.context.parent;scan;scan=scan.parent)if(scan.index<0){let parent=scan.parent;(layers||(layers=[inner])).push(parent.resolve(pos,side)),scan=parent}else{let mount=MountedTree.get(scan.tree);if(mount&&mount.overlay&&mount.overlay[0].from<=pos&&mount.overlay[mount.overlay.length-1].to>=pos){let root=new TreeNode(mount.tree,mount.overlay[0].from+scan.from,-1,scan);(layers||(layers=[inner])).push(resolveNode(root,pos,side,!1))}}return layers?iterStack(layers):inner}(this,pos,side)}iterate(spec){let{enter:enter,leave:leave,from:from=0,to:to=this.length}=spec,mode=spec.mode||0,anon=(mode&IterMode.IncludeAnonymous)>0;for(let c=this.cursor(mode|IterMode.IncludeAnonymous);;){let entered=!1;if(c.from<=to&&c.to>=from&&(!anon&&c.type.isAnonymous||!1!==enter(c))){if(c.firstChild())continue;entered=!0}for(;entered&&leave&&(anon||!c.type.isAnonymous)&&leave(c),!c.nextSibling();){if(!c.parent())return;entered=!0}}}prop(prop){return prop.perNode?this.props?this.props[prop.id]:void 0:this.type.prop(prop)}get propValues(){let result=[];if(this.props)for(let id2 in this.props)result.push([+id2,this.props[id2]]);return result}balance(config2={}){return this.children.length<=8?this:balanceRange(NodeType.none,this.children,this.positions,0,this.children.length,0,this.length,((children2,positions,length)=>new Tree(this.type,children2,positions,length,this.propValues)),config2.makeTree||((children2,positions,length)=>new Tree(NodeType.none,children2,positions,length)))}static build(data2){return function(data2){var _a2;let{buffer:buffer,nodeSet:nodeSet,maxBufferLength:maxBufferLength=DefaultBufferLength,reused:reused=[],minRepeatType:minRepeatType=nodeSet.types.length}=data2,cursor2=Array.isArray(buffer)?new FlatBufferCursor(buffer,buffer.length):buffer,types2=nodeSet.types,contextHash=0,lookAhead=0;function takeNode(parentStart,minPos,children3,positions2,inRepeat,depth){let{id:id2,start:start2,end:end2,size:size}=cursor2,lookAheadAtStart=lookAhead;for(;size<0;){if(cursor2.next(),-1==size){let node2=reused[id2];return children3.push(node2),void positions2.push(start2-parentStart)}if(-3==size)return void(contextHash=id2);if(-4==size)return void(lookAhead=id2);throw new RangeError(`Unrecognized record size: ${size}`)}let node,buffer2,type2=types2[id2],startPos=start2-parentStart;if(end2-start2<=maxBufferLength&&(buffer2=findBufferSize(cursor2.pos-minPos,inRepeat))){let data3=new Uint16Array(buffer2.size-buffer2.skip),endPos=cursor2.pos-buffer2.size,index=data3.length;for(;cursor2.pos>endPos;)index=copyToBuffer(buffer2.start,data3,index);node=new TreeBuffer(data3,end2-buffer2.start,nodeSet),startPos=buffer2.start-parentStart}else{let endPos=cursor2.pos-size;cursor2.next();let localChildren=[],localPositions=[],localInRepeat=id2>=minRepeatType?id2:-1,lastGroup=0,lastEnd=end2;for(;cursor2.pos>endPos;)localInRepeat>=0&&cursor2.id==localInRepeat&&cursor2.size>=0?(cursor2.end<=lastEnd-maxBufferLength&&(makeRepeatLeaf(localChildren,localPositions,start2,lastGroup,cursor2.end,lastEnd,localInRepeat,lookAheadAtStart),lastGroup=localChildren.length,lastEnd=cursor2.end),cursor2.next()):depth>2500?takeFlatNode(start2,endPos,localChildren,localPositions):takeNode(start2,endPos,localChildren,localPositions,localInRepeat,depth+1);if(localInRepeat>=0&&lastGroup>0&&lastGroup<localChildren.length&&makeRepeatLeaf(localChildren,localPositions,start2,lastGroup,start2,lastEnd,localInRepeat,lookAheadAtStart),localChildren.reverse(),localPositions.reverse(),localInRepeat>-1&&lastGroup>0){let make=makeBalanced(type2);node=balanceRange(type2,localChildren,localPositions,0,localChildren.length,0,end2-start2,make,make)}else node=makeTree(type2,localChildren,localPositions,end2-start2,lookAheadAtStart-end2)}children3.push(node),positions2.push(startPos)}function takeFlatNode(parentStart,minPos,children3,positions2){let nodes=[],nodeCount=0,stopAt=-1;for(;cursor2.pos>minPos;){let{id:id2,start:start2,end:end2,size:size}=cursor2;if(size>4)cursor2.next();else{if(stopAt>-1&&start2<stopAt)break;stopAt<0&&(stopAt=end2-maxBufferLength),nodes.push(id2,start2,end2),nodeCount++,cursor2.next()}}if(nodeCount){let buffer2=new Uint16Array(4*nodeCount),start2=nodes[nodes.length-2];for(let i2=nodes.length-3,j=0;i2>=0;i2-=3)buffer2[j++]=nodes[i2],buffer2[j++]=nodes[i2+1]-start2,buffer2[j++]=nodes[i2+2]-start2,buffer2[j++]=j;children3.push(new TreeBuffer(buffer2,nodes[2]-start2,nodeSet)),positions2.push(start2-parentStart)}}function makeBalanced(type2){return(children3,positions2,length2)=>{let last,lookAheadProp,lookAhead2=0,lastI=children3.length-1;if(lastI>=0&&(last=children3[lastI])instanceof Tree){if(!lastI&&last.type==type2&&last.length==length2)return last;(lookAheadProp=last.prop(NodeProp.lookAhead))&&(lookAhead2=positions2[lastI]+last.length+lookAheadProp)}return makeTree(type2,children3,positions2,length2,lookAhead2)}}function makeRepeatLeaf(children3,positions2,base2,i2,from,to,type2,lookAhead2){let localChildren=[],localPositions=[];for(;children3.length>i2;)localChildren.push(children3.pop()),localPositions.push(positions2.pop()+base2-from);children3.push(makeTree(nodeSet.types[type2],localChildren,localPositions,to-from,lookAhead2-to)),positions2.push(from-base2)}function makeTree(type2,children3,positions2,length2,lookAhead2=0,props){if(contextHash){let pair2=[NodeProp.contextHash,contextHash];props=props?[pair2].concat(props):[pair2]}if(lookAhead2>25){let pair2=[NodeProp.lookAhead,lookAhead2];props=props?[pair2].concat(props):[pair2]}return new Tree(type2,children3,positions2,length2,props)}function findBufferSize(maxSize,inRepeat){let fork=cursor2.fork(),size=0,start2=0,skip=0,minStart=fork.end-maxBufferLength,result={size:0,start:0,skip:0};scan:for(let minPos=fork.pos-maxSize;fork.pos>minPos;){let nodeSize2=fork.size;if(fork.id==inRepeat&&nodeSize2>=0){result.size=size,result.start=start2,result.skip=skip,skip+=4,size+=4,fork.next();continue}let startPos=fork.pos-nodeSize2;if(nodeSize2<0||startPos<minPos||fork.start<minStart)break;let localSkipped=fork.id>=minRepeatType?4:0,nodeStart2=fork.start;for(fork.next();fork.pos>startPos;){if(fork.size<0){if(-3!=fork.size)break scan;localSkipped+=4}else fork.id>=minRepeatType&&(localSkipped+=4);fork.next()}start2=nodeStart2,size+=nodeSize2,skip+=localSkipped}return(inRepeat<0||size==maxSize)&&(result.size=size,result.start=start2,result.skip=skip),result.size>4?result:void 0}function copyToBuffer(bufferStart,buffer2,index){let{id:id2,start:start2,end:end2,size:size}=cursor2;if(cursor2.next(),size>=0&&id2<minRepeatType){let startIndex=index;if(size>4){let endPos=cursor2.pos-(size-4);for(;cursor2.pos>endPos;)index=copyToBuffer(bufferStart,buffer2,index)}buffer2[--index]=startIndex,buffer2[--index]=end2-bufferStart,buffer2[--index]=start2-bufferStart,buffer2[--index]=id2}else-3==size?contextHash=id2:-4==size&&(lookAhead=id2);return index}let children2=[],positions=[];for(;cursor2.pos>0;)takeNode(data2.start||0,data2.bufferStart||0,children2,positions,-1,0);let length=null!==(_a2=data2.length)&&void 0!==_a2?_a2:children2.length?positions[0]+children2[0].length:0;return new Tree(types2[data2.topID],children2.reverse(),positions.reverse(),length)}(data2)}}Tree.empty=new Tree(NodeType.none,[],[],0);class FlatBufferCursor{constructor(buffer,index){this.buffer=buffer,this.index=index}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new FlatBufferCursor(this.buffer,this.index)}}class TreeBuffer{constructor(buffer,length,set2){this.buffer=buffer,this.length=length,this.set=set2}get type(){return NodeType.none}toString(){let result=[];for(let index=0;index<this.buffer.length;)result.push(this.childString(index)),index=this.buffer[index+3];return result.join(",")}childString(index){let id2=this.buffer[index],endIndex=this.buffer[index+3],type2=this.set.types[id2],result=type2.name;if(/\W/.test(result)&&!type2.isError&&(result=JSON.stringify(result)),endIndex==(index+=4))return result;let children2=[];for(;index<endIndex;)children2.push(this.childString(index)),index=this.buffer[index+3];return result+"("+children2.join(",")+")"}findChild(startIndex,endIndex,dir,pos,side){let{buffer:buffer}=this,pick=-1;for(let i2=startIndex;i2!=endIndex&&!(checkSide(side,pos,buffer[i2+1],buffer[i2+2])&&(pick=i2,dir>0));i2=buffer[i2+3]);return pick}slice(startI,endI,from){let b=this.buffer,copy=new Uint16Array(endI-startI),len=0;for(let i2=startI,j=0;i2<endI;){copy[j++]=b[i2++],copy[j++]=b[i2++]-from;let to=copy[j++]=b[i2++]-from;copy[j++]=b[i2++]-startI,len=Math.max(len,to)}return new TreeBuffer(copy,len,this.set)}}function checkSide(side,pos,from,to){switch(side){case-2:return from<pos;case-1:return to>=pos&&from<pos;case 0:return from<pos&&to>pos;case 1:return from<=pos&&to>pos;case 2:return to>pos;case 4:return!0}}function resolveNode(node,pos,side,overlays){for(var _a2;node.from==node.to||(side<1?node.from>=pos:node.from>pos)||(side>-1?node.to<=pos:node.to<pos);){let parent=!overlays&&node instanceof TreeNode&&node.index<0?null:node.parent;if(!parent)return node;node=parent}let mode=overlays?0:IterMode.IgnoreOverlays;if(overlays)for(let scan=node,parent=scan.parent;parent;scan=parent,parent=scan.parent)scan instanceof TreeNode&&scan.index<0&&(null===(_a2=parent.enter(pos,side,mode))||void 0===_a2?void 0:_a2.from)!=scan.from&&(node=parent);for(;;){let inner=node.enter(pos,side,mode);if(!inner)return node;node=inner}}class BaseNode{cursor(mode=0){return new TreeCursor(this,mode)}getChild(type2,before=null,after=null){let r=getChildren(this,type2,before,after);return r.length?r[0]:null}getChildren(type2,before=null,after=null){return getChildren(this,type2,before,after)}resolve(pos,side=0){return resolveNode(this,pos,side,!1)}resolveInner(pos,side=0){return resolveNode(this,pos,side,!0)}matchContext(context){return matchNodeContext(this,context)}enterUnfinishedNodesBefore(pos){let scan=this.childBefore(pos),node=this;for(;scan;){let last=scan.lastChild;if(!last||last.to!=scan.to)break;last.type.isError&&last.from==last.to?(node=scan,scan=last.prevSibling):scan=last}return node}get node(){return this}get next(){return this.parent}}class TreeNode extends BaseNode{constructor(_tree,from,index,_parent){super(),this._tree=_tree,this.from=from,this.index=index,this._parent=_parent}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(i2,dir,pos,side,mode=0){for(let parent=this;;){for(let{children:children2,positions:positions}=parent._tree,e=dir>0?children2.length:-1;i2!=e;i2+=dir){let next=children2[i2],start2=positions[i2]+parent.from;if(checkSide(side,pos,start2,start2+next.length))if(next instanceof TreeBuffer){if(mode&IterMode.ExcludeBuffers)continue;let index=next.findChild(0,next.buffer.length,dir,pos-start2,side);if(index>-1)return new BufferNode(new BufferContext(parent,next,i2,start2),null,index)}else if(mode&IterMode.IncludeAnonymous||!next.type.isAnonymous||hasChild(next)){let mounted;if(!(mode&IterMode.IgnoreMounts)&&(mounted=MountedTree.get(next))&&!mounted.overlay)return new TreeNode(mounted.tree,start2,i2,parent);let inner=new TreeNode(next,start2,i2,parent);return mode&IterMode.IncludeAnonymous||!inner.type.isAnonymous?inner:inner.nextChild(dir<0?next.children.length-1:0,dir,pos,side)}}if(mode&IterMode.IncludeAnonymous||!parent.type.isAnonymous)return null;if(i2=parent.index>=0?parent.index+dir:dir<0?-1:parent._parent._tree.children.length,parent=parent._parent,!parent)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(pos){return this.nextChild(0,1,pos,2)}childBefore(pos){return this.nextChild(this._tree.children.length-1,-1,pos,-2)}enter(pos,side,mode=0){let mounted;if(!(mode&IterMode.IgnoreOverlays)&&(mounted=MountedTree.get(this._tree))&&mounted.overlay){let rPos=pos-this.from;for(let{from:from,to:to}of mounted.overlay)if((side>0?from<=rPos:from<rPos)&&(side<0?to>=rPos:to>rPos))return new TreeNode(mounted.tree,mounted.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,pos,side,mode)}nextSignificantParent(){let val=this;for(;val.type.isAnonymous&&val._parent;)val=val._parent;return val}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function getChildren(node,type2,before,after){let cur2=node.cursor(),result=[];if(!cur2.firstChild())return result;if(null!=before)for(;!cur2.type.is(before);)if(!cur2.nextSibling())return result;for(;;){if(null!=after&&cur2.type.is(after))return result;if(cur2.type.is(type2)&&result.push(cur2.node),!cur2.nextSibling())return null==after?result:[]}}function matchNodeContext(node,context,i2=context.length-1){for(let p=node.parent;i2>=0;p=p.parent){if(!p)return!1;if(!p.type.isAnonymous){if(context[i2]&&context[i2]!=p.name)return!1;i2--}}return!0}class BufferContext{constructor(parent,buffer,index,start2){this.parent=parent,this.buffer=buffer,this.index=index,this.start=start2}}class BufferNode extends BaseNode{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(context,_parent,index){super(),this.context=context,this._parent=_parent,this.index=index,this.type=context.buffer.set.types[context.buffer.buffer[index]]}child(dir,pos,side){let{buffer:buffer}=this.context,index=buffer.findChild(this.index+4,buffer.buffer[this.index+3],dir,pos-this.context.start,side);return index<0?null:new BufferNode(this.context,this,index)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(pos){return this.child(1,pos,2)}childBefore(pos){return this.child(-1,pos,-2)}enter(pos,side,mode=0){if(mode&IterMode.ExcludeBuffers)return null;let{buffer:buffer}=this.context,index=buffer.findChild(this.index+4,buffer.buffer[this.index+3],side>0?1:-1,pos-this.context.start,side);return index<0?null:new BufferNode(this.context,this,index)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(dir){return this._parent?null:this.context.parent.nextChild(this.context.index+dir,dir,0,4)}get nextSibling(){let{buffer:buffer}=this.context,after=buffer.buffer[this.index+3];return after<(this._parent?buffer.buffer[this._parent.index+3]:buffer.buffer.length)?new BufferNode(this.context,this._parent,after):this.externalSibling(1)}get prevSibling(){let{buffer:buffer}=this.context,parentStart=this._parent?this._parent.index+4:0;return this.index==parentStart?this.externalSibling(-1):new BufferNode(this.context,this._parent,buffer.findChild(parentStart,this.index,-1,0,4))}get tree(){return null}toTree(){let children2=[],positions=[],{buffer:buffer}=this.context,startI=this.index+4,endI=buffer.buffer[this.index+3];if(endI>startI){let from=buffer.buffer[this.index+1];children2.push(buffer.slice(startI,endI,from)),positions.push(0)}return new Tree(this.type,children2,positions,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function iterStack(heads){if(!heads.length)return null;let pick=0,picked=heads[0];for(let i2=1;i2<heads.length;i2++){let node=heads[i2];(node.from>picked.from||node.to<picked.to)&&(picked=node,pick=i2)}let next=picked instanceof TreeNode&&picked.index<0?null:picked.parent,newHeads=heads.slice();return next?newHeads[pick]=next:newHeads.splice(pick,1),new StackIterator(newHeads,picked)}class StackIterator{constructor(heads,node){this.heads=heads,this.node=node}get next(){return iterStack(this.heads)}}class TreeCursor{get name(){return this.type.name}constructor(node,mode=0){if(this.mode=mode,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,node instanceof TreeNode)this.yieldNode(node);else{this._tree=node.context.parent,this.buffer=node.context;for(let n=node._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=node,this.yieldBuf(node.index)}}yieldNode(node){return!!node&&(this._tree=node,this.type=node.type,this.from=node.from,this.to=node.to,!0)}yieldBuf(index,type2){this.index=index;let{start:start2,buffer:buffer}=this.buffer;return this.type=type2||buffer.set.types[buffer.buffer[index]],this.from=start2+buffer.buffer[index+1],this.to=start2+buffer.buffer[index+2],!0}yield(node){return!!node&&(node instanceof TreeNode?(this.buffer=null,this.yieldNode(node)):(this.buffer=node.context,this.yieldBuf(node.index,node.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(dir,pos,side){if(!this.buffer)return this.yield(this._tree.nextChild(dir<0?this._tree._tree.children.length-1:0,dir,pos,side,this.mode));let{buffer:buffer}=this.buffer,index=buffer.findChild(this.index+4,buffer.buffer[this.index+3],dir,pos-this.buffer.start,side);return!(index<0)&&(this.stack.push(this.index),this.yieldBuf(index))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(pos){return this.enterChild(1,pos,2)}childBefore(pos){return this.enterChild(-1,pos,-2)}enter(pos,side,mode=this.mode){return this.buffer?!(mode&IterMode.ExcludeBuffers)&&this.enterChild(1,pos,side):this.yield(this._tree.enter(pos,side,mode))}parent(){if(!this.buffer)return this.yieldNode(this.mode&IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let parent=this.mode&IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(parent)}sibling(dir){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+dir,dir,0,4,this.mode));let{buffer:buffer}=this.buffer,d=this.stack.length-1;if(dir<0){let parentStart=d<0?0:this.stack[d]+4;if(this.index!=parentStart)return this.yieldBuf(buffer.findChild(parentStart,this.index,-1,0,4))}else{let after=buffer.buffer[this.index+3];if(after<(d<0?buffer.buffer.length:buffer.buffer[this.stack[d]+3]))return this.yieldBuf(after)}return d<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+dir,dir,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(dir){let index,parent,{buffer:buffer}=this;if(buffer){if(dir>0){if(this.index<buffer.buffer.buffer.length)return!1}else for(let i2=0;i2<this.index;i2++)if(buffer.buffer.buffer[i2+3]<this.index)return!1;({index:index,parent:parent}=buffer)}else({index:index,_parent:parent}=this._tree);for(;parent;({index:index,_parent:parent}=parent))if(index>-1)for(let i2=index+dir,e=dir<0?-1:parent._tree.children.length;i2!=e;i2+=dir){let child=parent._tree.children[i2];if(this.mode&IterMode.IncludeAnonymous||child instanceof TreeBuffer||!child.type.isAnonymous||hasChild(child))return!1}return!0}move(dir,enter){if(enter&&this.enterChild(dir,0,4))return!0;for(;;){if(this.sibling(dir))return!0;if(this.atLastNode(dir)||!this.parent())return!1}}next(enter=!0){return this.move(1,enter)}prev(enter=!0){return this.move(-1,enter)}moveTo(pos,side=0){for(;(this.from==this.to||(side<1?this.from>=pos:this.from>pos)||(side>-1?this.to<=pos:this.to<pos))&&this.parent(););for(;this.enterChild(1,pos,side););return this}get node(){if(!this.buffer)return this._tree;let cache=this.bufferNode,result=null,depth=0;if(cache&&cache.context==this.buffer)scan:for(let index=this.index,d=this.stack.length;d>=0;){for(let c=cache;c;c=c._parent)if(c.index==index){if(index==this.index)return c;result=c,depth=d+1;break scan}index=this.stack[--d]}for(let i2=depth;i2<this.stack.length;i2++)result=new BufferNode(this.buffer,result,this.stack[i2]);return this.bufferNode=new BufferNode(this.buffer,result,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(enter,leave){for(let depth=0;;){let mustLeave=!1;if(this.type.isAnonymous||!1!==enter(this)){if(this.firstChild()){depth++;continue}this.type.isAnonymous||(mustLeave=!0)}for(;mustLeave&&leave&&leave(this),mustLeave=this.type.isAnonymous,!this.nextSibling();){if(!depth)return;this.parent(),depth--,mustLeave=!0}}}matchContext(context){if(!this.buffer)return matchNodeContext(this.node,context);let{buffer:buffer}=this.buffer,{types:types2}=buffer.set;for(let i2=context.length-1,d=this.stack.length-1;i2>=0;d--){if(d<0)return matchNodeContext(this.node,context,i2);let type2=types2[buffer.buffer[this.stack[d]]];if(!type2.isAnonymous){if(context[i2]&&context[i2]!=type2.name)return!1;i2--}}return!0}}function hasChild(tree){return tree.children.some((ch=>ch instanceof TreeBuffer||!ch.type.isAnonymous||hasChild(ch)))}const nodeSizeCache=new WeakMap;function nodeSize(balanceType,node){if(!balanceType.isAnonymous||node instanceof TreeBuffer||node.type!=balanceType)return 1;let size=nodeSizeCache.get(node);if(null==size){size=1;for(let child of node.children){if(child.type!=balanceType||!(child instanceof Tree)){size=1;break}size+=nodeSize(balanceType,child)}nodeSizeCache.set(node,size)}return size}function balanceRange(balanceType,children2,positions,from,to,start2,length,mkTop,mkTree){let total=0;for(let i2=from;i2<to;i2++)total+=nodeSize(balanceType,children2[i2]);let maxChild=Math.ceil(1.5*total/8),localChildren=[],localPositions=[];return function divide(children3,positions2,from2,to2,offset2){for(let i2=from2;i2<to2;){let groupFrom=i2,groupStart=positions2[i2],groupSize=nodeSize(balanceType,children3[i2]);for(i2++;i2<to2;i2++){let nextSize=nodeSize(balanceType,children3[i2]);if(groupSize+nextSize>=maxChild)break;groupSize+=nextSize}if(i2==groupFrom+1){if(groupSize>maxChild){let only=children3[groupFrom];divide(only.children,only.positions,0,only.children.length,positions2[groupFrom]+offset2);continue}localChildren.push(children3[groupFrom])}else{let length2=positions2[i2-1]+children3[i2-1].length-groupStart;localChildren.push(balanceRange(balanceType,children3,positions2,groupFrom,i2,groupStart,length2,null,mkTree))}localPositions.push(groupStart+offset2-start2)}}(children2,positions,from,to,0),(mkTop||mkTree)(localChildren,localPositions,length)}new NodeProp({perNode:!0});function command(f,option){return({state:state,dispatch:dispatch2})=>{if(state.readOnly)return!1;let tr=f(option,state);return!!tr&&(dispatch2(state.update(tr)),!0)}}const toggleLineComment=command(changeLineComment,0),toggleBlockComment=command(changeBlockComment,0),toggleBlockCommentByLine=command(((o,s)=>changeBlockComment(o,s,function(state){let ranges=[];for(let r of state.selection.ranges){let fromLine=state.doc.lineAt(r.from),toLine=r.to<=fromLine.to?fromLine:state.doc.lineAt(r.to),last=ranges.length-1;last>=0&&ranges[last].to>fromLine.from?ranges[last].to=toLine.to:ranges.push({from:fromLine.from+/^\s*/.exec(fromLine.text)[0].length,to:toLine.to})}return ranges}(s))),0);function getConfig(state,pos){let data2=state.languageDataAt("commentTokens",pos);return data2.length?data2[0]:{}}const SearchMargin=50;function changeBlockComment(option,state,ranges=state.selection.ranges){let tokens=ranges.map((r=>getConfig(state,r.from).block));if(!tokens.every((c=>c)))return null;let comments=ranges.map(((r,i2)=>function(state,{open:open,close:close},from,to){let startText,endText,textBefore=state.sliceDoc(from-SearchMargin,from),textAfter=state.sliceDoc(to,to+SearchMargin),spaceBefore=/\s*$/.exec(textBefore)[0].length,spaceAfter=/^\s*/.exec(textAfter)[0].length,beforeOff=textBefore.length-spaceBefore;if(textBefore.slice(beforeOff-open.length,beforeOff)==open&&textAfter.slice(spaceAfter,spaceAfter+close.length)==close)return{open:{pos:from-spaceBefore,margin:spaceBefore&&1},close:{pos:to+spaceAfter,margin:spaceAfter&&1}};to-from<=2*SearchMargin?startText=endText=state.sliceDoc(from,to):(startText=state.sliceDoc(from,from+SearchMargin),endText=state.sliceDoc(to-SearchMargin,to));let startSpace=/^\s*/.exec(startText)[0].length,endSpace=/\s*$/.exec(endText)[0].length,endOff=endText.length-endSpace-close.length;return startText.slice(startSpace,startSpace+open.length)==open&&endText.slice(endOff,endOff+close.length)==close?{open:{pos:from+startSpace+open.length,margin:/\s/.test(startText.charAt(startSpace+open.length))?1:0},close:{pos:to-endSpace-close.length,margin:/\s/.test(endText.charAt(endOff-1))?1:0}}:null}(state,tokens[i2],r.from,r.to)));if(2!=option&&!comments.every((c=>c)))return{changes:state.changes(ranges.map(((range,i2)=>comments[i2]?[]:[{from:range.from,insert:tokens[i2].open+" "},{from:range.to,insert:" "+tokens[i2].close}])))};if(1!=option&&comments.some((c=>c))){let changes=[];for(let comment2,i2=0;i2<comments.length;i2++)if(comment2=comments[i2]){let token=tokens[i2],{open:open,close:close}=comment2;changes.push({from:open.pos-token.open.length,to:open.pos+open.margin},{from:close.pos-close.margin,to:close.pos+token.close.length})}return{changes:changes}}return null}function changeLineComment(option,state,ranges=state.selection.ranges){let lines=[],prevLine=-1;for(let{from:from,to:to}of ranges){let startI=lines.length,minIndent=1e9,token=getConfig(state,from).line;if(token){for(let pos=from;pos<=to;){let line=state.doc.lineAt(pos);if(line.from>prevLine&&(from==to||to>line.from)){prevLine=line.from;let indent=/^\s*/.exec(line.text)[0].length,empty2=indent==line.length,comment2=line.text.slice(indent,indent+token.length)==token?indent:-1;indent<line.text.length&&indent<minIndent&&(minIndent=indent),lines.push({line:line,comment:comment2,token:token,indent:indent,empty:empty2,single:!1})}pos=line.to+1}if(minIndent<1e9)for(let i2=startI;i2<lines.length;i2++)lines[i2].indent<lines[i2].line.text.length&&(lines[i2].indent=minIndent);lines.length==startI+1&&(lines[startI].single=!0)}}if(2!=option&&lines.some((l=>l.comment<0&&(!l.empty||l.single)))){let changes=[];for(let{line:line,token:token,indent:indent,empty:empty2,single:single}of lines)!single&&empty2||changes.push({from:line.from+indent,insert:token+" "});let changeSet=state.changes(changes);return{changes:changeSet,selection:state.selection.map(changeSet,1)}}if(1!=option&&lines.some((l=>l.comment>=0))){let changes=[];for(let{line:line,comment:comment2,token:token}of lines)if(comment2>=0){let from=line.from+comment2,to=from+token.length;" "==line.text[to-line.from]&&to++,changes.push({from:from,to:to})}return{changes:changes}}return null}const fromHistory=Annotation.define(),isolateHistory=Annotation.define(),invertedEffects=Facet.define(),historyConfig=Facet.define({combine:configs=>combineConfig(configs,{minDepth:100,newGroupDelay:500,joinToEvent:(_t,isAdjacent2)=>isAdjacent2},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(a,b)=>(tr,adj)=>a(tr,adj)||b(tr,adj)})});const historyField_=StateField.define({create:()=>HistoryState.empty,update(state,tr){let config2=tr.state.facet(historyConfig),fromHist=tr.annotation(fromHistory);if(fromHist){let selection2=tr.docChanged?EditorSelection.single(function(changes){let end2=0;return changes.iterChangedRanges(((_,to)=>end2=to)),end2}(tr.changes)):void 0,item=HistEvent.fromTransaction(tr,selection2),from=fromHist.side,other=0==from?state.undone:state.done;return other=item?updateBranch(other,other.length,config2.minDepth,item):addSelection(other,tr.startState.selection),new HistoryState(0==from?fromHist.rest:other,0==from?other:fromHist.rest)}let isolate=tr.annotation(isolateHistory);if("full"!=isolate&&"before"!=isolate||(state=state.isolate()),!1===tr.annotation(Transaction.addToHistory))return tr.changes.empty?state:state.addMapping(tr.changes.desc);let event=HistEvent.fromTransaction(tr),time=tr.annotation(Transaction.time),userEvent=tr.annotation(Transaction.userEvent);return event?state=state.addChanges(event,time,userEvent,config2,tr):tr.selection&&(state=state.addSelection(tr.startState.selection,time,userEvent,config2.newGroupDelay)),"full"!=isolate&&"after"!=isolate||(state=state.isolate()),state},toJSON:value=>({done:value.done.map((e=>e.toJSON())),undone:value.undone.map((e=>e.toJSON()))}),fromJSON:json2=>new HistoryState(json2.done.map(HistEvent.fromJSON),json2.undone.map(HistEvent.fromJSON))});function history(config2={}){return[historyField_,historyConfig.of(config2),EditorView$1.domEventHandlers({beforeinput(e,view){let command2="historyUndo"==e.inputType?undo:"historyRedo"==e.inputType?redo:null;return!!command2&&(e.preventDefault(),command2(view))}})]}function cmd(side,selection2){return function({state:state,dispatch:dispatch2}){if(!selection2&&state.readOnly)return!1;let historyState=state.field(historyField_,!1);if(!historyState)return!1;let tr=historyState.pop(side,state,selection2);return!!tr&&(dispatch2(tr),!0)}}const undo=cmd(0,!1),redo=cmd(1,!1),undoSelection=cmd(0,!0),redoSelection=cmd(1,!0);class HistEvent{constructor(changes,effects,mapped,startSelection,selectionsAfter){this.changes=changes,this.effects=effects,this.mapped=mapped,this.startSelection=startSelection,this.selectionsAfter=selectionsAfter}setSelAfter(after){return new HistEvent(this.changes,this.effects,this.mapped,this.startSelection,after)}toJSON(){var _a2,_b,_c;return{changes:null===(_a2=this.changes)||void 0===_a2?void 0:_a2.toJSON(),mapped:null===(_b=this.mapped)||void 0===_b?void 0:_b.toJSON(),startSelection:null===(_c=this.startSelection)||void 0===_c?void 0:_c.toJSON(),selectionsAfter:this.selectionsAfter.map((s=>s.toJSON()))}}static fromJSON(json2){return new HistEvent(json2.changes&&ChangeSet.fromJSON(json2.changes),[],json2.mapped&&ChangeDesc.fromJSON(json2.mapped),json2.startSelection&&EditorSelection.fromJSON(json2.startSelection),json2.selectionsAfter.map(EditorSelection.fromJSON))}static fromTransaction(tr,selection2){let effects=none$1;for(let invert of tr.startState.facet(invertedEffects)){let result=invert(tr);result.length&&(effects=effects.concat(result))}return!effects.length&&tr.changes.empty?null:new HistEvent(tr.changes.invert(tr.startState.doc),effects,void 0,selection2||tr.startState.selection,none$1)}static selection(selections){return new HistEvent(void 0,none$1,void 0,void 0,selections)}}function updateBranch(branch,to,maxLen,newEvent){let start2=to+1>maxLen+20?to-maxLen-1:0,newBranch=branch.slice(start2,to);return newBranch.push(newEvent),newBranch}function conc(a,b){return a.length?b.length?a.concat(b):a:b}const none$1=[],MaxSelectionsPerEvent=200;function addSelection(branch,selection2){if(branch.length){let lastEvent=branch[branch.length-1],sels=lastEvent.selectionsAfter.slice(Math.max(0,lastEvent.selectionsAfter.length-MaxSelectionsPerEvent));return sels.length&&sels[sels.length-1].eq(selection2)?branch:(sels.push(selection2),updateBranch(branch,branch.length-1,1e9,lastEvent.setSelAfter(sels)))}return[HistEvent.selection([selection2])]}function popSelection(branch){let last=branch[branch.length-1],newBranch=branch.slice();return newBranch[branch.length-1]=last.setSelAfter(last.selectionsAfter.slice(0,last.selectionsAfter.length-1)),newBranch}function addMappingToBranch(branch,mapping){if(!branch.length)return branch;let length=branch.length,selections=none$1;for(;length;){let event=mapEvent(branch[length-1],mapping,selections);if(event.changes&&!event.changes.empty||event.effects.length){let result=branch.slice(0,length);return result[length-1]=event,result}mapping=event.mapped,length--,selections=event.selectionsAfter}return selections.length?[HistEvent.selection(selections)]:none$1}function mapEvent(event,mapping,extraSelections){let selections=conc(event.selectionsAfter.length?event.selectionsAfter.map((s=>s.map(mapping))):none$1,extraSelections);if(!event.changes)return HistEvent.selection(selections);let mappedChanges=event.changes.map(mapping),before=mapping.mapDesc(event.changes,!0),fullMapping=event.mapped?event.mapped.composeDesc(before):before;return new HistEvent(mappedChanges,StateEffect.mapEffects(event.effects,mapping),fullMapping,event.startSelection.map(before),selections)}const joinableUserEvent=/^(input\.type|delete)($|\.)/;class HistoryState{constructor(done,undone,prevTime=0,prevUserEvent=void 0){this.done=done,this.undone=undone,this.prevTime=prevTime,this.prevUserEvent=prevUserEvent}isolate(){return this.prevTime?new HistoryState(this.done,this.undone):this}addChanges(event,time,userEvent,config2,tr){let done=this.done,lastEvent=done[done.length-1];return done=lastEvent&&lastEvent.changes&&!lastEvent.changes.empty&&event.changes&&(!userEvent||joinableUserEvent.test(userEvent))&&(!lastEvent.selectionsAfter.length&&time-this.prevTime<config2.newGroupDelay&&config2.joinToEvent(tr,function(a,b){let ranges=[],isAdjacent2=!1;return a.iterChangedRanges(((f,t2)=>ranges.push(f,t2))),b.iterChangedRanges(((_f,_t,f,t2)=>{for(let i2=0;i2<ranges.length;){let from=ranges[i2++],to=ranges[i2++];t2>=from&&f<=to&&(isAdjacent2=!0)}})),isAdjacent2}(lastEvent.changes,event.changes))||"input.type.compose"==userEvent)?updateBranch(done,done.length-1,config2.minDepth,new HistEvent(event.changes.compose(lastEvent.changes),conc(event.effects,lastEvent.effects),lastEvent.mapped,lastEvent.startSelection,none$1)):updateBranch(done,done.length,config2.minDepth,event),new HistoryState(done,none$1,time,userEvent)}addSelection(selection2,time,userEvent,newGroupDelay){let last=this.done.length?this.done[this.done.length-1].selectionsAfter:none$1;return last.length>0&&time-this.prevTime<newGroupDelay&&userEvent==this.prevUserEvent&&userEvent&&/^select($|\.)/.test(userEvent)&&(a=last[last.length-1],b=selection2,a.ranges.length==b.ranges.length&&0===a.ranges.filter(((r,i2)=>r.empty!=b.ranges[i2].empty)).length)?this:new HistoryState(addSelection(this.done,selection2),this.undone,time,userEvent);var a,b}addMapping(mapping){return new HistoryState(addMappingToBranch(this.done,mapping),addMappingToBranch(this.undone,mapping),this.prevTime,this.prevUserEvent)}pop(side,state,selection2){let branch=0==side?this.done:this.undone;if(0==branch.length)return null;let event=branch[branch.length-1];if(selection2&&event.selectionsAfter.length)return state.update({selection:event.selectionsAfter[event.selectionsAfter.length-1],annotations:fromHistory.of({side:side,rest:popSelection(branch)}),userEvent:0==side?"select.undo":"select.redo",scrollIntoView:!0});if(event.changes){let rest=1==branch.length?none$1:branch.slice(0,branch.length-1);return event.mapped&&(rest=addMappingToBranch(rest,event.mapped)),state.update({changes:event.changes,selection:event.startSelection,effects:event.effects,annotations:fromHistory.of({side:side,rest:rest}),filter:!1,userEvent:0==side?"undo":"redo",scrollIntoView:!0})}return null}}HistoryState.empty=new HistoryState(none$1,none$1);const historyKeymap=[{key:"Mod-z",run:undo,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:redo,preventDefault:!0},{linux:"Ctrl-Shift-z",run:redo,preventDefault:!0},{key:"Mod-u",run:undoSelection,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:redoSelection,preventDefault:!0}];function updateSel(sel,by){return EditorSelection.create(sel.ranges.map(by),sel.mainIndex)}function setSel(state,selection2){return state.update({selection:selection2,scrollIntoView:!0,userEvent:"select"})}function moveSel({state:state,dispatch:dispatch2},how){let selection2=updateSel(state.selection,how);return!selection2.eq(state.selection)&&(dispatch2(setSel(state,selection2)),!0)}function rangeEnd(range,forward){return EditorSelection.cursor(forward?range.to:range.from)}function cursorByChar(view,forward){return moveSel(view,(range=>range.empty?view.moveByChar(range,forward):rangeEnd(range,forward)))}function ltrAtCursor(view){return view.textDirectionAt(view.state.selection.main.head)==Direction$1.LTR}const cursorCharLeft=view=>cursorByChar(view,!ltrAtCursor(view)),cursorCharRight=view=>cursorByChar(view,ltrAtCursor(view));function cursorByGroup(view,forward){return moveSel(view,(range=>range.empty?view.moveByGroup(range,forward):rangeEnd(range,forward)))}function interestingNode(state,node,bracketProp){if(node.type.prop(bracketProp))return!0;let len=node.to-node.from;return len&&(len>2||/[^\s,.;:]/.test(state.sliceDoc(node.from,node.to)))||node.firstChild}function moveBySyntax(state,start2,forward){let match,newPos,pos=syntaxTree(state).resolveInner(start2.head),bracketProp=forward?NodeProp.closedBy:NodeProp.openedBy;for(let at=start2.head;;){let next=forward?pos.childAfter(at):pos.childBefore(at);if(!next)break;interestingNode(state,next,bracketProp)?pos=next:at=forward?next.to:next.from}return newPos=pos.type.prop(bracketProp)&&(match=forward?matchBrackets(state,pos.from,1):matchBrackets(state,pos.to,-1))&&match.matched?forward?match.end.to:match.end.from:forward?pos.to:pos.from,EditorSelection.cursor(newPos,forward?-1:1)}function cursorByLine(view,forward){return moveSel(view,(range=>{if(!range.empty)return rangeEnd(range,forward);let moved=view.moveVertically(range,forward);return moved.head!=range.head?moved:view.moveToLineBoundary(range,forward)}))}const cursorLineUp=view=>cursorByLine(view,!1),cursorLineDown=view=>cursorByLine(view,!0);function pageInfo(view){let height,selfScroll=view.scrollDOM.clientHeight<view.scrollDOM.scrollHeight-2,marginTop=0,marginBottom=0;if(selfScroll){for(let source of view.state.facet(EditorView$1.scrollMargins)){let margins=source(view);(null==margins?void 0:margins.top)&&(marginTop=Math.max(null==margins?void 0:margins.top,marginTop)),(null==margins?void 0:margins.bottom)&&(marginBottom=Math.max(null==margins?void 0:margins.bottom,marginBottom))}height=view.scrollDOM.clientHeight-marginTop-marginBottom}else height=(view.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:marginTop,marginBottom:marginBottom,selfScroll:selfScroll,height:Math.max(view.defaultLineHeight,height-5)}}function cursorByPage(view,forward){let effect2,page=pageInfo(view),{state:state}=view,selection2=updateSel(state.selection,(range=>range.empty?view.moveVertically(range,forward,page.height):rangeEnd(range,forward)));if(selection2.eq(state.selection))return!1;if(page.selfScroll){let startPos=view.coordsAtPos(state.selection.main.head),scrollRect=view.scrollDOM.getBoundingClientRect(),scrollTop=scrollRect.top+page.marginTop,scrollBottom=scrollRect.bottom-page.marginBottom;startPos&&startPos.top>scrollTop&&startPos.bottom<scrollBottom&&(effect2=EditorView$1.scrollIntoView(selection2.main.head,{y:"start",yMargin:startPos.top-scrollTop}))}return view.dispatch(setSel(state,selection2),{effects:effect2}),!0}const cursorPageUp=view=>cursorByPage(view,!1),cursorPageDown=view=>cursorByPage(view,!0);function moveByLineBoundary(view,start2,forward){let line=view.lineBlockAt(start2.head),moved=view.moveToLineBoundary(start2,forward);if(moved.head==start2.head&&moved.head!=(forward?line.to:line.from)&&(moved=view.moveToLineBoundary(start2,forward,!1)),!forward&&moved.head==line.from&&line.length){let space2=/^\s*/.exec(view.state.sliceDoc(line.from,Math.min(line.from+100,line.to)))[0].length;space2&&start2.head!=line.from+space2&&(moved=EditorSelection.cursor(line.from+space2))}return moved}function extendSel(view,how){let selection2=updateSel(view.state.selection,(range=>{let head=how(range);return EditorSelection.range(range.anchor,head.head,head.goalColumn,head.bidiLevel||void 0)}));return!selection2.eq(view.state.selection)&&(view.dispatch(setSel(view.state,selection2)),!0)}function selectByChar(view,forward){return extendSel(view,(range=>view.moveByChar(range,forward)))}const selectCharLeft=view=>selectByChar(view,!ltrAtCursor(view)),selectCharRight=view=>selectByChar(view,ltrAtCursor(view));function selectByGroup(view,forward){return extendSel(view,(range=>view.moveByGroup(range,forward)))}function selectByLine(view,forward){return extendSel(view,(range=>view.moveVertically(range,forward)))}const selectLineUp=view=>selectByLine(view,!1),selectLineDown=view=>selectByLine(view,!0);function selectByPage(view,forward){return extendSel(view,(range=>view.moveVertically(range,forward,pageInfo(view).height)))}const selectPageUp=view=>selectByPage(view,!1),selectPageDown=view=>selectByPage(view,!0),cursorDocStart=({state:state,dispatch:dispatch2})=>(dispatch2(setSel(state,{anchor:0})),!0),cursorDocEnd=({state:state,dispatch:dispatch2})=>(dispatch2(setSel(state,{anchor:state.doc.length})),!0),selectDocStart=({state:state,dispatch:dispatch2})=>(dispatch2(setSel(state,{anchor:state.selection.main.anchor,head:0})),!0),selectDocEnd=({state:state,dispatch:dispatch2})=>(dispatch2(setSel(state,{anchor:state.selection.main.anchor,head:state.doc.length})),!0);function deleteBy(target,by){if(target.state.readOnly)return!1;let event="delete.selection",{state:state}=target,changes=state.changeByRange((range=>{let{from:from,to:to}=range;if(from==to){let towards=by(range);towards<from?(event="delete.backward",towards=skipAtomic(target,towards,!1)):towards>from&&(event="delete.forward",towards=skipAtomic(target,towards,!0)),from=Math.min(from,towards),to=Math.max(to,towards)}else from=skipAtomic(target,from,!1),to=skipAtomic(target,to,!0);return from==to?{range:range}:{changes:{from:from,to:to},range:EditorSelection.cursor(from,from<range.head?-1:1)}}));return!changes.changes.empty&&(target.dispatch(state.update(changes,{scrollIntoView:!0,userEvent:event,effects:"delete.selection"==event?EditorView$1.announce.of(state.phrase("Selection deleted")):void 0})),!0)}function skipAtomic(target,pos,forward){if(target instanceof EditorView$1)for(let ranges of target.state.facet(EditorView$1.atomicRanges).map((f=>f(target))))ranges.between(pos,pos,((from,to)=>{from<pos&&to>pos&&(pos=forward?to:from)}));return pos}const deleteByChar=(target,forward)=>deleteBy(target,(range=>{let before,targetPos,pos=range.from,{state:state}=target,line=state.doc.lineAt(pos);if(!forward&&pos>line.from&&pos<line.from+200&&!/[^ \t]/.test(before=line.text.slice(0,pos-line.from))){if("\t"==before[before.length-1])return pos-1;let drop=countColumn(before,state.tabSize)%getIndentUnit(state)||getIndentUnit(state);for(let i2=0;i2<drop&&" "==before[before.length-1-i2];i2++)pos--;targetPos=pos}else targetPos=findClusterBreak(line.text,pos-line.from,forward,forward)+line.from,targetPos==pos&&line.number!=(forward?state.doc.lines:1)&&(targetPos+=forward?1:-1);return targetPos})),deleteCharBackward=view=>deleteByChar(view,!1),deleteCharForward=view=>deleteByChar(view,!0),deleteByGroup=(target,forward)=>deleteBy(target,(range=>{let pos=range.head,{state:state}=target,line=state.doc.lineAt(pos),categorize=state.charCategorizer(pos);for(let cat=null;;){if(pos==(forward?line.to:line.from)){pos==range.head&&line.number!=(forward?state.doc.lines:1)&&(pos+=forward?1:-1);break}let next=findClusterBreak(line.text,pos-line.from,forward)+line.from,nextChar2=line.text.slice(Math.min(pos,next)-line.from,Math.max(pos,next)-line.from),nextCat=categorize(nextChar2);if(null!=cat&&nextCat!=cat)break;" "==nextChar2&&pos==range.head||(cat=nextCat),pos=next}return pos})),deleteGroupBackward=target=>deleteByGroup(target,!1);function selectedLineBlocks(state){let blocks=[],upto=-1;for(let range of state.selection.ranges){let startLine=state.doc.lineAt(range.from),endLine=state.doc.lineAt(range.to);if(range.empty||range.to!=endLine.from||(endLine=state.doc.lineAt(range.to-1)),upto>=startLine.number){let prev=blocks[blocks.length-1];prev.to=endLine.to,prev.ranges.push(range)}else blocks.push({from:startLine.from,to:endLine.to,ranges:[range]});upto=endLine.number+1}return blocks}function moveLine(state,dispatch2,forward){if(state.readOnly)return!1;let changes=[],ranges=[];for(let block of selectedLineBlocks(state)){if(forward?block.to==state.doc.length:0==block.from)continue;let nextLine=state.doc.lineAt(forward?block.to+1:block.from-1),size=nextLine.length+1;if(forward){changes.push({from:block.to,to:nextLine.to},{from:block.from,insert:nextLine.text+state.lineBreak});for(let r of block.ranges)ranges.push(EditorSelection.range(Math.min(state.doc.length,r.anchor+size),Math.min(state.doc.length,r.head+size)))}else{changes.push({from:nextLine.from,to:block.from},{from:block.to,insert:state.lineBreak+nextLine.text});for(let r of block.ranges)ranges.push(EditorSelection.range(r.anchor-size,r.head-size))}}return!!changes.length&&(dispatch2(state.update({changes:changes,scrollIntoView:!0,selection:EditorSelection.create(ranges,state.selection.mainIndex),userEvent:"move.line"})),!0)}function copyLine(state,dispatch2,forward){if(state.readOnly)return!1;let changes=[];for(let block of selectedLineBlocks(state))forward?changes.push({from:block.from,insert:state.doc.slice(block.from,block.to)+state.lineBreak}):changes.push({from:block.to,insert:state.lineBreak+state.doc.slice(block.from,block.to)});return dispatch2(state.update({changes:changes,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const insertNewlineAndIndent=newlineAndIndent(!1);function newlineAndIndent(atEof){return({state:state,dispatch:dispatch2})=>{if(state.readOnly)return!1;let changes=state.changeByRange((range=>{let{from:from,to:to}=range,line=state.doc.lineAt(from),explode=!atEof&&from==to&&function(state,pos){if(/\(\)|\[\]|\{\}/.test(state.sliceDoc(pos-1,pos+1)))return{from:pos,to:pos};let closedBy,context=syntaxTree(state).resolveInner(pos),before=context.childBefore(pos),after=context.childAfter(pos);return before&&after&&before.to<=pos&&after.from>=pos&&(closedBy=before.type.prop(NodeProp.closedBy))&&closedBy.indexOf(after.name)>-1&&state.doc.lineAt(before.to).from==state.doc.lineAt(after.from).from&&!/\S/.test(state.sliceDoc(before.to,after.from))?{from:before.to,to:after.from}:null}(state,from);atEof&&(from=to=(to<=line.to?line:state.doc.lineAt(to)).to);let cx=new IndentContext(state,{simulateBreak:from,simulateDoubleBreak:!!explode}),indent=getIndentation(cx,from);for(null==indent&&(indent=countColumn(/^\s*/.exec(state.doc.lineAt(from).text)[0],state.tabSize));to<line.to&&/\s/.test(line.text[to-line.from]);)to++;explode?({from:from,to:to}=explode):from>line.from&&from<line.from+100&&!/\S/.test(line.text.slice(0,from))&&(from=line.from);let insert2=["",indentString(state,indent)];return explode&&insert2.push(indentString(state,cx.lineIndent(line.from,-1))),{changes:{from:from,to:to,insert:Text.of(insert2)},range:EditorSelection.cursor(from+1+insert2[1].length)}}));return dispatch2(state.update(changes,{scrollIntoView:!0,userEvent:"input"})),!0}}function changeBySelectedLine(state,f){let atLine=-1;return state.changeByRange((range=>{let changes=[];for(let pos=range.from;pos<=range.to;){let line=state.doc.lineAt(pos);line.number>atLine&&(range.empty||range.to>line.from)&&(f(line,changes,range),atLine=line.number),pos=line.to+1}let changeSet=state.changes(changes);return{changes:changes,range:EditorSelection.range(changeSet.mapPos(range.anchor,1),changeSet.mapPos(range.head,1))}}))}const indentMore=({state:state,dispatch:dispatch2})=>!state.readOnly&&(dispatch2(state.update(changeBySelectedLine(state,((line,changes)=>{changes.push({from:line.from,insert:state.facet(indentUnit)})})),{userEvent:"input.indent"})),!0),indentLess=({state:state,dispatch:dispatch2})=>!state.readOnly&&(dispatch2(state.update(changeBySelectedLine(state,((line,changes)=>{let space2=/^\s*/.exec(line.text)[0];if(!space2)return;let col=countColumn(space2,state.tabSize),keep=0,insert2=indentString(state,Math.max(0,col-getIndentUnit(state)));for(;keep<space2.length&&keep<insert2.length&&space2.charCodeAt(keep)==insert2.charCodeAt(keep);)keep++;changes.push({from:line.from+keep,to:line.from+space2.length,insert:insert2.slice(keep)})})),{userEvent:"delete.dedent"})),!0),defaultKeymap=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:view=>moveSel(view,(range=>moveBySyntax(view.state,range,!ltrAtCursor(view)))),shift:view=>extendSel(view,(range=>moveBySyntax(view.state,range,!ltrAtCursor(view))))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:view=>moveSel(view,(range=>moveBySyntax(view.state,range,ltrAtCursor(view)))),shift:view=>extendSel(view,(range=>moveBySyntax(view.state,range,ltrAtCursor(view))))},{key:"Alt-ArrowUp",run:({state:state,dispatch:dispatch2})=>moveLine(state,dispatch2,!1)},{key:"Shift-Alt-ArrowUp",run:({state:state,dispatch:dispatch2})=>copyLine(state,dispatch2,!1)},{key:"Alt-ArrowDown",run:({state:state,dispatch:dispatch2})=>moveLine(state,dispatch2,!0)},{key:"Shift-Alt-ArrowDown",run:({state:state,dispatch:dispatch2})=>copyLine(state,dispatch2,!0)},{key:"Escape",run:({state:state,dispatch:dispatch2})=>{let cur2=state.selection,selection2=null;return cur2.ranges.length>1?selection2=EditorSelection.create([cur2.main]):cur2.main.empty||(selection2=EditorSelection.create([EditorSelection.cursor(cur2.main.head)])),!!selection2&&(dispatch2(setSel(state,selection2)),!0)}},{key:"Mod-Enter",run:newlineAndIndent(!0)},{key:"Alt-l",mac:"Ctrl-l",run:({state:state,dispatch:dispatch2})=>{let ranges=selectedLineBlocks(state).map((({from:from,to:to})=>EditorSelection.range(from,Math.min(to+1,state.doc.length))));return dispatch2(state.update({selection:EditorSelection.create(ranges),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:state,dispatch:dispatch2})=>{let selection2=updateSel(state.selection,(range=>{var _a2;for(let cur2=syntaxTree(state).resolveStack(range.from,1);cur2;cur2=cur2.next){let{node:node}=cur2;if((node.from<range.from&&node.to>=range.to||node.to>range.to&&node.from<=range.from)&&(null===(_a2=node.parent)||void 0===_a2?void 0:_a2.parent))return EditorSelection.range(node.to,node.from)}return range}));return dispatch2(setSel(state,selection2)),!0},preventDefault:!0},{key:"Mod-[",run:indentLess},{key:"Mod-]",run:indentMore},{key:"Mod-Alt-\\",run:({state:state,dispatch:dispatch2})=>{if(state.readOnly)return!1;let updated=Object.create(null),context=new IndentContext(state,{overrideIndentation:start2=>{let found=updated[start2];return null==found?-1:found}}),changes=changeBySelectedLine(state,((line,changes2,range)=>{let indent=getIndentation(context,line.from);if(null==indent)return;/\S/.test(line.text)||(indent=0);let cur2=/^\s*/.exec(line.text)[0],norm=indentString(state,indent);(cur2!=norm||range.from<line.from+cur2.length)&&(updated[line.from]=indent,changes2.push({from:line.from,to:line.from+cur2.length,insert:norm}))}));return changes.changes.empty||dispatch2(state.update(changes,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:view=>{if(view.state.readOnly)return!1;let{state:state}=view,changes=state.changes(selectedLineBlocks(state).map((({from:from,to:to})=>(from>0?from--:to<state.doc.length&&to++,{from:from,to:to})))),selection2=updateSel(state.selection,(range=>view.moveVertically(range,!0))).map(changes);return view.dispatch({changes:changes,selection:selection2,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:state,dispatch:dispatch2})=>function(state,dispatch2,extend2){let found=!1,selection2=updateSel(state.selection,(range=>{let matching=matchBrackets(state,range.head,-1)||matchBrackets(state,range.head,1)||range.head>0&&matchBrackets(state,range.head-1,1)||range.head<state.doc.length&&matchBrackets(state,range.head+1,-1);if(!matching||!matching.end)return range;found=!0;let head=matching.start.from==range.head?matching.end.to:matching.end.from;return extend2?EditorSelection.range(range.anchor,head):EditorSelection.cursor(head)}));return!!found&&(dispatch2(setSel(state,selection2)),!0)}(state,dispatch2,!1)},{key:"Mod-/",run:target=>{let{state:state}=target,line=state.doc.lineAt(state.selection.main.from),config2=getConfig(target.state,line.from);return config2.line?toggleLineComment(target):!!config2.block&&toggleBlockCommentByLine(target)}},{key:"Alt-A",run:toggleBlockComment}].concat([{key:"ArrowLeft",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:view=>cursorByGroup(view,!ltrAtCursor(view)),shift:view=>selectByGroup(view,!ltrAtCursor(view)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:view=>moveSel(view,(range=>moveByLineBoundary(view,range,!ltrAtCursor(view)))),shift:view=>extendSel(view,(range=>moveByLineBoundary(view,range,!ltrAtCursor(view)))),preventDefault:!0},{key:"ArrowRight",run:cursorCharRight,shift:selectCharRight,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:view=>cursorByGroup(view,ltrAtCursor(view)),shift:view=>selectByGroup(view,ltrAtCursor(view)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:view=>moveSel(view,(range=>moveByLineBoundary(view,range,ltrAtCursor(view)))),shift:view=>extendSel(view,(range=>moveByLineBoundary(view,range,ltrAtCursor(view)))),preventDefault:!0},{key:"ArrowUp",run:cursorLineUp,shift:selectLineUp,preventDefault:!0},{mac:"Cmd-ArrowUp",run:cursorDocStart,shift:selectDocStart},{mac:"Ctrl-ArrowUp",run:cursorPageUp,shift:selectPageUp},{key:"ArrowDown",run:cursorLineDown,shift:selectLineDown,preventDefault:!0},{mac:"Cmd-ArrowDown",run:cursorDocEnd,shift:selectDocEnd},{mac:"Ctrl-ArrowDown",run:cursorPageDown,shift:selectPageDown},{key:"PageUp",run:cursorPageUp,shift:selectPageUp},{key:"PageDown",run:cursorPageDown,shift:selectPageDown},{key:"Home",run:view=>moveSel(view,(range=>moveByLineBoundary(view,range,!1))),shift:view=>extendSel(view,(range=>moveByLineBoundary(view,range,!1))),preventDefault:!0},{key:"Mod-Home",run:cursorDocStart,shift:selectDocStart},{key:"End",run:view=>moveSel(view,(range=>moveByLineBoundary(view,range,!0))),shift:view=>extendSel(view,(range=>moveByLineBoundary(view,range,!0))),preventDefault:!0},{key:"Mod-End",run:cursorDocEnd,shift:selectDocEnd},{key:"Enter",run:insertNewlineAndIndent},{key:"Mod-a",run:({state:state,dispatch:dispatch2})=>(dispatch2(state.update({selection:{anchor:0,head:state.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:deleteCharBackward,shift:deleteCharBackward},{key:"Delete",run:deleteCharForward},{key:"Mod-Backspace",mac:"Alt-Backspace",run:deleteGroupBackward},{key:"Mod-Delete",mac:"Alt-Delete",run:target=>deleteByGroup(target,!0)},{mac:"Mod-Backspace",run:view=>deleteBy(view,(range=>{let lineStart=view.moveToLineBoundary(range,!1).head;return range.head>lineStart?lineStart:Math.max(0,range.head-1)}))},{mac:"Mod-Delete",run:view=>deleteBy(view,(range=>{let lineStart=view.moveToLineBoundary(range,!0).head;return range.head<lineStart?lineStart:Math.min(view.state.doc.length,range.head+1)}))}].concat([{key:"Ctrl-b",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Ctrl-f",run:cursorCharRight,shift:selectCharRight},{key:"Ctrl-p",run:cursorLineUp,shift:selectLineUp},{key:"Ctrl-n",run:cursorLineDown,shift:selectLineDown},{key:"Ctrl-a",run:view=>moveSel(view,(range=>EditorSelection.cursor(view.lineBlockAt(range.head).from,1))),shift:view=>extendSel(view,(range=>EditorSelection.cursor(view.lineBlockAt(range.head).from)))},{key:"Ctrl-e",run:view=>moveSel(view,(range=>EditorSelection.cursor(view.lineBlockAt(range.head).to,-1))),shift:view=>extendSel(view,(range=>EditorSelection.cursor(view.lineBlockAt(range.head).to)))},{key:"Ctrl-d",run:deleteCharForward},{key:"Ctrl-h",run:deleteCharBackward},{key:"Ctrl-k",run:view=>deleteBy(view,(range=>{let lineEnd=view.lineBlockAt(range.head).to;return range.head<lineEnd?lineEnd:Math.min(view.state.doc.length,range.head+1)}))},{key:"Ctrl-Alt-h",run:deleteGroupBackward},{key:"Ctrl-o",run:({state:state,dispatch:dispatch2})=>{if(state.readOnly)return!1;let changes=state.changeByRange((range=>({changes:{from:range.from,to:range.to,insert:Text.of(["",""])},range:EditorSelection.cursor(range.from)})));return dispatch2(state.update(changes,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:state,dispatch:dispatch2})=>{if(state.readOnly)return!1;let changes=state.changeByRange((range=>{if(!range.empty||0==range.from||range.from==state.doc.length)return{range:range};let pos=range.from,line=state.doc.lineAt(pos),from=pos==line.from?pos-1:findClusterBreak(line.text,pos-line.from,!1)+line.from,to=pos==line.to?pos+1:findClusterBreak(line.text,pos-line.from,!0)+line.from;return{changes:{from:from,to:to,insert:state.doc.slice(pos,to).append(state.doc.slice(from,pos))},range:EditorSelection.cursor(to)}}));return!changes.changes.empty&&(dispatch2(state.update(changes,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:cursorPageDown}].map((b=>({mac:b.key,run:b.run,shift:b.shift}))))),indentWithTab={key:"Tab",run:indentMore,shift:indentLess};function crelt(){var elt=arguments[0];"string"==typeof elt&&(elt=document.createElement(elt));var i2=1,next=arguments[1];if(next&&"object"==typeof next&&null==next.nodeType&&!Array.isArray(next)){for(var name2 in next)if(Object.prototype.hasOwnProperty.call(next,name2)){var value=next[name2];"string"==typeof value?elt.setAttribute(name2,value):null!=value&&(elt[name2]=value)}i2++}for(;i2<arguments.length;i2++)add(elt,arguments[i2]);return elt}function add(elt,child){if("string"==typeof child)elt.appendChild(document.createTextNode(child));else if(null==child);else if(null!=child.nodeType)elt.appendChild(child);else{if(!Array.isArray(child))throw new RangeError("Unsupported child node: "+child);for(var i2=0;i2<child.length;i2++)add(elt,child[i2])}}const basicNormalize="function"==typeof String.prototype.normalize?x=>x.normalize("NFKD"):x=>x;class SearchCursor{constructor(text2,query,from=0,to=text2.length,normalize,test){this.test=test,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=text2.iterRange(from,to),this.bufferStart=from,this.normalize=normalize?x=>normalize(basicNormalize(x)):basicNormalize,this.query=this.normalize(query)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let next=this.peek();if(next<0)return this.done=!0,this;let str=fromCodePoint(next),start2=this.bufferStart+this.bufferPos;this.bufferPos+=codePointSize(next);let norm=this.normalize(str);for(let i2=0,pos=start2;;i2++){let code2=norm.charCodeAt(i2),match=this.match(code2,pos);if(i2==norm.length-1){if(match)return this.value=match,this;break}pos==start2&&i2<str.length&&str.charCodeAt(i2)==code2&&pos++}}}match(code2,pos){let match=null;for(let i2=0;i2<this.matches.length;i2+=2){let index=this.matches[i2],keep=!1;this.query.charCodeAt(index)==code2&&(index==this.query.length-1?match={from:this.matches[i2+1],to:pos+1}:(this.matches[i2]++,keep=!0)),keep||(this.matches.splice(i2,2),i2-=2)}return this.query.charCodeAt(0)==code2&&(1==this.query.length?match={from:pos,to:pos+1}:this.matches.push(1,pos)),match&&this.test&&!this.test(match.from,match.to,this.buffer,this.bufferStart)&&(match=null),match}}"undefined"!=typeof Symbol&&(SearchCursor.prototype[Symbol.iterator]=function(){return this});const empty={from:-1,to:-1,match:/.*/.exec("")},baseFlags="gm"+(null==/x/.unicode?"":"u");class RegExpCursor{constructor(text2,query,options,from=0,to=text2.length){if(this.text=text2,this.to=to,this.curLine="",this.done=!1,this.value=empty,/\\[sWDnr]|\n|\r|\[\^/.test(query))return new MultilineRegExpCursor(text2,query,options,from,to);this.re=new RegExp(query,baseFlags+((null==options?void 0:options.ignoreCase)?"i":"")),this.test=null==options?void 0:options.test,this.iter=text2.iter();let startLine=text2.lineAt(from);this.curLineStart=startLine.from,this.matchPos=toCharEnd(text2,from),this.getLine(this.curLineStart)}getLine(skip){this.iter.next(skip),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let off=this.matchPos-this.curLineStart;;){this.re.lastIndex=off;let match=this.matchPos<=this.to&&this.re.exec(this.curLine);if(match){let from=this.curLineStart+match.index,to=from+match[0].length;if(this.matchPos=toCharEnd(this.text,to+(from==to?1:0)),from==this.curLineStart+this.curLine.length&&this.nextLine(),(from<to||from>this.value.to)&&(!this.test||this.test(from,to,match)))return this.value={from:from,to:to,match:match},this;off=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),off=0}}}}const flattened=new WeakMap;class FlattenedDoc{constructor(from,text2){this.from=from,this.text=text2}get to(){return this.from+this.text.length}static get(doc2,from,to){let cached=flattened.get(doc2);if(!cached||cached.from>=to||cached.to<=from){let flat=new FlattenedDoc(from,doc2.sliceString(from,to));return flattened.set(doc2,flat),flat}if(cached.from==from&&cached.to==to)return cached;let{text:text2,from:cachedFrom}=cached;return cachedFrom>from&&(text2=doc2.sliceString(from,cachedFrom)+text2,cachedFrom=from),cached.to<to&&(text2+=doc2.sliceString(cached.to,to)),flattened.set(doc2,new FlattenedDoc(cachedFrom,text2)),new FlattenedDoc(from,text2.slice(from-cachedFrom,to-cachedFrom))}}class MultilineRegExpCursor{constructor(text2,query,options,from,to){this.text=text2,this.to=to,this.done=!1,this.value=empty,this.matchPos=toCharEnd(text2,from),this.re=new RegExp(query,baseFlags+((null==options?void 0:options.ignoreCase)?"i":"")),this.test=null==options?void 0:options.test,this.flat=FlattenedDoc.get(text2,from,this.chunkEnd(from+5e3))}chunkEnd(pos){return pos>=this.to?this.to:this.text.lineAt(pos).to}next(){for(;;){let off=this.re.lastIndex=this.matchPos-this.flat.from,match=this.re.exec(this.flat.text);if(match&&!match[0]&&match.index==off&&(this.re.lastIndex=off+1,match=this.re.exec(this.flat.text)),match){let from=this.flat.from+match.index,to=from+match[0].length;if((this.flat.to>=this.to||match.index+match[0].length<=this.flat.text.length-10)&&(!this.test||this.test(from,to,match)))return this.value={from:from,to:to,match:match},this.matchPos=toCharEnd(this.text,to+(from==to?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=FlattenedDoc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function toCharEnd(text2,pos){if(pos>=text2.length)return pos;let next,line=text2.lineAt(pos);for(;pos<line.to&&(next=line.text.charCodeAt(pos-line.from))>=56320&&next<57344;)pos++;return pos}function createLineDialog(view){let input=crelt("input",{class:"cm-textfield",name:"line",value:String(view.state.doc.lineAt(view.state.selection.main.head).number)});function go(){let match=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(input.value);if(!match)return;let{state:state}=view,startLine=state.doc.lineAt(state.selection.main.head),[,sign,ln,cl,percent]=match,col=cl?+cl.slice(1):0,line2=ln?+ln:startLine.number;if(ln&&percent){let pc=line2/100;sign&&(pc=pc*("-"==sign?-1:1)+startLine.number/state.doc.lines),line2=Math.round(state.doc.lines*pc)}else ln&&sign&&(line2=line2*("-"==sign?-1:1)+startLine.number);let docLine=state.doc.line(Math.max(1,Math.min(state.doc.lines,line2))),selection2=EditorSelection.cursor(docLine.from+Math.max(0,Math.min(col,docLine.length)));view.dispatch({effects:[dialogEffect.of(!1),EditorView$1.scrollIntoView(selection2.from,{y:"center"})],selection:selection2}),view.focus()}return{dom:crelt("form",{class:"cm-gotoLine",onkeydown:event=>{27==event.keyCode?(event.preventDefault(),view.dispatch({effects:dialogEffect.of(!1)}),view.focus()):13==event.keyCode&&(event.preventDefault(),go())},onsubmit:event=>{event.preventDefault(),go()}},crelt("label",view.state.phrase("Go to line"),": ",input)," ",crelt("button",{class:"cm-button",type:"submit"},view.state.phrase("go")))}}"undefined"!=typeof Symbol&&(RegExpCursor.prototype[Symbol.iterator]=MultilineRegExpCursor.prototype[Symbol.iterator]=function(){return this});const dialogEffect=StateEffect.define(),dialogField=StateField.define({create:()=>!0,update(value,tr){for(let e of tr.effects)e.is(dialogEffect)&&(value=e.value);return value},provide:f=>showPanel.from(f,(val=>val?createLineDialog:null))}),baseTheme$1$1=EditorView$1.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),defaultHighlightOptions={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},highlightConfig=Facet.define({combine:options=>combineConfig(options,defaultHighlightOptions,{highlightWordAroundCursor:(a,b)=>a||b,minSelectionLength:Math.min,maxMatches:Math.min})});function highlightSelectionMatches(options){let ext=[defaultTheme,matchHighlighter];return options&&ext.push(highlightConfig.of(options)),ext}const matchDeco=Decoration$1.mark({class:"cm-selectionMatch"}),mainMatchDeco=Decoration$1.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function insideWordBoundaries(check,state,from,to){return!(0!=from&&check(state.sliceDoc(from-1,from))==CharCategory.Word||to!=state.doc.length&&check(state.sliceDoc(to,to+1))==CharCategory.Word)}const matchHighlighter=ViewPlugin$1.fromClass(class{constructor(view){this.decorations=this.getDeco(view)}update(update2){(update2.selectionSet||update2.docChanged||update2.viewportChanged)&&(this.decorations=this.getDeco(update2.view))}getDeco(view){let conf=view.state.facet(highlightConfig),{state:state}=view,sel=state.selection;if(sel.ranges.length>1)return Decoration$1.none;let query,range=sel.main,check=null;if(range.empty){if(!conf.highlightWordAroundCursor)return Decoration$1.none;let word=state.wordAt(range.head);if(!word)return Decoration$1.none;check=state.charCategorizer(range.head),query=state.sliceDoc(word.from,word.to)}else{let len=range.to-range.from;if(len<conf.minSelectionLength||len>200)return Decoration$1.none;if(conf.wholeWords){if(query=state.sliceDoc(range.from,range.to),check=state.charCategorizer(range.head),!insideWordBoundaries(check,state,range.from,range.to)||!function(check,state,from,to){return check(state.sliceDoc(from,from+1))==CharCategory.Word&&check(state.sliceDoc(to-1,to))==CharCategory.Word}(check,state,range.from,range.to))return Decoration$1.none}else if(query=state.sliceDoc(range.from,range.to).trim(),!query)return Decoration$1.none}let deco=[];for(let part of view.visibleRanges){let cursor2=new SearchCursor(state.doc,query,part.from,part.to);for(;!cursor2.next().done;){let{from:from,to:to}=cursor2.value;if((!check||insideWordBoundaries(check,state,from,to))&&(range.empty&&from<=range.from&&to>=range.to?deco.push(mainMatchDeco.range(from,to)):(from>=range.to||to<=range.from)&&deco.push(matchDeco.range(from,to)),deco.length>conf.maxMatches))return Decoration$1.none}}return Decoration$1.set(deco)}},{decorations:v=>v.decorations}),defaultTheme=EditorView$1.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});const searchConfigFacet=Facet.define({combine:configs=>combineConfig(configs,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:view=>new SearchPanel(view),scrollToMatch:range=>EditorView$1.scrollIntoView(range)})});class SearchQuery{constructor(config2){this.search=config2.search,this.caseSensitive=!!config2.caseSensitive,this.literal=!!config2.literal,this.regexp=!!config2.regexp,this.replace=config2.replace||"",this.valid=!!this.search&&(!this.regexp||function(source){try{return new RegExp(source,baseFlags),!0}catch(_a2){return!1}}(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!config2.wholeWord}unquote(text2){return this.literal?text2:text2.replace(/\\([nrt\\])/g,((_,ch)=>"n"==ch?"\n":"r"==ch?"\r":"t"==ch?"\t":"\\"))}eq(other){return this.search==other.search&&this.replace==other.replace&&this.caseSensitive==other.caseSensitive&&this.regexp==other.regexp&&this.wholeWord==other.wholeWord}create(){return this.regexp?new RegExpQuery(this):new StringQuery(this)}getCursor(state,from=0,to){let st=state.doc?state:EditorState.create({doc:state});return null==to&&(to=st.doc.length),this.regexp?regexpCursor(this,st,from,to):stringCursor(this,st,from,to)}}class QueryType{constructor(spec){this.spec=spec}}function stringCursor(spec,state,from,to){return new SearchCursor(state.doc,spec.unquoted,from,to,spec.caseSensitive?void 0:x=>x.toLowerCase(),spec.wholeWord?(doc2=state.doc,categorizer=state.charCategorizer(state.selection.main.head),(from,to,buf,bufPos)=>((bufPos>from||bufPos+buf.length<to)&&(bufPos=Math.max(0,from-2),buf=doc2.sliceString(bufPos,Math.min(doc2.length,to+2))),!(categorizer(charBefore(buf,from-bufPos))==CharCategory.Word&&categorizer(charAfter(buf,from-bufPos))==CharCategory.Word||categorizer(charAfter(buf,to-bufPos))==CharCategory.Word&&categorizer(charBefore(buf,to-bufPos))==CharCategory.Word))):void 0);var doc2,categorizer}class StringQuery extends QueryType{constructor(spec){super(spec)}nextMatch(state,curFrom,curTo){let cursor2=stringCursor(this.spec,state,curTo,state.doc.length).nextOverlapping();return cursor2.done&&(cursor2=stringCursor(this.spec,state,0,curFrom).nextOverlapping()),cursor2.done?null:cursor2.value}prevMatchInRange(state,from,to){for(let pos=to;;){let start2=Math.max(from,pos-1e4-this.spec.unquoted.length),cursor2=stringCursor(this.spec,state,start2,pos),range=null;for(;!cursor2.nextOverlapping().done;)range=cursor2.value;if(range)return range;if(start2==from)return null;pos-=1e4}}prevMatch(state,curFrom,curTo){return this.prevMatchInRange(state,0,curFrom)||this.prevMatchInRange(state,curTo,state.doc.length)}getReplacement(_result){return this.spec.unquote(this.spec.replace)}matchAll(state,limit){let cursor2=stringCursor(this.spec,state,0,state.doc.length),ranges=[];for(;!cursor2.next().done;){if(ranges.length>=limit)return null;ranges.push(cursor2.value)}return ranges}highlight(state,from,to,add2){let cursor2=stringCursor(this.spec,state,Math.max(0,from-this.spec.unquoted.length),Math.min(to+this.spec.unquoted.length,state.doc.length));for(;!cursor2.next().done;)add2(cursor2.value.from,cursor2.value.to)}}function regexpCursor(spec,state,from,to){return new RegExpCursor(state.doc,spec.search,{ignoreCase:!spec.caseSensitive,test:spec.wholeWord?(categorizer=state.charCategorizer(state.selection.main.head),(_from,_to,match)=>!match[0].length||(categorizer(charBefore(match.input,match.index))!=CharCategory.Word||categorizer(charAfter(match.input,match.index))!=CharCategory.Word)&&(categorizer(charAfter(match.input,match.index+match[0].length))!=CharCategory.Word||categorizer(charBefore(match.input,match.index+match[0].length))!=CharCategory.Word)):void 0},from,to);var categorizer}function charBefore(str,index){return str.slice(findClusterBreak(str,index,!1),index)}function charAfter(str,index){return str.slice(index,findClusterBreak(str,index))}class RegExpQuery extends QueryType{nextMatch(state,curFrom,curTo){let cursor2=regexpCursor(this.spec,state,curTo,state.doc.length).next();return cursor2.done&&(cursor2=regexpCursor(this.spec,state,0,curFrom).next()),cursor2.done?null:cursor2.value}prevMatchInRange(state,from,to){for(let size=1;;size++){let start2=Math.max(from,to-1e4*size),cursor2=regexpCursor(this.spec,state,start2,to),range=null;for(;!cursor2.next().done;)range=cursor2.value;if(range&&(start2==from||range.from>start2+10))return range;if(start2==from)return null}}prevMatch(state,curFrom,curTo){return this.prevMatchInRange(state,0,curFrom)||this.prevMatchInRange(state,curTo,state.doc.length)}getReplacement(result){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,((m,i2)=>"$"==i2?"$":"&"==i2?result.match[0]:"0"!=i2&&+i2<result.match.length?result.match[i2]:m)))}matchAll(state,limit){let cursor2=regexpCursor(this.spec,state,0,state.doc.length),ranges=[];for(;!cursor2.next().done;){if(ranges.length>=limit)return null;ranges.push(cursor2.value)}return ranges}highlight(state,from,to,add2){let cursor2=regexpCursor(this.spec,state,Math.max(0,from-250),Math.min(to+250,state.doc.length));for(;!cursor2.next().done;)add2(cursor2.value.from,cursor2.value.to)}}const setSearchQuery=StateEffect.define(),togglePanel$1=StateEffect.define(),searchState=StateField.define({create:state=>new SearchState(defaultQuery(state).create(),null),update(value,tr){for(let effect2 of tr.effects)effect2.is(setSearchQuery)?value=new SearchState(effect2.value.create(),value.panel):effect2.is(togglePanel$1)&&(value=new SearchState(value.query,effect2.value?createSearchPanel:null));return value},provide:f=>showPanel.from(f,(val=>val.panel))});class SearchState{constructor(query,panel){this.query=query,this.panel=panel}}const matchMark=Decoration$1.mark({class:"cm-searchMatch"}),selectedMatchMark=Decoration$1.mark({class:"cm-searchMatch cm-searchMatch-selected"}),searchHighlighter=ViewPlugin$1.fromClass(class{constructor(view){this.view=view,this.decorations=this.highlight(view.state.field(searchState))}update(update2){let state=update2.state.field(searchState);(state!=update2.startState.field(searchState)||update2.docChanged||update2.selectionSet||update2.viewportChanged)&&(this.decorations=this.highlight(state))}highlight({query:query,panel:panel}){if(!panel||!query.spec.valid)return Decoration$1.none;let{view:view}=this,builder=new RangeSetBuilder;for(let i2=0,ranges=view.visibleRanges,l=ranges.length;i2<l;i2++){let{from:from,to:to}=ranges[i2];for(;i2<l-1&&to>ranges[i2+1].from-500;)to=ranges[++i2].to;query.highlight(view.state,from,to,((from2,to2)=>{let selected=view.state.selection.ranges.some((r=>r.from==from2&&r.to==to2));builder.add(from2,to2,selected?selectedMatchMark:matchMark)}))}return builder.finish()}},{decorations:v=>v.decorations});function searchCommand(f){return view=>{let state=view.state.field(searchState,!1);return state&&state.query.spec.valid?f(view,state):openSearchPanel(view)}}const findNext=searchCommand(((view,{query:query})=>{let{to:to}=view.state.selection.main,next=query.nextMatch(view.state,to,to);if(!next)return!1;let selection2=EditorSelection.single(next.from,next.to),config2=view.state.facet(searchConfigFacet);return view.dispatch({selection:selection2,effects:[announceMatch(view,next),config2.scrollToMatch(selection2.main,view)],userEvent:"select.search"}),selectSearchInput(view),!0})),findPrevious=searchCommand(((view,{query:query})=>{let{state:state}=view,{from:from}=state.selection.main,prev=query.prevMatch(state,from,from);if(!prev)return!1;let selection2=EditorSelection.single(prev.from,prev.to),config2=view.state.facet(searchConfigFacet);return view.dispatch({selection:selection2,effects:[announceMatch(view,prev),config2.scrollToMatch(selection2.main,view)],userEvent:"select.search"}),selectSearchInput(view),!0})),selectMatches=searchCommand(((view,{query:query})=>{let ranges=query.matchAll(view.state,1e3);return!(!ranges||!ranges.length)&&(view.dispatch({selection:EditorSelection.create(ranges.map((r=>EditorSelection.range(r.from,r.to)))),userEvent:"select.search.matches"}),!0)})),replaceNext=searchCommand(((view,{query:query})=>{let{state:state}=view,{from:from,to:to}=state.selection.main;if(state.readOnly)return!1;let next=query.nextMatch(state,from,from);if(!next)return!1;let selection2,replacement,changes=[],effects=[];if(next.from==from&&next.to==to&&(replacement=state.toText(query.getReplacement(next)),changes.push({from:next.from,to:next.to,insert:replacement}),next=query.nextMatch(state,next.from,next.to),effects.push(EditorView$1.announce.of(state.phrase("replaced match on line $",state.doc.lineAt(from).number)+"."))),next){let off=0==changes.length||changes[0].from>=next.to?0:next.to-next.from-replacement.length;selection2=EditorSelection.single(next.from-off,next.to-off),effects.push(announceMatch(view,next)),effects.push(state.facet(searchConfigFacet).scrollToMatch(selection2.main,view))}return view.dispatch({changes:changes,selection:selection2,effects:effects,userEvent:"input.replace"}),!0})),replaceAll=searchCommand(((view,{query:query})=>{if(view.state.readOnly)return!1;let changes=query.matchAll(view.state,1e9).map((match=>{let{from:from,to:to}=match;return{from:from,to:to,insert:query.getReplacement(match)}}));if(!changes.length)return!1;let announceText=view.state.phrase("replaced $ matches",changes.length)+".";return view.dispatch({changes:changes,effects:EditorView$1.announce.of(announceText),userEvent:"input.replace.all"}),!0}));function createSearchPanel(view){return view.state.facet(searchConfigFacet).createPanel(view)}function defaultQuery(state,fallback){var _a2,_b,_c,_d,_e;let sel=state.selection.main,selText=sel.empty||sel.to>sel.from+100?"":state.sliceDoc(sel.from,sel.to);if(fallback&&!selText)return fallback;let config2=state.facet(searchConfigFacet);return new SearchQuery({search:(null!==(_a2=null==fallback?void 0:fallback.literal)&&void 0!==_a2?_a2:config2.literal)?selText:selText.replace(/\n/g,"\\n"),caseSensitive:null!==(_b=null==fallback?void 0:fallback.caseSensitive)&&void 0!==_b?_b:config2.caseSensitive,literal:null!==(_c=null==fallback?void 0:fallback.literal)&&void 0!==_c?_c:config2.literal,regexp:null!==(_d=null==fallback?void 0:fallback.regexp)&&void 0!==_d?_d:config2.regexp,wholeWord:null!==(_e=null==fallback?void 0:fallback.wholeWord)&&void 0!==_e?_e:config2.wholeWord})}function getSearchInput(view){let panel=getPanel(view,createSearchPanel);return panel&&panel.dom.querySelector("[main-field]")}function selectSearchInput(view){let input=getSearchInput(view);input&&input==view.root.activeElement&&input.select()}const openSearchPanel=view=>{let state=view.state.field(searchState,!1);if(state&&state.panel){let searchInput=getSearchInput(view);if(searchInput&&searchInput!=view.root.activeElement){let query=defaultQuery(view.state,state.query.spec);query.valid&&view.dispatch({effects:setSearchQuery.of(query)}),searchInput.focus(),searchInput.select()}}else view.dispatch({effects:[togglePanel$1.of(!0),state?setSearchQuery.of(defaultQuery(view.state,state.query.spec)):StateEffect.appendConfig.of(searchExtensions)]});return!0},closeSearchPanel=view=>{let state=view.state.field(searchState,!1);if(!state||!state.panel)return!1;let panel=getPanel(view,createSearchPanel);return panel&&panel.dom.contains(view.root.activeElement)&&view.focus(),view.dispatch({effects:togglePanel$1.of(!1)}),!0},searchKeymap=[{key:"Mod-f",run:openSearchPanel,scope:"editor search-panel"},{key:"F3",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:closeSearchPanel,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:state,dispatch:dispatch2})=>{let sel=state.selection;if(sel.ranges.length>1||sel.main.empty)return!1;let{from:from,to:to}=sel.main,ranges=[],main2=0;for(let cur2=new SearchCursor(state.doc,state.sliceDoc(from,to));!cur2.next().done;){if(ranges.length>1e3)return!1;cur2.value.from==from&&(main2=ranges.length),ranges.push(EditorSelection.range(cur2.value.from,cur2.value.to))}return dispatch2(state.update({selection:EditorSelection.create(ranges,main2),userEvent:"select.search.matches"})),!0}},{key:"Alt-g",run:view=>{let panel=getPanel(view,createLineDialog);if(!panel){let effects=[dialogEffect.of(!0)];null==view.state.field(dialogField,!1)&&effects.push(StateEffect.appendConfig.of([dialogField,baseTheme$1$1])),view.dispatch({effects:effects}),panel=getPanel(view,createLineDialog)}return panel&&panel.dom.querySelector("input").select(),!0}},{key:"Mod-d",run:({state:state,dispatch:dispatch2})=>{let{ranges:ranges}=state.selection;if(ranges.some((sel=>sel.from===sel.to)))return(({state:state,dispatch:dispatch2})=>{let{selection:selection2}=state,newSel=EditorSelection.create(selection2.ranges.map((range=>state.wordAt(range.head)||EditorSelection.cursor(range.head))),selection2.mainIndex);return!newSel.eq(selection2)&&(dispatch2(state.update({selection:newSel})),!0)})({state:state,dispatch:dispatch2});let searchedText=state.sliceDoc(ranges[0].from,ranges[0].to);if(state.selection.ranges.some((r=>state.sliceDoc(r.from,r.to)!=searchedText)))return!1;let range=function(state,query){let{main:main2,ranges:ranges}=state.selection,word=state.wordAt(main2.head),fullWord=word&&word.from==main2.from&&word.to==main2.to;for(let cycled=!1,cursor2=new SearchCursor(state.doc,query,ranges[ranges.length-1].to);;){if(cursor2.next(),!cursor2.done){if(cycled&&ranges.some((r=>r.from==cursor2.value.from)))continue;if(fullWord){let word2=state.wordAt(cursor2.value.from);if(!word2||word2.from!=cursor2.value.from||word2.to!=cursor2.value.to)continue}return cursor2.value}if(cycled)return null;cursor2=new SearchCursor(state.doc,query,0,Math.max(0,ranges[ranges.length-1].from-1)),cycled=!0}}(state,searchedText);return!!range&&(dispatch2(state.update({selection:state.selection.addRange(EditorSelection.range(range.from,range.to),!1),effects:EditorView$1.scrollIntoView(range.to)})),!0)},preventDefault:!0}];class SearchPanel{constructor(view){this.view=view;let query=this.query=view.state.field(searchState).query.spec;function button(name2,onclick,content2){return crelt("button",{class:"cm-button",name:name2,onclick:onclick,type:"button"},content2)}this.commit=this.commit.bind(this),this.searchField=crelt("input",{value:query.search,placeholder:phrase(view,"Find"),"aria-label":phrase(view,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=crelt("input",{value:query.replace,placeholder:phrase(view,"Replace"),"aria-label":phrase(view,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=crelt("input",{type:"checkbox",name:"case",form:"",checked:query.caseSensitive,onchange:this.commit}),this.reField=crelt("input",{type:"checkbox",name:"re",form:"",checked:query.regexp,onchange:this.commit}),this.wordField=crelt("input",{type:"checkbox",name:"word",form:"",checked:query.wholeWord,onchange:this.commit}),this.dom=crelt("div",{onkeydown:e=>this.keydown(e),class:"cm-search"},[this.searchField,button("next",(()=>findNext(view)),[phrase(view,"next")]),button("prev",(()=>findPrevious(view)),[phrase(view,"previous")]),button("select",(()=>selectMatches(view)),[phrase(view,"all")]),crelt("label",null,[this.caseField,phrase(view,"match case")]),crelt("label",null,[this.reField,phrase(view,"regexp")]),crelt("label",null,[this.wordField,phrase(view,"by word")]),...view.state.readOnly?[]:[crelt("br"),this.replaceField,button("replace",(()=>replaceNext(view)),[phrase(view,"replace")]),button("replaceAll",(()=>replaceAll(view)),[phrase(view,"replace all")])],crelt("button",{name:"close",onclick:()=>closeSearchPanel(view),"aria-label":phrase(view,"close"),type:"button"},["\xd7"])])}commit(){let query=new SearchQuery({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});query.eq(this.query)||(this.query=query,this.view.dispatch({effects:setSearchQuery.of(query)}))}keydown(e){var view,event,scope;view=this.view,event=e,scope="search-panel",runHandlers$1(getKeymap$1(view.state),event,view,scope)?e.preventDefault():13==e.keyCode&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?findPrevious:findNext)(this.view)):13==e.keyCode&&e.target==this.replaceField&&(e.preventDefault(),replaceNext(this.view))}update(update2){for(let tr of update2.transactions)for(let effect2 of tr.effects)effect2.is(setSearchQuery)&&!effect2.value.eq(this.query)&&this.setQuery(effect2.value)}setQuery(query){this.query=query,this.searchField.value=query.search,this.replaceField.value=query.replace,this.caseField.checked=query.caseSensitive,this.reField.checked=query.regexp,this.wordField.checked=query.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(searchConfigFacet).top}}function phrase(view,phrase2){return view.state.phrase(phrase2)}const AnnounceMargin=30,Break=/[\s\.,:;?!]/;function announceMatch(view,{from:from,to:to}){let line=view.state.doc.lineAt(from),lineEnd=view.state.doc.lineAt(to).to,start2=Math.max(line.from,from-AnnounceMargin),end2=Math.min(lineEnd,to+AnnounceMargin),text2=view.state.sliceDoc(start2,end2);if(start2!=line.from)for(let i2=0;i2<AnnounceMargin;i2++)if(!Break.test(text2[i2+1])&&Break.test(text2[i2])){text2=text2.slice(i2);break}if(end2!=lineEnd)for(let i2=text2.length-1;i2>text2.length-AnnounceMargin;i2--)if(!Break.test(text2[i2-1])&&Break.test(text2[i2])){text2=text2.slice(0,i2);break}return EditorView$1.announce.of(`${view.state.phrase("current match")}. ${text2} ${view.state.phrase("on line")} ${line.number}.`)}const baseTheme$2=EditorView$1.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),searchExtensions=[searchState,Prec.low(searchHighlighter),baseTheme$2];class CompletionContext{constructor(state,pos,explicit){this.state=state,this.pos=pos,this.explicit=explicit,this.abortListeners=[]}tokenBefore(types2){let token=syntaxTree(this.state).resolveInner(this.pos,-1);for(;token&&types2.indexOf(token.name)<0;)token=token.parent;return token?{from:token.from,to:this.pos,text:this.state.sliceDoc(token.from,this.pos),type:token.type}:null}matchBefore(expr){let line=this.state.doc.lineAt(this.pos),start2=Math.max(line.from,this.pos-250),str=line.text.slice(start2-line.from,this.pos-line.from),found=str.search(ensureAnchor(expr,!1));return found<0?null:{from:start2+found,to:this.pos,text:str.slice(found)}}get aborted(){return null==this.abortListeners}addEventListener(type2,listener){"abort"==type2&&this.abortListeners&&this.abortListeners.push(listener)}}function toSet(chars){let flat=Object.keys(chars).join(""),words=/\w/.test(flat);return words&&(flat=flat.replace(/\w/g,"")),`[${words?"\\w":""}${flat.replace(/[^\w\s]/g,"\\$&")}]`}function completeFromList(list){let options=list.map((o=>"string"==typeof o?{label:o}:o)),[validFor,match]=options.every((o=>/^\w+$/.test(o.label)))?[/\w*$/,/\w+$/]:function(options){let first=Object.create(null),rest=Object.create(null);for(let{label:label}of options){first[label[0]]=!0;for(let i2=1;i2<label.length;i2++)rest[label[i2]]=!0}let source=toSet(first)+toSet(rest)+"*$";return[new RegExp("^"+source),new RegExp(source)]}(options);return context=>{let token=context.matchBefore(match);return token||context.explicit?{from:token?token.from:context.pos,options:options,validFor:validFor}:null}}class Option{constructor(completion,source,match,score2){this.completion=completion,this.source=source,this.match=match,this.score=score2}}function cur(state){return state.selection.main.from}function ensureAnchor(expr,start2){var _a2;let{source:source}=expr,addStart=start2&&"^"!=source[0],addEnd="$"!=source[source.length-1];return addStart||addEnd?new RegExp(`${addStart?"^":""}(?:${source})${addEnd?"$":""}`,null!==(_a2=expr.flags)&&void 0!==_a2?_a2:expr.ignoreCase?"i":""):expr}const pickedCompletion=Annotation.define();const SourceCache=new WeakMap;function asSource(source){if(!Array.isArray(source))return source;let known=SourceCache.get(source);return known||SourceCache.set(source,known=completeFromList(source)),known}const startCompletionEffect=StateEffect.define(),closeCompletionEffect=StateEffect.define();class FuzzyMatcher{constructor(pattern){this.pattern=pattern,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let p=0;p<pattern.length;){let char=codePointAt(pattern,p),size=codePointSize(char);this.chars.push(char);let part=pattern.slice(p,p+size),upper=part.toUpperCase();this.folded.push(codePointAt(upper==part?part.toLowerCase():upper,0)),p+=size}this.astral=pattern.length!=this.chars.length}ret(score2,matched){return this.score=score2,this.matched=matched,!0}match(word){if(0==this.pattern.length)return this.ret(-100,[]);if(word.length<this.pattern.length)return!1;let{chars:chars,folded:folded,any:any,precise:precise,byWord:byWord}=this;if(1==chars.length){let first=codePointAt(word,0),firstSize=codePointSize(first),score2=firstSize==word.length?0:-100;if(first==chars[0]);else{if(first!=folded[0])return!1;score2+=-200}return this.ret(score2,[0,firstSize])}let direct=word.indexOf(this.pattern);if(0==direct)return this.ret(word.length==this.pattern.length?0:-100,[0,this.pattern.length]);let len=chars.length,anyTo=0;if(direct<0){for(let i2=0,e=Math.min(word.length,200);i2<e&&anyTo<len;){let next=codePointAt(word,i2);next!=chars[anyTo]&&next!=folded[anyTo]||(any[anyTo++]=i2),i2+=codePointSize(next)}if(anyTo<len)return!1}let preciseTo=0,byWordTo=0,byWordFolded=!1,adjacentTo=0,adjacentStart=-1,adjacentEnd=-1,hasLower=/[a-z]/.test(word),wordAdjacent=!0;for(let i2=0,e=Math.min(word.length,200),prevType=0;i2<e&&byWordTo<len;){let next=codePointAt(word,i2);direct<0&&(preciseTo<len&&next==chars[preciseTo]&&(precise[preciseTo++]=i2),adjacentTo<len&&(next==chars[adjacentTo]||next==folded[adjacentTo]?(0==adjacentTo&&(adjacentStart=i2),adjacentEnd=i2+1,adjacentTo++):adjacentTo=0));let ch,type2=next<255?next>=48&&next<=57||next>=97&&next<=122?2:next>=65&&next<=90?1:0:(ch=fromCodePoint(next))!=ch.toLowerCase()?1:ch!=ch.toUpperCase()?2:0;(!i2||1==type2&&hasLower||0==prevType&&0!=type2)&&(chars[byWordTo]==next||folded[byWordTo]==next&&(byWordFolded=!0)?byWord[byWordTo++]=i2:byWord.length&&(wordAdjacent=!1)),prevType=type2,i2+=codePointSize(next)}return byWordTo==len&&0==byWord[0]&&wordAdjacent?this.result((byWordFolded?-200:0)-100,byWord,word):adjacentTo==len&&0==adjacentStart?this.ret(-200-word.length+(adjacentEnd==word.length?0:-100),[0,adjacentEnd]):direct>-1?this.ret(-700-word.length,[direct,direct+this.pattern.length]):adjacentTo==len?this.ret(-900-word.length,[adjacentStart,adjacentEnd]):byWordTo==len?this.result((byWordFolded?-200:0)-100-700+(wordAdjacent?0:-1100),byWord,word):2!=chars.length&&this.result((any[0]?-700:0)-200-1100,any,word)}result(score2,positions,word){let result=[],i2=0;for(let pos of positions){let to=pos+(this.astral?codePointSize(codePointAt(word,pos)):1);i2&&result[i2-1]==pos?result[i2-1]=to:(result[i2++]=pos,result[i2++]=to)}return this.ret(score2-word.length,result)}}const completionConfig=Facet.define({combine:configs=>combineConfig(configs,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:defaultPositionInfo,compareCompletions:(a,b)=>a.label.localeCompare(b.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(a,b)=>a&&b,closeOnBlur:(a,b)=>a&&b,icons:(a,b)=>a&&b,tooltipClass:(a,b)=>c=>joinClass(a(c),b(c)),optionClass:(a,b)=>c=>joinClass(a(c),b(c)),addToOptions:(a,b)=>a.concat(b)})});function joinClass(a,b){return a?b?a+" "+b:a:b}function defaultPositionInfo(view,list,option,info,space2,tooltip){let offset2,maxWidth,rtl=view.textDirection==Direction$1.RTL,left2=rtl,narrow=!1,side="top",spaceLeft=list.left-space2.left,spaceRight=space2.right-list.right,infoWidth=info.right-info.left,infoHeight=info.bottom-info.top;if(left2&&spaceLeft<Math.min(infoWidth,spaceRight)?left2=!1:!left2&&spaceRight<Math.min(infoWidth,spaceLeft)&&(left2=!0),infoWidth<=(left2?spaceLeft:spaceRight))offset2=Math.max(space2.top,Math.min(option.top,space2.bottom-infoHeight))-list.top,maxWidth=Math.min(400,left2?spaceLeft:spaceRight);else{narrow=!0,maxWidth=Math.min(400,(rtl?list.right:space2.right-list.left)-30);let spaceBelow=space2.bottom-list.bottom;spaceBelow>=infoHeight||spaceBelow>list.top?offset2=option.bottom-list.top:(side="bottom",offset2=list.bottom-option.top)}return{style:`${side}: ${offset2/((list.bottom-list.top)/tooltip.offsetHeight)}px; max-width: ${maxWidth/((list.right-list.left)/tooltip.offsetWidth)}px`,class:"cm-completionInfo-"+(narrow?rtl?"left-narrow":"right-narrow":left2?"left":"right")}}function rangeAroundSelected(total,selected,max2){if(total<=max2)return{from:0,to:total};if(selected<0&&(selected=0),selected<=total>>1){let off2=Math.floor(selected/max2);return{from:off2*max2,to:(off2+1)*max2}}let off=Math.floor((total-selected)/max2);return{from:total-(off+1)*max2,to:total-off*max2}}class CompletionTooltip{constructor(view,stateField,applyCompletion2){this.view=view,this.stateField=stateField,this.applyCompletion=applyCompletion2,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:pos=>this.placeInfo(pos),key:this},this.space=null,this.currentClass="";let cState=view.state.field(stateField),{options:options,selected:selected}=cState.open,config2=view.state.facet(completionConfig);this.optionContent=function(config2){let content2=config2.addToOptions.slice();return config2.icons&&content2.push({render(completion){let icon=document.createElement("div");return icon.classList.add("cm-completionIcon"),completion.type&&icon.classList.add(...completion.type.split(/\s+/g).map((cls=>"cm-completionIcon-"+cls))),icon.setAttribute("aria-hidden","true"),icon},position:20}),content2.push({render(completion,_s,_v,match){let labelElt=document.createElement("span");labelElt.className="cm-completionLabel";let label=completion.displayLabel||completion.label,off=0;for(let j=0;j<match.length;){let from=match[j++],to=match[j++];from>off&&labelElt.appendChild(document.createTextNode(label.slice(off,from)));let span=labelElt.appendChild(document.createElement("span"));span.appendChild(document.createTextNode(label.slice(from,to))),span.className="cm-completionMatchedText",off=to}return off<label.length&&labelElt.appendChild(document.createTextNode(label.slice(off))),labelElt},position:50},{render(completion){if(!completion.detail)return null;let detailElt=document.createElement("span");return detailElt.className="cm-completionDetail",detailElt.textContent=completion.detail,detailElt},position:80}),content2.sort(((a,b)=>a.position-b.position)).map((a=>a.render))}(config2),this.optionClass=config2.optionClass,this.tooltipClass=config2.tooltipClass,this.range=rangeAroundSelected(options.length,selected,config2.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(view.state),this.dom.addEventListener("mousedown",(e=>{let{options:options2}=view.state.field(stateField).open;for(let match,dom=e.target;dom&&dom!=this.dom;dom=dom.parentNode)if("LI"==dom.nodeName&&(match=/-(\d+)$/.exec(dom.id))&&+match[1]<options2.length)return this.applyCompletion(view,options2[+match[1]]),void e.preventDefault()})),this.dom.addEventListener("focusout",(e=>{let state=view.state.field(this.stateField,!1);state&&state.tooltip&&view.state.facet(completionConfig).closeOnBlur&&e.relatedTarget!=view.contentDOM&&view.dispatch({effects:closeCompletionEffect.of(null)})})),this.showOptions(options,cState.id)}mount(){this.updateSel()}showOptions(options,id2){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(options,id2,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)}))}update(update2){var _a2;let cState=update2.state.field(this.stateField),prevState=update2.startState.field(this.stateField);if(this.updateTooltipClass(update2.state),cState!=prevState){let{options:options,selected:selected,disabled:disabled}=cState.open;prevState.open&&prevState.open.options==options||(this.range=rangeAroundSelected(options.length,selected,update2.state.facet(completionConfig).maxRenderedOptions),this.showOptions(options,cState.id)),this.updateSel(),disabled!=(null===(_a2=prevState.open)||void 0===_a2?void 0:_a2.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!disabled)}}updateTooltipClass(state){let cls=this.tooltipClass(state);if(cls!=this.currentClass){for(let c of this.currentClass.split(" "))c&&this.dom.classList.remove(c);for(let c of cls.split(" "))c&&this.dom.classList.add(c);this.currentClass=cls}}positioned(space2){this.space=space2,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let cState=this.view.state.field(this.stateField),open=cState.open;if((open.selected>-1&&open.selected<this.range.from||open.selected>=this.range.to)&&(this.range=rangeAroundSelected(open.options.length,open.selected,this.view.state.facet(completionConfig).maxRenderedOptions),this.showOptions(open.options,cState.id)),this.updateSelectedOption(open.selected)){this.destroyInfo();let{completion:completion}=open.options[open.selected],{info:info}=completion;if(!info)return;let infoResult="string"==typeof info?document.createTextNode(info):info(completion);if(!infoResult)return;"then"in infoResult?infoResult.then((obj=>{obj&&this.view.state.field(this.stateField,!1)==cState&&this.addInfoPane(obj,completion)})).catch((e=>logException$1(this.view.state,e,"completion info"))):this.addInfoPane(infoResult,completion)}}addInfoPane(content2,completion){this.destroyInfo();let wrap=this.info=document.createElement("div");if(wrap.className="cm-tooltip cm-completionInfo",null!=content2.nodeType)wrap.appendChild(content2),this.infoDestroy=null;else{let{dom:dom,destroy:destroy}=content2;wrap.appendChild(dom),this.infoDestroy=destroy||null}this.dom.appendChild(wrap),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(selected){let set2=null;for(let opt=this.list.firstChild,i2=this.range.from;opt;opt=opt.nextSibling,i2++)"LI"==opt.nodeName&&opt.id?i2==selected?opt.hasAttribute("aria-selected")||(opt.setAttribute("aria-selected","true"),set2=opt):opt.hasAttribute("aria-selected")&&opt.removeAttribute("aria-selected"):i2--;return set2&&function(container,element2){let parent=container.getBoundingClientRect(),self2=element2.getBoundingClientRect(),scaleY=parent.height/container.offsetHeight;self2.top<parent.top?container.scrollTop-=(parent.top-self2.top)/scaleY:self2.bottom>parent.bottom&&(container.scrollTop+=(self2.bottom-parent.bottom)/scaleY)}(this.list,set2),set2}measureInfo(){let sel=this.dom.querySelector("[aria-selected]");if(!sel||!this.info)return null;let listRect=this.dom.getBoundingClientRect(),infoRect=this.info.getBoundingClientRect(),selRect=sel.getBoundingClientRect(),space2=this.space;if(!space2){let win=this.dom.ownerDocument.defaultView||window;space2={left:0,top:0,right:win.innerWidth,bottom:win.innerHeight}}return selRect.top>Math.min(space2.bottom,listRect.bottom)-10||selRect.bottom<Math.max(space2.top,listRect.top)+10?null:this.view.state.facet(completionConfig).positionInfo(this.view,listRect,selRect,infoRect,space2,this.dom)}placeInfo(pos){this.info&&(pos?(pos.style&&(this.info.style.cssText=pos.style),this.info.className="cm-tooltip cm-completionInfo "+(pos.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(options,id2,range){const ul=document.createElement("ul");ul.id=id2,ul.setAttribute("role","listbox"),ul.setAttribute("aria-expanded","true"),ul.setAttribute("aria-label",this.view.state.phrase("Completions"));let curSection=null;for(let i2=range.from;i2<range.to;i2++){let{completion:completion,match:match}=options[i2],{section:section2}=completion;if(section2){let name2="string"==typeof section2?section2:section2.name;if(name2!=curSection&&(i2>range.from||0==range.from))if(curSection=name2,"string"!=typeof section2&&section2.header)ul.appendChild(section2.header(section2));else{ul.appendChild(document.createElement("completion-section")).textContent=name2}}const li=ul.appendChild(document.createElement("li"));li.id=id2+"-"+i2,li.setAttribute("role","option");let cls=this.optionClass(completion);cls&&(li.className=cls);for(let source of this.optionContent){let node=source(completion,this.view.state,this.view,match);node&&li.appendChild(node)}}return range.from&&ul.classList.add("cm-completionListIncompleteTop"),range.to<options.length&&ul.classList.add("cm-completionListIncompleteBottom"),ul}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function completionTooltip(stateField,applyCompletion2){return view=>new CompletionTooltip(view,stateField,applyCompletion2)}function score(option){return 100*(option.boost||0)+(option.apply?10:0)+(option.info?5:0)+(option.type?1:0)}class CompletionDialog{constructor(options,attrs,tooltip,timestamp,selected,disabled){this.options=options,this.attrs=attrs,this.tooltip=tooltip,this.timestamp=timestamp,this.selected=selected,this.disabled=disabled}setSelected(selected,id2){return selected==this.selected||selected>=this.options.length?this:new CompletionDialog(this.options,makeAttrs(id2,selected),this.tooltip,this.timestamp,selected,this.disabled)}static build(active2,state,id2,prev,conf){let options=function(active2,state){let options=[],sections=null,addOption=option=>{options.push(option);let{section:section2}=option.completion;if(section2){sections||(sections=[]);let name2="string"==typeof section2?section2:section2.name;sections.some((s=>s.name==name2))||sections.push("string"==typeof section2?{name:name2}:section2)}};for(let a of active2)if(a.hasResult()){let getMatch=a.result.getMatch;if(!1===a.result.filter)for(let option of a.result.options)addOption(new Option(option,a.source,getMatch?getMatch(option):[],1e9-options.length));else{let matcher=new FuzzyMatcher(state.sliceDoc(a.from,a.to));for(let option of a.result.options)if(matcher.match(option.label)){let matched=option.displayLabel?getMatch?getMatch(option,matcher.matched):[]:matcher.matched;addOption(new Option(option,a.source,matched,matcher.score+(option.boost||0)))}}}if(sections){let sectionOrder=Object.create(null),pos=0,cmp=(a,b)=>{var _a2,_b;return(null!==(_a2=a.rank)&&void 0!==_a2?_a2:1e9)-(null!==(_b=b.rank)&&void 0!==_b?_b:1e9)||(a.name<b.name?-1:1)};for(let s of sections.sort(cmp))pos-=1e5,sectionOrder[s.name]=pos;for(let option of options){let{section:section2}=option.completion;section2&&(option.score+=sectionOrder["string"==typeof section2?section2:section2.name])}}let result=[],prev=null,compare2=state.facet(completionConfig).compareCompletions;for(let opt of options.sort(((a,b)=>b.score-a.score||compare2(a.completion,b.completion)))){let cur2=opt.completion;!prev||prev.label!=cur2.label||prev.detail!=cur2.detail||null!=prev.type&&null!=cur2.type&&prev.type!=cur2.type||prev.apply!=cur2.apply||prev.boost!=cur2.boost?result.push(opt):score(opt.completion)>score(prev)&&(result[result.length-1]=opt),prev=opt.completion}return result}(active2,state);if(!options.length)return prev&&active2.some((a=>1==a.state))?new CompletionDialog(prev.options,prev.attrs,prev.tooltip,prev.timestamp,prev.selected,!0):null;let selected=state.facet(completionConfig).selectOnOpen?0:-1;if(prev&&prev.selected!=selected&&-1!=prev.selected){let selectedValue=prev.options[prev.selected].completion;for(let i2=0;i2<options.length;i2++)if(options[i2].completion==selectedValue){selected=i2;break}}return new CompletionDialog(options,makeAttrs(id2,selected),{pos:active2.reduce(((a,b)=>b.hasResult()?Math.min(a,b.from):a),1e8),create:createTooltip,above:conf.aboveCursor},prev?prev.timestamp:Date.now(),selected,!1)}map(changes){return new CompletionDialog(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:changes.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class CompletionState{constructor(active2,id2,open){this.active=active2,this.id=id2,this.open=open}static start(){return new CompletionState(none,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(tr){let{state:state}=tr,conf=state.facet(completionConfig),active2=(conf.override||state.languageDataAt("autocomplete",cur(state)).map(asSource)).map((source=>(this.active.find((s=>s.source==source))||new ActiveSource(source,this.active.some((a=>0!=a.state))?1:0)).update(tr,conf)));active2.length==this.active.length&&active2.every(((a,i2)=>a==this.active[i2]))&&(active2=this.active);let open=this.open;open&&tr.docChanged&&(open=open.map(tr.changes)),tr.selection||active2.some((a=>a.hasResult()&&tr.changes.touchesRange(a.from,a.to)))||!function(a,b){if(a==b)return!0;for(let iA=0,iB=0;;){for(;iA<a.length&&!a[iA].hasResult;)iA++;for(;iB<b.length&&!b[iB].hasResult;)iB++;let endA=iA==a.length,endB=iB==b.length;if(endA||endB)return endA==endB;if(a[iA++].result!=b[iB++].result)return!1}}(active2,this.active)?open=CompletionDialog.build(active2,state,this.id,open,conf):open&&open.disabled&&!active2.some((a=>1==a.state))&&(open=null),!open&&active2.every((a=>1!=a.state))&&active2.some((a=>a.hasResult()))&&(active2=active2.map((a=>a.hasResult()?new ActiveSource(a.source,0):a)));for(let effect2 of tr.effects)effect2.is(setSelectedEffect)&&(open=open&&open.setSelected(effect2.value,this.id));return active2==this.active&&open==this.open?this:new CompletionState(active2,this.id,open)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:baseAttrs}}const baseAttrs={"aria-autocomplete":"list"};function makeAttrs(id2,selected){let result={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":id2};return selected>-1&&(result["aria-activedescendant"]=id2+"-"+selected),result}const none=[];function getUserEvent(tr){return tr.isUserEvent("input.type")?"input":tr.isUserEvent("delete.backward")?"delete":null}class ActiveSource{constructor(source,state,explicitPos=-1){this.source=source,this.state=state,this.explicitPos=explicitPos}hasResult(){return!1}update(tr,conf){let event=getUserEvent(tr),value=this;event?value=value.handleUserEvent(tr,event,conf):tr.docChanged?value=value.handleChange(tr):tr.selection&&0!=value.state&&(value=new ActiveSource(value.source,0));for(let effect2 of tr.effects)if(effect2.is(startCompletionEffect))value=new ActiveSource(value.source,1,effect2.value?cur(tr.state):-1);else if(effect2.is(closeCompletionEffect))value=new ActiveSource(value.source,0);else if(effect2.is(setActiveEffect))for(let active2 of effect2.value)active2.source==value.source&&(value=active2);return value}handleUserEvent(tr,type2,conf){return"delete"!=type2&&conf.activateOnTyping?new ActiveSource(this.source,1):this.map(tr.changes)}handleChange(tr){return tr.changes.touchesRange(cur(tr.startState))?new ActiveSource(this.source,0):this.map(tr.changes)}map(changes){return changes.empty||this.explicitPos<0?this:new ActiveSource(this.source,this.state,changes.mapPos(this.explicitPos))}}class ActiveResult extends ActiveSource{constructor(source,explicitPos,result,from,to){super(source,2,explicitPos),this.result=result,this.from=from,this.to=to}hasResult(){return!0}handleUserEvent(tr,type2,conf){var _a2;let from=tr.changes.mapPos(this.from),to=tr.changes.mapPos(this.to,1),pos=cur(tr.state);if((this.explicitPos<0?pos<=from:pos<this.from)||pos>to||"delete"==type2&&cur(tr.startState)==this.from)return new ActiveSource(this.source,"input"==type2&&conf.activateOnTyping?1:0);let updated,explicitPos=this.explicitPos<0?-1:tr.changes.mapPos(this.explicitPos);return function(validFor,state,from,to){if(!validFor)return!1;let text2=state.sliceDoc(from,to);return"function"==typeof validFor?validFor(text2,from,to,state):ensureAnchor(validFor,!0).test(text2)}(this.result.validFor,tr.state,from,to)?new ActiveResult(this.source,explicitPos,this.result,from,to):this.result.update&&(updated=this.result.update(this.result,from,to,new CompletionContext(tr.state,pos,explicitPos>=0)))?new ActiveResult(this.source,explicitPos,updated,updated.from,null!==(_a2=updated.to)&&void 0!==_a2?_a2:cur(tr.state)):new ActiveSource(this.source,1,explicitPos)}handleChange(tr){return tr.changes.touchesRange(this.from,this.to)?new ActiveSource(this.source,0):this.map(tr.changes)}map(mapping){return mapping.empty?this:new ActiveResult(this.source,this.explicitPos<0?-1:mapping.mapPos(this.explicitPos),this.result,mapping.mapPos(this.from),mapping.mapPos(this.to,1))}}const setActiveEffect=StateEffect.define({map:(sources,mapping)=>sources.map((s=>s.map(mapping)))}),setSelectedEffect=StateEffect.define(),completionState=StateField.define({create:()=>CompletionState.start(),update:(value,tr)=>value.update(tr),provide:f=>[showTooltip.from(f,(val=>val.tooltip)),EditorView$1.contentAttributes.from(f,(state=>state.attrs))]});function applyCompletion(view,option){const apply=option.completion.apply||option.completion.label;let result=view.state.field(completionState).active.find((a=>a.source==option.source));return result instanceof ActiveResult&&("string"==typeof apply?view.dispatch(Object.assign(Object.assign({},function(state,text2,from,to){let{main:main2}=state.selection,fromOff=from-main2.from,toOff=to-main2.from;return Object.assign(Object.assign({},state.changeByRange((range=>range!=main2&&from!=to&&state.sliceDoc(range.from+fromOff,range.from+toOff)!=state.sliceDoc(from,to)?{range:range}:{changes:{from:range.from+fromOff,to:to==main2.from?range.to:range.from+toOff,insert:text2},range:EditorSelection.cursor(range.from+fromOff+text2.length)}))),{scrollIntoView:!0,userEvent:"input.complete"})}(view.state,apply,result.from,result.to)),{annotations:pickedCompletion.of(option.completion)})):apply(view,option.completion,result.from,result.to),!0)}const createTooltip=completionTooltip(completionState,applyCompletion);function moveCompletionSelection(forward,by="option"){return view=>{let cState=view.state.field(completionState,!1);if(!cState||!cState.open||cState.open.disabled||Date.now()-cState.open.timestamp<view.state.facet(completionConfig).interactionDelay)return!1;let tooltip,step=1;"page"==by&&(tooltip=getTooltip(view,cState.open.tooltip))&&(step=Math.max(2,Math.floor(tooltip.dom.offsetHeight/tooltip.dom.querySelector("li").offsetHeight)-1));let{length:length}=cState.open.options,selected=cState.open.selected>-1?cState.open.selected+step*(forward?1:-1):forward?0:length-1;return selected<0?selected="page"==by?0:length-1:selected>=length&&(selected="page"==by?length-1:0),view.dispatch({effects:setSelectedEffect.of(selected)}),!0}}class RunningQuery{constructor(active2,context){this.active=active2,this.context=context,this.time=Date.now(),this.updates=[],this.done=void 0}}const completionPlugin=ViewPlugin$1.fromClass(class{constructor(view){this.view=view,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let active2 of view.state.field(completionState).active)1==active2.state&&this.startQuery(active2)}update(update2){let cState=update2.state.field(completionState);if(!update2.selectionSet&&!update2.docChanged&&update2.startState.field(completionState)==cState)return;let doesReset=update2.transactions.some((tr=>(tr.selection||tr.docChanged)&&!getUserEvent(tr)));for(let i2=0;i2<this.running.length;i2++){let query=this.running[i2];if(doesReset||query.updates.length+update2.transactions.length>50&&Date.now()-query.time>1e3){for(let handler of query.context.abortListeners)try{handler()}catch(e){logException$1(this.view.state,e)}query.context.abortListeners=null,this.running.splice(i2--,1)}else query.updates.push(...update2.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=cState.active.some((a=>1==a.state&&!this.running.some((q=>q.active.source==a.source))))?setTimeout((()=>this.startUpdate()),50):-1,0!=this.composing)for(let tr of update2.transactions)"input"==getUserEvent(tr)?this.composing=2:2==this.composing&&tr.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:state}=this.view,cState=state.field(completionState);for(let active2 of cState.active)1!=active2.state||this.running.some((r=>r.active.source==active2.source))||this.startQuery(active2)}startQuery(active2){let{state:state}=this.view,pos=cur(state),context=new CompletionContext(state,pos,active2.explicitPos==pos),pending=new RunningQuery(active2,context);this.running.push(pending),Promise.resolve(active2.source(context)).then((result=>{pending.context.aborted||(pending.done=result||null,this.scheduleAccept())}),(err=>{this.view.dispatch({effects:closeCompletionEffect.of(null)}),logException$1(this.view.state,err)}))}scheduleAccept(){this.running.every((q=>void 0!==q.done))?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout((()=>this.accept()),this.view.state.facet(completionConfig).updateSyncTime))}accept(){var _a2;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let updated=[],conf=this.view.state.facet(completionConfig);for(let i2=0;i2<this.running.length;i2++){let query=this.running[i2];if(void 0===query.done)continue;if(this.running.splice(i2--,1),query.done){let active2=new ActiveResult(query.active.source,query.active.explicitPos,query.done,query.done.from,null!==(_a2=query.done.to)&&void 0!==_a2?_a2:cur(query.updates.length?query.updates[0].startState:this.view.state));for(let tr of query.updates)active2=active2.update(tr,conf);if(active2.hasResult()){updated.push(active2);continue}}let current=this.view.state.field(completionState).active.find((a=>a.source==query.active.source));if(current&&1==current.state)if(null==query.done){let active2=new ActiveSource(query.active.source,0);for(let tr of query.updates)active2=active2.update(tr,conf);1!=active2.state&&updated.push(active2)}else this.startQuery(current)}updated.length&&this.view.dispatch({effects:setActiveEffect.of(updated)})}},{eventHandlers:{blur(event){let state=this.view.state.field(completionState,!1);if(state&&state.tooltip&&this.view.state.facet(completionConfig).closeOnBlur){let dialog=state.open&&getTooltip(this.view,state.open.tooltip);dialog&&dialog.dom.contains(event.relatedTarget)||this.view.dispatch({effects:closeCompletionEffect.of(null)})}},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout((()=>this.view.dispatch({effects:startCompletionEffect.of(!1)})),20),this.composing=0}}}),baseTheme$1=EditorView$1.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xb7\xb7\xb7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25cb'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25cc'"}},".cm-completionIcon-variable":{"&:after":{content:"'\ud835\udc65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\ud835\udc36'"}},".cm-completionIcon-type":{"&:after":{content:"'\ud835\udc61'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222a'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25a1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\ud83d\udd11\ufe0e'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25a2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),defaults={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},closeBracketEffect=StateEffect.define({map(value,mapping){let mapped=mapping.mapPos(value,-1,MapMode.TrackAfter);return null==mapped?void 0:mapped}}),closedBracket=new class extends RangeValue{};closedBracket.startSide=1,closedBracket.endSide=-1;const bracketState=StateField.define({create:()=>RangeSet.empty,update(value,tr){if(tr.selection){let line=tr.state.doc.lineAt(tr.selection.main.head);value=value.update({filter:from=>from>=line.from&&from<=line.to})}value=value.map(tr.changes);for(let effect2 of tr.effects)effect2.is(closeBracketEffect)&&(value=value.update({add:[closedBracket.range(effect2.value,effect2.value+1)]}));return value}});const definedClosing="()[]{}<>";function closing(ch){for(let i2=0;i2<definedClosing.length;i2+=2)if(definedClosing.charCodeAt(i2)==ch)return definedClosing.charAt(i2+1);return fromCodePoint(ch<128?ch:ch+1)}function config(state,pos){return state.languageDataAt("closeBrackets",pos)[0]||defaults}const android="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),inputHandler=EditorView$1.inputHandler.of(((view,from,to,insert2)=>{if((android?view.composing:view.compositionStarted)||view.state.readOnly)return!1;let sel=view.state.selection.main;if(insert2.length>2||2==insert2.length&&1==codePointSize(codePointAt(insert2,0))||from!=sel.from||to!=sel.to)return!1;let tr=function(state,bracket2){let conf=config(state,state.selection.main.head),tokens=conf.brackets||defaults.brackets;for(let tok of tokens){let closed=closing(codePointAt(tok,0));if(bracket2==tok)return closed==tok?handleSame(state,tok,tokens.indexOf(tok+tok+tok)>-1,conf):handleOpen(state,tok,closed,conf.before||defaults.before);if(bracket2==closed&&closedBracketAt(state,state.selection.main.from))return handleClose(state,tok,closed)}return null}(view.state,insert2);return!!tr&&(view.dispatch(tr),!0)})),closeBracketsKeymap=[{key:"Backspace",run:({state:state,dispatch:dispatch2})=>{if(state.readOnly)return!1;let tokens=config(state,state.selection.main.head).brackets||defaults.brackets,dont=null,changes=state.changeByRange((range=>{if(range.empty){let before=function(doc2,pos){let prev=doc2.sliceString(pos-2,pos);return codePointSize(codePointAt(prev,0))==prev.length?prev:prev.slice(1)}(state.doc,range.head);for(let token of tokens)if(token==before&&nextChar(state.doc,range.head)==closing(codePointAt(token,0)))return{changes:{from:range.head-token.length,to:range.head+token.length},range:EditorSelection.cursor(range.head-token.length)}}return{range:dont=range}}));return dont||dispatch2(state.update(changes,{scrollIntoView:!0,userEvent:"delete.backward"})),!dont}}];function closedBracketAt(state,pos){let found=!1;return state.field(bracketState).between(0,state.doc.length,(from=>{from==pos&&(found=!0)})),found}function nextChar(doc2,pos){let next=doc2.sliceString(pos,pos+2);return next.slice(0,codePointSize(codePointAt(next,0)))}function handleOpen(state,open,close,closeBefore){let dont=null,changes=state.changeByRange((range=>{if(!range.empty)return{changes:[{insert:open,from:range.from},{insert:close,from:range.to}],effects:closeBracketEffect.of(range.to+open.length),range:EditorSelection.range(range.anchor+open.length,range.head+open.length)};let next=nextChar(state.doc,range.head);return!next||/\s/.test(next)||closeBefore.indexOf(next)>-1?{changes:{insert:open+close,from:range.head},effects:closeBracketEffect.of(range.head+open.length),range:EditorSelection.cursor(range.head+open.length)}:{range:dont=range}}));return dont?null:state.update(changes,{scrollIntoView:!0,userEvent:"input.type"})}function handleClose(state,_open,close){let dont=null,changes=state.changeByRange((range=>range.empty&&nextChar(state.doc,range.head)==close?{changes:{from:range.head,to:range.head+close.length,insert:close},range:EditorSelection.cursor(range.head+close.length)}:dont={range:range}));return dont?null:state.update(changes,{scrollIntoView:!0,userEvent:"input.type"})}function handleSame(state,token,allowTriple,config2){let stringPrefixes=config2.stringPrefixes||defaults.stringPrefixes,dont=null,changes=state.changeByRange((range=>{if(!range.empty)return{changes:[{insert:token,from:range.from},{insert:token,from:range.to}],effects:closeBracketEffect.of(range.to+token.length),range:EditorSelection.range(range.anchor+token.length,range.head+token.length)};let start2,pos=range.head,next=nextChar(state.doc,pos);if(next==token){if(nodeStart(state,pos))return{changes:{insert:token+token,from:pos},effects:closeBracketEffect.of(pos+token.length),range:EditorSelection.cursor(pos+token.length)};if(closedBracketAt(state,pos)){let content2=allowTriple&&state.sliceDoc(pos,pos+3*token.length)==token+token+token?token+token+token:token;return{changes:{from:pos,to:pos+content2.length,insert:content2},range:EditorSelection.cursor(pos+content2.length)}}}else{if(allowTriple&&state.sliceDoc(pos-2*token.length,pos)==token+token&&(start2=canStartStringAt(state,pos-2*token.length,stringPrefixes))>-1&&nodeStart(state,start2))return{changes:{insert:token+token+token+token,from:pos},effects:closeBracketEffect.of(pos+token.length),range:EditorSelection.cursor(pos+token.length)};if(state.charCategorizer(pos)(next)!=CharCategory.Word&&canStartStringAt(state,pos,stringPrefixes)>-1&&!function(state,pos,quoteToken,prefixes){let node=syntaxTree(state).resolveInner(pos,-1),maxPrefix=prefixes.reduce(((m,p)=>Math.max(m,p.length)),0);for(let i2=0;i2<5;i2++){let start2=state.sliceDoc(node.from,Math.min(node.to,node.from+quoteToken.length+maxPrefix)),quotePos=start2.indexOf(quoteToken);if(!quotePos||quotePos>-1&&prefixes.indexOf(start2.slice(0,quotePos))>-1){let first=node.firstChild;for(;first&&first.from==node.from&&first.to-first.from>quoteToken.length+quotePos;){if(state.sliceDoc(first.to-quoteToken.length,first.to)==quoteToken)return!1;first=first.firstChild}return!0}let parent=node.to==pos&&node.parent;if(!parent)break;node=parent}return!1}(state,pos,token,stringPrefixes))return{changes:{insert:token+token,from:pos},effects:closeBracketEffect.of(pos+token.length),range:EditorSelection.cursor(pos+token.length)}}return{range:dont=range}}));return dont?null:state.update(changes,{scrollIntoView:!0,userEvent:"input.type"})}function nodeStart(state,pos){let tree=syntaxTree(state).resolveInner(pos+1);return tree.parent&&tree.from==pos}function canStartStringAt(state,pos,prefixes){let charCat=state.charCategorizer(pos);if(charCat(state.sliceDoc(pos-1,pos))!=CharCategory.Word)return pos;for(let prefix of prefixes){let start2=pos-prefix.length;if(state.sliceDoc(start2,pos)==prefix&&charCat(state.sliceDoc(start2-1,start2))!=CharCategory.Word)return start2}return-1}function autocompletion(config2={}){return[completionState,completionConfig.of(config2),completionPlugin,completionKeymapExt,baseTheme$1]}const completionKeymap=[{key:"Ctrl-Space",run:view=>!!view.state.field(completionState,!1)&&(view.dispatch({effects:startCompletionEffect.of(!0)}),!0)},{key:"Escape",run:view=>{let cState=view.state.field(completionState,!1);return!(!cState||!cState.active.some((a=>0!=a.state)))&&(view.dispatch({effects:closeCompletionEffect.of(null)}),!0)}},{key:"ArrowDown",run:moveCompletionSelection(!0)},{key:"ArrowUp",run:moveCompletionSelection(!1)},{key:"PageDown",run:moveCompletionSelection(!0,"page")},{key:"PageUp",run:moveCompletionSelection(!1,"page")},{key:"Enter",run:view=>{let cState=view.state.field(completionState,!1);return!(view.state.readOnly||!cState||!cState.open||cState.open.selected<0||cState.open.disabled||Date.now()-cState.open.timestamp<view.state.facet(completionConfig).interactionDelay)&&applyCompletion(view,cState.open.options[cState.open.selected])}}],completionKeymapExt=Prec.highest(keymap$1.computeN([completionConfig],(state=>state.facet(completionConfig).defaultKeymap?[completionKeymap]:[])));class SelectedDiagnostic{constructor(from,to,diagnostic){this.from=from,this.to=to,this.diagnostic=diagnostic}}class LintState{constructor(diagnostics,panel,selected){this.diagnostics=diagnostics,this.panel=panel,this.selected=selected}static init(diagnostics,panel,state){let markedDiagnostics=diagnostics,diagnosticFilter=state.facet(lintConfig).markerFilter;diagnosticFilter&&(markedDiagnostics=diagnosticFilter(markedDiagnostics));let ranges=Decoration$1.set(markedDiagnostics.map((d=>d.from==d.to||d.from==d.to-1&&state.doc.lineAt(d.from).to==d.from?Decoration$1.widget({widget:new DiagnosticWidget(d),diagnostic:d}).range(d.from):Decoration$1.mark({attributes:{class:"cm-lintRange cm-lintRange-"+d.severity+(d.markClass?" "+d.markClass:"")},diagnostic:d}).range(d.from,d.to))),!0);return new LintState(ranges,panel,findDiagnostic(ranges))}}function findDiagnostic(diagnostics,diagnostic=null,after=0){let found=null;return diagnostics.between(after,1e9,((from,to,{spec:spec})=>{if(!diagnostic||spec.diagnostic==diagnostic)return found=new SelectedDiagnostic(from,to,spec.diagnostic),!1})),found}const setDiagnosticsEffect=StateEffect.define(),togglePanel=StateEffect.define(),movePanelSelection=StateEffect.define(),lintState=StateField.define({create:()=>new LintState(Decoration$1.none,null,null),update(value,tr){if(tr.docChanged){let mapped=value.diagnostics.map(tr.changes),selected=null;if(value.selected){let selPos=tr.changes.mapPos(value.selected.from,1);selected=findDiagnostic(mapped,value.selected.diagnostic,selPos)||findDiagnostic(mapped,null,selPos)}value=new LintState(mapped,value.panel,selected)}for(let effect2 of tr.effects)effect2.is(setDiagnosticsEffect)?value=LintState.init(effect2.value,value.panel,tr.state):effect2.is(togglePanel)?value=new LintState(value.diagnostics,effect2.value?LintPanel.open:null,value.selected):effect2.is(movePanelSelection)&&(value=new LintState(value.diagnostics,value.panel,effect2.value));return value},provide:f=>[showPanel.from(f,(val=>val.panel)),EditorView$1.decorations.from(f,(s=>s.diagnostics))]}),activeMark=Decoration$1.mark({class:"cm-lintRange cm-lintRange-active"});function lintTooltip(view,pos,side){let{diagnostics:diagnostics}=view.state.field(lintState),found=[],stackStart=2e8,stackEnd=0;diagnostics.between(pos-(side<0?1:0),pos+(side>0?1:0),((from,to,{spec:spec})=>{pos>=from&&pos<=to&&(from==to||(pos>from||side>0)&&(pos<to||side<0))&&(found.push(spec.diagnostic),stackStart=Math.min(from,stackStart),stackEnd=Math.max(to,stackEnd))}));let diagnosticFilter=view.state.facet(lintConfig).tooltipFilter;return diagnosticFilter&&(found=diagnosticFilter(found)),found.length?{pos:stackStart,end:stackEnd,above:view.state.doc.lineAt(stackStart).to<stackEnd,create:()=>({dom:diagnosticsTooltip(view,found)})}:null}function diagnosticsTooltip(view,diagnostics){return crelt("ul",{class:"cm-tooltip-lint"},diagnostics.map((d=>renderDiagnostic(view,d,!1))))}const closeLintPanel=view=>{let field=view.state.field(lintState,!1);return!(!field||!field.panel)&&(view.dispatch({effects:togglePanel.of(!1)}),!0)},lintKeymap=[{key:"Mod-Shift-m",run:view=>{let field=view.state.field(lintState,!1);var state,effects;field&&field.panel||view.dispatch({effects:(state=view.state,effects=[togglePanel.of(!0)],state.field(lintState,!1)?effects:effects.concat(StateEffect.appendConfig.of(lintExtensions)))});let panel=getPanel(view,LintPanel.open);return panel&&panel.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:view=>{let field=view.state.field(lintState,!1);if(!field)return!1;let sel=view.state.selection.main,next=field.diagnostics.iter(sel.to+1);return!(!next.value&&(next=field.diagnostics.iter(0),!next.value||next.from==sel.from&&next.to==sel.to))&&(view.dispatch({selection:{anchor:next.from,head:next.to},scrollIntoView:!0}),!0)}}],lintConfig=Facet.define({combine:input=>Object.assign({sources:input.map((i2=>i2.source))},combineConfig(input.map((i2=>i2.config)),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(a,b)=>a?b?u=>a(u)||b(u):a:b}))});function assignKeys(actions){let assigned=[];if(actions)actions:for(let{name:name2}of actions){for(let i2=0;i2<name2.length;i2++){let ch=name2[i2];if(/[a-zA-Z]/.test(ch)&&!assigned.some((c=>c.toLowerCase()==ch.toLowerCase()))){assigned.push(ch);continue actions}}assigned.push("")}return assigned}function renderDiagnostic(view,diagnostic,inPanel){var _a2;let keys2=inPanel?assignKeys(diagnostic.actions):[];return crelt("li",{class:"cm-diagnostic cm-diagnostic-"+diagnostic.severity},crelt("span",{class:"cm-diagnosticText"},diagnostic.renderMessage?diagnostic.renderMessage():diagnostic.message),null===(_a2=diagnostic.actions)||void 0===_a2?void 0:_a2.map(((action,i2)=>{let fired=!1,click=e=>{if(e.preventDefault(),fired)return;fired=!0;let found=findDiagnostic(view.state.field(lintState).diagnostics,diagnostic);found&&action.apply(view,found.from,found.to)},{name:name2}=action,keyIndex=keys2[i2]?name2.indexOf(keys2[i2]):-1,nameElt=keyIndex<0?name2:[name2.slice(0,keyIndex),crelt("u",name2.slice(keyIndex,keyIndex+1)),name2.slice(keyIndex+1)];return crelt("button",{type:"button",class:"cm-diagnosticAction",onclick:click,onmousedown:click,"aria-label":` Action: ${name2}${keyIndex<0?"":` (access key "${keys2[i2]})"`}.`},nameElt)})),diagnostic.source&&crelt("div",{class:"cm-diagnosticSource"},diagnostic.source))}class DiagnosticWidget extends WidgetType$1{constructor(diagnostic){super(),this.diagnostic=diagnostic}eq(other){return other.diagnostic==this.diagnostic}toDOM(){return crelt("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class PanelItem{constructor(view,diagnostic){this.diagnostic=diagnostic,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=renderDiagnostic(view,diagnostic,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class LintPanel{constructor(view){this.view=view,this.items=[];this.list=crelt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:event=>{if(27==event.keyCode)closeLintPanel(this.view),this.view.focus();else if(38==event.keyCode||33==event.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==event.keyCode||34==event.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==event.keyCode)this.moveSelection(0);else if(35==event.keyCode)this.moveSelection(this.items.length-1);else if(13==event.keyCode)this.view.focus();else{if(!(event.keyCode>=65&&event.keyCode<=90&&this.selectedIndex>=0))return;{let{diagnostic:diagnostic}=this.items[this.selectedIndex],keys2=assignKeys(diagnostic.actions);for(let i2=0;i2<keys2.length;i2++)if(keys2[i2].toUpperCase().charCodeAt(0)==event.keyCode){let found=findDiagnostic(this.view.state.field(lintState).diagnostics,diagnostic);found&&diagnostic.actions[i2].apply(view,found.from,found.to)}}}event.preventDefault()},onclick:event=>{for(let i2=0;i2<this.items.length;i2++)this.items[i2].dom.contains(event.target)&&this.moveSelection(i2)}}),this.dom=crelt("div",{class:"cm-panel-lint"},this.list,crelt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>closeLintPanel(this.view)},"\xd7")),this.update()}get selectedIndex(){let selected=this.view.state.field(lintState).selected;if(!selected)return-1;for(let i2=0;i2<this.items.length;i2++)if(this.items[i2].diagnostic==selected.diagnostic)return i2;return-1}update(){let{diagnostics:diagnostics,selected:selected}=this.view.state.field(lintState),i2=0,needsSync=!1,newSelectedItem=null;for(diagnostics.between(0,this.view.state.doc.length,((_start,_end,{spec:spec})=>{let item,found=-1;for(let j=i2;j<this.items.length;j++)if(this.items[j].diagnostic==spec.diagnostic){found=j;break}found<0?(item=new PanelItem(this.view,spec.diagnostic),this.items.splice(i2,0,item),needsSync=!0):(item=this.items[found],found>i2&&(this.items.splice(i2,found-i2),needsSync=!0)),selected&&item.diagnostic==selected.diagnostic?item.dom.hasAttribute("aria-selected")||(item.dom.setAttribute("aria-selected","true"),newSelectedItem=item):item.dom.hasAttribute("aria-selected")&&item.dom.removeAttribute("aria-selected"),i2++}));i2<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)needsSync=!0,this.items.pop();0==this.items.length&&(this.items.push(new PanelItem(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),needsSync=!0),newSelectedItem?(this.list.setAttribute("aria-activedescendant",newSelectedItem.id),this.view.requestMeasure({key:this,read:()=>({sel:newSelectedItem.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:sel,panel:panel})=>{let scaleY=panel.height/this.list.offsetHeight;sel.top<panel.top?this.list.scrollTop-=(panel.top-sel.top)/scaleY:sel.bottom>panel.bottom&&(this.list.scrollTop+=(sel.bottom-panel.bottom)/scaleY)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),needsSync&&this.sync()}sync(){let domPos=this.list.firstChild;function rm2(){let prev=domPos;domPos=prev.nextSibling,prev.remove()}for(let item of this.items)if(item.dom.parentNode==this.list){for(;domPos!=item.dom;)rm2();domPos=item.dom.nextSibling}else this.list.insertBefore(item.dom,domPos);for(;domPos;)rm2()}moveSelection(selectedIndex){if(this.selectedIndex<0)return;let selection2=findDiagnostic(this.view.state.field(lintState).diagnostics,this.items[selectedIndex].diagnostic);selection2&&this.view.dispatch({selection:{anchor:selection2.from,head:selection2.to},scrollIntoView:!0,effects:movePanelSelection.of(selection2)})}static open(view){return new LintPanel(view)}}function underline(color2){return function(content2,attrs='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${attrs}>${encodeURIComponent(content2)}</svg>')`}(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${color2}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const baseTheme=EditorView$1.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:underline("#d11")},".cm-lintRange-warning":{backgroundImage:underline("orange")},".cm-lintRange-info":{backgroundImage:underline("#999")},".cm-lintRange-hint":{backgroundImage:underline("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),lintExtensions=[lintState,EditorView$1.decorations.compute([lintState],(state=>{let{selected:selected,panel:panel}=state.field(lintState);return selected&&panel&&selected.from!=selected.to?Decoration$1.set([activeMark.range(selected.from,selected.to)]):Decoration$1.none})),hoverTooltip(lintTooltip,{hideOn:function(tr,tooltip){let line=tr.startState.doc.lineAt(tooltip.pos);return!(!tr.effects.some((e=>e.is(setDiagnosticsEffect)))&&!tr.changes.touchesRange(line.from,line.to))}}),baseTheme],basicSetup=(()=>[lineNumbers(),activeLineGutterHighlighter,highlightSpecialChars(),history(),foldGutter(),drawSelection(),[dropCursorPos,drawDropCursor],EditorState.allowMultipleSelections.of(!0),EditorState.transactionFilter.of((tr=>{if(!tr.docChanged||!tr.isUserEvent("input.type")&&!tr.isUserEvent("input.complete"))return tr;let rules=tr.startState.languageDataAt("indentOnInput",tr.startState.selection.main.head);if(!rules.length)return tr;let doc2=tr.newDoc,{head:head}=tr.newSelection.main,line=doc2.lineAt(head);if(head>line.from+200)return tr;let lineStart=doc2.sliceString(line.from,head);if(!rules.some((r=>r.test(lineStart))))return tr;let{state:state}=tr,last=-1,changes=[];for(let{head:head2}of state.selection.ranges){let line2=state.doc.lineAt(head2);if(line2.from==last)continue;last=line2.from;let indent=getIndentation(state,line2.from);if(null==indent)continue;let cur2=/^\s*/.exec(line2.text)[0],norm=indentString(state,indent);cur2!=norm&&changes.push({from:line2.from,to:line2.from+cur2.length,insert:norm})}return changes.length?[tr,{changes:changes,sequential:!0}]:tr})),syntaxHighlighting(defaultHighlightStyle,{fallback:!0}),bracketMatching(),[inputHandler,bracketState],autocompletion(),rectangularSelection(),crosshairCursor(),activeLineHighlighter,highlightSelectionMatches(),keymap$1.of([...closeBracketsKeymap,...defaultKeymap,...searchKeymap,...historyKeymap,...foldKeymap,...completionKeymap,...lintKeymap])])();function create_else_block$4(ctx){let div2,div1,t2,pre,t3,div2_class_value;return{c(){div2=element("div"),div1=element("div"),div1.innerHTML='<div class="scm-loading__spinner svelte-kcx0g9"></div> <p class="scm-loading__text svelte-kcx0g9">Loading editor...</p>',t2=space(),pre=element("pre"),t3=text(ctx[0]),attr(div1,"class","scm-waiting__loading scm-loading svelte-kcx0g9"),attr(pre,"class","scm-pre cm-editor svelte-kcx0g9"),attr(div2,"class",div2_class_value="scm-waiting "+ctx[1]+" svelte-kcx0g9")},m(target,anchor){insert$1(target,div2,anchor),append(div2,div1),append(div2,t2),append(div2,pre),append(pre,t3)},p(ctx2,dirty){1&dirty&&set_data(t3,ctx2[0]),2&dirty&&div2_class_value!==(div2_class_value="scm-waiting "+ctx2[1]+" svelte-kcx0g9")&&attr(div2,"class",div2_class_value)},d(detaching){detaching&&detach(div2)}}}function create_if_block$c(ctx){let div,div_class_value;return{c(){div=element("div"),attr(div,"class",div_class_value="codemirror-wrapper "+ctx[1]+" svelte-kcx0g9")},m(target,anchor){insert$1(target,div,anchor),ctx[17](div)},p(ctx2,dirty){2&dirty&&div_class_value!==(div_class_value="codemirror-wrapper "+ctx2[1]+" svelte-kcx0g9")&&attr(div,"class",div_class_value)},d(detaching){detaching&&detach(div),ctx[17](null)}}}function create_fragment$f(ctx){let if_block_anchor;let if_block=(ctx[3]?create_if_block$c:create_else_block$4)(ctx);return{c(){if_block.c(),if_block_anchor=empty$1()},m(target,anchor){if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor)},p(ctx2,[dirty]){if_block.p(ctx2,dirty)},i:noop,o:noop,d(detaching){detaching&&detach(if_block_anchor),if_block.d(detaching)}}}function instance$f($$self,$$props,$$invalidate){let state_extensions,{class:classes=""}=$$props,{value:value=""}=$$props,{basic:basic=!0}=$$props,{lang:lang}=$$props,{theme:theme2}=$$props,{extensions:extensions=[]}=$$props,{useTab:useTab=!0}=$$props,{tabSize:tabSize=2}=$$props,{styles:styles2}=$$props,{lineWrapping:lineWrapping=!1}=$$props,{editable:editable2=!0}=$$props,{readonly:readonly=!1}=$$props,{placeholder:placeholder$12}=$$props;const is_browser="undefined"!=typeof window,dispatch2=function(){const component=get_current_component();return(type2,detail,{cancelable:cancelable=!1}={})=>{const callbacks=component.$$.callbacks[type2];if(callbacks){const event=custom_event(type2,detail,{cancelable:cancelable});return callbacks.slice().forEach((fn=>{fn.call(component,event)})),!event.defaultPrevented}return!0}}();let element2,view,update_from_prop=!1,update_from_state=!1,first_config=!0,first_update=!0;var fn;function handle_change(){const new_value=view.state.doc.toString();new_value!==value&&(update_from_state=!0,$$invalidate(0,value=new_value),dispatch2("change",value))}function create_editor_state(value2){return EditorState.create({doc:value2??void 0,extensions:state_extensions})}function get_base_extensions(basic2,useTab2,tabSize2,lineWrapping2,placeholder$13,editable3,readonly2,lang2){const extensions2=[indentUnit.of(" ".repeat(tabSize2)),EditorView.editable.of(editable3),EditorState.readOnly.of(readonly2)];var content2;return basic2&&extensions2.push(basicSetup),useTab2&&extensions2.push(keymap.of([indentWithTab])),placeholder$13&&extensions2.push((content2=placeholder$13,ViewPlugin.fromClass(class{constructor(view){this.view=view,this.placeholder=content2?Decoration.set([Decoration.widget({widget:new Placeholder(content2),side:1}).range(0)]):Decoration.none}get decorations(){return this.view.state.doc.length?Decoration.none:this.placeholder}},{decorations:v=>v.decorations}))),lang2&&extensions2.push(lang2),lineWrapping2&&extensions2.push(EditorView.lineWrapping),extensions2}function get_theme(theme3,styles3){const extensions2=[];return styles3&&extensions2.push(EditorView.theme(styles3)),theme3&&extensions2.push(theme3),extensions2}return onMount((()=>$$invalidate(15,view=function(){const on_change=function(func2,threshold,execAsap=!1){let timeout;return function(...args){const self2=this;timeout?clearTimeout(timeout):execAsap&&func2.apply(self2,args),timeout=setTimeout((function(){execAsap||func2.apply(self2,args),timeout=null}),threshold||100)}}(handle_change,300);return new EditorView({parent:element2,state:create_editor_state(value),dispatch(transaction){view.update([transaction]),!update_from_prop&&transaction.docChanged&&on_change()}})}()))),fn=()=>null==view?void 0:view.destroy(),get_current_component().$$.on_destroy.push(fn),$$self.$$set=$$props2=>{"class"in $$props2&&$$invalidate(1,classes=$$props2.class),"value"in $$props2&&$$invalidate(0,value=$$props2.value),"basic"in $$props2&&$$invalidate(4,basic=$$props2.basic),"lang"in $$props2&&$$invalidate(5,lang=$$props2.lang),"theme"in $$props2&&$$invalidate(6,theme2=$$props2.theme),"extensions"in $$props2&&$$invalidate(7,extensions=$$props2.extensions),"useTab"in $$props2&&$$invalidate(8,useTab=$$props2.useTab),"tabSize"in $$props2&&$$invalidate(9,tabSize=$$props2.tabSize),"styles"in $$props2&&$$invalidate(10,styles2=$$props2.styles),"lineWrapping"in $$props2&&$$invalidate(11,lineWrapping=$$props2.lineWrapping),"editable"in $$props2&&$$invalidate(12,editable2=$$props2.editable),"readonly"in $$props2&&$$invalidate(13,readonly=$$props2.readonly),"placeholder"in $$props2&&$$invalidate(14,placeholder$12=$$props2.placeholder)},$$self.$$.update=()=>{var value2;32752&$$self.$$.dirty&&$$invalidate(16,state_extensions=[...get_base_extensions(basic,useTab,tabSize,lineWrapping,placeholder$12,editable2,readonly,lang),...get_theme(theme2,styles2),...extensions]),32769&$$self.$$.dirty&&view&&(value2=value,first_update?first_update=!1:update_from_state?update_from_state=!1:(update_from_prop=!0,view.setState(create_editor_state(value2)),update_from_prop=!1)),98304&$$self.$$.dirty&&view&&state_extensions&&(first_config?first_config=!1:view.dispatch({effects:StateEffect.reconfigure.of(state_extensions)}))},[value,classes,element2,is_browser,basic,lang,theme2,extensions,useTab,tabSize,styles2,lineWrapping,editable2,readonly,placeholder$12,view,state_extensions,function($$value){binding_callbacks[$$value?"unshift":"push"]((()=>{element2=$$value,$$invalidate(2,element2)}))}]}class CodeMirror extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$f,create_fragment$f,safe_not_equal,{class:1,value:0,basic:4,lang:5,theme:6,extensions:7,useTab:8,tabSize:9,styles:10,lineWrapping:11,editable:12,readonly:13,placeholder:14})}}const oneDark=[EditorView.theme({"&":{color:"#abb2bf",backgroundColor:"#282c34"},".cm-content":{caretColor:"#528bff"},".cm-cursor, .cm-dropCursor":{borderLeftColor:"#528bff"},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"#3E4451"},".cm-panels":{backgroundColor:"#21252b",color:"#abb2bf"},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:"#282c34",color:"#7d8799",border:"none"},".cm-activeLineGutter":{backgroundColor:"#2c313a"},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:"#353a42"},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:"#353a42",borderBottomColor:"#353a42"},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:"#2c313a",color:"#abb2bf"}}},{dark:!0}),syntaxHighlighting(HighlightStyle.define([{tag:tags.keyword,color:"#c678dd"},{tag:[tags.name,tags.deleted,tags.character,tags.propertyName,tags.macroName],color:"#e06c75"},{tag:[tags.function(tags.variableName),tags.labelName],color:"#61afef"},{tag:[tags.color,tags.constant(tags.name),tags.standard(tags.name)],color:"#d19a66"},{tag:[tags.definition(tags.name),tags.separator],color:"#abb2bf"},{tag:[tags.typeName,tags.className,tags.number,tags.changed,tags.annotation,tags.modifier,tags.self,tags.namespace],color:"#e5c07b"},{tag:[tags.operator,tags.operatorKeyword,tags.url,tags.escape,tags.regexp,tags.link,tags.special(tags.string)],color:"#56b6c2"},{tag:[tags.meta,tags.comment],color:"#7d8799"},{tag:tags.strong,fontWeight:"bold"},{tag:tags.emphasis,fontStyle:"italic"},{tag:tags.strikethrough,textDecoration:"line-through"},{tag:tags.link,color:"#7d8799",textDecoration:"underline"},{tag:tags.heading,fontWeight:"bold",color:"#e06c75"},{tag:[tags.atom,tags.bool,tags.special(tags.variableName)],color:"#d19a66"},{tag:[tags.processingInstruction,tags.string,tags.inserted],color:"#98c379"},{tag:tags.invalid,color:"#ffffff"}]))];class Stack{constructor(p,stack,state,reducePos,pos,score2,buffer,bufferBase,curContext,lookAhead=0,parent){this.p=p,this.stack=stack,this.state=state,this.reducePos=reducePos,this.pos=pos,this.score=score2,this.buffer=buffer,this.bufferBase=bufferBase,this.curContext=curContext,this.lookAhead=lookAhead,this.parent=parent}toString(){return`[${this.stack.filter(((_,i2)=>i2%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(p,state,pos=0){let cx=p.parser.context;return new Stack(p,[],state,pos,pos,0,[],0,cx?new StackContext(cx,cx.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(state,start2){this.stack.push(this.state,start2,this.bufferBase+this.buffer.length),this.state=state}reduce(action){var _a2;let depth=action>>19,type2=65535&action,{parser:parser2}=this.p,dPrec=parser2.dynamicPrecedence(type2);if(dPrec&&(this.score+=dPrec),0==depth)return this.pushState(parser2.getGoto(this.state,type2,!0),this.reducePos),type2<parser2.minRepeatTerm&&this.storeNode(type2,this.reducePos,this.reducePos,4,!0),void this.reduceContext(type2,this.reducePos);let base2=this.stack.length-3*(depth-1)-(262144&action?6:0),start2=base2?this.stack[base2-2]:this.p.ranges[0].from,size=this.reducePos-start2;size>=2e3&&!(null===(_a2=this.p.parser.nodeSet.types[type2])||void 0===_a2?void 0:_a2.isAnonymous)&&(start2==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=size):this.p.lastBigReductionSize<size&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=start2,this.p.lastBigReductionSize=size));let bufferBase=base2?this.stack[base2-1]:0,count=this.bufferBase+this.buffer.length-bufferBase;if(type2<parser2.minRepeatTerm||131072&action){let pos=parser2.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(type2,start2,pos,count+4,!0)}if(262144&action)this.state=this.stack[base2];else{let baseStateID=this.stack[base2-3];this.state=parser2.getGoto(baseStateID,type2,!0)}for(;this.stack.length>base2;)this.stack.pop();this.reduceContext(type2,start2)}storeNode(term,start2,end2,size=4,isReduce=!1){if(0==term&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let cur2=this,top2=this.buffer.length;if(0==top2&&cur2.parent&&(top2=cur2.bufferBase-cur2.parent.bufferBase,cur2=cur2.parent),top2>0&&0==cur2.buffer[top2-4]&&cur2.buffer[top2-1]>-1){if(start2==end2)return;if(cur2.buffer[top2-2]>=start2)return void(cur2.buffer[top2-2]=end2)}}if(isReduce&&this.pos!=end2){let index=this.buffer.length;if(index>0&&0!=this.buffer[index-4])for(;index>0&&this.buffer[index-2]>end2;)this.buffer[index]=this.buffer[index-4],this.buffer[index+1]=this.buffer[index-3],this.buffer[index+2]=this.buffer[index-2],this.buffer[index+3]=this.buffer[index-1],index-=4,size>4&&(size-=4);this.buffer[index]=term,this.buffer[index+1]=start2,this.buffer[index+2]=end2,this.buffer[index+3]=size}else this.buffer.push(term,start2,end2,size)}shift(action,type2,start2,end2){if(131072&action)this.pushState(65535&action,this.pos);else if(0==(262144&action)){let nextState=action,{parser:parser2}=this.p;(end2>this.pos||type2<=parser2.maxNode)&&(this.pos=end2,parser2.stateFlag(nextState,1)||(this.reducePos=end2)),this.pushState(nextState,start2),this.shiftContext(type2,start2),type2<=parser2.maxNode&&this.buffer.push(type2,start2,end2,4)}else this.pos=end2,this.shiftContext(type2,start2),type2<=this.p.parser.maxNode&&this.buffer.push(type2,start2,end2,4)}apply(action,next,nextStart,nextEnd){65536&action?this.reduce(action):this.shift(action,next,nextStart,nextEnd)}useNode(value,next){let index=this.p.reused.length-1;(index<0||this.p.reused[index]!=value)&&(this.p.reused.push(value),index++);let start2=this.pos;this.reducePos=this.pos=start2+value.length,this.pushState(next,start2),this.buffer.push(index,start2,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,value,this,this.p.stream.reset(this.pos-value.length)))}split(){let parent=this,off=parent.buffer.length;for(;off>0&&parent.buffer[off-2]>parent.reducePos;)off-=4;let buffer=parent.buffer.slice(off),base2=parent.bufferBase+off;for(;parent&&base2==parent.bufferBase;)parent=parent.parent;return new Stack(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,buffer,base2,this.curContext,this.lookAhead,parent)}recoverByDelete(next,nextEnd){let isNode=next<=this.p.parser.maxNode;isNode&&this.storeNode(next,this.pos,nextEnd,4),this.storeNode(0,this.pos,nextEnd,isNode?8:4),this.pos=this.reducePos=nextEnd,this.score-=190}canShift(term){for(let sim=new SimulatedStack(this);;){let action=this.p.parser.stateSlot(sim.state,4)||this.p.parser.hasAction(sim.state,term);if(0==action)return!1;if(0==(65536&action))return!0;sim.reduce(action)}}recoverByInsert(next){if(this.stack.length>=300)return[];let nextStates=this.p.parser.nextStates(this.state);if(nextStates.length>8||this.stack.length>=120){let best=[];for(let s,i2=0;i2<nextStates.length;i2+=2)(s=nextStates[i2+1])!=this.state&&this.p.parser.hasAction(s,next)&&best.push(nextStates[i2],s);if(this.stack.length<120)for(let i2=0;best.length<8&&i2<nextStates.length;i2+=2){let s=nextStates[i2+1];best.some(((v,i3)=>1&i3&&v==s))||best.push(nextStates[i2],s)}nextStates=best}let result=[];for(let i2=0;i2<nextStates.length&&result.length<4;i2+=2){let s=nextStates[i2+1];if(s==this.state)continue;let stack=this.split();stack.pushState(s,this.pos),stack.storeNode(0,stack.pos,stack.pos,4,!0),stack.shiftContext(nextStates[i2],this.pos),stack.reducePos=this.pos,stack.score-=200,result.push(stack)}return result}forceReduce(){let{parser:parser2}=this.p,reduce=parser2.stateSlot(this.state,5);if(0==(65536&reduce))return!1;if(!parser2.validAction(this.state,reduce)){let depth=reduce>>19,term=65535&reduce,target=this.stack.length-3*depth;if(target<0||parser2.getGoto(this.stack[target],term,!1)<0){let backup=this.findForcedReduction();if(null==backup)return!1;reduce=backup}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(reduce),!0}findForcedReduction(){let{parser:parser2}=this.p,seen=[],explore=(state,depth)=>{if(!seen.includes(state))return seen.push(state),parser2.allActions(state,(action=>{if(393216&action);else if(65536&action){let rDepth=(action>>19)-depth;if(rDepth>1){let term=65535&action,target=this.stack.length-3*rDepth;if(target>=0&&parser2.getGoto(this.stack[target],term,!1)>=0)return rDepth<<19|65536|term}}else{let found=explore(action,depth+1);if(null!=found)return found}}))};return explore(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:parser2}=this.p;return 65535==parser2.data[parser2.stateSlot(this.state,1)]&&!parser2.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(other){if(this.state!=other.state||this.stack.length!=other.stack.length)return!1;for(let i2=0;i2<this.stack.length;i2+=3)if(this.stack[i2]!=other.stack[i2])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(dialectID){return this.p.parser.dialect.flags[dialectID]}shiftContext(term,start2){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,term,this,this.p.stream.reset(start2)))}reduceContext(term,start2){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,term,this,this.p.stream.reset(start2)))}emitContext(){let last=this.buffer.length-1;(last<0||-3!=this.buffer[last])&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let last=this.buffer.length-1;(last<0||-4!=this.buffer[last])&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(context){if(context!=this.curContext.context){let newCx=new StackContext(this.curContext.tracker,context);newCx.hash!=this.curContext.hash&&this.emitContext(),this.curContext=newCx}}setLookAhead(lookAhead){lookAhead>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=lookAhead)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class StackContext{constructor(tracker,context){this.tracker=tracker,this.context=context,this.hash=tracker.strict?tracker.hash(context):0}}class SimulatedStack{constructor(start2){this.start=start2,this.state=start2.state,this.stack=start2.stack,this.base=this.stack.length}reduce(action){let term=65535&action,depth=action>>19;0==depth?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(depth-1);let goto=this.start.p.parser.getGoto(this.stack[this.base-3],term,!0);this.state=goto}}class StackBufferCursor{constructor(stack,pos,index){this.stack=stack,this.pos=pos,this.index=index,this.buffer=stack.buffer,0==this.index&&this.maybeNext()}static create(stack,pos=stack.bufferBase+stack.buffer.length){return new StackBufferCursor(stack,pos,pos-stack.bufferBase)}maybeNext(){let next=this.stack.parent;null!=next&&(this.index=this.stack.bufferBase-next.bufferBase,this.stack=next,this.buffer=next.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new StackBufferCursor(this.stack,this.pos,this.index)}}function decodeArray(input,Type=Uint16Array){if("string"!=typeof input)return input;let array=null;for(let pos=0,out=0;pos<input.length;){let value=0;for(;;){let next=input.charCodeAt(pos++),stop=!1;if(126==next){value=65535;break}next>=92&&next--,next>=34&&next--;let digit=next-32;if(digit>=46&&(digit-=46,stop=!0),value+=digit,stop)break;value*=46}array?array[out++]=value:array=new Type(value)}return array}class CachedToken{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const nullToken=new CachedToken;class InputStream{constructor(input,ranges){this.input=input,this.ranges=ranges,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=nullToken,this.rangeIndex=0,this.pos=this.chunkPos=ranges[0].from,this.range=ranges[0],this.end=ranges[ranges.length-1].to,this.readNext()}resolveOffset(offset2,assoc){let range=this.range,index=this.rangeIndex,pos=this.pos+offset2;for(;pos<range.from;){if(!index)return null;let next=this.ranges[--index];pos-=range.from-next.to,range=next}for(;assoc<0?pos>range.to:pos>=range.to;){if(index==this.ranges.length-1)return null;let next=this.ranges[++index];pos+=next.from-range.to,range=next}return pos}clipPos(pos){if(pos>=this.range.from&&pos<this.range.to)return pos;for(let range of this.ranges)if(range.to>pos)return Math.max(pos,range.from);return this.end}peek(offset2){let pos,result,idx=this.chunkOff+offset2;if(idx>=0&&idx<this.chunk.length)pos=this.pos+offset2,result=this.chunk.charCodeAt(idx);else{let resolved=this.resolveOffset(offset2,1);if(null==resolved)return-1;if(pos=resolved,pos>=this.chunk2Pos&&pos<this.chunk2Pos+this.chunk2.length)result=this.chunk2.charCodeAt(pos-this.chunk2Pos);else{let i2=this.rangeIndex,range=this.range;for(;range.to<=pos;)range=this.ranges[++i2];this.chunk2=this.input.chunk(this.chunk2Pos=pos),pos+this.chunk2.length>range.to&&(this.chunk2=this.chunk2.slice(0,range.to-pos)),result=this.chunk2.charCodeAt(0)}}return pos>=this.token.lookAhead&&(this.token.lookAhead=pos+1),result}acceptToken(token,endOffset=0){let end2=endOffset?this.resolveOffset(endOffset,-1):this.pos;if(null==end2||end2<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=token,this.token.end=end2}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:chunk,chunkPos:chunkPos}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=chunk,this.chunk2Pos=chunkPos,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let nextChunk=this.input.chunk(this.pos),end2=this.pos+nextChunk.length;this.chunk=end2>this.range.to?nextChunk.slice(0,this.range.to-this.pos):nextChunk,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(n=1){for(this.chunkOff+=n;this.pos+n>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();n-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=n,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(pos,token){if(token?(this.token=token,token.start=pos,token.lookAhead=pos+1,token.value=token.extended=-1):this.token=nullToken,this.pos!=pos){if(this.pos=pos,pos==this.end)return this.setDone(),this;for(;pos<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;pos>=this.range.to;)this.range=this.ranges[++this.rangeIndex];pos>=this.chunkPos&&pos<this.chunkPos+this.chunk.length?this.chunkOff=pos-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(from,to){if(from>=this.chunkPos&&to<=this.chunkPos+this.chunk.length)return this.chunk.slice(from-this.chunkPos,to-this.chunkPos);if(from>=this.chunk2Pos&&to<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(from-this.chunk2Pos,to-this.chunk2Pos);if(from>=this.range.from&&to<=this.range.to)return this.input.read(from,to);let result="";for(let r of this.ranges){if(r.from>=to)break;r.to>from&&(result+=this.input.read(Math.max(r.from,from),Math.min(r.to,to)))}return result}}class TokenGroup{constructor(data2,id2){this.data=data2,this.id=id2}token(input,stack){let{parser:parser2}=stack.p;!function(data2,input,stack,group,precTable,precOffset){let state=0,groupMask=1<<group,{dialect:dialect}=stack.p.parser;scan:for(;0!=(groupMask&data2[state]);){let accEnd=data2[state+1];for(let i2=state+3;i2<accEnd;i2+=2)if((data2[i2+1]&groupMask)>0){let term=data2[i2];if(dialect.allows(term)&&(-1==input.token.value||input.token.value==term||overrides(term,input.token.value,precTable,precOffset))){input.acceptToken(term);break}}let next=input.next,low=0,high=data2[state+2];if(!(input.next<0&&high>low&&65535==data2[accEnd+3*high-3]&&65535==data2[accEnd+3*high-3])){for(;low<high;){let mid=low+high>>1,index=accEnd+mid+(mid<<1),from=data2[index],to=data2[index+1]||65536;if(next<from)high=mid;else{if(!(next>=to)){state=data2[index+2],input.advance();continue scan}low=mid+1}}break}state=data2[accEnd+3*high-1]}}(this.data,input,stack,this.id,parser2.data,parser2.tokenPrecTable)}}function findOffset(data2,start2,term){for(let next,i2=start2;65535!=(next=data2[i2]);i2++)if(next==term)return i2-start2;return-1}function overrides(token,prev,tableData,tableOffset){let iPrev=findOffset(tableData,tableOffset,prev);return iPrev<0||findOffset(tableData,tableOffset,token)<iPrev}TokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1,TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;const verbose="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);let stackIDs=null;function cutAt(tree,pos,side){let cursor2=tree.cursor(IterMode$1.IncludeAnonymous);for(cursor2.moveTo(pos);;)if(!(side<0?cursor2.childBefore(pos):cursor2.childAfter(pos)))for(;;){if((side<0?cursor2.to<pos:cursor2.from>pos)&&!cursor2.type.isError)return side<0?Math.max(0,Math.min(cursor2.to-1,pos-25)):Math.min(tree.length,Math.max(cursor2.from+1,pos+25));if(side<0?cursor2.prevSibling():cursor2.nextSibling())break;if(!cursor2.parent())return side<0?0:tree.length}}class FragmentCursor{constructor(fragments,nodeSet){this.fragments=fragments,this.nodeSet=nodeSet,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let fr=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(fr){for(this.safeFrom=fr.openStart?cutAt(fr.tree,fr.from+fr.offset,1)-fr.offset:fr.from,this.safeTo=fr.openEnd?cutAt(fr.tree,fr.to+fr.offset,-1)-fr.offset:fr.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(fr.tree),this.start.push(-fr.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(pos){if(pos<this.nextStart)return null;for(;this.fragment&&this.safeTo<=pos;)this.nextFragment();if(!this.fragment)return null;for(;;){let last=this.trees.length-1;if(last<0)return this.nextFragment(),null;let top2=this.trees[last],index=this.index[last];if(index==top2.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let next=top2.children[index],start2=this.start[last]+top2.positions[index];if(start2>pos)return this.nextStart=start2,null;if(next instanceof Tree$1){if(start2==pos){if(start2<this.safeFrom)return null;let end2=start2+next.length;if(end2<=this.safeTo){let lookAhead=next.prop(NodeProp$1.lookAhead);if(!lookAhead||end2+lookAhead<this.fragment.to)return next}}this.index[last]++,start2+next.length>=Math.max(this.safeFrom,pos)&&(this.trees.push(next),this.start.push(start2),this.index.push(0))}else this.index[last]++,this.nextStart=start2+next.length}}}class TokenCache{constructor(parser2,stream){this.stream=stream,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=parser2.tokenizers.map((_=>new CachedToken))}getActions(stack){let actionIndex=0,main2=null,{parser:parser2}=stack.p,{tokenizers:tokenizers}=parser2,mask=parser2.stateSlot(stack.state,3),context=stack.curContext?stack.curContext.hash:0,lookAhead=0;for(let i2=0;i2<tokenizers.length;i2++){if(0==(1<<i2&mask))continue;let tokenizer=tokenizers[i2],token=this.tokens[i2];if((!main2||tokenizer.fallback)&&((tokenizer.contextual||token.start!=stack.pos||token.mask!=mask||token.context!=context)&&(this.updateCachedToken(token,tokenizer,stack),token.mask=mask,token.context=context),token.lookAhead>token.end+25&&(lookAhead=Math.max(token.lookAhead,lookAhead)),0!=token.value)){let startIndex=actionIndex;if(token.extended>-1&&(actionIndex=this.addActions(stack,token.extended,token.end,actionIndex)),actionIndex=this.addActions(stack,token.value,token.end,actionIndex),!tokenizer.extend&&(main2=token,actionIndex>startIndex))break}}for(;this.actions.length>actionIndex;)this.actions.pop();return lookAhead&&stack.setLookAhead(lookAhead),main2||stack.pos!=this.stream.end||(main2=new CachedToken,main2.value=stack.p.parser.eofTerm,main2.start=main2.end=stack.pos,actionIndex=this.addActions(stack,main2.value,main2.end,actionIndex)),this.mainToken=main2,this.actions}getMainToken(stack){if(this.mainToken)return this.mainToken;let main2=new CachedToken,{pos:pos,p:p}=stack;return main2.start=pos,main2.end=Math.min(pos+1,p.stream.end),main2.value=pos==p.stream.end?p.parser.eofTerm:0,main2}updateCachedToken(token,tokenizer,stack){let start2=this.stream.clipPos(stack.pos);if(tokenizer.token(this.stream.reset(start2,token),stack),token.value>-1){let{parser:parser2}=stack.p;for(let i2=0;i2<parser2.specialized.length;i2++)if(parser2.specialized[i2]==token.value){let result=parser2.specializers[i2](this.stream.read(token.start,token.end),stack);if(result>=0&&stack.p.parser.dialect.allows(result>>1)){0==(1&result)?token.value=result>>1:token.extended=result>>1;break}}}else token.value=0,token.end=this.stream.clipPos(start2+1)}putAction(action,token,end2,index){for(let i2=0;i2<index;i2+=3)if(this.actions[i2]==action)return index;return this.actions[index++]=action,this.actions[index++]=token,this.actions[index++]=end2,index}addActions(stack,token,end2,index){let{state:state}=stack,{parser:parser2}=stack.p,{data:data2}=parser2;for(let set2=0;set2<2;set2++)for(let i2=parser2.stateSlot(state,set2?2:1);;i2+=3){if(65535==data2[i2]){if(1!=data2[i2+1]){0==index&&2==data2[i2+1]&&(index=this.putAction(pair(data2,i2+2),token,end2,index));break}i2=pair(data2,i2+2)}data2[i2]==token&&(index=this.putAction(pair(data2,i2+1),token,end2,index))}return index}}class Parse{constructor(parser2,input,fragments,ranges){this.parser=parser2,this.input=input,this.ranges=ranges,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new InputStream(input,ranges),this.tokens=new TokenCache(parser2,this.stream),this.topTerm=parser2.top[1];let{from:from}=ranges[0];this.stacks=[Stack.start(this,parser2.top[0],from)],this.fragments=fragments.length&&this.stream.end-from>4*parser2.bufferLength?new FragmentCursor(fragments,parser2.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let stopped,stoppedTokens,stacks=this.stacks,pos=this.minStackPos,newStacks=this.stacks=[];if(this.bigReductionCount>300&&1==stacks.length){let[s]=stacks;for(;s.forceReduce()&&s.stack.length&&s.stack[s.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let i2=0;i2<stacks.length;i2++){let stack=stacks[i2];for(;;){if(this.tokens.mainToken=null,stack.pos>pos)newStacks.push(stack);else{if(this.advanceStack(stack,newStacks,stacks))continue;{stopped||(stopped=[],stoppedTokens=[]),stopped.push(stack);let tok=this.tokens.getMainToken(stack);stoppedTokens.push(tok.value,tok.end)}}break}}if(!newStacks.length){let finished=stopped&&function(stacks){let best=null;for(let stack of stacks){let stopped=stack.p.stoppedAt;(stack.pos==stack.p.stream.end||null!=stopped&&stack.pos>stopped)&&stack.p.parser.stateFlag(stack.state,2)&&(!best||best.score<stack.score)&&(best=stack)}return best}(stopped);if(finished)return verbose&&console.log("Finish with "+this.stackID(finished)),this.stackToTree(finished);if(this.parser.strict)throw verbose&&stopped&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+pos);this.recovering||(this.recovering=5)}if(this.recovering&&stopped){let finished=null!=this.stoppedAt&&stopped[0].pos>this.stoppedAt?stopped[0]:this.runRecovery(stopped,stoppedTokens,newStacks);if(finished)return verbose&&console.log("Force-finish "+this.stackID(finished)),this.stackToTree(finished.forceAll())}if(this.recovering){let maxRemaining=1==this.recovering?1:3*this.recovering;if(newStacks.length>maxRemaining)for(newStacks.sort(((a,b)=>b.score-a.score));newStacks.length>maxRemaining;)newStacks.pop();newStacks.some((s=>s.reducePos>pos))&&this.recovering--}else if(newStacks.length>1){outer:for(let i2=0;i2<newStacks.length-1;i2++){let stack=newStacks[i2];for(let j=i2+1;j<newStacks.length;j++){let other=newStacks[j];if(stack.sameState(other)||stack.buffer.length>500&&other.buffer.length>500){if(!((stack.score-other.score||stack.buffer.length-other.buffer.length)>0)){newStacks.splice(i2--,1);continue outer}newStacks.splice(j--,1)}}}newStacks.length>12&&newStacks.splice(12,newStacks.length-12)}this.minStackPos=newStacks[0].pos;for(let i2=1;i2<newStacks.length;i2++)newStacks[i2].pos<this.minStackPos&&(this.minStackPos=newStacks[i2].pos);return null}stopAt(pos){if(null!=this.stoppedAt&&this.stoppedAt<pos)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=pos}advanceStack(stack,stacks,split){let start2=stack.pos,{parser:parser2}=this,base2=verbose?this.stackID(stack)+" -> ":"";if(null!=this.stoppedAt&&start2>this.stoppedAt)return stack.forceReduce()?stack:null;if(this.fragments){let strictCx=stack.curContext&&stack.curContext.tracker.strict,cxHash=strictCx?stack.curContext.hash:0;for(let cached=this.fragments.nodeAt(start2);cached;){let match=this.parser.nodeSet.types[cached.type.id]==cached.type?parser2.getGoto(stack.state,cached.type.id):-1;if(match>-1&&cached.length&&(!strictCx||(cached.prop(NodeProp$1.contextHash)||0)==cxHash))return stack.useNode(cached,match),verbose&&console.log(base2+this.stackID(stack)+` (via reuse of ${parser2.getName(cached.type.id)})`),!0;if(!(cached instanceof Tree$1)||0==cached.children.length||cached.positions[0]>0)break;let inner=cached.children[0];if(!(inner instanceof Tree$1&&0==cached.positions[0]))break;cached=inner}}let defaultReduce=parser2.stateSlot(stack.state,4);if(defaultReduce>0)return stack.reduce(defaultReduce),verbose&&console.log(base2+this.stackID(stack)+` (via always-reduce ${parser2.getName(65535&defaultReduce)})`),!0;if(stack.stack.length>=9e3)for(;stack.stack.length>6e3&&stack.forceReduce(););let actions=this.tokens.getActions(stack);for(let i2=0;i2<actions.length;){let action=actions[i2++],term=actions[i2++],end2=actions[i2++],last=i2==actions.length||!split,localStack=last?stack:stack.split(),main2=this.tokens.mainToken;if(localStack.apply(action,term,main2?main2.start:localStack.pos,end2),verbose&&console.log(base2+this.stackID(localStack)+` (via ${0==(65536&action)?"shift":`reduce of ${parser2.getName(65535&action)}`} for ${parser2.getName(term)} @ ${start2}${localStack==stack?"":", split"})`),last)return!0;localStack.pos>start2?stacks.push(localStack):split.push(localStack)}return!1}advanceFully(stack,newStacks){let pos=stack.pos;for(;;){if(!this.advanceStack(stack,null,null))return!1;if(stack.pos>pos)return pushStackDedup(stack,newStacks),!0}}runRecovery(stacks,tokens,newStacks){let finished=null,restarted=!1;for(let i2=0;i2<stacks.length;i2++){let stack=stacks[i2],token=tokens[i2<<1],tokenEnd=tokens[1+(i2<<1)],base2=verbose?this.stackID(stack)+" -> ":"";if(stack.deadEnd){if(restarted)continue;if(restarted=!0,stack.restart(),verbose&&console.log(base2+this.stackID(stack)+" (restarted)"),this.advanceFully(stack,newStacks))continue}let force=stack.split(),forceBase=base2;for(let j=0;force.forceReduce()&&j<10;j++){if(verbose&&console.log(forceBase+this.stackID(force)+" (via force-reduce)"),this.advanceFully(force,newStacks))break;verbose&&(forceBase=this.stackID(force)+" -> ")}for(let insert2 of stack.recoverByInsert(token))verbose&&console.log(base2+this.stackID(insert2)+" (via recover-insert)"),this.advanceFully(insert2,newStacks);this.stream.end>stack.pos?(tokenEnd==stack.pos&&(tokenEnd++,token=0),stack.recoverByDelete(token,tokenEnd),verbose&&console.log(base2+this.stackID(stack)+` (via recover-delete ${this.parser.getName(token)})`),pushStackDedup(stack,newStacks)):(!finished||finished.score<stack.score)&&(finished=stack)}return finished}stackToTree(stack){return stack.close(),Tree$1.build({buffer:StackBufferCursor.create(stack),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:stack.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(stack){let id2=(stackIDs||(stackIDs=new WeakMap)).get(stack);return id2||stackIDs.set(stack,id2=String.fromCodePoint(this.nextStackID++)),id2+stack}}function pushStackDedup(stack,newStacks){for(let i2=0;i2<newStacks.length;i2++){let other=newStacks[i2];if(other.pos==stack.pos&&other.sameState(stack))return void(newStacks[i2].score<stack.score&&(newStacks[i2]=stack))}newStacks.push(stack)}class Dialect{constructor(source,flags,disabled){this.source=source,this.flags=flags,this.disabled=disabled}allows(term){return!this.disabled||0==this.disabled[term]}}class LRParser extends Parser{constructor(spec){if(super(),this.wrappers=[],14!=spec.version)throw new RangeError(`Parser version (${spec.version}) doesn't match runtime version (14)`);let nodeNames=spec.nodeNames.split(" ");this.minRepeatTerm=nodeNames.length;for(let i2=0;i2<spec.repeatNodeCount;i2++)nodeNames.push("");let topTerms=Object.keys(spec.topRules).map((r=>spec.topRules[r][1])),nodeProps=[];for(let i2=0;i2<nodeNames.length;i2++)nodeProps.push([]);function setProp(nodeID,prop,value){nodeProps[nodeID].push([prop,prop.deserialize(String(value))])}if(spec.nodeProps)for(let propSpec of spec.nodeProps){let prop=propSpec[0];"string"==typeof prop&&(prop=NodeProp$1[prop]);for(let i2=1;i2<propSpec.length;){let next=propSpec[i2++];if(next>=0)setProp(next,prop,propSpec[i2++]);else{let value=propSpec[i2+-next];for(let j=-next;j>0;j--)setProp(propSpec[i2++],prop,value);i2++}}}this.nodeSet=new NodeSet(nodeNames.map(((name2,i2)=>NodeType$1.define({name:i2>=this.minRepeatTerm?void 0:name2,id:i2,props:nodeProps[i2],top:topTerms.indexOf(i2)>-1,error:0==i2,skipped:spec.skippedNodes&&spec.skippedNodes.indexOf(i2)>-1})))),spec.propSources&&(this.nodeSet=this.nodeSet.extend(...spec.propSources)),this.strict=!1,this.bufferLength=DefaultBufferLength$1;let tokenArray=decodeArray(spec.tokenData);this.context=spec.context,this.specializerSpecs=spec.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let i2=0;i2<this.specializerSpecs.length;i2++)this.specialized[i2]=this.specializerSpecs[i2].term;this.specializers=this.specializerSpecs.map(getSpecializer),this.states=decodeArray(spec.states,Uint32Array),this.data=decodeArray(spec.stateData),this.goto=decodeArray(spec.goto),this.maxTerm=spec.maxTerm,this.tokenizers=spec.tokenizers.map((value=>"number"==typeof value?new TokenGroup(tokenArray,value):value)),this.topRules=spec.topRules,this.dialects=spec.dialects||{},this.dynamicPrecedences=spec.dynamicPrecedences||null,this.tokenPrecTable=spec.tokenPrec,this.termNames=spec.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(input,fragments,ranges){let parse=new Parse(this,input,fragments,ranges);for(let w of this.wrappers)parse=w(parse,input,fragments,ranges);return parse}getGoto(state,term,loose=!1){let table=this.goto;if(term>=table[0])return-1;for(let pos=table[term+1];;){let groupTag=table[pos++],last=1&groupTag,target=table[pos++];if(last&&loose)return target;for(let end2=pos+(groupTag>>1);pos<end2;pos++)if(table[pos]==state)return target;if(last)return-1}}hasAction(state,terminal){let data2=this.data;for(let set2=0;set2<2;set2++)for(let next,i2=this.stateSlot(state,set2?2:1);;i2+=3){if(65535==(next=data2[i2])){if(1!=data2[i2+1]){if(2==data2[i2+1])return pair(data2,i2+2);break}next=data2[i2=pair(data2,i2+2)]}if(next==terminal||0==next)return pair(data2,i2+1)}return 0}stateSlot(state,slot){return this.states[6*state+slot]}stateFlag(state,flag){return(this.stateSlot(state,0)&flag)>0}validAction(state,action){return!!this.allActions(state,(a=>a==action||null))}allActions(state,action){let deflt=this.stateSlot(state,4),result=deflt?action(deflt):void 0;for(let i2=this.stateSlot(state,1);null==result;i2+=3){if(65535==this.data[i2]){if(1!=this.data[i2+1])break;i2=pair(this.data,i2+2)}result=action(pair(this.data,i2+1))}return result}nextStates(state){let result=[];for(let i2=this.stateSlot(state,1);;i2+=3){if(65535==this.data[i2]){if(1!=this.data[i2+1])break;i2=pair(this.data,i2+2)}if(0==(1&this.data[i2+2])){let value=this.data[i2+1];result.some(((v,i3)=>1&i3&&v==value))||result.push(this.data[i2],value)}}return result}configure(config2){let copy=Object.assign(Object.create(LRParser.prototype),this);if(config2.props&&(copy.nodeSet=this.nodeSet.extend(...config2.props)),config2.top){let info=this.topRules[config2.top];if(!info)throw new RangeError(`Invalid top rule name ${config2.top}`);copy.top=info}return config2.tokenizers&&(copy.tokenizers=this.tokenizers.map((t2=>{let found=config2.tokenizers.find((r=>r.from==t2));return found?found.to:t2}))),config2.specializers&&(copy.specializers=this.specializers.slice(),copy.specializerSpecs=this.specializerSpecs.map(((s,i2)=>{let found=config2.specializers.find((r=>r.from==s.external));if(!found)return s;let spec=Object.assign(Object.assign({},s),{external:found.to});return copy.specializers[i2]=getSpecializer(spec),spec}))),config2.contextTracker&&(copy.context=config2.contextTracker),config2.dialect&&(copy.dialect=this.parseDialect(config2.dialect)),null!=config2.strict&&(copy.strict=config2.strict),config2.wrap&&(copy.wrappers=copy.wrappers.concat(config2.wrap)),null!=config2.bufferLength&&(copy.bufferLength=config2.bufferLength),copy}hasWrappers(){return this.wrappers.length>0}getName(term){return this.termNames?this.termNames[term]:String(term<=this.maxNode&&this.nodeSet.types[term].name||term)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(term){let prec2=this.dynamicPrecedences;return null==prec2?0:prec2[term]||0}parseDialect(dialect){let values=Object.keys(this.dialects),flags=values.map((()=>!1));if(dialect)for(let part of dialect.split(" ")){let id2=values.indexOf(part);id2>=0&&(flags[id2]=!0)}let disabled=null;for(let i2=0;i2<values.length;i2++)if(!flags[i2])for(let id2,j=this.dialects[values[i2]];65535!=(id2=this.data[j++]);)(disabled||(disabled=new Uint8Array(this.maxTerm+1)))[id2]=1;return new Dialect(dialect,flags,disabled)}static deserialize(spec){return new LRParser(spec)}}function pair(data2,off){return data2[off]|data2[off+1]<<16}function getSpecializer(spec){if(spec.external){let mask=spec.extend?1:0;return(value,stack)=>spec.external(value,stack)<<1|mask}return spec.get}const jsonHighlighting=styleTags({String:tags.string,Number:tags.number,"True False":tags.bool,PropertyName:tags.propertyName,Null:tags.null,",":tags.separator,"[ ]":tags.squareBracket,"{ }":tags.brace}),parser=LRParser.deserialize({version:14,states:"$bOVQPOOOOQO'#Cb'#CbOnQPO'#CeOvQPO'#CjOOQO'#Cp'#CpQOQPOOOOQO'#Cg'#CgO}QPO'#CfO!SQPO'#CrOOQO,59P,59PO![QPO,59PO!aQPO'#CuOOQO,59U,59UO!iQPO,59UOVQPO,59QOqQPO'#CkO!nQPO,59^OOQO1G.k1G.kOVQPO'#ClO!vQPO,59aOOQO1G.p1G.pOOQO1G.l1G.lOOQO,59V,59VOOQO-E6i-E6iOOQO,59W,59WOOQO-E6j-E6j",stateData:"#O~OcOS~OQSORSOSSOTSOWQO]ROePO~OVXOeUO~O[[O~PVOg^O~Oh_OVfX~OVaO~OhbO[iX~O[dO~Oh_OVfa~OhbO[ia~O",goto:"!kjPPPPPPkPPkqwPPk{!RPPP!XP!ePP!hXSOR^bQWQRf_TVQ_Q`WRg`QcZRicQTOQZRQe^RhbRYQR]R",nodeNames:"\u26a0 JsonText True False Null Number String } { Object Property PropertyName ] [ Array",maxTerm:25,nodeProps:[["openedBy",7,"{",12,"["],["closedBy",8,"}",13,"]"]],propSources:[jsonHighlighting],skippedNodes:[0],repeatNodeCount:2,tokenData:"(|~RaXY!WYZ!W]^!Wpq!Wrs!]|}$u}!O$z!Q!R%T!R![&c![!]&t!}#O&y#P#Q'O#Y#Z'T#b#c'r#h#i(Z#o#p(r#q#r(w~!]Oc~~!`Wpq!]qr!]rs!xs#O!]#O#P!}#P;'S!];'S;=`$o<%lO!]~!}Oe~~#QXrs!]!P!Q!]#O#P!]#U#V!]#Y#Z!]#b#c!]#f#g!]#h#i!]#i#j#m~#pR!Q![#y!c!i#y#T#Z#y~#|R!Q![$V!c!i$V#T#Z$V~$YR!Q![$c!c!i$c#T#Z$c~$fR!Q![!]!c!i!]#T#Z!]~$rP;=`<%l!]~$zOh~~$}Q!Q!R%T!R![&c~%YRT~!O!P%c!g!h%w#X#Y%w~%fP!Q![%i~%nRT~!Q![%i!g!h%w#X#Y%w~%zR{|&T}!O&T!Q![&Z~&WP!Q![&Z~&`PT~!Q![&Z~&hST~!O!P%c!Q![&c!g!h%w#X#Y%w~&yOg~~'OO]~~'TO[~~'WP#T#U'Z~'^P#`#a'a~'dP#g#h'g~'jP#X#Y'm~'rOR~~'uP#i#j'x~'{P#`#a(O~(RP#`#a(U~(ZOS~~(^P#f#g(a~(dP#i#j(g~(jP#X#Y(m~(rOQ~~(wOW~~(|OV~",tokenizers:[0],topRules:{JsonText:[0,1]},tokenPrec:0}),jsonLanguage=LRLanguage.define({name:"json",parser:parser.configure({props:[indentNodeProp.add({Object:continuedIndent({except:/^\s*\}/}),Array:continuedIndent({except:/^\s*\]/})}),foldNodeProp.add({"Object Array":function(node){let first=node.firstChild,last=node.lastChild;return first&&first.to<last.from?{from:first.to,to:last.type.isError?node.to:last.from}:null}})]}),languageData:{closeBrackets:{brackets:["[","{",'"']},indentOnInput:/^\s*[\}\]]$/}});function create_if_block$b(ctx){let codemirror,updating_value,current;function codemirror_value_binding(value){ctx[7](value)}let codemirror_props={readonly:ctx[1],lang:new LanguageSupport(jsonLanguage),theme:oneDark,placeholder:ctx[2],editable:!ctx[1],class:editorClass+" "+ctx[6],styles:{"&":{width:ctx[5]||"100%",height:ctx[4]||"200px",borderRadius:"10px",opacity:ctx[1]?"0.5":"1"},".cm-scroller":{borderRadius:"10px"}}};return void 0!==ctx[0]&&(codemirror_props.value=ctx[0]),codemirror=new CodeMirror({props:codemirror_props}),binding_callbacks.push((()=>bind(codemirror,"value",codemirror_value_binding))),{c(){create_component(codemirror.$$.fragment)},m(target,anchor){mount_component(codemirror,target,anchor),current=!0},p(ctx2,dirty){const codemirror_changes={};2&dirty&&(codemirror_changes.readonly=ctx2[1]),4&dirty&&(codemirror_changes.placeholder=ctx2[2]),2&dirty&&(codemirror_changes.editable=!ctx2[1]),64&dirty&&(codemirror_changes.class=editorClass+" "+ctx2[6]),50&dirty&&(codemirror_changes.styles={"&":{width:ctx2[5]||"100%",height:ctx2[4]||"200px",borderRadius:"10px",opacity:ctx2[1]?"0.5":"1"},".cm-scroller":{borderRadius:"10px"}}),!updating_value&&1&dirty&&(updating_value=!0,codemirror_changes.value=ctx2[0],add_flush_callback((()=>updating_value=!1))),codemirror.$set(codemirror_changes)},i(local){current||(transition_in(codemirror.$$.fragment,local),current=!0)},o(local){transition_out(codemirror.$$.fragment,local),current=!1},d(detaching){destroy_component(codemirror,detaching)}}}function create_fragment$e(ctx){let if_block_anchor,current,if_block=ctx[3]===componentTypes.codeEditor.json&&create_if_block$b(ctx);return{c(){if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){if_block&&if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,[dirty]){ctx2[3]===componentTypes.codeEditor.json?if_block?(if_block.p(ctx2,dirty),8&dirty&&transition_in(if_block,1)):(if_block=create_if_block$b(ctx2),if_block.c(),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block&&(group_outros(),transition_out(if_block,1,1,(()=>{if_block=null})),check_outros())},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(if_block_anchor),if_block&&if_block.d(detaching)}}}let editorClass="[&>.cm-editor]:bg-gray-200/50 [&>.cm-editor]:dark:bg-gray-800 [&>.cm-editor]:text-gray-500 [&>.cm-editor]:dark:text-gray-200 [&>.cm-editor>.cm-scroller>.cm-gutters]:bg-gray-500/70 [&>.cm-editor>.cm-scroller>.cm-gutters]:dark:bg-gray-900/50";function instance$e($$self,$$props,$$invalidate){let{value:value}=$$props,{type:type2=componentTypes.codeEditor.json}=$$props,{readonly:readonly=!1}=$$props,{placeholder:placeholder2=""}=$$props,{height:height}=$$props,{width:width}=$$props,{customClasses:customClasses=""}=$$props;return void 0===readonly&&(readonly=!1),void 0===placeholder2&&(placeholder2=""),$$self.$$set=$$props2=>{"value"in $$props2&&$$invalidate(0,value=$$props2.value),"type"in $$props2&&$$invalidate(3,type2=$$props2.type),"readonly"in $$props2&&$$invalidate(1,readonly=$$props2.readonly),"placeholder"in $$props2&&$$invalidate(2,placeholder2=$$props2.placeholder),"height"in $$props2&&$$invalidate(4,height=$$props2.height),"width"in $$props2&&$$invalidate(5,width=$$props2.width),"customClasses"in $$props2&&$$invalidate(6,customClasses=$$props2.customClasses)},[value,readonly,placeholder2,type2,height,width,customClasses,function(value$1){value=value$1,$$invalidate(0,value)}]}class Code_editor extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$e,create_fragment$e,safe_not_equal,{value:0,type:3,readonly:1,placeholder:2,height:4,width:5,customClasses:6})}}function create_else_block$3(ctx){let button,t2,button_class_value,current,mounted,dispose,if_block=ctx[8]&&create_if_block_4$2(ctx);const default_slot_template=ctx[11].default,default_slot=create_slot(default_slot_template,ctx,ctx[14],null);return{c(){button=element("button"),if_block&&if_block.c(),t2=space(),default_slot&&default_slot.c(),attr(button,"id",ctx[0]),attr(button,"type","button"),attr(button,"class",button_class_value=btnClass+" "+ctx[9][ctx[2]]+" "+(ctx[6]?"cursor-not-allowed opacity-60":"")+" "+ctx[1]),attr(button,"data-active",ctx[5]),button.disabled=ctx[6]},m(target,anchor){insert$1(target,button,anchor),if_block&&if_block.m(button,null),append(button,t2),default_slot&&default_slot.m(button,null),current=!0,mounted||(dispose=listen(button,"click",ctx[13]),mounted=!0)},p(ctx2,dirty){ctx2[8]?if_block?(if_block.p(ctx2,dirty),256&dirty&&transition_in(if_block,1)):(if_block=create_if_block_4$2(ctx2),if_block.c(),transition_in(if_block,1),if_block.m(button,t2)):if_block&&(group_outros(),transition_out(if_block,1,1,(()=>{if_block=null})),check_outros()),default_slot&&default_slot.p&&(!current||16384&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[14],current?get_slot_changes(default_slot_template,ctx2[14],dirty,null):get_all_dirty_from_scope(ctx2[14]),null),(!current||1&dirty)&&attr(button,"id",ctx2[0]),(!current||70&dirty&&button_class_value!==(button_class_value=btnClass+" "+ctx2[9][ctx2[2]]+" "+(ctx2[6]?"cursor-not-allowed opacity-60":"")+" "+ctx2[1]))&&attr(button,"class",button_class_value),(!current||32&dirty)&&attr(button,"data-active",ctx2[5]),(!current||64&dirty)&&(button.disabled=ctx2[6])},i(local){current||(transition_in(if_block),transition_in(default_slot,local),current=!0)},o(local){transition_out(if_block),transition_out(default_slot,local),current=!1},d(detaching){detaching&&detach(button),if_block&&if_block.d(),default_slot&&default_slot.d(detaching),mounted=!1,dispose()}}}function create_if_block_2$3(ctx){let div1,div0,div0_class_value,t0,button,t1,button_class_value,div1_class_value,current,mounted,dispose;const default_slot_template=ctx[11].default,default_slot=create_slot(default_slot_template,ctx,ctx[14],null);let if_block=ctx[8]&&create_if_block_3$3(ctx);const default_slot_template_1=ctx[11].default,default_slot_1=create_slot(default_slot_template_1,ctx,ctx[14],null);return{c(){div1=element("div"),div0=element("div"),default_slot&&default_slot.c(),t0=space(),button=element("button"),if_block&&if_block.c(),t1=space(),default_slot_1&&default_slot_1.c(),attr(div0,"class",div0_class_value=btnClass+" mt-auto m-auto ring-4 btn-ping "+ctx[9][ctx[2]]+" "+ctx[1]),attr(button,"id",ctx[0]),attr(button,"type","button"),attr(button,"class",button_class_value=btnClass+" absolute mt-auto m-auto "+ctx[9][ctx[2]]+" "+ctx[1]),attr(button,"data-active",ctx[5]),button.disabled=ctx[6],attr(div1,"class",div1_class_value="relative inline-flex items-center justify-center p-0 m-0 rounded-full "+(ctx[6]?"cursor-not-allowed opacity-60":"")+" "+ctx[1])},m(target,anchor){insert$1(target,div1,anchor),append(div1,div0),default_slot&&default_slot.m(div0,null),append(div1,t0),append(div1,button),if_block&&if_block.m(button,null),append(button,t1),default_slot_1&&default_slot_1.m(button,null),current=!0,mounted||(dispose=listen(button,"click",ctx[12]),mounted=!0)},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||16384&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[14],current?get_slot_changes(default_slot_template,ctx2[14],dirty,null):get_all_dirty_from_scope(ctx2[14]),null),(!current||6&dirty&&div0_class_value!==(div0_class_value=btnClass+" mt-auto m-auto ring-4 btn-ping "+ctx2[9][ctx2[2]]+" "+ctx2[1]))&&attr(div0,"class",div0_class_value),ctx2[8]?if_block?(if_block.p(ctx2,dirty),256&dirty&&transition_in(if_block,1)):(if_block=create_if_block_3$3(ctx2),if_block.c(),transition_in(if_block,1),if_block.m(button,t1)):if_block&&(group_outros(),transition_out(if_block,1,1,(()=>{if_block=null})),check_outros()),default_slot_1&&default_slot_1.p&&(!current||16384&dirty)&&update_slot_base(default_slot_1,default_slot_template_1,ctx2,ctx2[14],current?get_slot_changes(default_slot_template_1,ctx2[14],dirty,null):get_all_dirty_from_scope(ctx2[14]),null),(!current||1&dirty)&&attr(button,"id",ctx2[0]),(!current||6&dirty&&button_class_value!==(button_class_value=btnClass+" absolute mt-auto m-auto "+ctx2[9][ctx2[2]]+" "+ctx2[1]))&&attr(button,"class",button_class_value),(!current||32&dirty)&&attr(button,"data-active",ctx2[5]),(!current||64&dirty)&&(button.disabled=ctx2[6]),(!current||66&dirty&&div1_class_value!==(div1_class_value="relative inline-flex items-center justify-center p-0 m-0 rounded-full "+(ctx2[6]?"cursor-not-allowed opacity-60":"")+" "+ctx2[1]))&&attr(div1,"class",div1_class_value)},i(local){current||(transition_in(default_slot,local),transition_in(if_block),transition_in(default_slot_1,local),current=!0)},o(local){transition_out(default_slot,local),transition_out(if_block),transition_out(default_slot_1,local),current=!1},d(detaching){detaching&&detach(div1),default_slot&&default_slot.d(detaching),if_block&&if_block.d(),default_slot_1&&default_slot_1.d(detaching),mounted=!1,dispose()}}}function create_if_block_1$7(ctx){let a,a_class_value,current;const default_slot_template=ctx[11].default,default_slot=create_slot(default_slot_template,ctx,ctx[14],null);return{c(){a=element("a"),default_slot&&default_slot.c(),attr(a,"id",ctx[0]),attr(a,"href",ctx[3]),attr(a,"class",a_class_value=btnClass+" "+ctx[9][ctx[2]]+" "+(ctx[6]?"cursor-not-allowed opacity-60":"")+" "+ctx[1]),attr(a,"target","_blank"),attr(a,"role","button"),attr(a,"data-active",ctx[5])},m(target,anchor){insert$1(target,a,anchor),default_slot&&default_slot.m(a,null),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||16384&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[14],current?get_slot_changes(default_slot_template,ctx2[14],dirty,null):get_all_dirty_from_scope(ctx2[14]),null),(!current||1&dirty)&&attr(a,"id",ctx2[0]),(!current||8&dirty)&&attr(a,"href",ctx2[3]),(!current||70&dirty&&a_class_value!==(a_class_value=btnClass+" "+ctx2[9][ctx2[2]]+" "+(ctx2[6]?"cursor-not-allowed opacity-60":"")+" "+ctx2[1]))&&attr(a,"class",a_class_value),(!current||32&dirty)&&attr(a,"data-active",ctx2[5])},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){detaching&&detach(a),default_slot&&default_slot.d(detaching)}}}function create_if_block_4$2(ctx){let fa,current;return fa=new Fa({props:{icon:ctx[8],class:ctx[10].default?iconClass$1:""}}),{c(){create_component(fa.$$.fragment)},m(target,anchor){mount_component(fa,target,anchor),current=!0},p(ctx2,dirty){const fa_changes={};256&dirty&&(fa_changes.icon=ctx2[8]),1024&dirty&&(fa_changes.class=ctx2[10].default?iconClass$1:""),fa.$set(fa_changes)},i(local){current||(transition_in(fa.$$.fragment,local),current=!0)},o(local){transition_out(fa.$$.fragment,local),current=!1},d(detaching){destroy_component(fa,detaching)}}}function create_if_block_3$3(ctx){let fa,current;return fa=new Fa({props:{icon:ctx[8],class:ctx[10].default?iconClass$1:""}}),{c(){create_component(fa.$$.fragment)},m(target,anchor){mount_component(fa,target,anchor),current=!0},p(ctx2,dirty){const fa_changes={};256&dirty&&(fa_changes.icon=ctx2[8]),1024&dirty&&(fa_changes.class=ctx2[10].default?iconClass$1:""),fa.$set(fa_changes)},i(local){current||(transition_in(fa.$$.fragment,local),current=!0)},o(local){transition_out(fa.$$.fragment,local),current=!1},d(detaching){destroy_component(fa,detaching)}}}function create_if_block$a(ctx){let tooltip_1,current;const tooltip_1_spread_levels=[{type:componentTypes.tooltip.main},{position:componentPositions.tooltip.top},{id:ctx[0]},Object.fromEntries(Object.entries(ctx[7]).filter(func))];let tooltip_1_props={$$slots:{default:[create_default_slot$9]},$$scope:{ctx:ctx}};for(let i2=0;i2<tooltip_1_spread_levels.length;i2+=1)tooltip_1_props=assign(tooltip_1_props,tooltip_1_spread_levels[i2]);return tooltip_1=new Main({props:tooltip_1_props}),{c(){create_component(tooltip_1.$$.fragment)},m(target,anchor){mount_component(tooltip_1,target,anchor),current=!0},p(ctx2,dirty){const tooltip_1_changes=129&dirty?get_spread_update(tooltip_1_spread_levels,[tooltip_1_spread_levels[0],tooltip_1_spread_levels[1],1&dirty&&{id:ctx2[0]},128&dirty&&get_spread_object(Object.fromEntries(Object.entries(ctx2[7]).filter(func)))]):{};16512&dirty&&(tooltip_1_changes.$$scope={dirty:dirty,ctx:ctx2}),tooltip_1.$set(tooltip_1_changes)},i(local){current||(transition_in(tooltip_1.$$.fragment,local),current=!0)},o(local){transition_out(tooltip_1.$$.fragment,local),current=!1},d(detaching){destroy_component(tooltip_1,detaching)}}}function create_default_slot$9(ctx){let t2,t_value=ctx[7].title+"";return{c(){t2=text(t_value)},m(target,anchor){insert$1(target,t2,anchor)},p(ctx2,dirty){128&dirty&&t_value!==(t_value=ctx2[7].title+"")&&set_data(t2,t_value)},d(detaching){detaching&&detach(t2)}}}function create_fragment$d(ctx){let current_block_type_index,if_block0,t2,if_block1_anchor,current;const if_block_creators=[create_if_block_1$7,create_if_block_2$3,create_else_block$3],if_blocks=[];function select_block_type(ctx2,dirty){return""!==ctx2[3]?0:ctx2[4]?1:2}current_block_type_index=select_block_type(ctx),if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);let if_block1="object"==typeof ctx[7]&&ctx[7].title&&""!==ctx[7].title&&create_if_block$a(ctx);return{c(){if_block0.c(),t2=space(),if_block1&&if_block1.c(),if_block1_anchor=empty$1()},m(target,anchor){if_blocks[current_block_type_index].m(target,anchor),insert$1(target,t2,anchor),if_block1&&if_block1.m(target,anchor),insert$1(target,if_block1_anchor,anchor),current=!0},p(ctx2,[dirty]){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx2),current_block_type_index===previous_block_index?if_blocks[current_block_type_index].p(ctx2,dirty):(group_outros(),transition_out(if_blocks[previous_block_index],1,1,(()=>{if_blocks[previous_block_index]=null})),check_outros(),if_block0=if_blocks[current_block_type_index],if_block0?if_block0.p(ctx2,dirty):(if_block0=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx2),if_block0.c()),transition_in(if_block0,1),if_block0.m(t2.parentNode,t2)),"object"==typeof ctx2[7]&&ctx2[7].title&&""!==ctx2[7].title?if_block1?(if_block1.p(ctx2,dirty),128&dirty&&transition_in(if_block1,1)):(if_block1=create_if_block$a(ctx2),if_block1.c(),transition_in(if_block1,1),if_block1.m(if_block1_anchor.parentNode,if_block1_anchor)):if_block1&&(group_outros(),transition_out(if_block1,1,1,(()=>{if_block1=null})),check_outros())},i(local){current||(transition_in(if_block0),transition_in(if_block1),current=!0)},o(local){transition_out(if_block0),transition_out(if_block1),current=!1},d(detaching){detaching&&(detach(t2),detach(if_block1_anchor)),if_blocks[current_block_type_index].d(detaching),if_block1&&if_block1.d(detaching)}}}let btnClass="text-center font-medium focus:ring-0 focus:outline-0 inline-flex items-center justify-center px-3 py-2 text-xs my-4 mb-0 rounded-full",iconClass$1="mr-2";const func=([key])=>"title"!==key;function instance$d($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope:$$scope}=$$props;const $$slots=compute_slots(slots);let{customClasses:customClasses=""}=$$props,{id:id2=""}=$$props,{color:color2=componentTypes.btn.gray}=$$props,{href:href=""}=$$props,{ping:ping=!1}=$$props,{active:active2}=$$props,{disabled:disabled}=$$props,{tooltip:tooltip}=$$props,{icon:icon}=$$props,colored=v=>`text-white bg-${v}-700 hover:bg-${v}-800 focus:ring-${v}-300 dark:focus:${v}-800 dark:bg-${v}-700 dark:hover:bg-${v}-600 ring-${v}-800`,colorClass={[componentTypes.btn.light]:"text-gray-900 bg-white border-gray-300 hover:bg-gray-100 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 focus:ring-gray-200 dark:focus:ring-gray-700",[componentTypes.btn.neutral]:colored("gray"),[componentTypes.btn.primary]:colored("primary"),[componentTypes.btn.secondary]:"text-white bg-secondary-700 hover:bg-secondary-800 focus:ring-secondary-300 dark:focus:secondary-800 dark:bg-secondary-700 dark:hover:bg-secondary-600 ring-secondary-800",[componentTypes.btn.gray]:(v="gray",`text-white bg-${v}-800 hover:bg-${v}-900 focus:ring-${v}-400 dark:focus:${v}-900 dark:bg-${v}-800 dark:hover:bg-${v}-700 ring-${v}-800`),[componentTypes.btn.grayReverse]:(v=>`text-white bg-${v}-900 hover:bg-${v}-800 focus:ring-${v}-400 dark:focus:${v}-900 dark:bg-${v}-700 dark:hover:bg-${v}-800 ring-${v}-800`)("gray"),[componentTypes.btn.success]:colored("green"),[componentTypes.btn.error]:colored("red"),[componentTypes.btn.none]:""};var v;return""===id2&&(id2=functs.generateRamdomID()),$$self.$$set=$$props2=>{"customClasses"in $$props2&&$$invalidate(1,customClasses=$$props2.customClasses),"id"in $$props2&&$$invalidate(0,id2=$$props2.id),"color"in $$props2&&$$invalidate(2,color2=$$props2.color),"href"in $$props2&&$$invalidate(3,href=$$props2.href),"ping"in $$props2&&$$invalidate(4,ping=$$props2.ping),"active"in $$props2&&$$invalidate(5,active2=$$props2.active),"disabled"in $$props2&&$$invalidate(6,disabled=$$props2.disabled),"tooltip"in $$props2&&$$invalidate(7,tooltip=$$props2.tooltip),"icon"in $$props2&&$$invalidate(8,icon=$$props2.icon),"$$scope"in $$props2&&$$invalidate(14,$$scope=$$props2.$$scope)},[id2,customClasses,color2,href,ping,active2,disabled,tooltip,icon,colorClass,$$slots,slots,function(event){bubble.call(this,$$self,event)},function(event){bubble.call(this,$$self,event)},$$scope]}class Btn extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$d,create_fragment$d,safe_not_equal,{customClasses:1,id:0,color:2,href:3,ping:4,active:5,disabled:6,tooltip:7,icon:8})}}function create_if_block_3$2(ctx){let if_block_anchor,if_block=ctx[0]&&create_if_block_4$1(ctx);return{c(){if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){if_block&&if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor)},p(ctx2,dirty){ctx2[0]?if_block?if_block.p(ctx2,dirty):(if_block=create_if_block_4$1(ctx2),if_block.c(),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block&&(if_block.d(1),if_block=null)},d(detaching){detaching&&detach(if_block_anchor),if_block&&if_block.d(detaching)}}}function create_if_block_4$1(ctx){let span,t2;return{c(){span=element("span"),t2=text(ctx[0]),attr(span,"id",ctx[2]),attr(span,"class","mr-1 "+titleClass)},m(target,anchor){insert$1(target,span,anchor),append(span,t2)},p(ctx2,dirty){1&dirty&&set_data(t2,ctx2[0]),4&dirty&&attr(span,"id",ctx2[2])},d(detaching){detaching&&detach(span)}}}function create_if_block_2$2(ctx){let tooltip_1,current;const tooltip_1_spread_levels=[{type:componentTypes.tooltip.info},{id:ctx[2]+"-desc"},ctx[4]];let tooltip_1_props={$$slots:{default:[create_default_slot$8]},$$scope:{ctx:ctx}};for(let i2=0;i2<tooltip_1_spread_levels.length;i2+=1)tooltip_1_props=assign(tooltip_1_props,tooltip_1_spread_levels[i2]);return tooltip_1=new Main({props:tooltip_1_props}),{c(){create_component(tooltip_1.$$.fragment)},m(target,anchor){mount_component(tooltip_1,target,anchor),current=!0},p(ctx2,dirty){const tooltip_1_changes=20&dirty?get_spread_update(tooltip_1_spread_levels,[tooltip_1_spread_levels[0],4&dirty&&{id:ctx2[2]+"-desc"},16&dirty&&get_spread_object(ctx2[4])]):{};66&dirty&&(tooltip_1_changes.$$scope={dirty:dirty,ctx:ctx2}),tooltip_1.$set(tooltip_1_changes)},i(local){current||(transition_in(tooltip_1.$$.fragment,local),current=!0)},o(local){transition_out(tooltip_1.$$.fragment,local),current=!1},d(detaching){destroy_component(tooltip_1,detaching)}}}function create_default_slot$8(ctx){let t2;return{c(){t2=text(ctx[1])},m(target,anchor){insert$1(target,t2,anchor)},p(ctx2,dirty){2&dirty&&set_data(t2,ctx2[1])},d(detaching){detaching&&detach(t2)}}}function create_if_block$9(ctx){let if_block_anchor,if_block=ctx[0]&&create_if_block_1$6(ctx);return{c(){if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){if_block&&if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor)},p(ctx2,dirty){ctx2[0]?if_block?if_block.p(ctx2,dirty):(if_block=create_if_block_1$6(ctx2),if_block.c(),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block&&(if_block.d(1),if_block=null)},d(detaching){detaching&&detach(if_block_anchor),if_block&&if_block.d(detaching)}}}function create_if_block_1$6(ctx){let span,t2;return{c(){span=element("span"),t2=text(ctx[0]),attr(span,"id",ctx[2]),attr(span,"class","ml-1 "+titleClass)},m(target,anchor){insert$1(target,span,anchor),append(span,t2)},p(ctx2,dirty){1&dirty&&set_data(t2,ctx2[0]),4&dirty&&attr(span,"id",ctx2[2])},d(detaching){detaching&&detach(span)}}}function create_fragment$c(ctx){let div,t0,t1,div_class_value,current,if_block0=ctx[3]===componentTypes.title.tooltipRight&&create_if_block_3$2(ctx),if_block1=ctx[1]&&""!==ctx[1]&&create_if_block_2$2(ctx),if_block2=ctx[3]===componentTypes.title.tooltipLeft&&create_if_block$9(ctx);return{c(){div=element("div"),if_block0&&if_block0.c(),t0=space(),if_block1&&if_block1.c(),t1=space(),if_block2&&if_block2.c(),attr(div,"class",div_class_value=divClass+" "+ctx[5])},m(target,anchor){insert$1(target,div,anchor),if_block0&&if_block0.m(div,null),append(div,t0),if_block1&&if_block1.m(div,null),append(div,t1),if_block2&&if_block2.m(div,null),current=!0},p(ctx2,[dirty]){ctx2[3]===componentTypes.title.tooltipRight?if_block0?if_block0.p(ctx2,dirty):(if_block0=create_if_block_3$2(ctx2),if_block0.c(),if_block0.m(div,t0)):if_block0&&(if_block0.d(1),if_block0=null),ctx2[1]&&""!==ctx2[1]?if_block1?(if_block1.p(ctx2,dirty),2&dirty&&transition_in(if_block1,1)):(if_block1=create_if_block_2$2(ctx2),if_block1.c(),transition_in(if_block1,1),if_block1.m(div,t1)):if_block1&&(group_outros(),transition_out(if_block1,1,1,(()=>{if_block1=null})),check_outros()),ctx2[3]===componentTypes.title.tooltipLeft?if_block2?if_block2.p(ctx2,dirty):(if_block2=create_if_block$9(ctx2),if_block2.c(),if_block2.m(div,null)):if_block2&&(if_block2.d(1),if_block2=null),(!current||32&dirty&&div_class_value!==(div_class_value=divClass+" "+ctx2[5]))&&attr(div,"class",div_class_value)},i(local){current||(transition_in(if_block1),current=!0)},o(local){transition_out(if_block1),current=!1},d(detaching){detaching&&detach(div),if_block0&&if_block0.d(),if_block1&&if_block1.d(),if_block2&&if_block2.d()}}}let divClass="flex flex-row items-center",titleClass="text-[14px]";function instance$c($$self,$$props,$$invalidate){let{value:value=""}=$$props,{desc:desc}=$$props,{id:id2=""}=$$props,{type:type2=componentTypes.title.tooltipRight}=$$props,{tooltip:tooltip}=$$props,{customClasses:customClasses=""}=$$props;return $$self.$$set=$$props2=>{"value"in $$props2&&$$invalidate(0,value=$$props2.value),"desc"in $$props2&&$$invalidate(1,desc=$$props2.desc),"id"in $$props2&&$$invalidate(2,id2=$$props2.id),"type"in $$props2&&$$invalidate(3,type2=$$props2.type),"tooltip"in $$props2&&$$invalidate(4,tooltip=$$props2.tooltip),"customClasses"in $$props2&&$$invalidate(5,customClasses=$$props2.customClasses)},[value,desc,id2,type2,tooltip,customClasses]}let Main$8=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$c,create_fragment$c,safe_not_equal,{value:0,desc:1,id:2,type:3,tooltip:4,customClasses:5})}};function create_default_slot_1$5(ctx){let t2,t_value=(ctx[1]||"Reset value")+"";return{c(){t2=text(t_value)},m(target,anchor){insert$1(target,t2,anchor)},p(ctx2,dirty){2&dirty&&t_value!==(t_value=(ctx2[1]||"Reset value")+"")&&set_data(t2,t_value)},d(detaching){detaching&&detach(t2)}}}function create_default_slot$7(ctx){let fa,t2,tooltip,current;return fa=new Fa({props:{icon:faTrash}}),tooltip=new Tooltip({props:{class:"text-xs",$$slots:{default:[create_default_slot_1$5]},$$scope:{ctx:ctx}}}),{c(){create_component(fa.$$.fragment),t2=space(),create_component(tooltip.$$.fragment)},m(target,anchor){mount_component(fa,target,anchor),insert$1(target,t2,anchor),mount_component(tooltip,target,anchor),current=!0},p(ctx2,dirty){const tooltip_changes={};6&dirty&&(tooltip_changes.$$scope={dirty:dirty,ctx:ctx2}),tooltip.$set(tooltip_changes)},i(local){current||(transition_in(fa.$$.fragment,local),transition_in(tooltip.$$.fragment,local),current=!0)},o(local){transition_out(fa.$$.fragment,local),transition_out(tooltip.$$.fragment,local),current=!1},d(detaching){detaching&&detach(t2),destroy_component(fa,detaching),destroy_component(tooltip,detaching)}}}function create_fragment$b(ctx){let btn,current;return btn=new Btn({props:{color:componentTypes.btn.none,customClasses:"!px-2 my-0 px-1 ml-1 mt-0",$$slots:{default:[create_default_slot$7]},$$scope:{ctx:ctx}}}),btn.$on("click",(function(){is_function(ctx[0])&&ctx[0].apply(this,arguments)})),{c(){create_component(btn.$$.fragment)},m(target,anchor){mount_component(btn,target,anchor),current=!0},p(new_ctx,[dirty]){ctx=new_ctx;const btn_changes={};6&dirty&&(btn_changes.$$scope={dirty:dirty,ctx:ctx}),btn.$set(btn_changes)},i(local){current||(transition_in(btn.$$.fragment,local),current=!0)},o(local){transition_out(btn.$$.fragment,local),current=!1},d(detaching){destroy_component(btn,detaching)}}}function instance$b($$self,$$props,$$invalidate){let{onClick:onClick=(()=>{})}=$$props,{text:text2}=$$props;return $$self.$$set=$$props2=>{"onClick"in $$props2&&$$invalidate(0,onClick=$$props2.onClick),"text"in $$props2&&$$invalidate(1,text2=$$props2.text)},[onClick,text2]}class Reset extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$b,create_fragment$b,safe_not_equal,{onClick:0,text:1})}}function create_else_block$2(ctx){let div2,t0,t1,div0,title_1,t2,div1,show_if,show_if_1,current_block_type_index,if_block2,t3,div2_class_value,current,mounted,dispose,if_block0=ctx[4]&&create_if_block_12(ctx),if_block1=ctx[8]&&create_if_block_11(ctx);const title_1_spread_levels=[{id:ctx[1]+"-title"},ctx[3]];let title_1_props={};for(let i2=0;i2<title_1_spread_levels.length;i2+=1)title_1_props=assign(title_1_props,title_1_spread_levels[i2]);title_1=new Main$8({props:title_1_props});const if_block_creators=[create_if_block_2$1,create_if_block_3$1,create_if_block_4,create_if_block_5,create_if_block_6,create_if_block_7,create_if_block_8,create_if_block_9,create_if_block_10,create_else_block_1],if_blocks=[];function select_block_type_1(ctx2,dirty){return 69&dirty&&(show_if=null),69&dirty&&(show_if_1=null),ctx2[2]===componentTypes.option.btn?0:ctx2[2]===componentTypes.option.checkbox&&"boolean"==typeof ctx2[0]?1:ctx2[2]===componentTypes.option.text&&"string"==typeof ctx2[0]?2:ctx2[2]===componentTypes.option.number&&"number"==typeof ctx2[0]?3:(null==show_if&&(show_if=!(ctx2[2]!==componentTypes.option.radio||!ctx2[6]||!Array.isArray(ctx2[6])||"string"!=typeof ctx2[0])),show_if?4:(null==show_if_1&&(show_if_1=!(ctx2[2]!==componentTypes.option.select||!ctx2[6]||!Array.isArray(ctx2[6])||"string"!=typeof ctx2[0])),show_if_1?5:ctx2[2]===componentTypes.option.range&&"number"==typeof ctx2[0]?6:ctx2[2]===componentTypes.option.codeEditor&&"string"==typeof ctx2[0]?7:ctx2[2]===componentTypes.option.colorPicker&&"string"==typeof ctx2[0]?8:9))}current_block_type_index=select_block_type_1(ctx,-1),if_block2=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);let if_block3=ctx[7]&&create_if_block_1$5(ctx);return{c(){div2=element("div"),if_block0&&if_block0.c(),t0=space(),if_block1&&if_block1.c(),t1=space(),div0=element("div"),create_component(title_1.$$.fragment),t2=space(),div1=element("div"),if_block2.c(),t3=space(),if_block3&&if_block3.c(),attr(div0,"class",optionColClass),attr(div1,"class",optionColClass),attr(div2,"class",div2_class_value=optionClass+" "+ctx[5])},m(target,anchor){insert$1(target,div2,anchor),if_block0&&if_block0.m(div2,null),append(div2,t0),if_block1&&if_block1.m(div2,null),append(div2,t1),append(div2,div0),mount_component(title_1,div0,null),append(div2,t2),append(div2,div1),if_blocks[current_block_type_index].m(div1,null),append(div1,t3),if_block3&&if_block3.m(div1,null),current=!0,mounted||(dispose=[listen(div2,"mouseover",ctx[21]),listen(div2,"mouseout",ctx[22])],mounted=!0)},p(ctx2,dirty){ctx2[4]?if_block0?if_block0.p(ctx2,dirty):(if_block0=create_if_block_12(ctx2),if_block0.c(),if_block0.m(div2,t0)):if_block0&&(if_block0.d(1),if_block0=null),ctx2[8]?if_block1?(if_block1.p(ctx2,dirty),256&dirty&&transition_in(if_block1,1)):(if_block1=create_if_block_11(ctx2),if_block1.c(),transition_in(if_block1,1),if_block1.m(div2,t1)):if_block1&&(group_outros(),transition_out(if_block1,1,1,(()=>{if_block1=null})),check_outros());const title_1_changes=10&dirty?get_spread_update(title_1_spread_levels,[2&dirty&&{id:ctx2[1]+"-title"},8&dirty&&get_spread_object(ctx2[3])]):{};title_1.$set(title_1_changes);let previous_block_index=current_block_type_index;current_block_type_index=select_block_type_1(ctx2,dirty),current_block_type_index===previous_block_index?if_blocks[current_block_type_index].p(ctx2,dirty):(group_outros(),transition_out(if_blocks[previous_block_index],1,1,(()=>{if_blocks[previous_block_index]=null})),check_outros(),if_block2=if_blocks[current_block_type_index],if_block2?if_block2.p(ctx2,dirty):(if_block2=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx2),if_block2.c()),transition_in(if_block2,1),if_block2.m(div1,t3)),ctx2[7]?if_block3?(if_block3.p(ctx2,dirty),128&dirty&&transition_in(if_block3,1)):(if_block3=create_if_block_1$5(ctx2),if_block3.c(),transition_in(if_block3,1),if_block3.m(div1,null)):if_block3&&(group_outros(),transition_out(if_block3,1,1,(()=>{if_block3=null})),check_outros()),(!current||32&dirty&&div2_class_value!==(div2_class_value=optionClass+" "+ctx2[5]))&&attr(div2,"class",div2_class_value)},i(local){current||(transition_in(if_block1),transition_in(title_1.$$.fragment,local),transition_in(if_block2),transition_in(if_block3),current=!0)},o(local){transition_out(if_block1),transition_out(title_1.$$.fragment,local),transition_out(if_block2),transition_out(if_block3),current=!1},d(detaching){detaching&&detach(div2),if_block0&&if_block0.d(),if_block1&&if_block1.d(),destroy_component(title_1),if_blocks[current_block_type_index].d(),if_block3&&if_block3.d(),mounted=!1,run_all(dispose)}}}function create_if_block$8(ctx){let div,title_1,t2,div_class_value,current;const title_1_spread_levels=[{id:ctx[1]+"-title"},ctx[3]];let title_1_props={};for(let i2=0;i2<title_1_spread_levels.length;i2+=1)title_1_props=assign(title_1_props,title_1_spread_levels[i2]);title_1=new Main$8({props:title_1_props});const default_slot_template=ctx[12].default,default_slot=create_slot(default_slot_template,ctx,ctx[23],null);return{c(){div=element("div"),create_component(title_1.$$.fragment),t2=space(),default_slot&&default_slot.c(),attr(div,"class",div_class_value=sectionOptionClass+" "+ctx[5])},m(target,anchor){insert$1(target,div,anchor),mount_component(title_1,div,null),append(div,t2),default_slot&&default_slot.m(div,null),current=!0},p(ctx2,dirty){const title_1_changes=10&dirty?get_spread_update(title_1_spread_levels,[2&dirty&&{id:ctx2[1]+"-title"},8&dirty&&get_spread_object(ctx2[3])]):{};title_1.$set(title_1_changes),default_slot&&default_slot.p&&(!current||8388608&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[23],current?get_slot_changes(default_slot_template,ctx2[23],dirty,null):get_all_dirty_from_scope(ctx2[23]),null),(!current||32&dirty&&div_class_value!==(div_class_value=sectionOptionClass+" "+ctx2[5]))&&attr(div,"class",div_class_value)},i(local){current||(transition_in(title_1.$$.fragment,local),transition_in(default_slot,local),current=!0)},o(local){transition_out(title_1.$$.fragment,local),transition_out(default_slot,local),current=!1},d(detaching){detaching&&detach(div),destroy_component(title_1),default_slot&&default_slot.d(detaching)}}}function create_if_block_12(ctx){let div,t2,div_class_value,t_value=("string"==typeof ctx[4]?ctx[4]:"Disabled")+"";return{c(){div=element("div"),t2=text(t_value),attr(div,"class",div_class_value=optionDisabledClass+" "+(ctx[9]?"flex":"hidden"))},m(target,anchor){insert$1(target,div,anchor),append(div,t2)},p(ctx2,dirty){16&dirty&&t_value!==(t_value=("string"==typeof ctx2[4]?ctx2[4]:"Disabled")+"")&&set_data(t2,t_value),512&dirty&&div_class_value!==(div_class_value=optionDisabledClass+" "+(ctx2[9]?"flex":"hidden"))&&attr(div,"class",div_class_value)},d(detaching){detaching&&detach(div)}}}function create_if_block_11(ctx){let indicator_1,current;const indicator_1_spread_levels=[ctx[8]];let indicator_1_props={};for(let i2=0;i2<indicator_1_spread_levels.length;i2+=1)indicator_1_props=assign(indicator_1_props,indicator_1_spread_levels[i2]);return indicator_1=new Main$2({props:indicator_1_props}),{c(){create_component(indicator_1.$$.fragment)},m(target,anchor){mount_component(indicator_1,target,anchor),current=!0},p(ctx2,dirty){const indicator_1_changes=256&dirty?get_spread_update(indicator_1_spread_levels,[get_spread_object(ctx2[8])]):{};indicator_1.$set(indicator_1_changes)},i(local){current||(transition_in(indicator_1.$$.fragment,local),current=!0)},o(local){transition_out(indicator_1.$$.fragment,local),current=!1},d(detaching){destroy_component(indicator_1,detaching)}}}function create_else_block_1(ctx){let t2;return{c(){t2=text("No option set!")},m(target,anchor){insert$1(target,t2,anchor)},p:noop,i:noop,o:noop,d(detaching){detaching&&detach(t2)}}}function create_if_block_10(ctx){let colorpicker,updating_value,current;function colorpicker_value_binding(value){ctx[20](value)}let colorpicker_props={id:ctx[1],type:componentTypes.colorPicker.nativeAndOpacity,disabled:!!ctx[4]};return void 0!==ctx[0]&&(colorpicker_props.value=ctx[0]),colorpicker=new Color_picker({props:colorpicker_props}),binding_callbacks.push((()=>bind(colorpicker,"value",colorpicker_value_binding))),{c(){create_component(colorpicker.$$.fragment)},m(target,anchor){mount_component(colorpicker,target,anchor),current=!0},p(ctx2,dirty){const colorpicker_changes={};2&dirty&&(colorpicker_changes.id=ctx2[1]),16&dirty&&(colorpicker_changes.disabled=!!ctx2[4]),!updating_value&&1&dirty&&(updating_value=!0,colorpicker_changes.value=ctx2[0],add_flush_callback((()=>updating_value=!1))),colorpicker.$set(colorpicker_changes)},i(local){current||(transition_in(colorpicker.$$.fragment,local),current=!0)},o(local){transition_out(colorpicker.$$.fragment,local),current=!1},d(detaching){destroy_component(colorpicker,detaching)}}}function create_if_block_9(ctx){let codeeditor,updating_value,current;function codeeditor_value_binding(value){ctx[19](value)}let codeeditor_props={type:componentTypes.codeEditor.json,readonly:!!ctx[4],width:"250px",height:"100px"};return void 0!==ctx[0]&&(codeeditor_props.value=ctx[0]),codeeditor=new Code_editor({props:codeeditor_props}),binding_callbacks.push((()=>bind(codeeditor,"value",codeeditor_value_binding))),{c(){create_component(codeeditor.$$.fragment)},m(target,anchor){mount_component(codeeditor,target,anchor),current=!0},p(ctx2,dirty){const codeeditor_changes={};16&dirty&&(codeeditor_changes.readonly=!!ctx2[4]),!updating_value&&1&dirty&&(updating_value=!0,codeeditor_changes.value=ctx2[0],add_flush_callback((()=>updating_value=!1))),codeeditor.$set(codeeditor_changes)},i(local){current||(transition_in(codeeditor.$$.fragment,local),current=!0)},o(local){transition_out(codeeditor.$$.fragment,local),current=!1},d(detaching){destroy_component(codeeditor,detaching)}}}function create_if_block_8(ctx){let range,updating_value,current;function range_value_binding(value){ctx[18](value)}let range_props={id:ctx[1],opts:ctx[10],inputValue:!0,customClasses:"mx-4",disabled:!!ctx[4]};return void 0!==ctx[0]&&(range_props.value=ctx[0]),range=new Range_1({props:range_props}),binding_callbacks.push((()=>bind(range,"value",range_value_binding))),{c(){create_component(range.$$.fragment)},m(target,anchor){mount_component(range,target,anchor),current=!0},p(ctx2,dirty){const range_changes={};2&dirty&&(range_changes.id=ctx2[1]),16&dirty&&(range_changes.disabled=!!ctx2[4]),!updating_value&&1&dirty&&(updating_value=!0,range_changes.value=ctx2[0],add_flush_callback((()=>updating_value=!1))),range.$set(range_changes)},i(local){current||(transition_in(range.$$.fragment,local),current=!0)},o(local){transition_out(range.$$.fragment,local),current=!1},d(detaching){destroy_component(range,detaching)}}}function create_if_block_7(ctx){let select,updating_value,current;function select_value_binding(value){ctx[17](value)}let select_props={id:ctx[1],opts:ctx[6],customClasses:"flex gap-3",disabled:!!ctx[4]};return void 0!==ctx[0]&&(select_props.value=ctx[0]),select=new Select({props:select_props}),binding_callbacks.push((()=>bind(select,"value",select_value_binding))),{c(){create_component(select.$$.fragment)},m(target,anchor){mount_component(select,target,anchor),current=!0},p(ctx2,dirty){const select_changes={};2&dirty&&(select_changes.id=ctx2[1]),64&dirty&&(select_changes.opts=ctx2[6]),16&dirty&&(select_changes.disabled=!!ctx2[4]),!updating_value&&1&dirty&&(updating_value=!0,select_changes.value=ctx2[0],add_flush_callback((()=>updating_value=!1))),select.$set(select_changes)},i(local){current||(transition_in(select.$$.fragment,local),current=!0)},o(local){transition_out(select.$$.fragment,local),current=!1},d(detaching){destroy_component(select,detaching)}}}function create_if_block_6(ctx){let radio,updating_value,current;function radio_value_binding(value){ctx[16](value)}let radio_props={id:ctx[1],opts:ctx[6],customClasses:"flex gap-3",disabled:!!ctx[4]};return void 0!==ctx[0]&&(radio_props.value=ctx[0]),radio=new Radio_1({props:radio_props}),binding_callbacks.push((()=>bind(radio,"value",radio_value_binding))),{c(){create_component(radio.$$.fragment)},m(target,anchor){mount_component(radio,target,anchor),current=!0},p(ctx2,dirty){const radio_changes={};2&dirty&&(radio_changes.id=ctx2[1]),64&dirty&&(radio_changes.opts=ctx2[6]),16&dirty&&(radio_changes.disabled=!!ctx2[4]),!updating_value&&1&dirty&&(updating_value=!0,radio_changes.value=ctx2[0],add_flush_callback((()=>updating_value=!1))),radio.$set(radio_changes)},i(local){current||(transition_in(radio.$$.fragment,local),current=!0)},o(local){transition_out(radio.$$.fragment,local),current=!1},d(detaching){destroy_component(radio,detaching)}}}function create_if_block_5(ctx){let number2,updating_value,current;function number_value_binding(value){ctx[15](value)}let number_props={id:ctx[1],customClasses:"flex gap-3",disabled:!!ctx[4]};return void 0!==ctx[0]&&(number_props.value=ctx[0]),number2=new Number$1({props:number_props}),binding_callbacks.push((()=>bind(number2,"value",number_value_binding))),{c(){create_component(number2.$$.fragment)},m(target,anchor){mount_component(number2,target,anchor),current=!0},p(ctx2,dirty){const number_changes={};2&dirty&&(number_changes.id=ctx2[1]),16&dirty&&(number_changes.disabled=!!ctx2[4]),!updating_value&&1&dirty&&(updating_value=!0,number_changes.value=ctx2[0],add_flush_callback((()=>updating_value=!1))),number2.$set(number_changes)},i(local){current||(transition_in(number2.$$.fragment,local),current=!0)},o(local){transition_out(number2.$$.fragment,local),current=!1},d(detaching){destroy_component(number2,detaching)}}}function create_if_block_4(ctx){let text_1,updating_value,current;function text_1_value_binding(value){ctx[14](value)}let text_1_props={id:ctx[1],customClasses:"flex gap-3",disabled:!!ctx[4]};return void 0!==ctx[0]&&(text_1_props.value=ctx[0]),text_1=new Text$1({props:text_1_props}),binding_callbacks.push((()=>bind(text_1,"value",text_1_value_binding))),{c(){create_component(text_1.$$.fragment)},m(target,anchor){mount_component(text_1,target,anchor),current=!0},p(ctx2,dirty){const text_1_changes={};2&dirty&&(text_1_changes.id=ctx2[1]),16&dirty&&(text_1_changes.disabled=!!ctx2[4]),!updating_value&&1&dirty&&(updating_value=!0,text_1_changes.value=ctx2[0],add_flush_callback((()=>updating_value=!1))),text_1.$set(text_1_changes)},i(local){current||(transition_in(text_1.$$.fragment,local),current=!0)},o(local){transition_out(text_1.$$.fragment,local),current=!1},d(detaching){destroy_component(text_1,detaching)}}}function create_if_block_3$1(ctx){let checkbox,updating_value,current;function checkbox_value_binding(value){ctx[13](value)}let checkbox_props={id:ctx[1],disabled:!!ctx[4]};return void 0!==ctx[0]&&(checkbox_props.value=ctx[0]),checkbox=new Checkbox({props:checkbox_props}),binding_callbacks.push((()=>bind(checkbox,"value",checkbox_value_binding))),{c(){create_component(checkbox.$$.fragment)},m(target,anchor){mount_component(checkbox,target,anchor),current=!0},p(ctx2,dirty){const checkbox_changes={};2&dirty&&(checkbox_changes.id=ctx2[1]),16&dirty&&(checkbox_changes.disabled=!!ctx2[4]),!updating_value&&1&dirty&&(updating_value=!0,checkbox_changes.value=ctx2[0],add_flush_callback((()=>updating_value=!1))),checkbox.$set(checkbox_changes)},i(local){current||(transition_in(checkbox.$$.fragment,local),current=!0)},o(local){transition_out(checkbox.$$.fragment,local),current=!1},d(detaching){destroy_component(checkbox,detaching)}}}function create_if_block_2$1(ctx){let btn,current;return btn=new Btn({props:{$$slots:{default:[create_default_slot$6]},$$scope:{ctx:ctx}}}),{c(){create_component(btn.$$.fragment)},m(target,anchor){mount_component(btn,target,anchor),current=!0},p(ctx2,dirty){const btn_changes={};8388609&dirty&&(btn_changes.$$scope={dirty:dirty,ctx:ctx2}),btn.$set(btn_changes)},i(local){current||(transition_in(btn.$$.fragment,local),current=!0)},o(local){transition_out(btn.$$.fragment,local),current=!1},d(detaching){destroy_component(btn,detaching)}}}function create_default_slot$6(ctx){let t2;return{c(){t2=text(ctx[0])},m(target,anchor){insert$1(target,t2,anchor)},p(ctx2,dirty){1&dirty&&set_data(t2,ctx2[0])},d(detaching){detaching&&detach(t2)}}}function create_if_block_1$5(ctx){let reset,current;return reset=new Reset({props:{onClick:ctx[7]}}),{c(){create_component(reset.$$.fragment)},m(target,anchor){mount_component(reset,target,anchor),current=!0},p(ctx2,dirty){const reset_changes={};128&dirty&&(reset_changes.onClick=ctx2[7]),reset.$set(reset_changes)},i(local){current||(transition_in(reset.$$.fragment,local),current=!0)},o(local){transition_out(reset.$$.fragment,local),current=!1},d(detaching){destroy_component(reset,detaching)}}}function create_fragment$a(ctx){let current_block_type_index,if_block,if_block_anchor,current;const if_block_creators=[create_if_block$8,create_else_block$2],if_blocks=[];function select_block_type(ctx2,dirty){return ctx2[2]===componentTypes.option.section?0:1}return current_block_type_index=select_block_type(ctx),if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx),{c(){if_block.c(),if_block_anchor=empty$1()},m(target,anchor){if_blocks[current_block_type_index].m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,[dirty]){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx2),current_block_type_index===previous_block_index?if_blocks[current_block_type_index].p(ctx2,dirty):(group_outros(),transition_out(if_blocks[previous_block_index],1,1,(()=>{if_blocks[previous_block_index]=null})),check_outros(),if_block=if_blocks[current_block_type_index],if_block?if_block.p(ctx2,dirty):(if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx2),if_block.c()),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor))},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(if_block_anchor),if_blocks[current_block_type_index].d(detaching)}}}let sectionOptionClass="p-2",optionClass="w-full bg-gray-200/50 dark:bg-gray-800 px-4 py-2 my-2 flex flex-row items-center justify-between rounded-lg relative hover:shadow-[0_0_20px_0px_rgba(0,0,0,0.3)] hover:shadow-gray-600/30",optionDisabledClass="absolute z-10 inset-0 w-full h-full items-center justify-center bg-opacity-30 backdrop-blur-lg rounded-lg",optionColClass="flex flex-row items-center";function instance$a($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope:$$scope}=$$props,{type:type2=componentTypes.option.checkbox}=$$props,{id:id2=""}=$$props,{value:value}=$$props,{title:title}=$$props,{disabled:disabled}=$$props,{customClasses:customClasses=""}=$$props,{opts:opts}=$$props,{onChange:onChange}=$$props,{onReset:onReset}=$$props,{indicator:indicator}=$$props,isHovered=!1;const rangeOpts=type2===componentTypes.option.range?opts:void 0;id2||(id2=functs.generateRamdomID());return $$self.$$set=$$props2=>{"type"in $$props2&&$$invalidate(2,type2=$$props2.type),"id"in $$props2&&$$invalidate(1,id2=$$props2.id),"value"in $$props2&&$$invalidate(0,value=$$props2.value),"title"in $$props2&&$$invalidate(3,title=$$props2.title),"disabled"in $$props2&&$$invalidate(4,disabled=$$props2.disabled),"customClasses"in $$props2&&$$invalidate(5,customClasses=$$props2.customClasses),"opts"in $$props2&&$$invalidate(6,opts=$$props2.opts),"onChange"in $$props2&&$$invalidate(11,onChange=$$props2.onChange),"onReset"in $$props2&&$$invalidate(7,onReset=$$props2.onReset),"indicator"in $$props2&&$$invalidate(8,indicator=$$props2.indicator),"$$scope"in $$props2&&$$invalidate(23,$$scope=$$props2.$$scope)},$$self.$$.update=()=>{if(2113&$$self.$$.dirty&&onChange&&"function"==typeof onChange){const isOpt=opts&&"object"==typeof opts&&"unit"in opts&&"object"==typeof opts.unit;(value||isOpt)&&onChange(value)}},[value,id2,type2,title,disabled,customClasses,opts,onReset,indicator,isHovered,rangeOpts,onChange,slots,function(value$1){value=value$1,$$invalidate(0,value)},function(value$1){value=value$1,$$invalidate(0,value)},function(value$1){value=value$1,$$invalidate(0,value)},function(value$1){value=value$1,$$invalidate(0,value)},function(value$1){value=value$1,$$invalidate(0,value)},function(value$1){value=value$1,$$invalidate(0,value)},function(value$1){value=value$1,$$invalidate(0,value)},function(value$1){value=value$1,$$invalidate(0,value)},()=>$$invalidate(9,isHovered=!0),()=>$$invalidate(9,isHovered=!1),$$scope]}let Main$7=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$a,create_fragment$a,safe_not_equal,{type:2,id:1,value:0,title:3,disabled:4,customClasses:5,opts:6,onChange:11,onReset:7,indicator:8})}};function create_if_block$7(ctx){let option,updating_value,current;const option_spread_levels=[ctx[0],{onReset:ctx[12]},{disabled:!(!ctx[3]||ctx[4][ctx[0].id])&&ctx[5].limit.optionBlock},{indicator:ctx[4][ctx[0].id]?ctx[10]:void 0}];function option_value_binding(value){ctx[13](value)}let option_props={};for(let i2=0;i2<option_spread_levels.length;i2+=1)option_props=assign(option_props,option_spread_levels[i2]);return void 0!==ctx[2][ctx[1].parent].value[ctx[1].list].value&&(option_props.value=ctx[2][ctx[1].parent].value[ctx[1].list].value),option=new Main$7({props:option_props}),binding_callbacks.push((()=>bind(option,"value",option_value_binding))),{c(){create_component(option.$$.fragment)},m(target,anchor){mount_component(option,target,anchor),current=!0},p(ctx2,dirty){const option_changes=1337&dirty?get_spread_update(option_spread_levels,[1&dirty&&get_spread_object(ctx2[0]),257&dirty&&{onReset:ctx2[12]},57&dirty&&{disabled:!(!ctx2[3]||ctx2[4][ctx2[0].id])&&ctx2[5].limit.optionBlock},1041&dirty&&{indicator:ctx2[4][ctx2[0].id]?ctx2[10]:void 0}]):{};!updating_value&&6&dirty&&(updating_value=!0,option_changes.value=ctx2[2][ctx2[1].parent].value[ctx2[1].list].value,add_flush_callback((()=>updating_value=!1))),option.$set(option_changes)},i(local){current||(transition_in(option.$$.fragment,local),current=!0)},o(local){transition_out(option.$$.fragment,local),current=!1},d(detaching){destroy_component(option,detaching)}}}function create_fragment$9(ctx){let if_block_anchor,current,if_block=ctx[0]&&ctx[1]&&"object"==typeof ctx[1]&&"parent"in ctx[1]&&"list"in ctx[1]&&create_if_block$7(ctx);return{c(){if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){if_block&&if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,[dirty]){ctx2[0]&&ctx2[1]&&"object"==typeof ctx2[1]&&"parent"in ctx2[1]&&"list"in ctx2[1]?if_block?(if_block.p(ctx2,dirty),3&dirty&&transition_in(if_block,1)):(if_block=create_if_block$7(ctx2),if_block.c(),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block&&(group_outros(),transition_out(if_block,1,1,(()=>{if_block=null})),check_outros())},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(if_block_anchor),if_block&&if_block.d(detaching)}}}function instance$9($$self,$$props,$$invalidate){let $custom,$isBlocked,$notInDefaultList,$locales,{value:value}=$$props,{keys:keys2}=$$props;const{custom:custom2,locales:locales2}=filters;component_subscribe($$self,custom2,(value2=>$$invalidate(2,$custom=value2))),component_subscribe($$self,locales2,(value2=>$$invalidate(5,$locales=value2)));const{resetValue:resetValue,valuesNotInDefault:valuesNotInDefault,isBlocked:isBlocked}=custom2;component_subscribe($$self,isBlocked,(value2=>$$invalidate(3,$isBlocked=value2)));const indicatorObj={position:componentPositions.indicator.left,type:componentTypes.indicator.neutral,customClasses:"!bg-primary-700 !w-2 !h-2"},notInDefaultList=valuesNotInDefault.list;component_subscribe($$self,notInDefaultList,(value2=>$$invalidate(4,$notInDefaultList=value2)));return $$self.$$set=$$props2=>{"value"in $$props2&&$$invalidate(0,value=$$props2.value),"keys"in $$props2&&$$invalidate(1,keys2=$$props2.keys)},[value,keys2,$custom,$isBlocked,$notInDefaultList,$locales,custom2,locales2,resetValue,isBlocked,indicatorObj,notInDefaultList,()=>{value&&resetValue(value.id)},function(value2){$$self.$$.not_equal($custom[keys2.parent].value[keys2.list].value,value2)&&($custom[keys2.parent].value[keys2.list].value=value2,custom2.set($custom))}]}class Option_1 extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$9,create_fragment$9,safe_not_equal,{value:0,keys:1})}}function create_if_block_3(ctx){let accordion,current;return accordion=new Accordion({props:{flush:!0,class:"w-full "+ctx[4],$$slots:{default:[create_default_slot_1$4]},$$scope:{ctx:ctx}}}),{c(){create_component(accordion.$$.fragment)},m(target,anchor){mount_component(accordion,target,anchor),current=!0},p(ctx2,dirty){const accordion_changes={};16&dirty&&(accordion_changes.class="w-full "+ctx2[4]),128&dirty&&(accordion_changes.$$scope={dirty:dirty,ctx:ctx2}),accordion.$set(accordion_changes)},i(local){current||(transition_in(accordion.$$.fragment,local),current=!0)},o(local){transition_out(accordion.$$.fragment,local),current=!1},d(detaching){destroy_component(accordion,detaching)}}}function create_if_block$6(ctx){let accordionitem,updating_open,current;function accordionitem_open_binding(value){ctx[6](value)}let accordionitem_props={borderClass:"border-none",borderBottomClass:"border-none",class:ctx[4],$$slots:{header:[create_header_slot],default:[create_default_slot$5]},$$scope:{ctx:ctx}};return void 0!==ctx[0]&&(accordionitem_props.open=ctx[0]),accordionitem=new AccordionItem({props:accordionitem_props}),binding_callbacks.push((()=>bind(accordionitem,"open",accordionitem_open_binding))),{c(){create_component(accordionitem.$$.fragment)},m(target,anchor){mount_component(accordionitem,target,anchor),current=!0},p(ctx2,dirty){const accordionitem_changes={};16&dirty&&(accordionitem_changes.class=ctx2[4]),138&dirty&&(accordionitem_changes.$$scope={dirty:dirty,ctx:ctx2}),!updating_open&&1&dirty&&(updating_open=!0,accordionitem_changes.open=ctx2[0],add_flush_callback((()=>updating_open=!1))),accordionitem.$set(accordionitem_changes)},i(local){current||(transition_in(accordionitem.$$.fragment,local),current=!0)},o(local){transition_out(accordionitem.$$.fragment,local),current=!1},d(detaching){destroy_component(accordionitem,detaching)}}}function create_default_slot_1$4(ctx){let current;const default_slot_template=ctx[5].default,default_slot=create_slot(default_slot_template,ctx,ctx[7],null);return{c(){default_slot&&default_slot.c()},m(target,anchor){default_slot&&default_slot.m(target,anchor),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||128&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[7],current?get_slot_changes(default_slot_template,ctx2[7],dirty,null):get_all_dirty_from_scope(ctx2[7]),null)},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){default_slot&&default_slot.d(detaching)}}}function create_default_slot$5(ctx){let current;const default_slot_template=ctx[5].default,default_slot=create_slot(default_slot_template,ctx,ctx[7],null);return{c(){default_slot&&default_slot.c()},m(target,anchor){default_slot&&default_slot.m(target,anchor),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||128&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[7],current?get_slot_changes(default_slot_template,ctx2[7],dirty,null):get_all_dirty_from_scope(ctx2[7]),null)},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){default_slot&&default_slot.d(detaching)}}}function create_if_block_2(ctx){let title_1,current;const title_1_spread_levels=[ctx[1]];let title_1_props={};for(let i2=0;i2<title_1_spread_levels.length;i2+=1)title_1_props=assign(title_1_props,title_1_spread_levels[i2]);return title_1=new Main$8({props:title_1_props}),{c(){create_component(title_1.$$.fragment)},m(target,anchor){mount_component(title_1,target,anchor),current=!0},p(ctx2,dirty){const title_1_changes=2&dirty?get_spread_update(title_1_spread_levels,[get_spread_object(ctx2[1])]):{};title_1.$set(title_1_changes)},i(local){current||(transition_in(title_1.$$.fragment,local),current=!0)},o(local){transition_out(title_1.$$.fragment,local),current=!1},d(detaching){destroy_component(title_1,detaching)}}}function create_if_block_1$4(ctx){let indicator_1,current;const indicator_1_spread_levels=[{position:componentPositions.indicator.left},{customClasses:"ml-[-9px]"},ctx[3]];let indicator_1_props={};for(let i2=0;i2<indicator_1_spread_levels.length;i2+=1)indicator_1_props=assign(indicator_1_props,indicator_1_spread_levels[i2]);return indicator_1=new Main$2({props:indicator_1_props}),{c(){create_component(indicator_1.$$.fragment)},m(target,anchor){mount_component(indicator_1,target,anchor),current=!0},p(ctx2,dirty){const indicator_1_changes=8&dirty?get_spread_update(indicator_1_spread_levels,[indicator_1_spread_levels[0],indicator_1_spread_levels[1],get_spread_object(ctx2[3])]):{};indicator_1.$set(indicator_1_changes)},i(local){current||(transition_in(indicator_1.$$.fragment,local),current=!0)},o(local){transition_out(indicator_1.$$.fragment,local),current=!1},d(detaching){destroy_component(indicator_1,detaching)}}}function create_header_slot(ctx){let span,t2,current,if_block0=ctx[1]&&ctx[1].value&&create_if_block_2(ctx),if_block1=ctx[3]&&create_if_block_1$4(ctx);return{c(){span=element("span"),if_block0&&if_block0.c(),t2=space(),if_block1&&if_block1.c(),attr(span,"slot","header"),attr(span,"class","relative")},m(target,anchor){insert$1(target,span,anchor),if_block0&&if_block0.m(span,null),append(span,t2),if_block1&&if_block1.m(span,null),current=!0},p(ctx2,dirty){ctx2[1]&&ctx2[1].value?if_block0?(if_block0.p(ctx2,dirty),2&dirty&&transition_in(if_block0,1)):(if_block0=create_if_block_2(ctx2),if_block0.c(),transition_in(if_block0,1),if_block0.m(span,t2)):if_block0&&(group_outros(),transition_out(if_block0,1,1,(()=>{if_block0=null})),check_outros()),ctx2[3]?if_block1?(if_block1.p(ctx2,dirty),8&dirty&&transition_in(if_block1,1)):(if_block1=create_if_block_1$4(ctx2),if_block1.c(),transition_in(if_block1,1),if_block1.m(span,null)):if_block1&&(group_outros(),transition_out(if_block1,1,1,(()=>{if_block1=null})),check_outros())},i(local){current||(transition_in(if_block0),transition_in(if_block1),current=!0)},o(local){transition_out(if_block0),transition_out(if_block1),current=!1},d(detaching){detaching&&detach(span),if_block0&&if_block0.d(),if_block1&&if_block1.d()}}}function create_fragment$8(ctx){let current_block_type_index,if_block,if_block_anchor,current;const if_block_creators=[create_if_block$6,create_if_block_3],if_blocks=[];function select_block_type(ctx2,dirty){return ctx2[2]===componentTypes.accordion.item?0:ctx2[2]===componentTypes.accordion.section?1:-1}return~(current_block_type_index=select_block_type(ctx))&&(if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx)),{c(){if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){~current_block_type_index&&if_blocks[current_block_type_index].m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,[dirty]){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx2),current_block_type_index===previous_block_index?~current_block_type_index&&if_blocks[current_block_type_index].p(ctx2,dirty):(if_block&&(group_outros(),transition_out(if_blocks[previous_block_index],1,1,(()=>{if_blocks[previous_block_index]=null})),check_outros()),~current_block_type_index?(if_block=if_blocks[current_block_type_index],if_block?if_block.p(ctx2,dirty):(if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx2),if_block.c()),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block=null)},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(if_block_anchor),~current_block_type_index&&if_blocks[current_block_type_index].d(detaching)}}}function instance$8($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope:$$scope}=$$props,{title:title}=$$props,{type:type2=componentTypes.accordion.item}=$$props,{open:open=!1}=$$props,{indicator:indicator}=$$props,{customClasses:customClasses=""}=$$props;return functs.generateRamdomID(),$$self.$$set=$$props2=>{"title"in $$props2&&$$invalidate(1,title=$$props2.title),"type"in $$props2&&$$invalidate(2,type2=$$props2.type),"open"in $$props2&&$$invalidate(0,open=$$props2.open),"indicator"in $$props2&&$$invalidate(3,indicator=$$props2.indicator),"customClasses"in $$props2&&$$invalidate(4,customClasses=$$props2.customClasses),"$$scope"in $$props2&&$$invalidate(7,$$scope=$$props2.$$scope)},[open,title,type2,indicator,customClasses,slots,function(value){open=value,$$invalidate(0,open)},$$scope]}let Main$6=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$8,create_fragment$8,safe_not_equal,{title:1,type:2,open:0,indicator:3,customClasses:4})}};function create_default_slot$4(ctx){let h4,t0,t1,span,t2,t0_value=ctx[0].custom.animation.nots.comingsoon.title+"",t2_value=ctx[0].custom.animation.nots.comingsoon.desc+"";return{c(){h4=element("h4"),t0=text(t0_value),t1=space(),span=element("span"),t2=text(t2_value),attr(h4,"class","font-bold"),attr(span,"class","opacity-75")},m(target,anchor){insert$1(target,h4,anchor),append(h4,t0),insert$1(target,t1,anchor),insert$1(target,span,anchor),append(span,t2)},p(ctx2,dirty){1&dirty&&t0_value!==(t0_value=ctx2[0].custom.animation.nots.comingsoon.title+"")&&set_data(t0,t0_value),1&dirty&&t2_value!==(t2_value=ctx2[0].custom.animation.nots.comingsoon.desc+"")&&set_data(t2,t2_value)},d(detaching){detaching&&(detach(h4),detach(t1),detach(span))}}}function create_fragment$7(ctx){let not,current;return not=new Main$1({props:{type:componentTypes.notification.info,$$slots:{default:[create_default_slot$4]},$$scope:{ctx:ctx}}}),{c(){create_component(not.$$.fragment)},m(target,anchor){mount_component(not,target,anchor),current=!0},p(ctx2,[dirty]){const not_changes={};5&dirty&&(not_changes.$$scope={dirty:dirty,ctx:ctx2}),not.$set(not_changes)},i(local){current||(transition_in(not.$$.fragment,local),current=!0)},o(local){transition_out(not.$$.fragment,local),current=!1},d(detaching){destroy_component(not,detaching)}}}function instance$7($$self,$$props,$$invalidate){let $locales;const{locales:locales2}=filters;return component_subscribe($$self,locales2,(value=>$$invalidate(0,$locales=value))),[$locales,locales2]}class Animation extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$7,create_fragment$7,safe_not_equal,{})}}function get_each_context$1(ctx,list,i2){const child_ctx=ctx.slice();return child_ctx[18]=list[i2][0],child_ctx[19]=list[i2][1],child_ctx[20]=list,child_ctx[21]=i2,child_ctx}function get_each_context_1$1(ctx,list,i2){const child_ctx=ctx.slice();return child_ctx[22]=list[i2],child_ctx[24]=i2,child_ctx}function create_if_block_1$3(ctx){let accordion,updating_open,current;function accordion_open_binding(value){ctx[13](value,ctx[18])}let accordion_props={type:componentTypes.accordion.item,title:ctx[19].title,indicator:ctx[12](ctx[18],ctx[0],ctx[2])?ctx[10]:void 0,$$slots:{default:[create_default_slot_3]},$$scope:{ctx:ctx}};return void 0!==ctx[2][ctx[18]]&&(accordion_props.open=ctx[2][ctx[18]]),accordion=new Main$6({props:accordion_props}),binding_callbacks.push((()=>bind(accordion,"open",accordion_open_binding))),{c(){create_component(accordion.$$.fragment)},m(target,anchor){mount_component(accordion,target,anchor),current=!0},p(new_ctx,dirty){ctx=new_ctx;const accordion_changes={};2&dirty&&(accordion_changes.title=ctx[19].title),7&dirty&&(accordion_changes.indicator=ctx[12](ctx[18],ctx[0],ctx[2])?ctx[10]:void 0),33554434&dirty&&(accordion_changes.$$scope={dirty:dirty,ctx:ctx}),!updating_open&&6&dirty&&(updating_open=!0,accordion_changes.open=ctx[2][ctx[18]],add_flush_callback((()=>updating_open=!1))),accordion.$set(accordion_changes)},i(local){current||(transition_in(accordion.$$.fragment,local),current=!0)},o(local){transition_out(accordion.$$.fragment,local),current=!1},d(detaching){destroy_component(accordion,detaching)}}}function create_each_block_1$1(ctx){let option,current;return option=new Option_1({props:{keys:{parent:ctx[18],list:ctx[24]},value:ctx[22]}}),{c(){create_component(option.$$.fragment)},m(target,anchor){mount_component(option,target,anchor),current=!0},p(ctx2,dirty){const option_changes={};2&dirty&&(option_changes.keys={parent:ctx2[18],list:ctx2[24]}),2&dirty&&(option_changes.value=ctx2[22]),option.$set(option_changes)},i(local){current||(transition_in(option.$$.fragment,local),current=!0)},o(local){transition_out(option.$$.fragment,local),current=!1},d(detaching){destroy_component(option,detaching)}}}function create_default_slot_3(ctx){let t2,current,each_value_1=ensure_array_like(ctx[19].value),each_blocks=[];for(let i2=0;i2<each_value_1.length;i2+=1)each_blocks[i2]=create_each_block_1$1(get_each_context_1$1(ctx,each_value_1,i2));const out=i2=>transition_out(each_blocks[i2],1,1,(()=>{each_blocks[i2]=null}));return{c(){for(let i2=0;i2<each_blocks.length;i2+=1)each_blocks[i2].c();t2=space()},m(target,anchor){for(let i2=0;i2<each_blocks.length;i2+=1)each_blocks[i2]&&each_blocks[i2].m(target,anchor);insert$1(target,t2,anchor),current=!0},p(ctx2,dirty){if(2&dirty){let i2;for(each_value_1=ensure_array_like(ctx2[19].value),i2=0;i2<each_value_1.length;i2+=1){const child_ctx=get_each_context_1$1(ctx2,each_value_1,i2);each_blocks[i2]?(each_blocks[i2].p(child_ctx,dirty),transition_in(each_blocks[i2],1)):(each_blocks[i2]=create_each_block_1$1(child_ctx),each_blocks[i2].c(),transition_in(each_blocks[i2],1),each_blocks[i2].m(t2.parentNode,t2))}for(group_outros(),i2=each_value_1.length;i2<each_blocks.length;i2+=1)out(i2);check_outros()}},i(local){if(!current){for(let i2=0;i2<each_value_1.length;i2+=1)transition_in(each_blocks[i2]);current=!0}},o(local){each_blocks=each_blocks.filter(Boolean);for(let i2=0;i2<each_blocks.length;i2+=1)transition_out(each_blocks[i2]);current=!1},d(detaching){detaching&&detach(t2),destroy_each(each_blocks,detaching)}}}function create_each_block$1(ctx){let if_block_anchor,current,show_if=ctx[18]&&ctx[11](ctx[18]),if_block=show_if&&create_if_block_1$3(ctx);return{c(){if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){if_block&&if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,dirty){2&dirty&&(show_if=ctx2[18]&&ctx2[11](ctx2[18])),show_if?if_block?(if_block.p(ctx2,dirty),2&dirty&&transition_in(if_block,1)):(if_block=create_if_block_1$3(ctx2),if_block.c(),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block&&(group_outros(),transition_out(if_block,1,1,(()=>{if_block=null})),check_outros())},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(if_block_anchor),if_block&&if_block.d(detaching)}}}function create_default_slot_2$2(ctx){let animation,current;return animation=new Animation({}),{c(){create_component(animation.$$.fragment)},m(target,anchor){mount_component(animation,target,anchor),current=!0},i(local){current||(transition_in(animation.$$.fragment,local),current=!0)},o(local){transition_out(animation.$$.fragment,local),current=!1},d(detaching){destroy_component(animation,detaching)}}}function create_default_slot_1$3(ctx){let t2,t_value=ctx[3].custom.addPreset.title+"";return{c(){t2=text(t_value)},m(target,anchor){insert$1(target,t2,anchor)},p(ctx2,dirty){8&dirty&&t_value!==(t_value=ctx2[3].custom.addPreset.title+"")&&set_data(t2,t_value)},d(detaching){detaching&&detach(t2)}}}function create_default_slot$3(ctx){let t0,accordion,updating_open,t1,if_block_anchor,current,show_if=ctx[6].ifHasValue(allowedFilterTabs.more),each_value=ensure_array_like(Object.entries(ctx[1])),each_blocks=[];for(let i2=0;i2<each_value.length;i2+=1)each_blocks[i2]=create_each_block$1(get_each_context$1(ctx,each_value,i2));const out=i2=>transition_out(each_blocks[i2],1,1,(()=>{each_blocks[i2]=null}));function accordion_open_binding_1(value){ctx[14](value)}let accordion_props={type:componentTypes.accordion.item,title:{value:ctx[3].custom.animation.title,desc:ctx[3].custom.animation.desc},$$slots:{default:[create_default_slot_2$2]},$$scope:{ctx:ctx}};void 0!==ctx[2][filtersSectionsIds.custom.animation]&&(accordion_props.open=ctx[2][filtersSectionsIds.custom.animation]),accordion=new Main$6({props:accordion_props}),binding_callbacks.push((()=>bind(accordion,"open",accordion_open_binding_1)));let if_block=show_if&&function(ctx){let btn,current;return btn=new Btn({props:{customClasses:"w-full",icon:faAdd,tooltip:{title:ctx[3].custom.addPreset.desc},$$slots:{default:[create_default_slot_1$3]},$$scope:{ctx:ctx}}}),btn.$on("click",ctx[15]),{c(){create_component(btn.$$.fragment)},m(target,anchor){mount_component(btn,target,anchor),current=!0},p(ctx2,dirty){const btn_changes={};8&dirty&&(btn_changes.tooltip={title:ctx2[3].custom.addPreset.desc}),33554440&dirty&&(btn_changes.$$scope={dirty:dirty,ctx:ctx2}),btn.$set(btn_changes)},i(local){current||(transition_in(btn.$$.fragment,local),current=!0)},o(local){transition_out(btn.$$.fragment,local),current=!1},d(detaching){destroy_component(btn,detaching)}}}(ctx);return{c(){for(let i2=0;i2<each_blocks.length;i2+=1)each_blocks[i2].c();t0=space(),create_component(accordion.$$.fragment),t1=space(),if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){for(let i2=0;i2<each_blocks.length;i2+=1)each_blocks[i2]&&each_blocks[i2].m(target,anchor);insert$1(target,t0,anchor),mount_component(accordion,target,anchor),insert$1(target,t1,anchor),if_block&&if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,dirty){if(7175&dirty){let i2;for(each_value=ensure_array_like(Object.entries(ctx2[1])),i2=0;i2<each_value.length;i2+=1){const child_ctx=get_each_context$1(ctx2,each_value,i2);each_blocks[i2]?(each_blocks[i2].p(child_ctx,dirty),transition_in(each_blocks[i2],1)):(each_blocks[i2]=create_each_block$1(child_ctx),each_blocks[i2].c(),transition_in(each_blocks[i2],1),each_blocks[i2].m(t0.parentNode,t0))}for(group_outros(),i2=each_value.length;i2<each_blocks.length;i2+=1)out(i2);check_outros()}const accordion_changes={};8&dirty&&(accordion_changes.title={value:ctx2[3].custom.animation.title,desc:ctx2[3].custom.animation.desc}),33554432&dirty&&(accordion_changes.$$scope={dirty:dirty,ctx:ctx2}),!updating_open&&4&dirty&&(updating_open=!0,accordion_changes.open=ctx2[2][filtersSectionsIds.custom.animation],add_flush_callback((()=>updating_open=!1))),accordion.$set(accordion_changes),show_if&&if_block.p(ctx2,dirty)},i(local){if(!current){for(let i2=0;i2<each_value.length;i2+=1)transition_in(each_blocks[i2]);transition_in(accordion.$$.fragment,local),transition_in(if_block),current=!0}},o(local){each_blocks=each_blocks.filter(Boolean);for(let i2=0;i2<each_blocks.length;i2+=1)transition_out(each_blocks[i2]);transition_out(accordion.$$.fragment,local),transition_out(if_block),current=!1},d(detaching){detaching&&(detach(t0),detach(t1),detach(if_block_anchor)),destroy_each(each_blocks,detaching),destroy_component(accordion,detaching),if_block&&if_block.d(detaching)}}}function create_fragment$6(ctx){let accordion,current;return accordion=new Main$6({props:{type:componentTypes.accordion.section,$$slots:{default:[create_default_slot$3]},$$scope:{ctx:ctx}}}),{c(){create_component(accordion.$$.fragment)},m(target,anchor){mount_component(accordion,target,anchor),current=!0},p(ctx2,[dirty]){const accordion_changes={};33554447&dirty&&(accordion_changes.$$scope={dirty:dirty,ctx:ctx2}),accordion.$set(accordion_changes)},i(local){current||(transition_in(accordion.$$.fragment,local),current=!0)},o(local){transition_out(accordion.$$.fragment,local),current=!1},d(detaching){destroy_component(accordion,detaching)}}}function instance$6($$self,$$props,$$invalidate){let $countBySection,$valuesWithLocales,$section,$locales;const{custom:custom2,locales:locales2,more:more2,items:items2}=filters;component_subscribe($$self,locales2,(value=>$$invalidate(3,$locales=value)));const{valuesWithLocales:valuesWithLocales,section:section2,valuesNotInDefault:valuesNotInDefault}=custom2;component_subscribe($$self,valuesWithLocales,(value=>$$invalidate(1,$valuesWithLocales=value))),component_subscribe($$self,section2,(value=>$$invalidate(2,$section=value)));const{countBySection:countBySection}=valuesNotInDefault;component_subscribe($$self,countBySection,(value=>$$invalidate(0,$countBySection=value)));const indicatorObj={position:componentPositions.indicator.left,type:componentTypes.indicator.neutral,customClasses:"!bg-primary-700 !w-2 !h-2 !ml-[-10px]"};return[$countBySection,$valuesWithLocales,$section,$locales,locales2,more2,items2,valuesWithLocales,section2,countBySection,indicatorObj,key=>key in filtersSectionsIds.custom,(key,countBySection2,section22)=>{let k="shadow"===key?"box-shadow":key;return k in $countBySection&&"number"==typeof countBySection2[k]&&countBySection2[k]>0&&!section22[key]},function(value,sectionKey){$$self.$$.not_equal($section[sectionKey],value)&&($section[sectionKey]=value,section2.set($section))},function(value){$$self.$$.not_equal($section[filtersSectionsIds.custom.animation],value)&&($section[filtersSectionsIds.custom.animation]=value,section2.set($section))},e=>{e.stopPropagation(),more2.addPreset.addCurrConfig()}]}let Main$5=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$6,create_fragment$6,safe_not_equal,{})}};function create_if_block$4(ctx){let btn,t2,popover,current;return btn=new Btn({props:{color:ctx[2]===ctx[0].id?componentTypes.btn.primary:componentTypes.btn.neutral,customClasses:"mr-2",$$slots:{default:[create_default_slot_2$1]},$$scope:{ctx:ctx}}}),btn.$on("click",ctx[8]),popover=new Popover({props:{triggeredBy:"[id^='"+ctx[7]+"']",class:"max-w-[230px] items-start cursor-auto text-[12px]",$$slots:{default:[create_default_slot$2]},$$scope:{ctx:ctx}}}),{c(){create_component(btn.$$.fragment),t2=space(),create_component(popover.$$.fragment)},m(target,anchor){mount_component(btn,target,anchor),insert$1(target,t2,anchor),mount_component(popover,target,anchor),current=!0},p(ctx2,dirty){const btn_changes={};5&dirty&&(btn_changes.color=ctx2[2]===ctx2[0].id?componentTypes.btn.primary:componentTypes.btn.neutral),1025&dirty&&(btn_changes.$$scope={dirty:dirty,ctx:ctx2}),btn.$set(btn_changes);const popover_changes={};1035&dirty&&(popover_changes.$$scope={dirty:dirty,ctx:ctx2}),popover.$set(popover_changes)},i(local){current||(transition_in(btn.$$.fragment,local),transition_in(popover.$$.fragment,local),current=!0)},o(local){transition_out(btn.$$.fragment,local),transition_out(popover.$$.fragment,local),current=!1},d(detaching){detaching&&detach(t2),destroy_component(btn,detaching),destroy_component(popover,detaching)}}}function create_default_slot_2$1(ctx){let t0,t1,span,fa,current,t0_value=ctx[0].name+"";return fa=new Fa({props:{icon:faInfo,class:"drop-shadow-lg",style:"color:"+functs.color.getHexDarken(ctx[0].opts.color)}}),{c(){t0=text(t0_value),t1=space(),span=element("span"),create_component(fa.$$.fragment),attr(span,"id",ctx[7]),attr(span,"class","w-[20px] h-[20px] ml-2 flex items-center justify-center rounded-full"),set_style(span,"background-color",ctx[0].opts.color)},m(target,anchor){insert$1(target,t0,anchor),insert$1(target,t1,anchor),insert$1(target,span,anchor),mount_component(fa,span,null),current=!0},p(ctx2,dirty){(!current||1&dirty)&&t0_value!==(t0_value=ctx2[0].name+"")&&set_data(t0,t0_value);const fa_changes={};1&dirty&&(fa_changes.style="color:"+functs.color.getHexDarken(ctx2[0].opts.color)),fa.$set(fa_changes),(!current||1&dirty)&&set_style(span,"background-color",ctx2[0].opts.color)},i(local){current||(transition_in(fa.$$.fragment,local),current=!0)},o(local){transition_out(fa.$$.fragment,local),current=!1},d(detaching){detaching&&(detach(t0),detach(t1),detach(span)),destroy_component(fa)}}}function create_if_block_1$2(ctx){let btn,current;return btn=new Btn({props:{color:componentTypes.btn.neutral,customClasses:"!py-1 px-2 w-full !my-2",$$slots:{default:[create_default_slot_1$2]},$$scope:{ctx:ctx}}}),btn.$on("click",ctx[9]),{c(){create_component(btn.$$.fragment)},m(target,anchor){mount_component(btn,target,anchor),current=!0},p(ctx2,dirty){const btn_changes={};1032&dirty&&(btn_changes.$$scope={dirty:dirty,ctx:ctx2}),btn.$set(btn_changes)},i(local){current||(transition_in(btn.$$.fragment,local),current=!0)},o(local){transition_out(btn.$$.fragment,local),current=!1},d(detaching){destroy_component(btn,detaching)}}}function create_default_slot_1$2(ctx){let t2,t_value=ctx[3].presets.user.btnRemove+"";return{c(){t2=text(t_value)},m(target,anchor){insert$1(target,t2,anchor)},p(ctx2,dirty){8&dirty&&t_value!==(t_value=ctx2[3].presets.user.btnRemove+"")&&set_data(t2,t_value)},d(detaching){detaching&&detach(t2)}}}function create_default_slot$2(ctx){let div0,t0,t1,div1,codeeditor,t2,if_block_anchor,current,t0_value=ctx[0].id+"";codeeditor=new Code_editor({props:{type:componentTypes.codeEditor.json,readonly:!0,value:functs.objectToJson(ctx[0].value),height:"100px",width:"200px",customClasses:"rounded-xl text-[10px] bg-gray-900 text-start border border-gray-700"}});let if_block=ctx[1]&&create_if_block_1$2(ctx);return{c(){div0=element("div"),t0=text(t0_value),t1=space(),div1=element("div"),create_component(codeeditor.$$.fragment),t2=space(),if_block&&if_block.c(),if_block_anchor=empty$1(),attr(div0,"class","flex justify-center"),attr(div1,"class","flex flex-col items-start py-1")},m(target,anchor){insert$1(target,div0,anchor),append(div0,t0),insert$1(target,t1,anchor),insert$1(target,div1,anchor),mount_component(codeeditor,div1,null),insert$1(target,t2,anchor),if_block&&if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,dirty){(!current||1&dirty)&&t0_value!==(t0_value=ctx2[0].id+"")&&set_data(t0,t0_value);const codeeditor_changes={};1&dirty&&(codeeditor_changes.value=functs.objectToJson(ctx2[0].value)),codeeditor.$set(codeeditor_changes),ctx2[1]?if_block?(if_block.p(ctx2,dirty),2&dirty&&transition_in(if_block,1)):(if_block=create_if_block_1$2(ctx2),if_block.c(),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block&&(group_outros(),transition_out(if_block,1,1,(()=>{if_block=null})),check_outros())},i(local){current||(transition_in(codeeditor.$$.fragment,local),transition_in(if_block),current=!0)},o(local){transition_out(codeeditor.$$.fragment,local),transition_out(if_block),current=!1},d(detaching){detaching&&(detach(div0),detach(t1),detach(div1),detach(t2),detach(if_block_anchor)),destroy_component(codeeditor),if_block&&if_block.d(detaching)}}}function create_fragment$5(ctx){let if_block_anchor,current,if_block=ctx[0]&&create_if_block$4(ctx);return{c(){if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){if_block&&if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,[dirty]){ctx2[0]?if_block?(if_block.p(ctx2,dirty),1&dirty&&transition_in(if_block,1)):(if_block=create_if_block$4(ctx2),if_block.c(),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block&&(group_outros(),transition_out(if_block,1,1,(()=>{if_block=null})),check_outros())},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(if_block_anchor),if_block&&if_block.d(detaching)}}}function instance$5($$self,$$props,$$invalidate){let $valueID,$locales,{value:value}=$$props,{rmBtn:rmBtn=!1}=$$props;const{presets:presets2,locales:locales2}=filters;component_subscribe($$self,locales2,(value2=>$$invalidate(3,$locales=value2)));const{valueID:valueID}=presets2;component_subscribe($$self,valueID,(value2=>$$invalidate(2,$valueID=value2)));const id2=functs.generateRamdomID();return $$self.$$set=$$props2=>{"value"in $$props2&&$$invalidate(0,value=$$props2.value),"rmBtn"in $$props2&&$$invalidate(1,rmBtn=$$props2.rmBtn)},[value,rmBtn,$valueID,$locales,presets2,locales2,valueID,id2,e=>{e.stopPropagation(),value&&presets2.update(value)},e=>{e.stopPropagation(),value&&presets2.removeCustom(value.id)}]}class Btn_1 extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$5,create_fragment$5,safe_not_equal,{value:0,rmBtn:1})}}function get_each_context(ctx,list,i2){const child_ctx=ctx.slice();return child_ctx[6]=list[i2],child_ctx}function get_each_context_1(ctx,list,i2){const child_ctx=ctx.slice();return child_ctx[6]=list[i2],child_ctx}function create_each_block_1(ctx){let btn,current;return btn=new Btn_1({props:{value:ctx[6]}}),{c(){create_component(btn.$$.fragment)},m(target,anchor){mount_component(btn,target,anchor),current=!0},p:noop,i(local){current||(transition_in(btn.$$.fragment,local),current=!0)},o(local){transition_out(btn.$$.fragment,local),current=!1},d(detaching){destroy_component(btn,detaching)}}}function create_default_slot_1$1(ctx){let each_1_anchor,current,each_value_1=ensure_array_like(ctx[2].list),each_blocks=[];for(let i2=0;i2<each_value_1.length;i2+=1)each_blocks[i2]=create_each_block_1(get_each_context_1(ctx,each_value_1,i2));const out=i2=>transition_out(each_blocks[i2],1,1,(()=>{each_blocks[i2]=null}));return{c(){for(let i2=0;i2<each_blocks.length;i2+=1)each_blocks[i2].c();each_1_anchor=empty$1()},m(target,anchor){for(let i2=0;i2<each_blocks.length;i2+=1)each_blocks[i2]&&each_blocks[i2].m(target,anchor);insert$1(target,each_1_anchor,anchor),current=!0},p(ctx2,dirty){if(4&dirty){let i2;for(each_value_1=ensure_array_like(ctx2[2].list),i2=0;i2<each_value_1.length;i2+=1){const child_ctx=get_each_context_1(ctx2,each_value_1,i2);each_blocks[i2]?(each_blocks[i2].p(child_ctx,dirty),transition_in(each_blocks[i2],1)):(each_blocks[i2]=create_each_block_1(child_ctx),each_blocks[i2].c(),transition_in(each_blocks[i2],1),each_blocks[i2].m(each_1_anchor.parentNode,each_1_anchor))}for(group_outros(),i2=each_value_1.length;i2<each_blocks.length;i2+=1)out(i2);check_outros()}},i(local){if(!current){for(let i2=0;i2<each_value_1.length;i2+=1)transition_in(each_blocks[i2]);current=!0}},o(local){each_blocks=each_blocks.filter(Boolean);for(let i2=0;i2<each_blocks.length;i2+=1)transition_out(each_blocks[i2]);current=!1},d(detaching){detaching&&detach(each_1_anchor),destroy_each(each_blocks,detaching)}}}function create_else_block$1(ctx){let span,t2,t_value=ctx[0].presets.user.none+"";return{c(){span=element("span"),t2=text(t_value),attr(span,"class","italic text-gray-700")},m(target,anchor){insert$1(target,span,anchor),append(span,t2)},p(ctx2,dirty){1&dirty&&t_value!==(t_value=ctx2[0].presets.user.none+"")&&set_data(t2,t_value)},i:noop,o:noop,d(detaching){detaching&&detach(span)}}}function create_if_block_1$1(ctx){let each_1_anchor,current,each_value=ensure_array_like(ctx[1]),each_blocks=[];for(let i2=0;i2<each_value.length;i2+=1)each_blocks[i2]=create_each_block(get_each_context(ctx,each_value,i2));const out=i2=>transition_out(each_blocks[i2],1,1,(()=>{each_blocks[i2]=null}));return{c(){for(let i2=0;i2<each_blocks.length;i2+=1)each_blocks[i2].c();each_1_anchor=empty$1()},m(target,anchor){for(let i2=0;i2<each_blocks.length;i2+=1)each_blocks[i2]&&each_blocks[i2].m(target,anchor);insert$1(target,each_1_anchor,anchor),current=!0},p(ctx2,dirty){if(2&dirty){let i2;for(each_value=ensure_array_like(ctx2[1]),i2=0;i2<each_value.length;i2+=1){const child_ctx=get_each_context(ctx2,each_value,i2);each_blocks[i2]?(each_blocks[i2].p(child_ctx,dirty),transition_in(each_blocks[i2],1)):(each_blocks[i2]=create_each_block(child_ctx),each_blocks[i2].c(),transition_in(each_blocks[i2],1),each_blocks[i2].m(each_1_anchor.parentNode,each_1_anchor))}for(group_outros(),i2=each_value.length;i2<each_blocks.length;i2+=1)out(i2);check_outros()}},i(local){if(!current){for(let i2=0;i2<each_value.length;i2+=1)transition_in(each_blocks[i2]);current=!0}},o(local){each_blocks=each_blocks.filter(Boolean);for(let i2=0;i2<each_blocks.length;i2+=1)transition_out(each_blocks[i2]);current=!1},d(detaching){detaching&&detach(each_1_anchor),destroy_each(each_blocks,detaching)}}}function create_each_block(ctx){let btn,current;return btn=new Btn_1({props:{value:ctx[6],rmBtn:!0}}),{c(){create_component(btn.$$.fragment)},m(target,anchor){mount_component(btn,target,anchor),current=!0},p(ctx2,dirty){const btn_changes={};2&dirty&&(btn_changes.value=ctx2[6]),btn.$set(btn_changes)},i(local){current||(transition_in(btn.$$.fragment,local),current=!0)},o(local){transition_out(btn.$$.fragment,local),current=!1},d(detaching){destroy_component(btn,detaching)}}}function create_default_slot$1(ctx){let current_block_type_index,if_block,if_block_anchor,current;const if_block_creators=[create_if_block_1$1,create_else_block$1],if_blocks=[];function select_block_type(ctx2,dirty){return ctx2[1]&&ctx2[1].length>0?0:1}return current_block_type_index=select_block_type(ctx),if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx),{c(){if_block.c(),if_block_anchor=empty$1()},m(target,anchor){if_blocks[current_block_type_index].m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,dirty){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx2),current_block_type_index===previous_block_index?if_blocks[current_block_type_index].p(ctx2,dirty):(group_outros(),transition_out(if_blocks[previous_block_index],1,1,(()=>{if_blocks[previous_block_index]=null})),check_outros(),if_block=if_blocks[current_block_type_index],if_block?if_block.p(ctx2,dirty):(if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx2),if_block.c()),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor))},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(if_block_anchor),if_blocks[current_block_type_index].d(detaching)}}}function create_fragment$4(ctx){let option,t2,if_block_anchor,current,show_if=ctx[4].ifHasValue(allowedFilterTabs.more);option=new Main$7({props:{type:componentTypes.option.section,title:{value:ctx[0].presets.official.title,desc:ctx[0].presets.official.desc},$$slots:{default:[create_default_slot_1$1]},$$scope:{ctx:ctx}}});let if_block=show_if&&function(ctx){let option,current;return option=new Main$7({props:{type:componentTypes.option.section,title:{value:ctx[0].presets.user.title,desc:ctx[0].presets.user.desc},$$slots:{default:[create_default_slot$1]},$$scope:{ctx:ctx}}}),{c(){create_component(option.$$.fragment)},m(target,anchor){mount_component(option,target,anchor),current=!0},p(ctx2,dirty){const option_changes={};1&dirty&&(option_changes.title={value:ctx2[0].presets.user.title,desc:ctx2[0].presets.user.desc}),2051&dirty&&(option_changes.$$scope={dirty:dirty,ctx:ctx2}),option.$set(option_changes)},i(local){current||(transition_in(option.$$.fragment,local),current=!0)},o(local){transition_out(option.$$.fragment,local),current=!1},d(detaching){destroy_component(option,detaching)}}}(ctx);return{c(){create_component(option.$$.fragment),t2=space(),if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){mount_component(option,target,anchor),insert$1(target,t2,anchor),if_block&&if_block.m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,[dirty]){const option_changes={};1&dirty&&(option_changes.title={value:ctx2[0].presets.official.title,desc:ctx2[0].presets.official.desc}),2048&dirty&&(option_changes.$$scope={dirty:dirty,ctx:ctx2}),option.$set(option_changes),show_if&&if_block.p(ctx2,dirty)},i(local){current||(transition_in(option.$$.fragment,local),transition_in(if_block),current=!0)},o(local){transition_out(option.$$.fragment,local),transition_out(if_block),current=!1},d(detaching){detaching&&(detach(t2),detach(if_block_anchor)),destroy_component(option,detaching),if_block&&if_block.d(detaching)}}}function instance$4($$self,$$props,$$invalidate){let $locales,$customList;const{presets:presets2,locales:locales2,items:items2}=filters;component_subscribe($$self,locales2,(value=>$$invalidate(0,$locales=value)));const{customList:customList}=presets2;return component_subscribe($$self,customList,(value=>$$invalidate(1,$customList=value))),[$locales,$customList,presets2,locales2,items2,customList]}let Main$4=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$4,create_fragment$4,safe_not_equal,{})}};const items=(()=>{const allowedItems=writable(void 0),value=derived([locales,allowedItems,custom.valuesNotInDefault.count,presets.isValueSet],(([$locales,$allowedItems,$customCount,$isPresetSet])=>{let items2;const itemsDefault=[{name:$locales.custom.title,desc:$locales.custom.desc,value:allowedFilterTabs.custom,indicator:$customCount>0,component:Main$5},{name:$locales.presets.title,desc:$locales.presets.desc,value:allowedFilterTabs.preset,indicator:$isPresetSet,component:Main$4},{name:$locales.more.title,desc:$locales.more.desc,value:allowedFilterTabs.more,component:Main$9}];return items2=$allowedItems&&Array.isArray($allowedItems)?itemsDefault.filter((d=>$allowedItems&&$allowedItems.includes(d.value))):itemsDefault,items2}));return{...value,allowedItems:allowedItems,ifHasValue:id2=>{if(!id2)return!1;return get_store_value(value).some((item=>item.value&&item.value===id2))}}})(),filters={custom:custom,presets:presets,locales:locales,styles:styles,tabs:tabs,more:more,active:active,items:items};function create_else_block(ctx){let div,div_class_value,current;const default_slot_template=ctx[7].default,default_slot=create_slot(default_slot_template,ctx,ctx[6],null);return{c(){div=element("div"),default_slot&&default_slot.c(),attr(div,"class",div_class_value="pp-s8-badge "+ctx[4]+" "+ctx[0]+" svelte-1rffbx6"),attr(div,"id",ctx[1]),attr(div,"title",ctx[3])},m(target,anchor){insert$1(target,div,anchor),default_slot&&default_slot.m(div,null),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||64&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[6],current?get_slot_changes(default_slot_template,ctx2[6],dirty,null):get_all_dirty_from_scope(ctx2[6]),null),(!current||1&dirty&&div_class_value!==(div_class_value="pp-s8-badge "+ctx2[4]+" "+ctx2[0]+" svelte-1rffbx6"))&&attr(div,"class",div_class_value),(!current||2&dirty)&&attr(div,"id",ctx2[1]),(!current||8&dirty)&&attr(div,"title",ctx2[3])},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){detaching&&detach(div),default_slot&&default_slot.d(detaching)}}}function create_if_block$2(ctx){let a,a_class_value,current;const default_slot_template=ctx[7].default,default_slot=create_slot(default_slot_template,ctx,ctx[6],null);return{c(){a=element("a"),default_slot&&default_slot.c(),attr(a,"class",a_class_value="pp-s8-badge "+ctx[4]+" "+ctx[0]+" svelte-1rffbx6"),attr(a,"id",ctx[1]),attr(a,"href",ctx[2]),attr(a,"target","_blank"),attr(a,"title",ctx[3])},m(target,anchor){insert$1(target,a,anchor),default_slot&&default_slot.m(a,null),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||64&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[6],current?get_slot_changes(default_slot_template,ctx2[6],dirty,null):get_all_dirty_from_scope(ctx2[6]),null),(!current||1&dirty&&a_class_value!==(a_class_value="pp-s8-badge "+ctx2[4]+" "+ctx2[0]+" svelte-1rffbx6"))&&attr(a,"class",a_class_value),(!current||2&dirty)&&attr(a,"id",ctx2[1]),(!current||4&dirty)&&attr(a,"href",ctx2[2]),(!current||8&dirty)&&attr(a,"title",ctx2[3])},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){detaching&&detach(a),default_slot&&default_slot.d(detaching)}}}function create_fragment$3(ctx){let current_block_type_index,if_block,if_block_anchor,current;const if_block_creators=[create_if_block$2,create_else_block],if_blocks=[];function select_block_type(ctx2,dirty){return ctx2[2]&&""!==ctx2[2]?0:1}return current_block_type_index=select_block_type(ctx),if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx),{c(){if_block.c(),if_block_anchor=empty$1()},m(target,anchor){if_blocks[current_block_type_index].m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,[dirty]){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx2),current_block_type_index===previous_block_index?if_blocks[current_block_type_index].p(ctx2,dirty):(group_outros(),transition_out(if_blocks[previous_block_index],1,1,(()=>{if_blocks[previous_block_index]=null})),check_outros(),if_block=if_blocks[current_block_type_index],if_block?if_block.p(ctx2,dirty):(if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx2),if_block.c()),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor))},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(if_block_anchor),if_blocks[current_block_type_index].d(detaching)}}}function instance$3($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope:$$scope}=$$props,{type:type2=componentTypes.badge.gray}=$$props,{customClasses:customClasses=""}=$$props,{id:id2=""}=$$props,{url:url=""}=$$props,{title:title=""}=$$props,badgeClass2="font-medium inline-flex items-center justify-center px-2.5 py-0.5 text-xs rounded-full whitespace-nowrap overflow-x-scroll "+{[componentTypes.badge.primary]:"border-gray-200 dark:border-gray-700 bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-300",[componentTypes.badge.secondary]:"border-gray-200 dark:border-gray-700 bg-secondary-100 text-secondary-800 dark:bg-secondary-900 dark:text-secondary-300",[componentTypes.badge.error]:"border-gray-200 dark:border-gray-700 bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",[componentTypes.badge.success]:"border-gray-200 dark:border-gray-700 bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",[componentTypes.badge.warning]:"border-gray-200 dark:border-gray-700 bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",[componentTypes.badge.gray]:"border-gray-200 dark:border-gray-700 bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",[componentTypes.badge.neutral]:"border-gray-200 dark:border-gray-700 bg-gray-700 text-gray-200",[componentTypes.badge.transparent]:""}[type2];return $$self.$$set=$$props2=>{"type"in $$props2&&$$invalidate(5,type2=$$props2.type),"customClasses"in $$props2&&$$invalidate(0,customClasses=$$props2.customClasses),"id"in $$props2&&$$invalidate(1,id2=$$props2.id),"url"in $$props2&&$$invalidate(2,url=$$props2.url),"title"in $$props2&&$$invalidate(3,title=$$props2.title),"$$scope"in $$props2&&$$invalidate(6,$$scope=$$props2.$$scope)},[customClasses,id2,url,title,badgeClass2,type2,$$scope,slots]}let Main$3=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$3,create_fragment$3,safe_not_equal,{type:5,customClasses:0,id:1,url:2,title:3})}};function create_if_block$1(ctx){let span,t2;return{c(){span=element("span"),t2=text(ctx[3])},m(target,anchor){insert$1(target,span,anchor),append(span,t2)},p(ctx2,dirty){8&dirty&&set_data(t2,ctx2[3])},d(detaching){detaching&&detach(span)}}}function create_fragment$2(ctx){let div,div_class_value,if_block=ctx[3]&&create_if_block$1(ctx);return{c(){div=element("div"),if_block&&if_block.c(),attr(div,"class",div_class_value=defaultClass+" "+(ctx[4]?ctx[5][ctx[4]]:ctx[5][sizeValues_medium])+" "+ctx[6][ctx[1]]+" "+(ctx[0]?ctx[7][ctx[0]]:"")+" "+ctx[2]+" svelte-nhgo2b")},m(target,anchor){insert$1(target,div,anchor),if_block&&if_block.m(div,null)},p(ctx2,[dirty]){ctx2[3]?if_block?if_block.p(ctx2,dirty):(if_block=create_if_block$1(ctx2),if_block.c(),if_block.m(div,null)):if_block&&(if_block.d(1),if_block=null),23&dirty&&div_class_value!==(div_class_value=defaultClass+" "+(ctx2[4]?ctx2[5][ctx2[4]]:ctx2[5][sizeValues_medium])+" "+ctx2[6][ctx2[1]]+" "+(ctx2[0]?ctx2[7][ctx2[0]]:"")+" "+ctx2[2]+" svelte-nhgo2b")&&attr(div,"class",div_class_value)},i:noop,o:noop,d(detaching){detaching&&detach(div),if_block&&if_block.d()}}}let defaultClass="flex-shrink-0 rounded-full text-[10px] absolute";function instance$2($$self,$$props,$$invalidate){let{position:position=componentPositions.indicator.bottom}=$$props,{type:type2=componentTypes.indicator.main}=$$props,{customClasses:customClasses=""}=$$props,{title:title}=$$props,{size:size}=$$props,sizeClass={[sizeValues_extraSmall]:"w-1 h-1",[sizeValues_small]:"w-2 h-2",[sizeValues_medium]:"w-4 h-4",[sizeValues_large]:"w-8 h-8",[sizeValues_extraLarge]:"w-10 h-10"},colorClass={[componentTypes.indicator.main]:"bg-primary-600 shadow-primary-500/50 text-primary-900",[componentTypes.indicator.error]:"bg-red-600 shadow-red-500/50 text-red-900",[componentTypes.indicator.info]:"bg-blue-600 shadow-blue-500/50 text-blue-900",[componentTypes.indicator.neutral]:"bg-gray-500 shadow-gray-500/50 text-gray-900",[componentTypes.indicator.warn]:"bg-yellow-600 shadow-yellow-500/50 text-yellow-900",[componentTypes.indicator.success]:"bg-green-600 shadow-green-500/50 text-green-900"},positionClass={[componentPositions.indicator.top]:"top-0 left-1/2 -translate-x-1/2 -translate-y-1/2",[componentPositions.indicator.bottom]:"bottom-0 left-1/2 -translate-x-1/2 translate-y-1/3",[componentPositions.indicator.left]:"top-1/2 left-0 -translate-x-1/2 -translate-y-1/2",[componentPositions.indicator.right]:"top-1/2 right-0 -translate-y-1/2 translate-x-1/3",[componentPositions.indicator.bottomLeft]:"bottom-0 left-0 -translate-x-1/2 translate-y-1/3",[componentPositions.indicator.bottomRight]:"bottom-0 right-0 translate-y-1/2 translate-x-1/3",[componentPositions.indicator.topLeft]:"top-0 left-0 -translate-x-1/2 -translate-y-1/2",[componentPositions.indicator.topRight]:"top-0 right-0 -translate-y-1/2 translate-x-1/3"};return $$self.$$set=$$props2=>{"position"in $$props2&&$$invalidate(0,position=$$props2.position),"type"in $$props2&&$$invalidate(1,type2=$$props2.type),"customClasses"in $$props2&&$$invalidate(2,customClasses=$$props2.customClasses),"title"in $$props2&&$$invalidate(3,title=$$props2.title),"size"in $$props2&&$$invalidate(4,size=$$props2.size)},[position,type2,customClasses,title,size,sizeClass,colorClass,positionClass]}let Main$2=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$2,create_fragment$2,safe_not_equal,{position:0,type:1,customClasses:2,title:3,size:4})}};function create_fragment$1(ctx){let div,fa,t2,span,div_class_value,current,mounted,dispose;fa=new Fa({props:{icon:ctx[3][ctx[1]].icon,class:iconClass+" "+ctx[3][ctx[1]].iconClass}});const default_slot_template=ctx[8].default,default_slot=create_slot(default_slot_template,ctx,ctx[7],null);return{c(){div=element("div"),create_component(fa.$$.fragment),t2=space(),span=element("span"),default_slot&&default_slot.c(),attr(span,"class","text-[13px]"),attr(div,"id",ctx[0]),attr(div,"class",div_class_value=divSection+" "+ctx[3][ctx[1]].divClass+" "+ctx[2])},m(target,anchor){insert$1(target,div,anchor),mount_component(fa,div,null),append(div,t2),append(div,span),default_slot&&default_slot.m(span,null),current=!0,mounted||(dispose=[listen(div,"mouseover",ctx[4]),listen(div,"mouseleave",ctx[5])],mounted=!0)},p(ctx2,[dirty]){const fa_changes={};2&dirty&&(fa_changes.icon=ctx2[3][ctx2[1]].icon),2&dirty&&(fa_changes.class=iconClass+" "+ctx2[3][ctx2[1]].iconClass),fa.$set(fa_changes),default_slot&&default_slot.p&&(!current||128&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[7],current?get_slot_changes(default_slot_template,ctx2[7],dirty,null):get_all_dirty_from_scope(ctx2[7]),null),(!current||1&dirty)&&attr(div,"id",ctx2[0]),(!current||6&dirty&&div_class_value!==(div_class_value=divSection+" "+ctx2[3][ctx2[1]].divClass+" "+ctx2[2]))&&attr(div,"class",div_class_value)},i(local){current||(transition_in(fa.$$.fragment,local),transition_in(default_slot,local),current=!0)},o(local){transition_out(fa.$$.fragment,local),transition_out(default_slot,local),current=!1},d(detaching){detaching&&detach(div),destroy_component(fa),default_slot&&default_slot.d(detaching),mounted=!1,run_all(dispose)}}}let divSection="rounded-lg p-2 flex flex-row items-center mt-4",iconClass="mr-2 text-xl";function instance$1($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope:$$scope}=$$props,{id:id2=""}=$$props,{type:type2=componentTypes.notification.info}=$$props,{customClasses:customClasses=""}=$$props,{onHover:onHover=!1}=$$props,data2={[componentTypes.notification.error]:{divClass:"bg-red-900/80 dark:bg-red-800/25 border border-red-900/50 text-red-200 dark:text-red-300",icon:faCircleExclamation,iconClass:"text-red-950/50 dark:text-red-400"},[componentTypes.notification.warn]:{divClass:"bg-yellow-900/80 dark:bg-yellow-800/25 border border-yellow-900/50 text-yellow-200 dark:text-yellow-300",icon:faTriangleExclamation,iconClass:"text-yellow-950/50 dark:text-yellow-400"},[componentTypes.notification.success]:{divClass:"bg-green-900/80 dark:bg-green-800/25 border border-green-900/50 text-green-200 dark:text-green-300",icon:faCircleCheck,iconClass:"text-green-950/50 dark:text-green-400"},[componentTypes.notification.info]:{divClass:"bg-gray-800/80 dark:bg-gray-800/25 border border-gray-900/50 text-gray-200 dark:text-gray-300",icon:faCircleInfo,iconClass:"text-gray-950/50 dark:text-gray-400"}};return $$self.$$set=$$props2=>{"id"in $$props2&&$$invalidate(0,id2=$$props2.id),"type"in $$props2&&$$invalidate(1,type2=$$props2.type),"customClasses"in $$props2&&$$invalidate(2,customClasses=$$props2.customClasses),"onHover"in $$props2&&$$invalidate(6,onHover=$$props2.onHover),"$$scope"in $$props2&&$$invalidate(7,$$scope=$$props2.$$scope)},[id2,type2,customClasses,data2,()=>{$$invalidate(6,onHover=!0)},()=>{$$invalidate(6,onHover=!1)},onHover,$$scope,slots]}let Main$1=class extends SvelteComponent{constructor(options){super(),init$1(this,options,instance$1,create_fragment$1,safe_not_equal,{id:0,type:1,customClasses:2,onHover:6})}};function create_if_block_1(ctx){let tooltip,current;return tooltip=new Tooltip({props:{class:"text-xs "+popoverClass,placement:ctx[3],triggeredBy:"#"+ctx[1],transition:blur,params:{duration:500},$$slots:{default:[create_default_slot_2]},$$scope:{ctx:ctx}}}),{c(){create_component(tooltip.$$.fragment)},m(target,anchor){mount_component(tooltip,target,anchor),current=!0},p(ctx2,dirty){const tooltip_changes={};8&dirty&&(tooltip_changes.placement=ctx2[3]),2&dirty&&(tooltip_changes.triggeredBy="#"+ctx2[1]),128&dirty&&(tooltip_changes.$$scope={dirty:dirty,ctx:ctx2}),tooltip.$set(tooltip_changes)},i(local){current||(transition_in(tooltip.$$.fragment,local),current=!0)},o(local){transition_out(tooltip.$$.fragment,local),current=!1},d(detaching){destroy_component(tooltip,detaching)}}}function create_if_block(ctx){let badge,t2,popover,current;return badge=new Main$3({props:{id:ctx[5],type:componentTypes.badge.transparent,customClasses:badgeClass+" "+ctx[4],$$slots:{default:[create_default_slot_1]},$$scope:{ctx:ctx}}}),popover=new Popover({props:{class:popoverClass,placement:ctx[3],triggeredBy:"#"+ctx[5],transition:blur,params:{duration:500},$$slots:{default:[create_default_slot]},$$scope:{ctx:ctx}}}),{c(){create_component(badge.$$.fragment),t2=space(),create_component(popover.$$.fragment)},m(target,anchor){mount_component(badge,target,anchor),insert$1(target,t2,anchor),mount_component(popover,target,anchor),current=!0},p(ctx2,dirty){const badge_changes={};16&dirty&&(badge_changes.customClasses=badgeClass+" "+ctx2[4]),129&dirty&&(badge_changes.$$scope={dirty:dirty,ctx:ctx2}),badge.$set(badge_changes);const popover_changes={};8&dirty&&(popover_changes.placement=ctx2[3]),128&dirty&&(popover_changes.$$scope={dirty:dirty,ctx:ctx2}),popover.$set(popover_changes)},i(local){current||(transition_in(badge.$$.fragment,local),transition_in(popover.$$.fragment,local),current=!0)},o(local){transition_out(badge.$$.fragment,local),transition_out(popover.$$.fragment,local),current=!1},d(detaching){detaching&&detach(t2),destroy_component(badge,detaching),destroy_component(popover,detaching)}}}function create_default_slot_2(ctx){let current;const default_slot_template=ctx[6].default,default_slot=create_slot(default_slot_template,ctx,ctx[7],null);return{c(){default_slot&&default_slot.c()},m(target,anchor){default_slot&&default_slot.m(target,anchor),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||128&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[7],current?get_slot_changes(default_slot_template,ctx2[7],dirty,null):get_all_dirty_from_scope(ctx2[7]),null)},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){default_slot&&default_slot.d(detaching)}}}function create_default_slot_1(ctx){let fa,current;return fa=new Fa({props:{icon:ctx[0]}}),{c(){create_component(fa.$$.fragment)},m(target,anchor){mount_component(fa,target,anchor),current=!0},p(ctx2,dirty){const fa_changes={};1&dirty&&(fa_changes.icon=ctx2[0]),fa.$set(fa_changes)},i(local){current||(transition_in(fa.$$.fragment,local),current=!0)},o(local){transition_out(fa.$$.fragment,local),current=!1},d(detaching){destroy_component(fa,detaching)}}}function create_default_slot(ctx){let current;const default_slot_template=ctx[6].default,default_slot=create_slot(default_slot_template,ctx,ctx[7],null);return{c(){default_slot&&default_slot.c()},m(target,anchor){default_slot&&default_slot.m(target,anchor),current=!0},p(ctx2,dirty){default_slot&&default_slot.p&&(!current||128&dirty)&&update_slot_base(default_slot,default_slot_template,ctx2,ctx2[7],current?get_slot_changes(default_slot_template,ctx2[7],dirty,null):get_all_dirty_from_scope(ctx2[7]),null)},i(local){current||(transition_in(default_slot,local),current=!0)},o(local){transition_out(default_slot,local),current=!1},d(detaching){default_slot&&default_slot.d(detaching)}}}function create_fragment(ctx){let current_block_type_index,if_block,if_block_anchor,current;const if_block_creators=[create_if_block,create_if_block_1],if_blocks=[];function select_block_type(ctx2,dirty){return ctx2[2]===componentTypes.tooltip.info?0:ctx2[2]===componentTypes.tooltip.main?1:-1}return~(current_block_type_index=select_block_type(ctx))&&(if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx)),{c(){if_block&&if_block.c(),if_block_anchor=empty$1()},m(target,anchor){~current_block_type_index&&if_blocks[current_block_type_index].m(target,anchor),insert$1(target,if_block_anchor,anchor),current=!0},p(ctx2,[dirty]){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx2),current_block_type_index===previous_block_index?~current_block_type_index&&if_blocks[current_block_type_index].p(ctx2,dirty):(if_block&&(group_outros(),transition_out(if_blocks[previous_block_index],1,1,(()=>{if_blocks[previous_block_index]=null})),check_outros()),~current_block_type_index?(if_block=if_blocks[current_block_type_index],if_block?if_block.p(ctx2,dirty):(if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx2),if_block.c()),transition_in(if_block,1),if_block.m(if_block_anchor.parentNode,if_block_anchor)):if_block=null)},i(local){current||(transition_in(if_block),current=!0)},o(local){transition_out(if_block),current=!1},d(detaching){detaching&&detach(if_block_anchor),~current_block_type_index&&if_blocks[current_block_type_index].d(detaching)}}}let badgeClass="!p-1 !font-semibold cursor-help focus:outline-none",popoverClass="w-64 z-10 text-xs font-light cursor-auto";function instance($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope:$$scope}=$$props,{icon:icon=faCircleQuestion}=$$props,{id:id2=""}=$$props,{type:type2=componentTypes.tooltip.info}=$$props,{position:position=componentPositions.tooltip.right}=$$props,{customClasses:customClasses=""}=$$props,badgeID="pp-s8-popover-"+id2;return $$self.$$set=$$props2=>{"icon"in $$props2&&$$invalidate(0,icon=$$props2.icon),"id"in $$props2&&$$invalidate(1,id2=$$props2.id),"type"in $$props2&&$$invalidate(2,type2=$$props2.type),"position"in $$props2&&$$invalidate(3,position=$$props2.position),"customClasses"in $$props2&&$$invalidate(4,customClasses=$$props2.customClasses),"$$scope"in $$props2&&$$invalidate(7,$$scope=$$props2.$$scope)},[icon,id2,type2,position,customClasses,badgeID,slots,$$scope]}class Main extends SvelteComponent{constructor(options){super(),init$1(this,options,instance,create_fragment,safe_not_equal,{icon:0,id:1,type:2,position:3,customClasses:4})}}browser$3.i18n.getMessage("filters_reset"),browser$3.i18n.getMessage("filters_reset_desc"),browser$3.i18n.getMessage("filters_hide"),browser$3.i18n.getMessage("filters_hide_desc"),browser$3.i18n.getMessage("filters_show"),browser$3.i18n.getMessage("filters_show_desc"),browser$3.i18n.getMessage("filters_presets"),browser$3.i18n.getMessage("filters_presets_desc"),browser$3.i18n.getMessage("filters_presets_official"),browser$3.i18n.getMessage("filters_presets_official_desc"),browser$3.i18n.getMessage("filters_presets_user"),browser$3.i18n.getMessage("filters_presets_user_desc"),browser$3.i18n.getMessage("filters_presets_user_none"),browser$3.i18n.getMessage("filters_presets_user_btnRemove"),browser$3.i18n.getMessage("filters_more"),browser$3.i18n.getMessage("filters_more_desc"),browser$3.i18n.getMessage("filters_more_copy"),browser$3.i18n.getMessage("filters_more_copy_desc"),browser$3.i18n.getMessage("filters_more_copy_btn"),browser$3.i18n.getMessage("filters_more_copy_btn_onClick"),browser$3.i18n.getMessage("filters_more_copy_nots_success"),browser$3.i18n.getMessage("filters_more_addPresets"),browser$3.i18n.getMessage("filters_more_addPresets_desc"),browser$3.i18n.getMessage("filters_more_addPresets_inputName"),browser$3.i18n.getMessage("filters_more_addPresets_inputName_desc"),browser$3.i18n.getMessage("filters_more_addPresets_inputName_placeholder"),browser$3.i18n.getMessage("filters_more_addPresets_inputObject"),browser$3.i18n.getMessage("filters_more_addPresets_inputObject_desc"),browser$3.i18n.getMessage("filters_more_addPresets_inputObject_placeholder"),browser$3.i18n.getMessage("filters_more_addPresets_btn"),browser$3.i18n.getMessage("filters_more_addPresets_nots_success"),browser$3.i18n.getMessage("filters_more_addPresets_nots_errorName"),browser$3.i18n.getMessage("filters_more_addPresets_nots_errorObject"),browser$3.i18n.getMessage("filters_custom"),browser$3.i18n.getMessage("filters_custom_desc"),browser$3.i18n.getMessage("filters_custom_border"),browser$3.i18n.getMessage("filters_custom_border_desc"),browser$3.i18n.getMessage("filters_custom_values_borderWidth"),browser$3.i18n.getMessage("filters_custom_values_borderWidth_desc"),browser$3.i18n.getMessage("filters_custom_values_borderRadius"),browser$3.i18n.getMessage("filters_custom_values_borderRadius_desc"),browser$3.i18n.getMessage("filters_custom_values_borderStyle"),browser$3.i18n.getMessage("filters_custom_values_borderStyle_desc"),browser$3.i18n.getMessage("filters_custom_values_borderColor"),browser$3.i18n.getMessage("filters_custom_values_borderColor_desc"),browser$3.i18n.getMessage("filters_custom_values_shadow"),browser$3.i18n.getMessage("filters_custom_values_shadow_desc"),browser$3.i18n.getMessage("filters_custom_values_shadowX"),browser$3.i18n.getMessage("filters_custom_values_shadowX_desc"),browser$3.i18n.getMessage("filters_custom_values_shadowY"),browser$3.i18n.getMessage("filters_custom_values_shadowY_desc"),browser$3.i18n.getMessage("filters_custom_values_shadowSpread"),browser$3.i18n.getMessage("filters_custom_values_shadowSpread_desc"),browser$3.i18n.getMessage("filters_custom_values_shadowBlur"),browser$3.i18n.getMessage("filters_custom_values_shadowBlur_desc"),browser$3.i18n.getMessage("filters_custom_values_shadowInset"),browser$3.i18n.getMessage("filters_custom_values_shadowInset_desc"),browser$3.i18n.getMessage("filters_custom_values_shadowColor"),browser$3.i18n.getMessage("filters_custom_values_shadowColor_desc"),browser$3.i18n.getMessage("filters_custom_values_filter"),browser$3.i18n.getMessage("filters_custom_values_filter_desc"),browser$3.i18n.getMessage("filters_custom_values_filterBlur"),browser$3.i18n.getMessage("filters_custom_values_filterBlur_desc"),browser$3.i18n.getMessage("filters_custom_values_filterBrightness"),browser$3.i18n.getMessage("filters_custom_values_filterBrightness_desc"),browser$3.i18n.getMessage("filters_custom_values_filterContrast"),browser$3.i18n.getMessage("filters_custom_values_filterContrast_desc"),browser$3.i18n.getMessage("filters_custom_values_filterGrayscale"),browser$3.i18n.getMessage("filters_custom_values_filterGrayscale_desc"),browser$3.i18n.getMessage("filters_custom_values_filterHueRotate"),browser$3.i18n.getMessage("filters_custom_values_filterHueRotate_desc"),browser$3.i18n.getMessage("filters_custom_values_filterInvert"),browser$3.i18n.getMessage("filters_custom_values_filterInvert_desc"),browser$3.i18n.getMessage("filters_custom_values_filterOpacity"),browser$3.i18n.getMessage("filters_custom_values_filterOpacity_desc"),browser$3.i18n.getMessage("filters_custom_values_filterSaturation"),browser$3.i18n.getMessage("filters_custom_values_filterSaturation_desc"),browser$3.i18n.getMessage("filters_custom_values_filterSepia"),browser$3.i18n.getMessage("filters_custom_values_filterSepia_desc"),browser$3.i18n.getMessage("filters_custom_values_animation"),browser$3.i18n.getMessage("filters_custom_values_animation_desc"),browser$3.i18n.getMessage("filters_custom_values_animation_nots_comingsoon"),browser$3.i18n.getMessage("filters_custom_values_animation_nots_comingsoon_desc"),browser$3.i18n.getMessage("filters_custom_values_addPreset"),browser$3.i18n.getMessage("filters_custom_values_addPreset_desc");const defaultData$1={[optionsIds.allowSites.youtube]:{urlStarts:allowSites.youtube,videoSelector:["video"],defaultValue:!0,selectorForBtn:[{position:insertedAdjacentPosition_afterbegin,query:".ytp-right-controls"}]},[optionsIds.allowSites.vimeo]:{urlStarts:allowSites.vimeo,videoSelector:["video"],defaultValue:!0,selectorForBtn:[{position:insertedAdjacentPosition_afterend,query:"video"}]},[optionsIds.allowSites.twitch]:{urlStarts:allowSites.twitch,videoSelector:["video"],defaultValue:!1,selectorForBtn:[{position:insertedAdjacentPosition_afterbegin,query:".player-controls__right-control-group"}]},[optionsIds.allowSites.filmin]:{urlStarts:allowSites.filmin,videoSelector:["video"],defaultValue:!1,selectorForBtn:[{position:insertedAdjacentPosition_afterend,query:"video"}]},[optionsIds.allowSites.disney]:{urlStarts:allowSites.disney,videoSelector:["video"],defaultValue:!1,selectorForBtn:[{position:insertedAdjacentPosition_afterend,query:"video"}]},[optionsIds.allowSites.netflix]:{urlStarts:allowSites.netflix,videoSelector:["video"],defaultValue:!1,selectorForBtn:[{position:insertedAdjacentPosition_afterend,query:"video"}]},[optionsIds.allowSites.primevideo]:{urlStarts:allowSites.primevideo,videoSelector:["video"],defaultValue:!1,selectorForBtn:[{position:insertedAdjacentPosition_afterend,query:"video"}]}};componentTypes.option.section,browser$3.i18n.getMessage("opts_allowedSites"),optionsIds.allowSites.youtube,componentTypes.option.checkbox,browser$3.i18n.getMessage("opts_allowedSites_youtube"),defaultData$1[optionsIds.allowSites.youtube].defaultValue,optionsIds.allowSites.vimeo,componentTypes.option.checkbox,browser$3.i18n.getMessage("opts_allowedSites_vimeo"),defaultData$1[optionsIds.allowSites.vimeo].defaultValue,optionsIds.allowSites.twitch,componentTypes.option.checkbox,browser$3.i18n.getMessage("opts_allowedSites_twitch"),defaultData$1[optionsIds.allowSites.twitch].defaultValue,optionsIds.allowSites.disney,componentTypes.option.checkbox,browser$3.i18n.getMessage("opts_allowedSites_disney"),defaultData$1[optionsIds.allowSites.disney].defaultValue,optionsIds.allowSites.netflix,browser$3.i18n.getMessage("opts_allowedSites_comingsoon"),componentTypes.option.checkbox,browser$3.i18n.getMessage("opts_allowedSites_netflix"),defaultData$1[optionsIds.allowSites.netflix].defaultValue,optionsIds.allowSites.primevideo,browser$3.i18n.getMessage("opts_allowedSites_comingsoon"),componentTypes.option.checkbox,browser$3.i18n.getMessage("opts_allowedSites_primevideo"),defaultData$1[optionsIds.allowSites.primevideo].defaultValue,optionsIds.allowSites.filmin,componentTypes.option.checkbox,browser$3.i18n.getMessage("opts_allowedSites_filmin"),defaultData$1[optionsIds.allowSites.filmin].defaultValue;const defaultData={[optionsIds.filtersSidebar.display]:{defaultValue:!0},[optionsIds.filtersSidebar.insidePlayer]:{defaultValue:!1},[optionsIds.filtersSidebar.popupPosition]:{defaultValue:componentPositions.filters.sidebar.right},[optionsIds.filtersSidebar.buttonPosition]:{defaultValue:componentPositions.filters.btn.bottomLeft},[optionsIds.filtersSidebar.styleTheme]:{defaultValue:optBtnStylesIds_theme}};componentTypes.option.section,browser$3.i18n.getMessage("opts_filters_popup"),browser$3.i18n.getMessage("opts_filters_popup_description"),optionsIds.filtersSidebar.popupPosition,componentTypes.option.radio,browser$3.i18n.getMessage("opts_filters_popup_position_left"),componentPositions.filters.sidebar.left,browser$3.i18n.getMessage("opts_filters_popup_position_right"),componentPositions.filters.sidebar.right,defaultData[optionsIds.filtersSidebar.popupPosition].defaultValue,browser$3.i18n.getMessage("opts_filters_popup_position"),componentTypes.option.section,browser$3.i18n.getMessage("opts_filters_btn"),browser$3.i18n.getMessage("opts_filters_btn_description"),optionsIds.filtersSidebar.display,componentTypes.option.checkbox,browser$3.i18n.getMessage("opts_filters_btn_display"),browser$3.i18n.getMessage("opts_filters_btn_display_description"),defaultData[optionsIds.filtersSidebar.display].defaultValue,optionsIds.filtersSidebar.insidePlayer,componentTypes.option.checkbox,browser$3.i18n.getMessage("opts_filters_btn_insidePlaye"),browser$3.i18n.getMessage("opts_filters_btn_insidePlayer_description"),browser$3.i18n.getMessage("opts_allowedSites_comingsoon"),defaultData[optionsIds.filtersSidebar.insidePlayer].defaultValue,optionsIds.filtersSidebar.buttonPosition,componentTypes.option.select,browser$3.i18n.getMessage("opts_filters_btn_position_bottomLeft"),componentPositions.filters.btn.bottomLeft,browser$3.i18n.getMessage("opts_filters_btn_position_bottomRight"),componentPositions.filters.btn.bottomRight,browser$3.i18n.getMessage("opts_filters_btn_position_topLeft"),componentPositions.filters.btn.topLeft,browser$3.i18n.getMessage("opts_filters_btn_position_topRight"),componentPositions.filters.btn.topRight,defaultData[optionsIds.filtersSidebar.buttonPosition].defaultValue,browser$3.i18n.getMessage("opts_filters_btn_position"),browser$3.i18n.getMessage("opts_filters_btn_position_description"),optionsIds.filtersSidebar.styleTheme,componentTypes.option.select,browser$3.i18n.getMessage("opts_filters_btn_theme_default"),browser$3.i18n.getMessage("opts_filters_btn_theme_minimal"),browser$3.i18n.getMessage("opts_filters_btn_theme_minimal_dark"),defaultData[optionsIds.filtersSidebar.styleTheme].defaultValue,browser$3.i18n.getMessage("opts_filters_btn_theme"),browser$3.i18n.getMessage("opts_filters_btn_theme_description");const storageAppShared={id:"",defaultValue:void 0,group:storageGroupsIds.content,validate:value=>!!value,async set(value,type2=storageSetIds_set){this.validate(value)&&(type2===storageSetIds_set?store$1.setKey(this.id,value):store$1.setKeyWithDebounce(this.id,value))},async get(){const storeRes=await store$1.get(this.id);return this.validate(storeRes)?storeRes:void 0},async init(){await this.get()||this.set(this.defaultValue)}},storageApp={[storageIds_active]:{...storageAppShared,id:storageIds_active,defaultValue:!1,validate:v=>"boolean"==typeof v},[storageIds_hide]:{...storageAppShared,id:storageIds_hide,defaultValue:!1,validate:v=>"boolean"==typeof v},[storageIds_presets]:{...storageAppShared,id:storageIds_presets,defaultValue:{value:"",customList:[]},validate:v=>!!(v&&"object"==typeof v&&"value"in v&&"customList"in v)},[storageIds_options]:{...storageAppShared,id:storageIds_options,group:storageGroupsIds.option,defaultValue:(()=>{const res={};for(const[key,value]of Object.entries(defaultData$1))res[key]=value.defaultValue;for(const[_key,_value]of Object.entries(defaultData))res[_key]=_value.defaultValue;return res})(),async set(value,type2=storageSetIds_set){const store2=await this.get(),setFunc=storageAppShared.set.bind(this);await setFunc(functs.mergeDeep(store2,value),type2)},validate(v){if(v&&"object"==typeof v&&!Array.isArray(v)){const defautlKeys=Object.keys(this.defaultValue);for(const value of Object.keys(v))if(!defautlKeys.includes(value))return!1;return!0}return!1}},[storageIds_values]:{...storageAppShared,id:storageIds_values,defaultValue:void 0,validate:v=>!!(v&&Array.isArray(v)&&v.length>0)}},getAll=async()=>await store$1.get(null),storage={value:storageApp,init:async()=>{const initGet=await getAll();if(initGet&&"object"==typeof initGet&&!functs.isObjectEmpty(initGet))return;const res={};for(const storage2 of Object.values(storageApp))res[storage2.id]=storage2.defaultValue;await store$1.set(res)},clearAll:()=>store$1.clearAll(),getAll:getAll,getGroup:async(type2=storageGroupsIds.content)=>{const res={};for(const[key,storage2]of Object.entries(storageApp))storage2.group==storageGroupsIds[type2]&&(res[key]=await storage2.get());return res}},getAllUrlPatterns=()=>{const res=[];for(const value of Object.values(defaultData$1))if(Array.isArray(value.urlStarts)){const urlPatterns=value.urlStarts.map((v=>v+"*"));res.push(...urlPatterns)}return res};browser$3.i18n.getMessage("filters_btn"),componentPositions.filters.btn.bottomLeft,componentTypes.btn.primary,componentTypes.indicator.main,componentPositions.filters.sidebar.right;(()=>{const store2=writable([])})();const storeDefault={};writable("options"),writable(storeDefault);class Super{constructor(){this.browser=browser$3,this.pkg=pkg,this.pkgMain=pkgMain,this.manifest=this.browser.runtime.getManifest(),this.isMan3=3===Number(this.manifest.manifest_version),this.data=data}}class ContextMenuSuper extends Super{constructor(){super(),this.extensionId="pp-s8-super8",this.orgId="pp-s8-pigeonposse",this.extensionPageId="pp-s8-page",this.contextMenus=this.browser.contextMenus||this.browser.menus,this.contextTypeAction=this.browser.isChromium()&&this.isMan3?"action":"browser_action"}createMenus(array){for(let i2=0;i2<array.length;i2++)this.contextMenus.create(array[i2])}createMenuSeparator(id2,content2=[this.contextTypeAction]){this.contextMenus.create({id:id2,type:"separator",contexts:content2})}}class ContextMenuOrg extends ContextMenuSuper{constructor(){super(...arguments),__privateAdd(this,_values),__privateAdd(this,_functions)}setMenu(){this.createMenus(__privateMethod(this,_values,values_fn).call(this))}init(){__privateMethod(this,_functions,functions_fn).call(this)}}_values=new WeakSet,values_fn=function(){const id2=this.orgId,contexts=[this.contextTypeAction];return[{id:id2,title:"PigeonPosse Collective \ud83d\udc26\ud83c\udf08",contexts:contexts},{parentId:id2,id:id2+"_description",title:this.browser.i18n.getMessage("orgMenuDesc"),enabled:!1,contexts:contexts},{parentId:id2,id:id2+"_separator",type:"separator",contexts:contexts},{parentId:id2,id:id2+"_donate",title:"\ud83d\udc9c "+this.browser.i18n.getMessage("donate"),contexts:contexts},{parentId:id2,id:id2+"_web",title:"\ud83c\udf10 "+this.browser.i18n.getMessage("web"),contexts:contexts},{parentId:id2,id:id2+"_about",title:"\ud83d\udc26 "+this.browser.i18n.getMessage("about"),contexts:contexts},{parentId:id2,id:id2+"_more",title:"\ud83d\ude80 "+this.browser.i18n.getMessage("moreProjects"),contexts:contexts}]},_functions=new WeakSet,functions_fn=function(){this.contextMenus.onClicked.addListener((info=>{const createTabs=this.browser.tabs.create;info.menuItemId===this.orgId+"_more"&&createTabs({url:this.data.collectiveRepoUrl}),info.menuItemId===this.orgId+"_about"&&createTabs({url:this.data.collectiveAboutUrl}),info.menuItemId===this.orgId+"_donate"&&createTabs({url:this.data.collectiveFundingUrl}),info.menuItemId===this.orgId+"_web"&&createTabs({url:this.data.collectiveWebUrl})}))};class ContextMenuExt extends ContextMenuSuper{constructor(){super(...arguments),__privateAdd(this,_values2),__privateAdd(this,_functions2)}setMenu(){this.createMenus(__privateMethod(this,_values2,values_fn2).call(this))}init(){__privateMethod(this,_functions2,functions_fn2).call(this)}}_values2=new WeakSet,values_fn2=function(){const id2=this.extensionId,contexts=[this.contextTypeAction];return[{id:id2,title:this.manifest.name,contexts:contexts},{parentId:id2,id:id2+"_description",title:this.browser.i18n.getMessage("extMenuDesc"),enabled:!1,contexts:contexts},{parentId:id2,id:id2+"_separator",type:"separator",contexts:contexts},{parentId:id2,id:id2+"_reviews",title:"\u2b50\ufe0f "+this.browser.i18n.getMessage("review"),contexts:contexts},{parentId:id2,id:id2+"_contribute",title:"\ud83d\udc69\u200d\ud83d\udcbb "+this.browser.i18n.getMessage("contribute"),contexts:contexts},{parentId:id2,id:id2+"_issues",title:"\ud83d\udc1e "+this.browser.i18n.getMessage("issues"),contexts:contexts},{parentId:id2,id:id2+"_version",title:"v"+this.manifest.version,enabled:!1,contexts:contexts}]},_functions2=new WeakSet,functions_fn2=function(){this.contextMenus.onClicked.addListener((info=>{const createTabs=this.browser.tabs.create;info.menuItemId===this.extensionId+"_issues"&&createTabs({url:this.data.extRepoBugsUrl}),info.menuItemId===this.extensionId+"_contribute"&&createTabs({url:this.data.extRepoUrl}),info.menuItemId===this.extensionId+"_reviews"&&createTabs({url:this.data.extStoreUrl})}))};class ContextMenuContent extends ContextMenuSuper{constructor(){super(...arguments),__privateAdd(this,_values3),__privateAdd(this,_functions3)}setMenu(){this.createMenus(__privateMethod(this,_values3,values_fn3).call(this))}init(){__privateMethod(this,_functions3,functions_fn3).call(this)}}_values3=new WeakSet,values_fn3=function(){return[{id:this.extensionPageId,title:this.browser.i18n.getMessage("contextMenu_page_open"),contexts:["page","selection"],enabled:!1,documentUrlPatterns:getAllUrlPatterns()}]},_functions3=new WeakSet,functions_fn3=function(){this.browser.tabs.onUpdated.addListener((async(tabId,changeInfo,tab)=>{if("loading"===tab.status){const siteData=await(async(url,back=!1)=>{const store2=await storage.value[storageIds_options].get(),currUrl=url||back?!(!url||!back)&&url:window.location.href;if(!currUrl)return;const isAllowed=(()=>{const isAllowedOptionChecked=key=>void 0!==store2&&key in store2&&!0===store2[key];for(const[key,value]of Object.entries(defaultData$1))if(isAllowedOptionChecked(key))for(const urlStarts of value.urlStarts)if(currUrl.startsWith(urlStarts))return!0;return!1})(),data2=(()=>{for(const value of Object.values(defaultData$1))for(const urlValue of value.urlStarts)if(currUrl.startsWith(urlValue))return value})();return isAllowed&&store2&&data2?{isAllowed:isAllowed,data:data2,store:store2}:void 0})(tab.url,!0);(null==siteData?void 0:siteData.isAllowed)?this.contextMenus.update(this.extensionPageId,{enabled:!0}):this.contextMenus.update(this.extensionPageId,{enabled:!1})}})),this.contextMenus.onClicked.addListener(((info,tab)=>{tab&&"id"in tab&&void 0!==tab.id?(this.browser.tabs.sendMessage(tab.id,{type:messagesIds_activeFilters,data:!0}),this.browser.runtime.sendMessage({type:messagesIds_log,data:{time:getDateString(),type:"info",message:"Super8 opened with Context menu"}})):this.browser.runtime.sendMessage({type:messagesIds_log,data:{time:getDateString(),type:"error",message:"Error openning Super8 with Context menu"}})}))};class ContextMenu extends Super{constructor(){super(),__privateAdd(this,_menus),__privateAdd(this,_menuExt,void 0),__privateAdd(this,_menuOrg,void 0),__privateAdd(this,_menuContent,void 0),__privateSet(this,_menuExt,new ContextMenuExt),__privateSet(this,_menuOrg,new ContextMenuOrg),__privateSet(this,_menuContent,new ContextMenuContent)}init(){this.browser.runtime.onInstalled.addListener((()=>{__privateMethod(this,_menus,menus_fn).call(this),__privateGet(this,_menuExt).init(),__privateGet(this,_menuOrg).init(),__privateGet(this,_menuContent).init()}))}}_menuExt=new WeakMap,_menuOrg=new WeakMap,_menuContent=new WeakMap,_menus=new WeakSet,menus_fn=function(){__privateGet(this,_menuExt).setMenu(),__privateGet(this,_menuExt).createMenuSeparator("separator_id"),__privateGet(this,_menuOrg).setMenu(),__privateGet(this,_menuContent).setMenu()};class ExtStorage extends Super{init(){this.browser.runtime.onInstalled.addListener((async()=>{await storage.init()}))}}class Core extends Super{constructor(){super(),__privateAdd(this,_setErrors),__privateAdd(this,_contextMenu,void 0),__privateAdd(this,_storage,void 0),__privateSet(this,_contextMenu,new ContextMenu),__privateSet(this,_storage,new ExtStorage)}async init(){__privateGet(this,_storage).init(),__privateGet(this,_contextMenu).init(),__privateMethod(this,_setErrors,setErrors_fn).call(this)}}_contextMenu=new WeakMap,_storage=new WeakMap,_setErrors=new WeakSet,setErrors_fn=function(){this.browser.runtime.onMessage.addListener((message=>{message.error&&console.error(message)}))};try{(async()=>{const core=new Core;await core.init()})()}catch(e){console.error(e)}}();
