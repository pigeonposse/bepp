###############################################################################
# UPDATE REPO INFO
###############################################################################

name: Update repo info

###############################################################################
# ON
###############################################################################

on:
  push:
    branches:
      - main
    paths:
      - 'package.json'
  workflow_dispatch:

###############################################################################
# JOBS
###############################################################################

jobs:
  build:
    name: Update repo info
    runs-on: ubuntu-latest

    ###########################################################################
    # STEPS
    ###########################################################################

    steps:

      #########################################################################
      # INIT REPO
      #########################################################################

      - name: ðŸ›Ž Checkout
        uses: actions/checkout@v3


      #########################################################################
      # GET DATA
      #########################################################################

      - name: Get PACKAGE data
        id: pkg
        run: |
          content=$(jq -c . ./package.json)
          echo "::set-output name=packageJson::$content"

      #########################################################################
      # UPDATE
      #########################################################################

      - name: Change GitHub data
        run: |
          gh repo edit $(echo ${{ steps.pkg.outputs.packageJson }} | jq -r '.repository.url') -d "$(echo ${{ steps.pkg.outputs.packageJson }} | jq -r '.description')"
          gh repo edit $(echo ${{ steps.pkg.outputs.packageJson }} | jq -r '.repository.url') --add-topic $(echo ${{ steps.pkg.outputs.packageJson }} | jq -r '.keywords | join(",")')
          gh repo edit $(echo ${{ steps.pkg.outputs.packageJson }} | jq -r '.repository.url') --homepage $(echo ${{ steps.pkg.outputs.packageJson }} | jq -r '.homepage')
        env:
            GH_TOKEN: ${{ secrets.GH_TOKEN }}
			
###############################################################################
